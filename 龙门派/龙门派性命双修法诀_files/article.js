if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(d){if(!d||!d.length){return null}var a=d.split(".");var c=Sina;for(var b=(a[0]=="Sina")?1:0;b<a.length;++b){c[a[b]]=c[a[b]]||{};c=c[a[b]]}return c};function $E(b){var a=typeof b=="string"?document.getElementById(b):b;if(a!=null){return a}return null}function $C(a){return document.createElement(a)}function $N(a){return document.getElementsByName(a)}function $T(b,a){return b.getElementsByTagName(a)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var b=function(f,c){var d=f;return function(){return d.apply(c,arguments)}};var a="Debug";if(window[a]==null||typeof window[a].log=="undefined"){window[a]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(c){this.addData(c,1)},error:function(c){this.addData(c,2)},warning:function(c){this.addData(c,3)},info:function(c){this.addData(c,4)},log:function(c){this.addData(c,5)},dir:function(c){this.addData(c,5)},addData:function(f,d,c,g){if(f==null){return}if(typeof f!="object"){f=f.toString()}var j={type:d||"5",color:c||this.baseColor[d].color,bgcolor:g||this.baseColor[d].bgcolor};this.cacheData.push([f,j]);if(this.initFinished==true){this.showCurrentData([f,j])}}};window.trace=b(window[a].log,window[a]);window.traceError=b(window[a].error,window[a])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(d,c){if(d==null&&d.constructor!=Array){return[]}var f=0,b=d.length,g=[];while(f<b){var a=c(d[f],f);if(a!==null){g[g.length]=a}f++}return g};Sina.pkg("Core.Events");(function(n){var g=navigator.userAgent.toLowerCase();var f={$winXP:/windows nt 5.1/.test(g),$winVista:/windows nt 6.0/.test(g),$win7:/windows nt 6.1/.test(g),$macOS:/mac/.test(g)};var a={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var o={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(g)||n.opera){a.$OPERA=true}else{if(/chrome\/(\S+)/.test(g)){a.$CHROME=true}else{if(/safari\/(\S+)/.test(g)){a.$SAFARI=true}else{if(/msie/.test(g)){o.$IE=true;if(/360se/.test(g)){a.$360=true}else{if(/tencenttraveler/.test(g)){a.$TT=true}else{if(/se\s\S+\smetasr\s\d+\.\d+/.test(g)){a.$SOGO=true}}}var b=g.match(/msie (\d+)/);var d=parseInt(b[1]);o.$IE=d;if(d===8){a.$IE8=true}else{if(d===6){a.$IE6=true}else{if(d===9){a.$IE9=true}else{if(d===7){a.$IE7=true}else{if(d===10){a.$IE10=true}}}}}}else{if(/firefox/.test(g)){var b=g.match(/firefox\/(\d+)/);a.$FF=parseInt(b[1]);if(/firefox\/3/.test(g)){a.$FF3=true}else{if(/firefox\/4/.test(g)){a.$FF4=true}else{if(/firefox\/2/.test(g)){a.$FF2=true}}}}else{if(/trident\/7.0/.test(g)&&/rv:11.0/.test(g)){o.$IE=11;a.$IE11=true}}}}}}try{var m=window.external;a.$Maxthon=m.max_version?true:false}catch(c){}if(/applewebkit\/(\S+)/.test(g)){o.$WEBKIT=true}else{if(/khtml\/(\S+)/.test(g)){o.$KHTML=true}else{if(/rv:([^\)]+)\) gecko\/\d{8}/.test(g)){o.$MOZ=true}}}a.$MOBILE=/mobile/i.test(g);if(!a.$MOBILE){a.$MOBILE=/HTC/.test(g)}function j(s,q){var r;for(r in q){s[r]=q[r]}}j(n,a);j(n,o);j(n,f)})(window);Core.Events.addEvent=function(g,c,a,d){var f=typeof g=="string"?$E(g):g;if(f==null){trace("addEvent 找不到对象："+g);return}if(typeof d=="undefined"){d=false}if(typeof a=="undefined"){a="click"}if(f.addEventListener){if(a=="mousewheel"&&$FF){a="DOMMouseScroll"}f.addEventListener(a,c,d);return true}else{if(f.attachEvent){var b=f.attachEvent("on"+a,c);return true}else{f["on"+a]=c}}};Core.Events.removeEvent=function(b,a,c){var d=$E(b);if(d==null){trace("removeEvent 找不到对象："+b);return}if(typeof a!="function"){return}if(typeof c=="undefined"){c="click"}if(d.addEventListener){d.removeEventListener(c,a,false)}else{if(d.attachEvent){d.detachEvent("on"+c,a)}}a[c]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(d,b,a){a=a==null?[]:a;var c=d;return function(){return c.apply(b,a)}};Core.Array.findit=function(a,c){var b=-1;Core.Array.foreach(a,function(f,d){if(c==f){b=d}});return b};window.onerror=function(c,b,a){trace("Error occured:"+c+"<br/>file:"+b+"<br/>line:"+a+"<br/>");return true};function Jobs(a){this.option=a||{};this._jobTable=[[],[],[],[]]}Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(b,a){this._registedJobTable[b]=a},error:function(a){Debug.error(a);this.errorMsg.push(a)},add:function(b,a){a=a||1;if(Core.Array.findit(this._jobTable[a],b)==-1){this._jobTable[a].push(b)}else{this.error("Error: Job <b>"+b+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var b=this._registedJobTable;var a=this._jobTable[1].concat(this._jobTable[2]);var d=this;this.fe=Core.Function.bind3(d.focus,d,[]);var c=function(){if(d._jobTable[3].length==0){if(d.option.onEnd!=null){d.option.onEnd()}return}Core.Events.addEvent(document.body,d.fe,"focus");Core.Events.addEvent(window,d.fe,"scroll");Core.Events.addEvent(document.body,d.fe,"mousemove");Core.Events.addEvent(document.body,d.fe,"mouseover")};this.queue(a,c)},focus:function(){var b=this;if(this.focusdown){Core.Events.removeEvent(document.body,b.fe,"focus");Core.Events.removeEvent(window,b.fe,"scroll");Core.Events.removeEvent(document.body,b.fe,"mousemove");Core.Events.removeEvent(document.body,b.fe,"mouseover");b.fe=null;return}this.focusdown=true;var a=this._jobTable[3];this.queue(a,this.option.onEnd)},queue:function(a,j){var m=this;var g=function(){return new Date().valueOf()};var b=this._registedJobTable;var d=a.length;var f=0;var c=window.setInterval(function(){if(f>=d){clearInterval(c);c=null;if(j!=null){j()}return}var s=a[f];var q=b[s];f++;if(typeof q=="undefined"){m.error("<b>Job["+s+"] is undefiend!!!</b>");return}var p=true;var o=g();try{q.call()}catch(r){m.error("<b>Job["+s+"] failed!!!</b>"+r.message+"");if(j!=null){j()}p=false;throw r}finally{if(p){var n=g();Debug.info("<b>Job["+s+"] done in "+(n-o)+"ms.</b>")}}},10)},call:function(b,a){if(typeof this._registedJobTable[b]!="undefined"){this._registedJobTable[b].apply(this,a)}else{trace("<b>Job["+b+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(b,a){Jobs.prototype._registJob(b,a)};$callJob=function(b){var a=[];if(arguments.length>1){Core.Array.foreach(arguments,function(c,d){a[d]=c});a.shift()}Jobs.prototype.call(b,a)};if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(d){if(!d||!d.length){return null}var a=d.split(".");var c=Lib;for(var b=(a[0]=="Lib")?1:0;b<a.length;++b){c[a[b]]=c[a[b]]||{};c=c[a[b]]}return c};Lib.register=function(a,f){var d=a.split(".");var g={},c,b=Lib;while(c=d.shift()){if(d.length){if(b[c]===undefined){b[c]={}}b=b[c]}else{if(b[c]===undefined){b[c]=f(Lib)}}}};Lib.register("Listener",function(){var a={};a.listeners={};return{add:function(b){if(a.listeners[b]){throw new Error("listener '"+b+"' has registed!")}a.listeners[b]=[]},remove:function(b){if(a.listeners[b]){a.listeners[b]=null;return true}return false},notify:function(f,j){var d=a.listeners[f],c=null;if(!d){return}for(var g=0,b=d.length;g<b;g++){c=d[g];c.callBack.call(c.scope,j)}},on:function(g){var d=arguments,c=null;for(var f=0,b=d.length;f<b;f++){c=d[f];if(!this.isListen(c)){if(!a.listeners[c.name]){a.listeners[c.name]=[]}a.listeners[c.name].push(c)}}},off:function(g){var d=a.listeners[g.name];if(!d){return true}var c=null;for(var f=0,b=d.length;f<b;f++){c=d[f];if(c.callBack==g.callBack&&c.scope==g.scope){d.splice(f,1)}}},isListen:function(g){var d=a.listeners[g.name];var c=null;if(!d){return false}for(var f=0,b=d.length;f<b;f++){c=d[f];if(c.callBack==g.callBack&&c.scope==g.scope){return true}}return false}}});Sina.pkg("Core.Dom");Core.Dom.insertHTML=function(d,c,b){d=$E(d)||document.body;b=b.toLowerCase()||"beforeend";if(d.insertAdjacentHTML){switch(b){case"beforebegin":d.insertAdjacentHTML("BeforeBegin",c);return d.previousSibling;case"afterbegin":d.insertAdjacentHTML("AfterBegin",c);return d.firstChild;case"beforeend":d.insertAdjacentHTML("BeforeEnd",c);return d.lastChild;case"afterend":d.insertAdjacentHTML("AfterEnd",c);return d.nextSibling}throw'Illegal insertion point -> "'+b+'"'}var a=d.ownerDocument.createRange();var f;switch(b){case"beforebegin":a.setStartBefore(d);f=a.createContextualFragment(c);d.parentNode.insertBefore(f,d);return d.previousSibling;case"afterbegin":if(d.firstChild){a.setStartBefore(d.firstChild);f=a.createContextualFragment(c);d.insertBefore(f,d.firstChild);return d.firstChild}else{d.innerHTML=c;return d.firstChild}break;case"beforeend":if(d.lastChild){a.setStartAfter(d.lastChild);f=a.createContextualFragment(c);d.appendChild(f);return d.lastChild}else{d.innerHTML=c;return d.lastChild}break;case"afterend":a.setStartAfter(d);f=a.createContextualFragment(c);d.parentNode.insertBefore(f,d.nextSibling);return d.nextSibling}throw'Illegal insertion point -> "'+b+'"'};Core.Dom.setStyle=function(b,a,c){switch(a){case"opacity":b.style.filter="alpha(opacity="+(c*100)+")";if(!b.currentStyle||!b.currentStyle.hasLayout){b.style.zoom=1}break;case"float":a="styleFloat";default:b.style[a]=c}};if(!$IE||!($IE<9)){Core.Dom.setStyle=function(b,a,c){if(a=="float"){a="cssFloat"}b.style[a]=c}}Sina.pkg("Core.String");Core.String.formatNumber=function(a){a=a+"";return a.replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")};Core.String.encodeHTML=function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML.replace(/\s/g,"&nbsp;")};Core.String.trimHead=function(a){return a.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(a){return a.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(a){return Core.String.trimHead(Core.String.trimTail(a))};Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Io");Sina.pkg("Core.System");(function(){var a=function(d,b){var c;try{if(typeof b!="undefined"){for(c in d){if(b[c]!=null){d[c]=b[c]}}}}finally{c=null;return d}};Core.System.parseParam=a})();Utils.Url=function(a){a=a||"";this.url=a;this.query={};this.parse()};Utils.Url.prototype={parse:function(a){if(a){this.url=a}this.parseAnchor();this.parseParam()},parseAnchor:function(){var a=this.url.match(/\#(.*)/);a=a?a[1]:null;this._anchor=a;if(a!=null){this.anchor=this.getNameValuePair(a);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var a=this.url.match(/\?([^\?]*)/);a=a?a[1]:null;if(a!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(a)}},getNameValuePair:function(b){var a={};b.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(c,f,d){if(f==""){return}a[f]=d||""});return a},getParam:function(a){return this.query[a]||""},clearParam:function(){this.query={}},setParam:function(a,b){if(a==null||a==""||typeof(a)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[a]=b},setParams:function(a){this.query=a},serialize:function(c){var a=[];for(var b in c){if(c[b]==null||c[b]==""){a.push(b+"=")}else{a.push(b+"="+c[b])}}return a.join("&")},toString:function(){var a=this.serialize(this.query);return this.url+(a.length>0?"?"+a:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(a){return this.anchor?"#"+this.serialize(this.anchor):(a?"#":"")}};Core.String.encodeDoubleByte=function(a){if(typeof a!="string"){return a}return encodeURIComponent(a)};Utils.Io.JsLoad={};(function(){function c(n,g){a(n,g);var m=n.urls;var f,d=m.length;for(f=0;f<d;f++){var j=$C("script");j.src=m[f].url;j.charset=m[f].charset;j.onload=j.onerror=j.onreadystatechange=function(){if(j&&j.readyState&&j.readyState!="loaded"&&j.readyState!="complete"){return}g.script_loaded_num++;j.onload=j.onreadystatechange=j.onerror=null;if((!1)!==n.isRemove){j.src="";j.parentNode.removeChild(j)}j=null};document.getElementsByTagName("head")[0].appendChild(j)}}function a(p,g){var o=p.urls;var r=p.GET;var j,m=o.length;var q,n,d,f;for(j=0;j<m;j++){f=window.parseInt(Math.random()*100000000);n=new Utils.Url(o[j].url);for(q in r){if(p.noencode==true){n.setParam(q,r[q])}else{n.setParam(q,Core.String.encodeDoubleByte(r[q]))}}d=n.getParam("varname")||"requestId_"+f;if(p.noreturn!=true){n.setParam("varname",d)}g.script_var_arr.push(d);o[j].url=n.toString();o[j].charset=o[j].charset||p.charset}}function b(g,j){var f={isRemove:!0,urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var d={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};f.urls=typeof g=="string"?[{url:g}]:g;Core.System.parseParam(f,j);c(f,d);(function(){if(f.noreturn==true&&f.onComplete==null){return}var m,n=[];if(d.script_loaded_num==f.urls.length){d.is_loadcomplete=true;if(f.onComplete!=null){for(m=0;m<d.script_var_arr.length;m++){n.push(window[d.script_var_arr[m]])}if(d.script_var_arr.length<2){f.onComplete(n[0])}else{f.onComplete(n)}}return}if(d.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(f.timeout>0){setTimeout(function(){if(d.is_loadcomplete!=true){if(f.onException!=null){f.onException()}d.is_timeout=true}},f.timeout)}}Utils.Io.JsLoad.request=function(d,f){new b(d,f)}})();Sina.pkg("Core.Class");Core.Class.AsPrototype={};Core.Class.create=function(){return function(a){if(a!=Core.Class.AsPrototype){this.initialize.apply(this,arguments)}}};Lib.pkg("Lib.Component");Lib.Component=Core.Class.create();Lib.Component.instances=Lib.Component.instances||{};Lib.Component.compSize={};Lib.Component.getInitCompSize=function(){if(scope.component_lists!=null){var b=scope.component_lists;for(var a in b){if(b[a].list.length>0){Core.Array.foreach(b[a].list,function(c){Lib.Component.compSize[c]=b[a].size})}}return true}else{return null}};Lib.Component.refresh=function(c,b){b=b||{};try{if(Lib.Component.instances[c]==null){if(typeof Lib.Component["Comp_"+c]=="undefined"){$registComp(c,{},"static")}Lib.Component.instances[c]=new Lib.Component["Comp_"+c](c)}}catch(a){}Debug.log("刷新组件 "+c+" ，新宽度是 "+b.width);Debug.log("组件 "+c+" 增加管理链接："+b.addManage);Lib.Component.instances[c].reload(b.width,b.addManage,b.forceRefresh)};Lib.Component.set=function(a){Debug.log("展开组件 "+a+" 的设置功能");if(Lib.Component.instances[a]==null){Lib.Component.instances[a]=new Lib.Component["Comp_"+a](a)}Lib.Component.instances[a].getUserSet()};Core.Class.extend=function(d,c,b){for(var a in c){if(b!=null){if(!d[a]){d[a]=c[a]}}else{d[a]=c[a]}}return d};Core.Class.define=function(f,b,a){if(f&&f.__isClass&&f.__isClass()){throw new Error("class cnt be used as another class' constructor : "+f)}b=b||Object;a=a||{};a.initialize=f||a.initialize||b.prototype.initialize||(function(){});if(typeof(a.initialize)!="function"){throw new Error("only function can be used as constructor")}a.__isClass=function(){return true};var c=Core.Class.create();c.__isClass=a.__isClass;var d=b==Object?{}:new b(Core.Class.AsPrototype);c.prototype=Core.Class.extend(d,a);return c};$registComp=Lib.Component.registComp=function(c,b,a){a=(a==null)?Lib.Component.Comp:Lib.Component["Comp_"+a];a=a||Lib.Component.Comp;b.compId=c;Lib.Component["Comp_"+c]=Core.Class.define(null,a,b)};Core.Function.bind2=function(c,a){var b=c;return function(){return b.apply(a,arguments)}};Function.prototype.bind2=function(a){var b=this;return function(){return b.apply(a,arguments)}};Core.Dom.getElementsByClass=function(a,b,j){a=a||document;var d=[];j=" "+j+" ";var n=a.getElementsByTagName(b),g=n.length;for(var f=0;f<g;++f){var c=n[f];if(c.nodeType==1){var m=" "+c.className+" ";if(m.indexOf(j)!=-1){d[d.length]=c}}}return d};Core.Dom.byClz=Core.Dom.getElementsByClass;Core.Dom.removeNode=function(a){a=$E(a)||a;try{a.parentNode.removeChild(a)}catch(b){}};Lib.Component.Comp=Core.Class.create();Lib.Component.Comp.prototype={initialize:function(a){if(this.isInit==true||a==null||Lib.Component.compSize[a]==null){return}else{this.isInit=true;this.compId=a;this.size=Lib.Component.compSize[a];Lib.Component.instances[a]=this;return this}},compId:null,getContainer:function(){return $E("module_"+this.compId)},getTitle:function(){return Core.Dom.getElementsByClass($E("module_"+this.compId),"span","title")[0]},getManage:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"span","edit");if(a.length!=0){return a[0]}else{Debug.error("组件添加管理链接失败，检查组件"+this.compId+"标题栏 SPAN[class=edit] 是否存在");return null}},getContent:function(){var a=Core.Dom.getElementsByClass($E("module_"+this.compId),"div","SG_connBody");if(a.length!=0){return a[0]}else{Debug.error("组件内容节点获取失败，检查组件"+this.compId+"内 DIV[class=SG_connBody] 是否存在");return null}},load:function(){trace("load compId="+this.compId);this.setContent("")},reload:function(a){this.clearContent();this.load()},setTitle:function(a){var b=this.getTitle();if(b){b.innerHTML=a||""}},setManage:function(){var a=this.getManage();if($isAdmin&&a){a.innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}},setContent:function(a){a=typeof a=="string"?a:a+"";this.getContent().innerHTML=a||""},clearContent:function(){this.getContent().innerHTML=""},remove:function(){Core.Dom.removeNode(this.getContainer());this.finalize()},finalize:function(){this.isInit=null;Lib.Component.instances[this.compId]=null}};var $SYSMSG={};$SYSMSG.extend=function(c,b){for(var a in c){$SYSMSG[a]=!!b==false?c[a]:$SYSMSG[a]}};$SYSMSG.extend({A80001:"暂无内容。",A80002:"暂无内容。",A80101:"组件加载失败，请刷新。",A80201:"你要删除留下的访问记录吗？",A80202:'<div class="CP_w_cnt SG_txtb">删除后一小时内不会在此留下访问记录。</div>',A80203:"确实要删除此访问记录吗？",A80204:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_12_deleteToBlack" class="CP_w_fm1" /><label for="comp_12_deleteToBlack" >将此人加入黑名单</label></li></ul><div class="CP_w_cnt SG_txtb">加入黑名单的用户无法和你沟通。</div>'].join(""),A02003:"已添加过此模块，不能重复添加。",A02004:"抱歉，该模块不能被克隆。",A02005:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“添加到您的博客”。",A02006:"模块已成功添加到你的博客。",A02007:"确实要隐藏此模块吗？隐藏后可在“页面设置”中恢复。",A02008:"确实要隐藏此模块吗？此模块活动时间已结束，隐藏后不可恢复。"});$registComp("dynamic",{render_210:function(){},render_510:function(){},render_730:function(){},show:function(a){this.setContent(a)},showEmpty:function(a){this.setContent('<div class="SG_nodata2">'+(a||$SYSMSG.A80001)+"</div>")},showError:function(a){this.setContent(a)},setManage:function(){if($isAdmin&&this.getManage()){this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}},reload:function(d,a,c){var b=d==null||(d&&(d==210||d==510||d==730));if(!b){Debug.error("请检查传入的组件尺寸是否正确。"+d);return}this.size=d||this.size;this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>';this.isSetOn=null;Debug.log("this.isSetOn : "+this.isSetOn);if(c==true||this.cacheData==null){Debug.log("强制刷新："+this.compId);this.load()}else{Debug.log("缓存刷新："+this.compId);this["render_"+this.size]()}if(a){this.setManage()}}});Sina.pkg("Utils.Cookie");Utils.Cookie.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var c=new RegExp(a+"=([^;]*)?;","i");var d=document.cookie+";";var b=d.match(c);if(b){return b[1]||""}else{return""}};Core.System.keyValue=function(c,b){var a=c.match(new RegExp("(\\?|&)"+b+"=([^&]*)(&|$)"));if(a!=null){return a[2]}return null};Lib.checkAuthor=function(){var a=unescape(Utils.Cookie.getCookie("SUP"));if(a&&a!=""){$UID=Core.System.keyValue(a,"uid");$nick=decodeURIComponent(Core.System.keyValue(a,"nick"));$isLogin=!!($UID);if(typeof scope.$uid=="undefined"){$isAdmin=false}else{$isAdmin=(scope.$uid==$UID)}}else{a=Utils.Cookie.getCookie("SU");if(a&&a!=""){var b=a.match(/^([^:]*:){2}(\d{5,11})/);$UID=(b&&b[2])||null;window.$isLogin=!!($UID);if(typeof scope.$uid=="undefined"){window.$isAdmin=false}else{window.$isAdmin=(scope.$uid==$UID)}}else{$UID=null;$isLogin=false;$isAdmin=false}}};Core.Array.uniq=function(b){var d=[],a;for(var c=0;c<b.length;c++){a=b[c];if(Core.Array.findit(d,a)==-1){d.push(a)}}return d};Lib.Uic={_interfaceMultiquery:"http://uic.sso.sina.com.cn/uic/Mutiquery.php",cacheNickName:{},getNickName:function(q,c,r){q=Core.Array.uniq(q)||[];r=r||10;var s=Core.String.trim;var m=this.cacheNickName,b=[],g=[];var a={};for(var f=0,n=q.length;f<n;f++){if(typeof m[q[f]]=="undefined"&&m[q[f]]==null){var d=$E("ownernick");var o=s(scope.$pageid);if(q[f]==scope.$uid&&d!=null&&(o!="articleM"&&o!="article"&&o!="personal"&&o!="personalM"&&o!="index"&&o!="indexM")){a[q[f]]=s(d.textContent||d.innerText);continue}if(q[f]==$UID&&scope.nickname!=null){a[q[f]]=s(scope.nickname);continue}b.push(q[f])}else{a[q[f]]=m[q[f]]||q[f]}}if(b.length==0){c(a);a=null}else{var p=[];for(var f=0;f<b.length;f++){g[f]=1}if(b.length>0){if(g.length>0){g="["+g.toString().replace(/,$/g,"")+"]"}b="["+b.toString().replace(/,$/g,"")+"]";p.push({url:this._interfaceMultiquery+"?UID=0&Check=null&UIDS="+b+"&UserInfoTypes="+g+"&ProductType=2"})}var j=function(t){Utils.Io.JsLoad.request(t[0].url,{onComplete:function(y){if(y){var v=y.UserInfos;for(var u=0;u<v.length;u++){a[v[u][0]]=v[u][2][1];Lib.Uic.cacheNickName[v[u][0]]=v[u][2][1]}c(a)}}});if(p.length>0){setTimeout(function(){j(p.splice(0,1))},10)}};if(p.length>0){setTimeout(function(){j(p.splice(0,1))},10)}}}};$registComp("901",{load:function(){Lib.checkAuthor();if($isAdmin==false&&$isLogin){this.loadIsFriend()}else{if($isAdmin==false&&!$isLogin){this.isFriend=false;this.loadOnline()}else{this.isOnline=true;this.showOnlineInfo()}}this.loadNickname();this.loadOtherInfo()},loadIsFriend:function(){if($_GLOBAL.mashAddFriend){this.mashAddFriend=true;return}var a=new Interface("http://control.blog.sina.com.cn/riaapi/profile/IsFriend.php","jsload");a.request({GET:{friend_uids:scope.$uid,version:7},onSuccess:(function(b){this.friendSuccessCallback(b)}).bind2(this),onError:(function(b){this.friendErrorCallback()}).bind2(this),onFail:(function(){this.friendErrorCallback()}).bind2(this)})},friendSuccessCallback:function(c){for(var b=0,a=c.length;b<a;b++){if(c[b].uid==scope.$uid){this.isFriend=(c[b].status==1)?true:false}}this.isFriend=(this.isFriend!=null)?this.isFriend:false;this.loadOnline()},friendErrorCallback:function(){this.isFriend=false;this.loadOnline()},loadOnline:function(){if($isAdmin){this.isOnline=true;this.showOnlineInfo()}else{var a=Utils.Io.JsLoad.request("http://online.sso.sina.com.cn/status/MutiqueryVProduct.php",{GET:{UIDS:"["+scope.$uid+"]",Check:scope.$key,ProductType:"1000",Verbose:"0",noencode:true},onComplete:Core.Function.bind2(function(c){try{var b=c.Status;this.isOnline=(b[0]==1)?true:false}catch(d){this.isOnline=$isAdmin?true:false}this.showVisitButton();this.showOnlineInfo()},this),onException:Core.Function.bind2(function(){this.isOnline=false;this.showVisitButton();this.showOnlineInfo()},this)})}},loadNickname:function(){Lib.Uic.getNickName([scope.$uid],Core.Function.bind2(function(a){this.showNickName(a)},this))},showOnlineInfo:function(){},showNickName:function(){},showVisitButton:function(){},loadOtherInfo:function(){},mashAddFriend:false,reload:function(d,a,c){var b=d==null||(d&&(d==210||d==510||d==730));if(!b){Debug.error("请检查传入的组件尺寸是否正确。"+d);return}this.size=d||this.size;if(c==true||this.cacheData==null){this.load()}else{this["render_"+this.size]()}if(a){this.setManage()}}},"dynamic");Core.String.j2o=function(str){if(!str||str==""){return null}try{var o=window.eval("("+str+")");return o}catch(e){trace("j2o : 数据分析出错");traceError(e);return null}};Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var a="loadingIframe_thread"+Math.ceil(Math.random()*10000);var b="loadingIframe_thread"+Math.ceil((Math.random()+1)*10000);this.loadFrames=[a,b];var d='<iframe id="'+a+'" name="'+a+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>				  <iframe id="'+b+'" name="'+b+'" class="invisible"	              scrolling="no" src=""	              allowTransparency="true" style="display:none;" frameborder="0"	              ></iframe>';var c=$C("div");c.id="ijax_iframes";c.innerHTML=d;trace("创建 Ijax 需要的 iframe");document.body.appendChild(c);var f=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(f);f=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var a in this.loadingIframe){if(this.loadingIframe[a].isBusy==false){this.loadingIframe[a].isBusy=true;return this.loadingIframe[a]}}return false},request:function(b,a){var c={};c.url=b;c.option=a||{};this.arrTaskLists.push(c);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var a=this.isIjaxReady();if(a==false){return false}var b=this.arrTaskLists[0];this.loadData(b.url,b.option,a);this.arrTaskLists.shift()},loadData:function(a,d,p){var f=new Utils.Url(a);if(d.GET){for(var o in d.GET){f.setParam(o,Core.String.encodeDoubleByte(d.GET[o]))}}if(!/\bdomain\b/.test(a)){f.setParam("domain","1")}f=f.toString();var j=p.container;j.listener=Core.Function.bind2(function(){try{var q=j.contentWindow.document,r;var s=Core.Dom.byClz(q,"textarea","")[0];if(typeof s!="undefined"){r=s.value}else{r=q.body.innerHTML}if(d.onComplete){d.onComplete(r)}else{d.onException()}}catch(t){traceError(t);if(d.onException){d.onException(t.message,f.toString())}}p.isBusy=false;Core.Events.removeEvent(j,j.listener,"load");this.loadByList()},this);Core.Events.addEvent(j,j.listener,"load");if(d.POST){var b=$C("form");b.id="IjaxForm";b.action=f;b.method="post";b.target=j.id;for(var m in d.POST){var n;if(d.noEncode){n=Core.String.encodeDoubleByte(d.POST[m])}else{n=d.POST[m]}var c=$C("input");c.type="hidden";c.name=m;c.value=n;b.appendChild(c)}document.body.appendChild(b);b.submit()}else{try{window.frames(j.id).location.href=f}catch(g){j.src=f}}}};Utils.Io.Ajax={createRequest:function(){var c=null;try{c=new XMLHttpRequest()}catch(b){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{c=ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}if(c==null){}else{return c}},request:function(b,a){a=a||{};a.onComplete=a.onComplete||function(){};a.onException=a.onException||function(){};a.returnType=a.returnType||"txt";a.method=a.method||"get";a.data=a.data||{};if(typeof a.GET!="undefined"&&typeof a.GET.url_random!="undefined"&&a.GET.url_random==0){this.rand=false;a.GET.url_random=null}return this.loadData(b,a)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser();response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};if($IE6&&typeof Utils.Io.Ijax!="undefined"){Utils.Io.Ijax.loadData=function(a,d,r){var f=new Utils.Url(a);if(d.GET){for(var p in d.GET){f.setParam(p,Core.String.encodeDoubleByte(d.GET[p]))}}if(!/\bdomain\b/.test(a)){f.setParam("domain","1")}f=f.toString();var j=r.container;j.listener=Core.Function.bind2(function(){try{var s=j.contentWindow.document,t;var u=Core.Dom.byClz(s,"textarea","")[0];if(typeof u!="undefined"){t=u.value}else{t=s.body.innerHTML}if(d.onComplete){d.onComplete(t)}else{d.onException()}}catch(v){traceError(v);if(d.onException){d.onException(v.message,f.toString())}}r.isBusy=false;Core.Events.removeEvent(j,j.listener,"load");this.loadByList()},this);Core.Events.addEvent(j,j.listener,"load");if(d.POST){var b=$C("form");b.id="IjaxForm";b.action=f;b.method="post";b.target=j.id;for(var m in d.POST){var o;if(d.noEncode){o=Core.String.encodeDoubleByte(d.POST[m])}else{o=d.POST[m]}var c=$C("input");c.type="hidden";c.name=m;c.value=o;b.appendChild(c)}document.body.appendChild(b);var q=100;function n(){if(q>0){try{b.submit()}catch(s){setTimeout(n,10)}}q--}n()}else{try{window.frames(j.id).location.href=f}catch(g){j.src=f}}}}var Interface=function(a,b){this.url=new Utils.Url(a);this.type=b.toLowerCase()};Interface.prototype={url:null,type:"",request:function(a){var d=a.onError;var b=a.onSuccess;a.onComplete=a.onSuccess=function(f){try{if(typeof f=="string"){f=f.replace(/;$/,"")}f=(typeof f=="string"&&(/\s*{/.test(f)))?Core.String.j2o(f):f;if(f!=null&&typeof f.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(f!=null){if(f.code=="A00006"){b(f.data)}else{d(f)}}else{d(f)}}catch(g){traceError(g)}}.bind2(this);a.onException=a.onError=a.onFail||function(){trace("接口失败："+this.url,"#F00");if(arguments.length>0){for(var g=0,f=arguments.length;g<f;g++){if(arguments[g]&&typeof arguments[g]!="undefined"){trace("错误信息："+arguments[g].toString())}}}}.bind2(this);var c=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(c,a);break;case"ajax":Utils.Io.Ajax.request(c,a);break;case"script":case"jsload":Utils.Io.JsLoad.request(c,a);break;default:throw new Error("未指定有效的数据传输类型")}}};function v6SendLog(b,a){}function v7sendLog(a,b,c){if(!a){return false}if(a.split("_").length==3){Lib.checkAuthor();if($isLogin){a+="_"+$UID}}if(typeof scope=="undefined"){window.scope={};scope.$pageid=""}b=b||scope.$pageid;c=c||"";Utils.Io.JsLoad.request("http://hits.sinajs.cn/A2/b.html?type="+a+"&pageid="+b+"&msg="+c,{onComplete:function(){}})}(function(){function a(c){function b(){}b.prototype=c;return new b()}Function.prototype.$define=function(c){var b;for(b in c){this.prototype[b]=c[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")};return this};Function.prototype.$extends=function(){var f=this,c=arguments.length,b,d;if(c===0){throw new Error("$extends语句错误：未指定父类")}b=arguments[0];d=function(){b.apply(this,arguments);f.apply(this,arguments)};d.prototype=a(b.prototype);d.prototype.constructor=d;d.$super=b.prototype;return d};Function.prototype.$implements=function(){var b=Array.prototype.slice.call(arguments,0),f,d=b.length,c;while(d--){if(typeof b[d]!=="object"){throw new Error("$implements语句错误：参数必须为object类型")}for(c in b[d]){typeof this.prototype[c]==="undefined"&&(this.prototype[c]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")};return this}})();Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var b=arguments.callee.caller;var a;var c=0;while(b!=null&&c<40){a=b.arguments[0];if(a&&(a.constructor==Event||a.constructor==MouseEvent)){return a}c++;b=b.caller}return a}}Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true;b.returnValue=false}};if(!$IE||$IE>8){Core.Events.stopEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.preventDefault();b.stopPropagation()}}}Sina.pkg("Ui");if(typeof Ui=="undefined"){Ui=Sina.Ui}Ui.Template=function(a){this.tmpl=a;this.pattern=/(#\{(.*?)\})/g};Ui.Template.prototype={evaluate:function(a){return this.tmpl.replace(this.pattern,function(){return a[arguments[2]]||""})},evaluateMulti:function(c,a){var b=[];Core.Array.foreach(c,Core.Function.bind2(function(d,f){f=a?c.length-f:f;b[f]=this.evaluate(d)},this));return b.join("")}};(function(){Core.Function.defineGetter=function(g,f,d){if(f instanceof Array&&d instanceof Array){var c=Math.min(f.length,d.length);while(c--){if(typeof f[c]==="string"&&b(d[c])){g[f[c]]={valueOf:(function(m){return function(){return a(g,d[m])}})(c),toString:this.valueOf}}}}else{if(typeof f==="string"&&b(d)){g[f]={valueOf:function(){return a(g,d)},toString:this.valueOf}}}};function b(c){return typeof c!=="string"&&String.prototype.slice.call(c,0,8)=="function"}function a(f,d){var c=d.call(f);return typeof c==="string"||typeof c==="number"?c:null}})();Ui.IE6FixedController=function(){var a=this;this.node=null;this.iframeNode=null;this.__orgX=0;this.__orgY=0;this.__isBindScroll=false;this.__fixedHandle=function(){if(a.node){a.node.style.left=document.documentElement.scrollLeft+a.__orgX+"px";a.node.style.top=document.documentElement.scrollTop+a.__orgY+"px"}if(a.iframeNode){a.iframeNode.style.left=a.node.style.left;a.iframeNode.style.top=a.node.style.top}}}.$define({setFixed:function(a,b){this.updateOrgPosition();if(b&&!this.__isBindScroll){Core.Events.addEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=true}if(!b&&this.__isBindScroll){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false}},setPosition:function(b,a,c){if(typeof c.x!=="undefined"){if(a){b.style.left=c.x+document.documentElement.scrollLeft+"px";this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft}else{b.style.left=c.x+"px"}}if(typeof c.y!=="undefined"){if(a){b.style.top=c.y+document.documentElement.scrollTop+"px";this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop}else{b.style.top=c.y+"px"}}typeof c.z!=="undefined"&&(b.style.zIndex=c.z)},getX:function(b,a){if(a){return parseInt(b.style.left)-document.documentElement.scrollLeft}else{return parseInt(b.style.left)}},getY:function(b,a){if(a){return parseInt(b.style.top)-document.documentElement.scrollTop}else{return parseInt(b.style.top)}},updateIframe:function(a){this.setFixed(this.iframeNode,a);a&&this.__fixedHandle()},updateOrgPosition:function(){if(!this.node){return}this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft;this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false;this.node=null;this.iframeNode=null}});Core.Events.EventDispatcher=function(a){this.__target=a;this.__events={}}.$define({addEventListener:function(c,a){if(!this.__checkFunction(a)){return}var b=this.__events;c=c.toLowerCase();!b[c]&&(b[c]=[]);b[c].push(a)},removeEventListener:function(d,a){var b=this.__events[d];d=d.toLowerCase();if(!this.__checkFunction(a)||!b||!b.length){return}for(var c=b.length-1;c>=0;c--){(b[c]==a)&&b.splice(c,1)}},dispatchEvent:function(f){f=f.toLowerCase();var b=this.__events[f];if(!b||!b.length){return}var c=Array.prototype.slice.call(arguments,0);c.shift();for(var d=0,a=b.length;d<a;d++){b[d].apply(this.__target,c)}},__checkFunction:function(a){return typeof a!=="string"&&String.prototype.slice.call(a,0,8)=="function"}});Ui.IRenderer={setCanShow:function(a){},setCanHidden:function(a){},show:function(a){},hidden:function(a){},addEventListener:function(b,a){},removeEventListener:function(b,a){}};Ui.SimpleRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(a){this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){a.style.display="";this.__eventDispatcher.dispatchEvent("show")}return this},hidden:function(a){this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){a.style.display="none";this.__eventDispatcher.dispatchEvent("hidden")}return this},addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this}});Ui.DisplayObject=function(b,c){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]);this.__renderer=null;this.__entity=c;this.__isInited=false;this.__parent=b||document.body;this.__eventDispatcher=new Core.Events.EventDispatcher(this);var a=this.__eventDispatcher;this.__onBeforeShow=function(){a.dispatchEvent("beforeShow")};this.__onShow=function(){a.dispatchEvent("show")};this.__onBeforeHidden=function(){a.dispatchEvent("beforeHidden")};this.__onHidden=function(){a.dispatchEvent("hidden")};this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(a){!this.__isInited&&this.__initEntity();typeof a.x!=="undefined"&&(this.__entity.style.left=a.x+"px");typeof a.y!=="undefined"&&(this.__entity.style.top=a.y+"px");typeof a.z!=="undefined"&&(this.__entity.style.zIndex=a.z);return this},setSize:function(a){!this.__isInited&&this.__initEntity();typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px");return this},setRenderer:function(a){!this.__isInited&&this.__initEntity();this.__updateRenderer(a);return this},show:function(a){this.isHidden=!1;this.isShow=!0;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.show(this.__entity);return this},hidden:function(a){return this.hide(a)},hide:function(a){this.isHidden=!0;this.isShow=!1;!this.__isInited&&this.__initEntity();this.__updateRenderer(a);this.__renderer.hidden(this.__entity);return this},setCanShow:function(a){this.__renderer.setCanShow(a);return this},setCanHidden:function(a){this.__renderer.setCanHidden(a);return this},addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this},destroy:function(){if(!this.__entity){return}!this.__isInited&&this.__initEntity();this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity);this.__entity=null},__initEntity:function(){var a;!this.__entity&&(this.__entity=$C("div"));a=this.__entity.style;a.position="absolute";a.left=0;a.top=0;!this.__entity.parentNode&&this.__parent.appendChild(this.__entity);this.__isInited=true},__updateRenderer:function(b){if(!b){return}var a=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};if(!this.__renderer){this.__renderer=new b();a.call(this)}else{if(this.__renderer.constructor!==b){this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden);this.__renderer=new b();a.call(this)}}},__getX:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.left)},__getY:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.top)},__getZ:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.zIndex)},__getWidth:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetHeight")},__getSize:function(c,f){var d=c,a,b=d.style.visibility;if(d.style.display=="none"){d.style.visibility="hidden";d.style.display="";a=d[f];d.style.display="none";d.style.visibility=b}else{a=d[f]}return a}});Ui.Panel=function(a,b){this.nodes={};this.uniqueID=this.__getUniqueID();this.entity=null;this.__iframe=null;this.__isSetAdamant=false;this.__templateNodesIDs=[];this.__isFixed=false;$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController())}.$extends(Ui.DisplayObject).$define({setTemplate:function(a){var b=$C("div");b.innerHTML=new Ui.Template(a).evaluate(this.__getNodes(a,"i"));b.style.display="none";this.__parent.appendChild(b);this.__updateTemplate(b);this.nodes=this.__getNodes(a);this.entity=this.__entity;this.nodes.panel=this.entity;return this},setFixed:function(b){!this.__isInited&&this.__initEntity();var a=parseInt(this.__entity.style.left),c=parseInt(this.__entity.style.top);if($IE6){this.__ie6FixedController.setFixed(this.__entity,b);this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,b)}else{if(b&&!this.__isFixed){this.setPosition({x:a-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c-Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="fixed"}if(!b&&this.__isFixed){this.setPosition({x:a+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:c+Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="absolute"}}this.__isFixed=!!b;this.__updateIframe();return this},setAdamant:function(a){this.__isSetAdamant=!!a;this.__isSetAdamant&&!this.__iframe&&this.__createIframe();this.__updateIframe();return this},destroy:function(){if(!this.__entity){return}Ui.Panel.$super.destroy.call(this);this.__ie6FixedController&&this.__ie6FixedController.destroy();this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe)},setPosition:function(a){!this.__isInited&&this.__initEntity();if($IE6){this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,a)}else{Ui.Panel.$super.setPosition.call(this,a)}this.__updateIframe();return this},setSize:function(a){Ui.Panel.$super.setSize.call(this,a).__updateIframe();return this},show:function(a){Ui.Panel.$super.show.call(this,a).__updateIframe();return this},hidden:function(a){Ui.Panel.$super.hidden.call(this,a).__updateIframe();return this},__getX:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getX(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.left)}},__getY:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getY(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.top)}},__createIframe:function(){this.__iframe=$C("iframe");this.__iframe.frameBorder="none";this.__parent.insertBefore(this.__iframe,this.__entity);Core.Dom.setStyle(this.__iframe,"opacity",0);this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe);this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var a=this.__iframe.style;a.backgroundColor="#ffffff";a.left=this.x+"px";a.top=this.y+"px";a.width=this.width+"px";a.height=this.height+"px";a.position=this.__entity.style.position;a.display=this.__entity.style.display;a.zIndex=this.__entity.style.zIndex;$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(m){var a,b,j,f,g,c=this.__entity;if(c){c.parentNode&&c.parentNode.removeChild(c);a=c.style.left;b=c.style.top;j=c.style.zIndex;f=c.style.position;g=c.style.display}else{g="none"}c=this.__entity=$E("_"+this.uniqueID+"_panel");if(!c){c=this.__entity=$E("_"+this.uniqueID+"_entity")}if(!c){throw new Error("[Panel Error]there missing identifier #{panel} in panel template")}c.style.left=a||0;c.style.top=b||0;c.style.zIndex=j||0;c.style.position=f||"absolute";c.style.display=g;this.__parent.replaceChild(c,m);this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(c,n){var a=n||"o",j=/\{[^\}]+(?=\})/g,d,b={},g,f;this.__templateNodesIDs=c.match(j);g=this.__templateNodesIDs;if(g){d=g.length;while(d--){f=g[d].replace("{","");switch(a){case"o":b[f]=$E("_"+this.uniqueID+"_"+f);break;case"i":b[f]="_"+this.uniqueID+"_"+f;break}}}return b},__getUniqueID:function(){return parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()},setContent:function(a){this.nodes.content&&(this.nodes.content.innerHTML=a)},getNodes:function(){return this.nodes}});Ui.Drag=function(c,a,d){var b=this;this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.__captureNode=c;this.__dragNodes=[];this.__deltaX=[];this.__deltaY=[];this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__isDraging=false;this.__canDragX=true;this.__canDragY=true;this.__dragHandle=function(){b.__drag()};this.__mouseDownHandle=function(){b.__isDraging=true;b.__eventDispatcher.dispatchEvent("beforeDrag");b.__setCapture(true)};this.__mouseUpHandle=function(){b.__isDraging&&b.__eventDispatcher.dispatchEvent("afterDrag");b.__isDraging=false;b.__setCapture(false)};this.__initNodes(c,a,d);this.__initCaputerNode()}.$define({addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown");Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup");this.__captureNode=null;this.__dragNodes=null},__initNodes:function(d,c,f){if(c){c instanceof Array?this.__dragNodes=c:this.__dragNodes.push(c);(typeof f==="undefined"||f)&&this.__dragNodes.push(this.__captureNode)}else{this.__dragNodes.push(this.__captureNode)}var a=this.__dragNodes,b=a.length;while(b--){!a[b].style.position&&(a[b].style.position="absolute");!a[b].style.left&&(a[b].style.left=0);!a[b].style.top&&(a[b].style.top=0)}},__initCaputerNode:function(){var b=this.__captureNode,a=this;Core.Events.addEvent(b,this.__mouseDownHandle,"mousedown");Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(c){var f=this.__captureNode,b=this.__dragNodes,a=Core.Events.getEvent(),d=b.length;while(d--){this.__deltaX[d]=a.clientX-parseInt(b[d].style.left);this.__deltaY[d]=a.clientY-parseInt(b[d].style.top)}if(c){if($IE){f.setCapture();Core.Events.addEvent(f,this.__dragHandle,"mousemove")}else{Core.Events.addEvent(document,this.__dragHandle,"mousemove")}}else{if($IE){f.releaseCapture();Core.Events.removeEvent(f,this.__dragHandle,"mousemove")}else{Core.Events.removeEvent(document,this.__dragHandle,"mousemove")}}},__drag:function(){if(!this.canDrag){return}var d=this.__dragNodes,c=Core.Events.getEvent(),f=d.length,g=this.lockArea,b=0,a=0;this.__eventDispatcher.dispatchEvent("drag");while(f--){b=c.clientX-this.__deltaX[f];a=c.clientY-this.__deltaY[f];if(this.isLock){b=Math.min(Math.max(b,g.left),g.right);a=Math.min(Math.max(a,g.top),g.bottom)}d[f].style.left=b+"px";d[f].style.top=a+"px"}}});Ui.IDragger={addEventListener:function(b,a){},removeEventListener:function(b,a){},setDrag:function(b,a,c){},setLock:function(a){},setArea:function(a){},destroy:function(){}};Ui.SimpleDragger=function(){this.__drag=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(b,a){if(b.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(b,a)}else{this.__drag.addEventListener(b,a)}return this},removeEventListener:function(b,a){if(b.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(b,a)}else{this.__drag.removeEventListener(b,a)}return this},setDrag:function(c,a,d){var b=this;this.__drag=new Ui.Drag(c,a,d);this.__drag.addEventListener("afterDrag",function(){b.__eventDispatcher.dispatchEvent("afterDrag")});return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()}});Ui.Dialog=function(a,c){var b=this;this.__dragger=null;this.__isBindUpadateAreaEvent=false;this.__isBindUpdateIE6AreaEvent=false;this.__beforeDragHandle=function(){b.__updateDraggerArea();b.__eventDispatcher.dispatchEvent("beforedrag")};this.__dragHandle=function(){b.__isSetAdamant&&b.__updateIframe();b.__eventDispatcher.dispatchEvent("drag")};this.__afterDragHandle=function(){b.__isFixed&&$IE6&&b.__updateIE6FCOrgPosition();b.__eventDispatcher.dispatchEvent("afterdrag")};this.__updateDraggerAreaHandle=function(){setTimeout(function(){b.__updateDraggerArea()},1)};this.__setMiddleHandle=function(){b.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(a){Ui.Dialog.$super.setTemplate.call(this,a);this.__initTitleBar();this.setDragger(Ui.SimpleDragger);return this},setContent:function(a){if(!this.nodes.content){return this}this.nodes.content.innerHTML=new Ui.Template(a).evaluate(this.__getNodes(a,"i"));this.__addContentNodes(this.__getNodes(a));return this},setFixed:function(a){Ui.Dialog.$super.setFixed.call(this,a);if(a){Core.Events.addEvent(window,this.__setMiddleHandle,"resize")}else{Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")}this.__updateDraggerArea();return this},setMiddle:function(){var d=this.__getDocumentSize().height-this.height,c=(Math.sqrt(5)-1)/2,a=1,b=d*c/(c+a),f=this.__getDocumentSize().width/2-this.width/2;if(!this.__isFixed){b+=Math.max(document.documentElement.scrollTop,document.body.scrollTop);f+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}this.setPosition({x:Math.max(f,0),y:Math.max(b,0)});return this},setAreaLocked:function(a){if(!this.__dragger){return this}this.__dragger.setLock(a);return this},setSize:function(a){!this.__isInited&&this.__initEntity();if(this.nodes.content){typeof a.width!=="undefined"&&(this.nodes.content.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.nodes.content.style.height=a.height+"px")}else{typeof a.width!=="undefined"&&(this.__entity.style.width=a.width+"px");typeof a.height!=="undefined"&&(this.__entity.style.height=a.height+"px")}return this},setDragger:function(a){if(!this.nodes.titleBar||!a){return this}if(!this.__dragger){this.__dragger=new a()}else{if(this.__dragger.constructor===a){return this}}this.__updateDragger(a);return this},destroy:function(){if(!this.__entity){return}Ui.Dialog.$super.destroy.call(this);Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize");Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")},__addContentNodes:function(b){var c=this.nodes,a;for(a in b){c[a]=b[a]}},__updateDragger:function(a){if(this.__dragger.constructor!==a){this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle);this.__dragger.destroy();this.__dragger=new a()}this.__dragger.setDrag(this.nodes.titleBar,this.__entity,false);this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var c,d,f,a;if(this.__isFixed){c=$IE6?document.documentElement.scrollLeft:0;d=$IE6?document.documentElement.scrollTop:0;f=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width;a=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height}else{c=0;d=0;f=document.documentElement.scrollWidth-this.width;a=document.documentElement.scrollHeight-this.height}this.__dragger.setArea({left:c,top:d,right:f,bottom:a})},__initTitleBar:function(){if(!this.nodes.titleBar){return}var a=this.nodes.titleBar;a.style.cursor="move";if($IE){Core.Events.addEvent(a,function(){return false},"selectstart")}else{a.style.MozUserSelect="none"}},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.ModuleDialog=function(c,b,a){this.__bgShadow=null;this.__dialog=null;this.__isInitBgShadow=false;this.__tplConfig=c;this.__iconSet=b;this.__dialogQueue=[];this.__zIndex=(a&&a.zIndex)||5000;this.__cfg=a||{};this.__initDialogEvent()}.$define({alert:function(c,a){a=a||{};var b=this.__createMessageDialog(a.tplConfig||this.__tplConfig.alert,a);b.nodes.text&&(b.nodes.text.innerHTML=c||"");b.show(a.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});b.nodes.linkOk&&b.nodes.linkOk.style.display!=="none"&&b.nodes.linkOk.focus();return b},newAlert:function(c,a,b){a.tplConfig=this.__tplConfig.newAlert;this.alert(c,a,b)},confirm:function(d,a){a=a||{};var c=this.__createMessageDialog(a.tplConfig||this.__tplConfig.confirm,a),b=this;c.nodes.text&&(c.nodes.text.innerHTML=d||"");if(c.nodes.btnCancel){c.nodes.btnCancel.innerHTML=a.textCancel||"取消";Core.Events.addEvent(c.nodes.btnCancel,function(){a.funcCancel&&a.funcCancel.call(c);c.hidden(a.renderer||b.__cfg.renderer);Core.Events.stopEvent()},"click");c.nodes.linkCancel&&Core.Events.addEvent(c.nodes.linkCancel,function(){var f=Core.Events.getEvent();if(f.keyCode=="13"){a.funcCancel&&a.funcCancel.call(c);c.hidden(a.renderer||b.__cfg.renderer)}},"keydown")}c.show(a.renderer||b.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});if(a.defaultButton==0){c.nodes.linkCancel&&c.nodes.linkCancel.style.display!=="none"&&c.nodes.linkCancel.focus()}else{c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus()}return c},newConfirm:function(c,a,b){a.tplConfig=this.__tplConfig.newConfirm;this.confirm(c,a,b)},create:function(a){var b=this;a=a||{};var c=new Ui.Dialog();c.setTemplate(a.tpl||this.__tplConfig.customs);a.content&&c.setContent(a.content);a.width&&!isNaN(a.width)&&c.setSize({width:a.width});a.height&&!isNaN(a.height)&&c.setSize({height:a.height});return this.__initDialog(c,a)},__initDialogEvent:function(){var a=this.__dialogQueue;Core.Events.addEvent(document,function(){var b=Core.Events.getEvent();if(a.length&&b.keyCode=="27"){a[a.length-1].hidden()}},"keydown")},__createMessageDialog:function(b,a){var f=new Ui.Dialog(),d=this,c;f.setTemplate(b);a.width&&!isNaN(a.width)&&f.setSize({width:a.width});a.height&&!isNaN(a.height)&&f.setSize({height:a.height});f.nodes.subText&&(f.nodes.subText.innerHTML=a.subText||"");if(f.nodes.icon){f.nodes.icon.className=this.__iconSet[a.icon||"01"]["class"];f.nodes.icon.alt=this.__iconSet[a.icon||"01"]["alt"]}if(f.nodes.btnOk){f.nodes.btnOk.innerHTML=a.textOk||"确定";Core.Events.addEvent(f.nodes.btnOk,function(){f.hidden(a.renderer||d.__cfg.renderer);a.funcOk&&a.funcOk.call(f);Core.Events.stopEvent()},"click")}f.nodes.linkOk&&Core.Events.addEvent(f.nodes.linkOk,function(){var g=Core.Events.getEvent();if(g.keyCode=="13"){f.hidden(a.renderer||d.__cfg.renderer);a.funcOk&&a.funcOk.call(f)}},"keydown");f.setDragger(a.dragger||d.__cfg.dragger).setFixed(true).setAreaLocked(true);return this.__initDialog(f,a)},__initDialog:function(c,a){var b=this;a.zIndex&&(b.__zIndex=a.zIndex);c.nodes.titleName&&(c.nodes.titleName.innerHTML=a.title||"提示");if(c.nodes.btnClose){Core.Events.addEvent(c.nodes.btnClose,function(){var d=true;a.funcBeforeClose&&(d=a.funcBeforeClose.call(c)!==false);a.funcClose&&a.funcClose.call(c);d&&c.hidden()},"click");Core.Events.addEvent(c.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")}c.setPosition({z:a.zIndex||b.__zIndex});c.setRenderer(a.renderer||this.__cfg.renderer);c.setDragger(a.dragger||this.__cfg.dragger);c.setMiddle();c.addEventListener("beforeHidden",function(){b.__updateDialogQueue(this,"remove")});c.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var d=this;if(!b.__isInitBgShadow){b.__initBGShadow(this,a.isAdamant||b.__cfg.isAdamant)}b.__setBGShadowOpacity(a.bgShadowOpacity!==0?a.bgShadowOpacity||0.4:a.bgShadowOpacity);window.setTimeout(function(){b.__bgShadow.show();b.__updateDialogQueue(d,"add")},1)});c.setTitle=function(d){this.nodes.titleName&&(this.nodes.titleName.innerHTML=d)};c.setHelp=function(d){this.nodes.btnHelp&&(this.nodes.btnHelp.href=d)};c.close=function(){this.hidden()};c.getNodes=function(){return this.nodes};c.getX=function(){return this.x};c.getY=function(){return this.y};c.getWidth=function(){return this.width};c.getHeight=function(){return this.height};return c},__initBGShadow:function(f,a){var b=this.__getDocumentSize().width,c=this.__getDocumentSize().height,d=this;this.__bgShadow=new Ui.Panel();this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:b,height:c}).setAdamant(a).setFixed(true).setPosition({x:0,y:0,z:d.__zIndex});Core.Events.addEvent(window,function(){d.__bgShadow.setPosition({x:0,y:0}).setSize({width:d.__getDocumentSize().width,height:d.__getDocumentSize().height})},"resize");this.__isInitBgShadow=true},__updateDialogQueue:function(a,d){var b,c;if(d==="add"){this.__dialogQueue.push(a)}else{if(d==="remove"){b=this.__dialogQueue.length;while(b--){this.__dialogQueue[b]===a&&this.__dialogQueue.splice(b,1)}}}if(this.__dialogQueue.length===0){this.__bgShadow.hidden()}else{c=this.__dialogQueue[this.__dialogQueue.length-1];this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,c.nodes.panel);this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel);c.nodes.linkOk&&c.nodes.linkOk.style.display!=="none"&&c.nodes.linkOk.focus()}},__setBGShadowOpacity:function(a){a=isNaN(a)?0:Math.max(Math.min(a,1),0);Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",a)},__getDocumentSize:function(){var a=document.documentElement.clientWidth||document.body.clientWidth,b=document.documentElement.clientHeight||document.body.clientHeight;return{width:a,height:b}}});Ui.Transition={simple:function(f,a,j,g){return j*f/g+a},backEaseIn:function(f,a,m,j){var g=1.70158;return m*(f/=j)*f*((g+1)*f-g)+a},backEaseOut:function(f,a,m,j){var g=1.70158;return m*((f=f/j-1)*f*((g+1)*f+g)+1)+a},backEaseInOut:function(f,a,m,j){var g=1.70158;if((f/=j/2)<1){return m/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return m/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},bounceEaseOut:function(f,a,j,g){if((f/=g)<(1/2.75)){return j*(7.5625*f*f)+a}else{if(f<(2/2.75)){return j*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return j*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return j*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},bounceEaseIn:function(f,a,j,g){return j-Transition.bounceEaseOut(g-f,0,j,g)+a},bounceEaseInOut:function(f,a,j,g){if(f<g/2){return Transition.bounceEaseIn(f*2,0,j,g)*0.5+a}else{return Transition.bounceEaseOut(f*2-g,0,j,g)*0.5+j*0.5+a}},regularEaseIn:function(f,a,j,g){return j*(f/=g)*f+a},regularEaseOut:function(f,a,j,g){return -j*(f/=g)*(f-2)+a},regularEaseInOut:function(f,a,j,g){if((f/=g/2)<1){return j/2*f*f+a}return -j/2*((--f)*(f-2)-1)+a},strongEaseIn:function(f,a,j,g){return j*(f/=g)*f*f*f*f+a},strongEaseOut:function(f,a,j,g){return j*((f=f/g-1)*f*f*f*f+1)+a},strongEaseInOut:function(f,a,j,g){if((f/=g/2)<1){return j/2*f*f*f*f*f+a}return j/2*((f-=2)*f*f*f*f+2)+a},elasticEaseIn:function(j,f,q,o){var g,n;if(j==0){return f}if((j/=o)==1){return f+q}n=o*0.3;if(!g||g<Math.abs(q)){g=q;var m=n/4}else{var m=n/(2*Math.PI)*Math.asin(q/g)}return -(g*Math.pow(2,10*(j-=1))*Math.sin((j*o-m)*(2*Math.PI)/n))+f},elasticEaseOut:function(j,f,q,o){var g,n;if(j==0){return f}if((j/=o)==1){return f+q}if(!n){n=o*0.3}if(!g||g<Math.abs(q)){g=q;var m=n/4}else{var m=n/(2*Math.PI)*Math.asin(q/g)}return(g*Math.pow(2,-10*j)*Math.sin((j*o-m)*(2*Math.PI)/n)+q+f)},elasticEaseInOut:function(j,f,q,o){var g,n;if(j==0){return f}if((j/=o/2)==2){return f+q}if(!n){var n=o*(0.3*1.5)}if(!g||g<Math.abs(q)){var g=q;var m=n/4}else{var m=n/(2*Math.PI)*Math.asin(q/g)}if(j<1){return -0.5*(g*Math.pow(2,10*(j-=1))*Math.sin((j*o-m)*(2*Math.PI)/n))+f}return g*Math.pow(2,-10*(j-=1))*Math.sin((j*o-m)*(2*Math.PI)/n)*0.5+q+f}};Ui.TweenStrategy=function(b,a,d,c){this.startValue=b||0;this.endValue=a||0;this.duration=d||0;this.motion=c||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var g=this,c,a=this.startValue,f=this.endValue,m=this.duration,j,b=(new Date()).getTime();this._itvID=window.setInterval(function(){c=((new Date()).getTime()-b)/1000;c>g.duration&&(c=g.duration);j=g.motion(c,a,f-a,m);g.onTween&&g.onTween(j);g.__eventDispatcher.dispatchEvent("tween",j);c==g.duration&&g.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(a){},onEnd:function(){}});Ui.OpacityRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__node=null;this.__tween=new Ui.TweenStrategy(0,0,0.6,Ui.Transition.strongEaseOut);this.__state="";this.__lastState="";this.__value=0;this.__node=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(a){this.__canShow=!!a},setCanHidden:function(a){this.__canHidden=!!a},show:function(b){var a=this.__tween;a.stop();Core.Dom.setStyle(b,"opacity",this.__value);b.style.display="";this.__node=b;this.__state="show";this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){a.startValue=this.__value;a.endValue=1;a.start()}return this},hidden:function(b){var a=this.__tween;a.stop();this.__node=b;this.__state="hidden";this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){a.startValue=this.__value;a.endValue=0;a.start()}return this},addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this},__initTweenEvent:function(){var a=this;this.__tween.addEventListener("tween",function(b){a.__value=b;Core.Dom.setStyle(a.__node,"opacity",b)});this.__tween.addEventListener("end",function(){a.__node&&a.__node.style.filter&&(a.__node.style.filter="");if(a.__state!==""&&a.__state!==a.__lastState){a.__lastState=a.__state;a.__eventDispatcher.dispatchEvent(a.__state)}a.__state==="hidden"&&(a.__node.style.display="none")})}});Ui.BorderDragger=function(){this.__drag=null;this.__isBindEvent=false;this.__border=null;this.__dragNode=null;this.__isCreated=false;this.__tweenX=new Ui.TweenStrategy(0,0,0.5,Ui.Transition.strongEaseOut);this.__tweenY=new Ui.TweenStrategy(0,0,0.5,Ui.Transition.strongEaseOut);this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(b,a){if(b.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(b,a)}else{this.__drag.addEventListener(b,a)}return this},removeEventListener:function(b,a){if(b.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(b,a)}else{this.__drag.removeEventListener(b,a)}return this},setDrag:function(b,a,c){if(!this.__isCreated){this.__createBorder(a);this.__initTweenEvent(a)}this.__drag=new Ui.Drag(b,this.__border,c);this.__dragNode=a;this.__initDragEvent();return this},setLock:function(a){this.__drag.isLock=!!a;return this},setArea:function(a){this.__drag.lockArea=a;return this},destroy:function(){this.__drag.destroy()},__createBorder:function(b){this.__border=$C("div");var a=this.__border.style;a.border="2px dashed #BCC4D0";a.position="absolute";a.display="none";a.backgroundColor="transparent";a.MozUserSelect="none";document.body.appendChild(this.__border);this.__isCreated=true},__initDragEvent:function(){if(this.__isBindEvent){return}var d=this,f=this.__border.style,b=this.__dragNode.style,c=this.__tweenX,a=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){f.zIndex=b.zIndex+1;f.position=b.position;f.width=d.__dragNode.offsetWidth-4+"px";f.height=d.__dragNode.offsetHeight-4+"px";f.left=parseInt(b.left)+"px";f.top=parseInt(b.top)+"px";f.display=""});this.__drag.addEventListener("afterDrag",function(){if($IE6){b.left=parseInt(f.left)+"px";b.top=parseInt(f.top)+"px";f.display="none";d.__eventDispatcher.dispatchEvent("afterDrag")}else{c.startValue=parseInt(b.left);c.endValue=parseInt(f.left);a.startValue=parseInt(b.top);a.endValue=parseInt(f.top);c.start();a.start()}});this.__isBindEvent=true},__initTweenEvent:function(c){var a=c.style,d=this.__border.style,b=this;this.__tweenX.addEventListener("tween",function(f){a.left=f+"px"});this.__tweenY.addEventListener("tween",function(f){a.top=f+"px"});this.__tweenX.addEventListener("end",function(){d.display="none";b.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={};var DialogTemplate={};(function(){var c={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")};var b={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}};var d={};var a=new Ui.ModuleDialog(c,b,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(g,f){if(f&&typeof f==="string"){d[f]=a.create(g);return d[f]}else{return a.create(g)}};winDialog.alert=function(j,f,g){if(g&&typeof g==="string"){d[g]=a.alert(j,f);return d[g]}else{return a.alert(j,f)}};winDialog.newAlert=function(j,f,g){if(g&&typeof g==="string"){d[g]=a.newAlert(j,f);return d[g]}else{return a.newAlert(j,f)}};winDialog.confirm=function(j,f,g){if(g&&typeof g==="string"){d[g]=a.confirm(j,f);return d[g]}else{return a.confirm(j,f)}};winDialog.newConfirm=function(j,f,g){if(g&&typeof g==="string"){d[g]=a.newConfirm(j,f);return d[g]}else{return a.newConfirm(j,f)}};winDialog.getDialog=function(f){if(f&&typeof f==="string"){return d[f]}};DialogTemplate=c})();$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"网络繁忙，请稍后再试",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='http://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});function showError(a,b){var c=$SYSMSG[a]||a;winDialog.alert(c,{icon:b||"01"})}$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='http://control.blog.sina.com.cn/blogprofile/attention.php' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"});Utils.Cookie.setCookie=function(a,g,d,n,b,f){var m=[];m.push(a+"="+escape(g));if(d){var j=new Date();var c=j.getTime()+d*3600000;j.setTime(c);m.push("expires="+j.toGMTString())}if(n){m.push("path="+n)}if(b){m.push("domain="+b)}if(f){m.push(f)}document.cookie=m.join(";")};String.prototype.format=function(){var f=(!arguments[0]||typeof arguments[0]=="undefined")?"":arguments[0].toString();var d=/(.*?)({(\d+)(:([0-9a-z]+))?})/ig;var c=this.match(d);if(c){for(var b=0,a=c.length;b<a;b++){c[b]=c[b].replace(d,function(){return RegExp.$1});c[b]=RegExp.$1;switch(typeof arguments[parseInt(RegExp.$3)]){case"undefined":c[b]+=RegExp.$2;break;case"number":c[b]+=(isNaN(RegExp.$5)||RegExp.$5=="")?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:c[b]+=arguments[parseInt(RegExp.$3)]}}c.push(this.replace(d,""));return c.join("")}return this};Sina.pkg("Core.Math");Core.Math.getUniqueId=function(b,a){return parseInt(Math.random()*10000).toString()+(new Date).getTime().toString()};Lib.pkg("Login");Lib.Login.info=function(){var a;if(window.sinaSSOController&&(a=sinaSSOController.getLoginInfo())){return a}else{return{}}};Lib.Login.LoginPost=Core.Class.create();Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(b,a,c){window.sinaSSOConfig=new function(){if(c){this.from=c}this.pageCharset="utf-8";this.noActiveTime=14400;this.setDomain=true;this.entry="boke";this.customInit=function(){};this.customLoginCallBack=b;this.customLogoutCallBack=function(d){};this.useIframe=true}},login:function(d,b,c){var f=this;if(typeof sinaSSOController=="undefined"||!sinaSSOController){trace("no sso");Utils.Io.JsLoad.request(this.url,{onComplete:function(){a()},onException:function(){},timeout:30000,isRemove:false})}else{trace("has sso");sinaSSOController.init();if(typeof sinaSSOController.setLoginType=="function"){sinaSSOController.setLoginType(2)}if(typeof sinaSSOController.getServerTime=="function"){}trace("init ok");a()}function a(){if(typeof c=="undefined"){sinaSSOController.login(d,b)}else{sinaSSOController.login(d,b,c)}}},parse:function(a){this.callback.call(a)}};Core.System.getScrollPos=function(c){c=c||document;var a=c.documentElement;var b=c.body;return[Math.max(a.scrollTop,b.scrollTop),Math.max(a.scrollLeft,b.scrollLeft),Math.max(a.scrollWidth,b.scrollWidth),Math.max(a.scrollHeight,b.scrollHeight)]};Core.Dom.getStyle=function(b,a){switch(a){case"opacity":var f=100;try{f=b.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{f=b.filters("alpha").opacity}catch(d){}}return f/100;case"float":a="styleFloat";default:var c=b.currentStyle?b.currentStyle[a]:null;return(b.style[a]||c)}};if(!$IE||$IE>8){Core.Dom.getStyle=function(c,a){if(a=="float"){a="cssFloat"}try{var b=document.defaultView.getComputedStyle(c,"")}catch(d){traceError(d)}return c.style[a]||b?b[a]:null}}Core.Dom.getXY=function(a){if((a.parentNode==null||a.offsetParent==null||Core.Dom.getStyle(a,"display")=="none")&&a!=document.body){return false}var c=null;var g=[];var b;var d=a.ownerDocument;b=a.getBoundingClientRect();var f=Core.System.getScrollPos(a.ownerDocument);return[b.left+f[1],b.top+f[0]];c=a.parentNode;while(c.tagName&&!/^body|html$/i.test(c.tagName)){if(Core.Dom.getStyle(c,"display").search(/^inline|table-row.*$/i)){g[0]-=c.scrollLeft;g[1]-=c.scrollTop}c=c.parentNode}return g};if(!$IE){Core.Dom.getXY=function(a){if((a.parentNode==null||a.offsetParent==null||Core.Dom.getStyle(a,"display")=="none")&&a!=document.body){return false}var c=null;var g=[];var b;var f=a.ownerDocument;g=[a.offsetLeft,a.offsetTop];c=a.offsetParent;var d=Core.Dom.getStyle(a,"position")=="absolute";if(c!=a){while(c){g[0]+=c.offsetLeft;g[1]+=c.offsetTop;if($SAFARI&&!d&&Core.Dom.getStyle(c,"position")=="absolute"){d=true}c=c.offsetParent}}if($SAFARI&&d){g[0]-=a.ownerDocument.body.offsetLeft;g[1]-=a.ownerDocument.body.offsetTop}c=a.parentNode;while(c.tagName&&!/^body|html$/i.test(c.tagName)){if(Core.Dom.getStyle(c,"display").search(/^inline|table-row.*$/i)){g[0]-=c.scrollLeft;g[1]-=c.scrollTop}c=c.parentNode}return g}}(function(){var j;var d=parseInt(Math.random()*100);var m=[];var c=-1;var g="";var f="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;				line-height: 20px;cursor: pointer;color: #999999;}				#sinaNote li.note {text-align: left;color: #999999;}";var b=window;var a={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":true,"sina.cn":true,"vip.sina.com":true,"qq.com":true,"163.com":true,"126.com":true,"hotmail.com":true,"yahoo.com.cn":true,"gmail.com":true}};a.createNode=function(){var q=b.document;var r=q.createElement("div");r.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var p=q.createElement("style");p.setAttribute("type","text/css");try{if($IE){p.styleSheet.cssText=f}else{p.innerHTML=f}}catch(o){trace(o.message)}var n=q.createElement("div");n.appendChild(r);n.appendChild(p);q.body.appendChild(n)};a.arrowKey=function(n){if(n==38){if(c<=0){c=m.length}c--;a.selectLi(c)}if(n==40){if(c>=m.length-1){c=-1}c++;a.selectLi(c)}};a.showList=function(z){g="";var F=Core.Events.getEvent().keyCode;if(F==38||F==40){a.arrowKey(F);return false}if(!$E("sinaNote")){a.createNode()}var r=$E(z).value;var t={};var D=r.indexOf("@");var v="";var u="";if(D>-1){v=r.substr(D+1);u=r.substr(0,D)}m=[];c=0;m[m.length]="sinaNote_MenuItem_Title_"+d;for(var H in this.menuStatus){this.menuStatus[H]=true;if(v!=""&&v!=H.substr(0,v.length)){this.menuStatus[H]=false}else{m[m.length]="sinaNote_MenuItem_"+H+"_"+d}}var A='<li class="note">请选择登录类型</li>';A+='<li id="sinaNote_MenuItem_Title_'+d+'">'+r+"</li>";var C;for(var q in this.menuStatus){if(this.menuStatus[q]==true){if(u==""){C=r+"@"+q}else{C=u+"@"+q}A+='<li id="sinaNote_MenuItem_'+q+"_"+d+'" title="'+C+'">'+C+"</li>"}}$E("sinaNote").innerHTML=A;for(var y=0;y<r.length;y++){if(r.charCodeAt(y)<160){$E("sinaNote").style.display="";this.selectList(z)}else{this.hideList()}}var n=$E(z);var o=$E("sinaNote");var s=0;var E=0;var p;if(b!=window){p=Core.Dom.getXY(window.frameElement);s=p[0];E=p[1]}var B=n.offsetWidth;if(B<200){B=200}o.style.width=B-2+"px";var G=Core.Dom.getXY(n);o.style.left=(G[0]-($IE?2:-1)+s)+"px";o.style.top=(G[1]+n.offsetHeight-($IE?2:-1)+E)+"px"};a.selectList=function(p){var o=$E("sinaNote").getElementsByTagName("li");for(var n=1;n<o.length;n++){o[1].style.backgroundColor=a.overbgcolor;o[1].style.color=a.outfcolor;o[n].onmousedown=function(){var q=this.innerHTML;if(q.indexOf("非新浪邮箱")>-1){var r=q.split("@");$E(p).value=r[0]}else{$E(p).value=this.innerHTML}if(Core.Events.getEvent()!=null){Core.Events.stopEvent()}};o[n].onmouseover=function(){if(n!=1){o[1].style.backgroundColor=a.outbgcolor;o[1].style.color=a.overfcolor}this.style.backgroundColor=a.overbgcolor;this.style.color=a.outfcolor};o[n].onmouseout=function(){this.style.backgroundColor=a.outbgcolor;this.style.color=a.overfcolor;o[1].style.backgroundColor=a.overbgcolor;o[1].style.color=a.outfcolor}}};a.selectLi=function(p){var n;$E("sinaNote_MenuItem_Title_"+d).style.backgroundColor=a.outbgcolor;$E("sinaNote_MenuItem_Title_"+d).style.color=a.overfcolor;for(var o=0;o<m.length;o++){n=$E(m[o]);n.style.backgroundColor=a.outbgcolor;n.style.color=a.overfcolor}$E(m[p]).style.backgroundColor=a.overbgcolor;$E(m[p]).style.color=a.outfcolor;g=$E(m[p]).innerHTML};a.hideList=function(){if(!$E("sinaNote")){a.createNode()}$E("sinaNote").style.display="none"};a.init=function(r,o,q,p){p=p||window;if(p.document.body==null){setTimeout(Core.Function.bind3(function(){this.init(r,o,q,p)},this),100)}for(var n in o){this[n]=o[n]}Core.Events.addEvent(document,a.hideList,"click");Core.Events.addEvent(r,a.hideList,"blur");Core.Events.addEvent(r,Core.Function.bind3(a.showList,this,[r]),"keyup");Core.Events.addEvent(r,function(u){var t=Core.Events.getEvent().keyCode;var y;if(t==13||t==9){if(g!=""){var s=g;if(s.indexOf("非新浪邮箱")>-1){var v=s.split("@");r.value=v[0]+"@";y=false}else{r.value=g;y=true}}if(y){if(q!=null){setTimeout(function(){q.focus()},0)}}else{if(r){r.focus()}}}},"keydown");if(p){b=p}};Lib.passcardOBJ=a})();Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;function msnrefreshWindow(){var setCookie=Utils.Cookie.setCookie;var getCookie=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var reg_token=getCookie("reg_token");if(reg_token){trace("token find out...");setCookie("reg_token","","","/",".blog.sina.com.cn")}else{trace("no token...");msnRefreshTimer=setTimeout(msnrefreshWindow,1000);return}var cookieArr;var cid;var code;var c_cid=getCookie("c_uid");var CBcookie=getCookie("msnLinkCB");var altReg=getCookie("AlT");setCookie("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn");if(CBcookie){cookieArr=CBcookie.split("_");cid=cookieArr[0];code=cookieArr[1]}if(c_cid!=cid){return}switch(code){case"noCid":break;case"loginError":break;case"unlink":deleteCookie("msnLinkCB");funcNoAccount(reg_token);break;case"done":deleteCookie("msnLinkCB");setCookie("loginFromMsn","msn",24,"/",".blog.sina.com.cn");funcSuccess(altReg,reg_token);break;case"pass":break}function funcSuccess(arg,reg_tk){trace("has Account");if(arg){trace("alt:"+arg);var iframe=$C("iframe");iframe.setAttribute("height",0);iframe.setAttribute("width",0);document.body.appendChild(iframe);iframe.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(arg)+"&savestate=7&returntype=TEXT";(function(){var me=arguments.callee;if(!me.count){me.count=0}if(me.count++>10){trace("放弃获取SUP");iframe.parentNode.removeChild(iframe);return}trace("尝试获取SUP, count:"+me.count);if(getCookie("SUP")){trace("获取到 SUP"+getCookie("SUP"));window.location.reload();return}setTimeout(me,1000)})()}else{window.location.reload()}}function funcNoAccount(){trace("noAccount");window.location.href="http://blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php"}function deleteCookie(name){var Then=new Date();Then.setTime(Then.getTime()-1);document.cookie=name+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+Then.toGMTString()}function jsonDecode(str){if(!str||str==""){return null}try{return window.eval("("+str+")")}catch(e){return null}}}Lib.Login.Ui.prototype={dialog:null,isInit:false,request:null,callback:null,initialize:function(){},login:function(b,a,c){this.callback=b||null;this.clearDomain=a||false;this.from=c||null;this.initDom();this.initEvent();this.dialog.show();this.dialog.setAreaLocked(true);this.reloadName();this.onShow();this.focus();if(scope.$pageid==="blogMove"){$E("login_move_tip").style.display=""}if($IE6){this.initAD()}Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var b=Lib.Login.info();var c=b.ln;if(c){$E("login_name_d").value=c}var a=Utils.Cookie.getCookie("ALF");if(a!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}a=Utils.Cookie.getCookie("LiRe");if(a!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}},initDom:function(){var a=this;this.dialog=winDialog.createCustomsDialog({tpl:a.tpl});this.dialog.addEventListener("hidden",function(){this.destroy()});this.dialog.setContent(this.struc);this.dialog.setTitle("登录新浪博客");this.dialog.setMiddle()},initEvent:function(){var a=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(a,this.clearDomain,this.from);Core.Events.addEvent("login_button",this.doLogin.bind2(this));Core.Events.addEvent("login_name_d",function(d){var c=d.keyCode;if(c==13){this.doLogin()}}.bind2(this),"keydown");Core.Events.addEvent("login_pass_d",function(d){var c=d.keyCode;if(c==13){this.doLogin()}}.bind2(this),"keydown");var b=1;Core.Events.addEvent("login_save",function(){if($E("login_save").checked){$E("login_save_tips").style.display=""}else{$E("login_save_tips").style.display="none"}if(b){var c="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(c,{onComplete:function(){},onException:function(){}});b=null}})},doLogin:function(){Core.Events.stopEvent();var b=$E("login_name_d").value;var a=$E("login_pass_d").value;b=Core.String.trim(b);a=a;if(b==""){this.error("请输入登录名");return false}if(a==""){this.error("请输入密码");return false}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){var c=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=c||1}}if($E("login_save").checked){v7sendLog("48_01_38_1");this.request.login(b,a,60)}else{v7sendLog("48_01_38_0");this.request.login(b,a)}return false},parse:function(b){if(b.result){Lib.checkAuthor();if($E("login_save").checked){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}var c=new Date(),o=c.getFullYear(),a=c.getMonth(),j=c.getDate();var f=new Date(o,a,j,24).getTime();Utils.Cookie.setCookie("onceloggedonblog",f,720,"/",".blog.sina.com.cn");var n=this;function g(){if(this.callback){try{$tray.renderLogin()}catch(d){}this.callback.call()}else{window.location=window.location.toString().replace(/#.*/,"")}}var p=false;Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:true,timeout:5000,onException:function(){if(!p){g.call(n)}}});scope.$bindEmailAlert=function(m){p=true;if((m.ret!="y"&&m.errcode!="not_verify")||Utils.Cookie.getCookie("sbr_noTBE")==1){g.call(n)}else{var d=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");d.setMiddle();d.show();d.nodes.btnClose.onclick=function(){g.call(n);d.hidden()};d.nodes.nobind.onclick=function(){setTimeout(function(){g.call(n);d.hidden()},100)};d.nodes.bindit.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog";d.nodes.bindit.onclick=function(){g.call(n)};d.nodes.noalertbind.onclick=function(){if(this.checked){Utils.Cookie.setCookie("sbr_noTBE","1",24*7,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}}};this.dialog.hidden()}else{if(b.errno==="4049"){sinaSSOController.loginExtraQuery={door:0};$E("login_ckimg").style.display="";$E("login_vcode").value="";$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";Core.Events.addEvent($E("reloadCode"),function(){$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value="";$E("login_div_error").innerHTML=""});this.error("");return}if(b.errno==="2070"){Core.Events.fireEvent($E("reloadCode"),"click");this.error(b.reason);return}if(b.errno=="4047"){this.error(b.reason);return}else{if(b.errno=="4057"){this.error(b.reason);return}else{if(b.errno=="4040"){this.error(b.reason);return}}}this.error("登录名或密码错误");$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value=""}},friendlyTip:function(d){var g=d;var c=$E("login_name_d");var b=c.value;var j=this;if(!/[\u0391-\uFFE5]+/.test(b)&&!/^\d+$/.test(b)&&!/^@/.test(b)){var m="你的登录名可能是 ";var a='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>';var n=["@sina.com","@sina.cn"];var f="";if(/@sina\.cn$/.test(b)){f=a.format("{0}",n[0])}else{if(/@sina\.com$/.test(b)){f=a.format("{0}",n[1])}else{f=a.format("{0}",n[0])+" 或 "+a.format("{0}",n[1])}}g=(m+f).format(b.replace(/@.*/,""))}return g},rename:(function(){window.$_RENAME=function(b,a){var c=$E("login_name_d");c.value=c.value.replace(b,"")+a;$E("login_pass_d").focus();$E("login_div_error").innerHTML=""};return window.$_RENAME})(),focus:function(){var a=$E("login_name_d");if(a.value==""){a.focus()}else{$E("login_pass_d").focus()}},initAD:function(){$E("login_ad").src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html"},onShow:function(){},error:function(a){$E("login_div_error").innerHTML=a;$E("login_pass_d").value="";this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'		<div class="CP_layercon2 passLoginItem">			<div>				<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>				<div class="boxA">登录名：					<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>				</div>				<div class="boxA">密　码：					<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>				</div>				<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  	<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  	<img width="100" align="absmiddle" id="checkImg" src="http://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> 			    </div>				<div class="ErrTips" id="login_div_error"></div>				<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>			</div>			<div class="connect_msn" id="connect_msn" style="position:relative;">				<span>使用 MSN 帐号登录博客</span>				<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>			</div>			<a href="http://blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;">如何登录？</a>			<div class="CP_lg_ad SG_j_linedot1">				<iframe id="login_ad" src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html" frameborder="0" scrolling="no" height="25" width="auto"></iframe>			</div>		</div>'};Core.System.winSize=function(b){var a,c;if(b){target=b.document}else{target=document}if(self.innerHeight){if(b){target=b.self}else{target=self}a=target.innerWidth;c=target.innerHeight}else{if(target.documentElement&&target.documentElement.clientHeight){a=target.documentElement.clientWidth;c=target.documentElement.clientHeight}else{if(target.body){a=target.body.clientWidth;c=target.body.clientHeight}}}return{width:a,height:c}};Core.System.pageSize=function(b){if(b){target=b.document}else{target=document}var f=(target.compatMode=="CSS1Compat"?target.documentElement:target.body);var d,c;if(window.innerHeight&&window.scrollMaxY){d=f.scrollWidth;c=window.innerHeight+window.scrollMaxY}else{if(f.scrollHeight>f.offsetHeight){d=f.scrollWidth;c=f.scrollHeight}else{d=f.offsetWidth;c=f.offsetHeight}}var a=Core.System.winSize(b);if(c<a.height){pageHeight=a.height}else{pageHeight=c}if(d<a.width){pageWidth=a.width}else{pageWidth=d}return[pageWidth,pageHeight,a.width,a.height]};(function(){function b(f,c){this.node=f;this.config=c;for(var d in this.defaultConfig){this.config[d]=this.defaultConfig[d]}this.initialize();return this}b.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=a.getViewableHeight();a.enrol(this)},callback:function(d){if(this.node.length==0){return}this.viewableHeight=d||this.viewableHeight;var g=[];for(var f=0,c=this.node.length;f<c;f++){if(this.node[f]&&this.node[f].dom==null&&Core.Dom.getXY(this.node[f])[1]<this.viewableHeight+this.config.preloadPixel){this.config.callback(this.node[f]);this.node[f]=null}else{if(this.node[f]&&this.node[f].dom&&Core.Dom.getXY(this.node[f].dom)[1]<this.viewableHeight+this.config.preloadPixel){this.node[f].callback(this.node[f].dom);this.node[f]=null}else{g.push(this.node[f])}}}this.node=g}};var a={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var d=window,c=d==window||d==document||!d.tagName||(/^(?:body|html)$/i).test(d.tagName);if(c){var f=d.document;d=(f.compatMode=="CSS1Compat"&&($IE||$FF||$OPERA))?f.documentElement:f.body}this._container=d;this._binder=c?window:d;this._isWindow=c;this._isInit=true;this.delayResize();this.bindEvent()},getViewableHeight:function(){var c=a._container.scrollTop+Core.System.winSize().height;this.eyeableHeight=c;return c},bindEvent:function(){if(!this._isInit){this.initialize();return}Core.Events.addEvent(this._binder,a.delayLoad,"scroll");if(this._isWindow){Core.Events.addEvent(this._binder,a.delayResize,"resize")}this.binded=true},unbindEvent:function(){Core.Events.removeEvent(a._binder,a.delayLoad,"scroll");if(this._isWindow){Core.Events.removeEvent(a._binder,a.delayResize,"resize")}this.binded=false},delayLoad:function(){if(a.scrollWatch){clearTimeout(a.scrollWatch)}a.scrollWatch=setTimeout(function(){a.callback();clearTimeout(a.scrollWatch);a.scrollWatch=null},100)},delayResize:function(){if(a.resizeWatch){clearTimeout(a.resizeWatch)}a.resizeWatch=setTimeout(function(){a.callback();clearTimeout(a.resizeWatch);a.resizeWatch=null},100)},enrol:function(c){a._member.push(c)},callback:function(){a.getViewableHeight();if(a._member.length>0){for(var d=0,c=a._member.length;d<c;d++){a._member[d].callback(a.eyeableHeight)}}if(a.eyeableHeight==Core.System.pageSize()[1]){a.unbindEvent()}}};Lib.LazyLoad=function(d,c){if(a.binded!=true){a.bindEvent(d,c)}new b(d,c)}})();var Layer=function(b){this.entity=null;this.ifm=null;var d=this;var c={width:0,height:0,x:0,y:0,isFixed:false,uniqueID:"",entityID:"",contentID:"",template:b,templateString:"",nodes:{}};this.getProperty=function(){return c};(function a(){var f=d.getProperty();f.uniqueID="_"+d.getUniqueID();f.entityID=f.uniqueID+"_entity";f.contentID=f.uniqueID+"_content";d.setTemplate(f.template);f.width=parseInt(d.entity.style.width);if($IE6){d.addIframe()}document.body.appendChild(d.entity);d.hidden()})();this._ie6Fixed=function(){d.entity.style.left=document.documentElement.scrollLeft+d.getProperty().x+"px";d.entity.style.top=document.documentElement.scrollTop+d.getProperty().y+"px";if(d.ifm){d.ifm.style.left=document.documentElement.scrollLeft+d.getProperty().x+"px";d.ifm.style.top=document.documentElement.scrollTop+d.getProperty().y+"px"}}};Layer.prototype={setTemplate:function(b){var f=this.getProperty();if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}if(typeof b=="object"){f.nodes=b;if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}this.entity=f.nodes.entity;document.body.appendChild(this.entity);if(!f.nodes.entity||!f.nodes.content){throw new Error("[layer.js] missing entity or content in layer nodes")}else{this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=f.x+"px";this.entity.style.top=f.y+"px"}return}var a=/[^\{\}]+(?=\})/g;f.template=b;f.templateString=f.template.match(a);this.entity=$C("div");var d=$C("div");var c=new Ui.Template(f.template);d.innerHTML=c.evaluate(this.getNodes("i"));document.body.appendChild(d);if(!$E(f.entityID)||!$E(f.contentID)){throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template")}else{this.entity=$E(f.entityID);this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=f.x+"px";this.entity.style.top=f.y+"px";document.body.replaceChild(this.entity,d);d=null}f.nodes=this.getNodes()},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);if(a.width){b.nodes.content.style.width=b.width+"px"}if(a.height){b.nodes.content.style.height=b.height+"px"}this.updateIfmSize()},setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.entity.style.left=b.x+"px";this.entity.style.top=b.y+"px";if($IE6&&b.isFixed){this.entity.style.left=b.x+document.documentElement.scrollLeft+"px";this.entity.style.top=b.y+document.documentElement.scrollTop+"px"}if(this.ifm){this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top}},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){var a=this;a.ifm.style.width=a.entity.offsetWidth+"px";a.ifm.style.height=a.entity.offsetHeight+"px"}},setFixed:function(b){var a=this.getProperty();a.isFixed=b;var c=this;if($IE6){c.entity.style.position="absolute";if(a.isFixed){c._ie6Fixed();Core.Events.addEvent(window,c._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,c._ie6Fixed,"scroll")}return}if(a.isFixed&&$FF2){c.updateFixed();return}this.entity.style.position=a.isFixed?"fixed":"absolute"},updateFixed:function(){var c=this.getProperty();if(c.isFixed&&$FF2){var d=this;var b=c.x,a=c.y;d.entity.style.position="absolute";d.setPosition({x:c.x+document.documentElement.scrollLeft,y:c.y+document.documentElement.scrollTop});d.entity.style.position="fixed";d.setPosition({x:b,y:a})}},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display="";this.updateIfmSize()}},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}},addIframe:function(){this.ifm=$C("iframe");this.ifm.style.position="absolute";this.ifm.style.zIndex="1024";this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;document.body.appendChild(this.ifm);Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(j){var g=this.getProperty();var a=j||"o";var c;var b={};var f=g.templateString;if(f){for(c=0;c<f.length;c++){var d=f[c];switch(a){case"o":b[d]=$E(g.uniqueID+"_"+d);break;case"i":b[d]=g.uniqueID+"_"+d;break}}}return"entity" in b?b:g.nodes},getUniqueID:function(){return parseInt(Math.random()*10000).toString()+(new Date).getTime().toString()},setContent:function(a){var b=this.getProperty();if(a){b.nodes.content.innerHTML=a}}};(function(){var p={simple:function(t,s,r,u){return r*t/u+s},backEaseIn:function(u,r,z,y){var v=1.70158;return z*(u/=y)*u*((v+1)*u-v)+r},backEaseOut:function(v,r,B,A,u,z){var y=1.70158;return B*((v=v/A-1)*v*((y+1)*v+y)+1)+r},backEaseInOut:function(v,r,B,A,u,z){var y=1.70158;if((v/=A/2)<1){return B/2*(v*v*(((y*=(1.525))+1)*v-y))+r}return B/2*((v-=2)*v*(((y*=(1.525))+1)*v+y)+2)+r},bounceEaseOut:function(s,r,v,u){if((s/=u)<(1/2.75)){return v*(7.5625*s*s)+r}else{if(s<(2/2.75)){return v*(7.5625*(s-=(1.5/2.75))*s+0.75)+r}else{if(s<(2.5/2.75)){return v*(7.5625*(s-=(2.25/2.75))*s+0.9375)+r}else{return v*(7.5625*(s-=(2.625/2.75))*s+0.984375)+r}}}},bounceEaseIn:function(s,r,v,u){return v-p.bounceEaseOut(u-s,0,v,u)+r},bounceEaseInOut:function(s,r,v,u){if(s<u/2){return p.bounceEaseIn(s*2,0,v,u)*0.5+r}else{return p.bounceEaseOut(s*2-u,0,v,u)*0.5+v*0.5+r}},strongEaseInOut:function(s,r,v,u){return v*(s/=u)*s*s*s*s+r},regularEaseIn:function(s,r,v,u){return v*(s/=u)*s+r},regularEaseOut:function(s,r,v,u){return -v*(s/=u)*(s-2)+r},regularEaseInOut:function(s,r,v,u){if((s/=u/2)<1){return v/2*s*s+r}return -v/2*((--s)*(s-2)-1)+r},strongEaseIn:function(s,r,v,u){return v*(s/=u)*s*s*s*s+r},strongEaseOut:function(s,r,v,u){return v*((s=s/u-1)*s*s*s*s+1)+r},strongEaseInOut:function(s,r,v,u){if((s/=u/2)<1){return v/2*s*s*s*s*s+r}return v/2*((s-=2)*s*s*s*s+2)+r},elasticEaseIn:function(v,r,B,A,u,z){if(v==0){return r}if((v/=A)==1){return r+B}if(!z){z=A*0.3}if(!u||u<Math.abs(B)){u=B;var y=z/4}else{var y=z/(2*Math.PI)*Math.asin(B/u)}return -(u*Math.pow(2,10*(v-=1))*Math.sin((v*A-y)*(2*Math.PI)/z))+r},elasticEaseOut:function(v,r,B,A,u,z){if(v==0){return r}if((v/=A)==1){return r+B}if(!z){z=A*0.3}if(!u||u<Math.abs(B)){u=B;var y=z/4}else{var y=z/(2*Math.PI)*Math.asin(B/u)}return(u*Math.pow(2,-10*v)*Math.sin((v*A-y)*(2*Math.PI)/z)+B+r)},elasticEaseInOut:function(v,r,B,A,u,z){if(v==0){return r}if((v/=A/2)==2){return r+B}if(!z){var z=A*(0.3*1.5)}if(!u||u<Math.abs(B)){var u=B;var y=z/4}else{var y=z/(2*Math.PI)*Math.asin(B/u)}if(v<1){return -0.5*(u*Math.pow(2,10*(v-=1))*Math.sin((v*A-y)*(2*Math.PI)/z))+r}return u*Math.pow(2,-10*(v-=1))*Math.sin((v*A-y)*(2*Math.PI)/z)*0.5+B+r}};var n=function(r){return r.uniqueID};if(!$IE){n=function(s){try{var r;if(s.getAttribute("uniqueID")==null){r="moz__id"+parseInt(Math.random()*100)+"_"+new Date().getTime();s.setAttribute("uniqueID",r);return r}return s.getAttribute("uniqueID")}finally{r=null}}}function a(t){try{var r=t.constructor.toString().toLowerCase();return r.slice(r.indexOf("function")+9,r.indexOf("()"))}finally{r=null}}function c(v,r){var u,t,s=[];t=r.length;for(u=0;u<t;u++){s[s.length]=parseFloat(Core.Dom.getStyle(v,r[u]))}return s}function q(r){return a(r)!="array"?[r]:r}function j(s,r){try{var v=a(s);var A=[],z=[],y,u,t;if(v!="array"){t=m(s);t[1]=r=="opacity"?"":t[1];A=[t[0]];z=[t[1]]}else{u=s.length;for(y=0;y<u;y++){t=m(s[y]);t[1]=r[y]=="opacity"?"":t[1];A[A.length]=t[0];z[z.length]=t[1]}}return[A,z]}finally{v=A=z=y=u=t=null}}function m(r){try{var s=/(-?\d.?\d*)([a-z%]*)/i.exec(r);return[s[1],s[2]?s[2]:"px"]}finally{s=null}}var b={};var f={};function g(t){try{var s=n(t);var r;if(b[s]!=true){r=new d();f[s]={node:t,func:r};b[s]=true;return r}else{return f[s].func}}finally{s=r=null}}function d(){this._timer=null}d.prototype.start=function(B,z,u,y,v,A){this.reset();A=A||{};if(A.before){this._func.before=A.before}if(A.end){this._func.end=A.end}if(A.tween){this._func.tween=A.tween}var r=q(z);var t=c(B,r);var s=j(u,r);this._node=B;this._property=r;this._endingvalue=s[0];this._suffixvalue=s[1];this._startvalue=t;this._end=false;this._fps=0;if(y!=null){this._seconds=y}if(p[v]!=null){this._animation=p[v]}this._starttime=new Date().getTime();this._func.before();this._timer=setInterval(Core.Function.bind3(this.play,this),10)};d.prototype.play=function(){var u=(new Date().getTime()-this._starttime)/1000;var t,s,r=this._property.length;if(u>this._seconds){u=this._seconds}for(t=0;t<r;t++){s=this._animation(u,this._startvalue[t],this._endingvalue[t]-this._startvalue[t],this._seconds);Core.Dom.setStyle(this._node,this._property[t],s+this._suffixvalue[t])}this._fps++;this._func.tween();if(u==this._seconds){this.stop()}};d.prototype.stop=function(){clearInterval(this._timer);this._end=true;this._func.end()};d.prototype.reset=function(){clearInterval(this._timer);this._end=false;this._node=null;this._property=[];this._startvalue=[];this._endingvalue=[];this._suffixvalue=[];this._fps=0;this._seconds=0.5;this._animation=p.simple;this._func={end:function(){},tween:function(){},before:function(){}}};function o(y,z,s,v,t,u){var r=g(y);r.start.apply(r,arguments)}o.stop=function(r){g(r).stop()};o.isTween=function(r){return !g(r)._end};Ui.tween=o})();var DialogDisplaySet={alpha1:{show:function(j,f,a){var b=0,d=0,c=parseInt(j.style.top)-f;j.style.top=c;Core.Dom.setStyle(j,"opacity",b);j.style.display="";var g=window.setInterval(function(){if(b<=1){Core.Dom.setStyle(j,"opacity",b)}if(d<=c+f){j.style.top=c+d+"px"}d+=1.5;b+=0.05;if(b>0.9&&parseInt(j.style.top)>=c+f){window.clearInterval(g);if(a){a()}}},10)},hidden:function(m,g,a){var c=1;var f=parseInt(m.style.top);var d=f-g;var b=f;var j=window.setInterval(function(){if(c>=0){Core.Dom.setStyle(m,"opacity",c)}if(b>=d){m.style.top=b+"px"}b-=1.5;c-=0.05;if(c<=0&&b<d){window.clearInterval(j);if(a){a()}}},10)}},alpha:{show:function(d,c,a){Core.Dom.setStyle(d,"opacity",0.3);d.style.display="";d.style.top=parseInt(d.style.top)-c+"px";var b=parseInt(d.style.top)+c;Ui.tween(d,["top","opacity"],[b,0.9],0.4,"simple",{end:a})},hidden:function(d,c,a){var b=parseInt(d.style.top)-c;Ui.tween(d,["top","opacity"],[b,0],0.2,"simple",{end:a})}},fallDown:{show:function(d,c,b,a){d.style.display="";d.style.top=c+"px";Ui.tween(d,"top",b,0.6,"bounceEaseOut",{end:a})},hidden:function(d,c,b,a){d.style.display="";d.style.top=c+"px";Ui.tween(d,"top",b,0.6,"strongEaseIn",{end:a})}}};Core.Events.fixEvent=function(a){if(typeof a=="undefined"){a=window.event}if(!a.target){a.target=a.srcElement;a.pageX=a.x;a.pageY=a.y}if(typeof a.layerX=="undefined"){a.layerX=a.offsetX}if(typeof a.layerY=="undefined"){a.layerY=a.offsetY}return a};var Drag3=function(b,d,c){var f=this;this.beDragObj=b;this.movedObjs=d||this.beDragObj;this.dragMode=c||"normal";this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.dragSet={normal:function(){f.normalDrag()},border:function(){f.borderDrag()},opacity:function(){f.opacityDrag()}};this.dragObjsFunc=function(){f.onDrag();f.dragObjs()};(function a(){f.beDragObj.style.MozUserSelect="none";Core.Events.addEvent(f.beDragObj,function(){return false},"selectstart");Core.Events.addEvent(f.beDragObj,function(){return false},"drag");for(var g=0;g<f.movedObjs.length;g++){if(f.movedObjs[g]!=f.beDragObj){f.movedObjs[g].style.position="absolute";if(!f.movedObjs[g].style.left){f.movedObjs[g].style.left=f.movedObjs[g].offsetLeft+"px"}if(!f.movedObjs[g].style.top){f.movedObjs[g].style.top=f.movedObjs[g].offsetTop+"px"}}}Core.Events.addEvent(f.beDragObj,f.dragSet[f.dragMode],"mousedown");if($IE){Core.Events.addEvent(f.beDragObj,function(){Core.Events.removeEvent(f.beDragObj,f.dragObjsFunc,"mousemove");f.beDragObj.releaseCapture();f.onDragEnd()},"mouseup")}else{Core.Events.addEvent(document,function(){Core.Events.removeEvent(document,f.dragObjsFunc,"mousemove");f.onDragEnd()},"mouseup")}})()};Drag3.prototype={capture:function(){this.canDrag=true},release:function(){this.canDrag=false},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var a=0;a<this.movedObjs.length;a++){if(this.isLock){if(e.clientX-this.movedObjs[a].deltaX<this.lockArea.left){this.movedObjs[a].style.left=this.lockArea.left+"px"}else{if(e.clientX-this.movedObjs[a].deltaX>this.lockArea.right-this.movedObjs[a].offsetWidth){this.movedObjs[a].style.left=this.lockArea.right-this.movedObjs[a].offsetWidth+"px"}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px"}}if(e.clientY-this.movedObjs[a].deltaY<this.lockArea.top){this.movedObjs[a].style.top=this.lockArea.top+"px"}else{if(e.clientY-this.movedObjs[a].deltaY>this.lockArea.bottom-this.movedObjs[a].offsetHeight){this.movedObjs[a].style.top=this.lockArea.bottom-this.movedObjs[a].offsetHeight+"px"}else{this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}}else{this.movedObjs[a].style.left=e.clientX-this.movedObjs[a].deltaX+"px";this.movedObjs[a].style.top=e.clientY-this.movedObjs[a].deltaY+"px"}}},normalDrag:function(){var b=this;e=Core.Events.getEvent();for(var a=0;a<b.movedObjs.length;a++){b.movedObjs[a].deltaX=e.clientX-parseInt(b.movedObjs[a].style.left);b.movedObjs[a].deltaY=e.clientY-parseInt(b.movedObjs[a].style.top)}if(b.canDrag){if($IE){b.beDragObj.setCapture();Core.Events.addEvent(b.beDragObj,b.dragObjsFunc,"mousemove")}else{Core.Events.addEvent(document,b.dragObjsFunc,"mousemove")}}b.onDragStart()},borderDrag:function(b,a){},opacityDrag:function(b,a){}};Ui.Drag3=Drag3;var Dialog=function(b){var d=this;d.entity=null;d.ifm=null;var c={id:"",x:0,y:0,width:0,height:0,isFixed:false,layer:new Layer(b),template:b,canDrag:false,dragEntity:null,name:"",uniqueID:"",isShow:false,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:false,enabled:true};this.getProperty=function(){return c};(function a(){var g=d.getProperty();var f;g.uniqueID=g.layer.getProperty().uniqueID;g.id=g.uniqueID+"_dialog";g.nodes=d.getNodes();d.entity=g.layer.entity;d.ifm=g.layer.ifm;g.width=parseInt(d.entity.style.width);if(g.nodes.titleBar){g.dragEntity=new Ui.Drag3(g.nodes.titleBar,d.ifm?[d.ifm,d.entity]:[d.entity]);g.nodes.titleBar.style.cursor="move";Core.Events.addEvent(g.nodes.titleBar,function(){return false},"selectstart");g.dragEntity.onDrag=function(){d.onDrag()}}Core.Events.addEvent(window,function(){if(g.isShow&&g.isFixed){var n=Core.System.winSize();var m=n.width/2-d.getWidth()/2;var j=n.height/2-d.getHeight()/2;m=m<0?0:m;j=j<0?0:j;d.setPosition({x:m,y:j})}},"resize")})()};Dialog.prototype={setPosition:function(a){var b=this.getProperty();Core.System.parseParam(b,a);this.getProperty().layer.setPosition(a)},setSize:function(a){var b=this.getProperty();Core.System.parseParam(b,a);b.layer.setSize(a)},setFixed:function(b){var a=this.getProperty();a.isFixed=b;this.getProperty().layer.setFixed(a.isFixed)},setContent:function(a){var b=this.getProperty();this.getProperty().layer.setContent(a)},setTemplate:function(a){var b=this.getProperty();b.template=a;b.layer.setTemplate(b.template)},setDrag:function(a){var b=this.getProperty();b.canDrag=a;if(b.canDrag){b.dragEntity.capture()}else{b.dragEntity.release()}},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(b){var a=this.getProperty();var c=this;a.isShow=true;if(this.ifm){this.ifm.style.display=""}this.onShow();if(a.displayMode=="normal"||b=="normal"){this.entity.style.display=""}else{a._modeDisplayRuning=true;a.enabled=false;this._showWithMode(function(){a._modeDisplayRuning=false;a.enabled=true;if(c.onDisplaied){c.onDisplaied()}})}},close:function(b){var c=this;var a=this.getProperty();if(a.displayMode=="normal"||b=="normal"){a.isShow=false;a.layer.hidden();this.destroy();this.onClose();if(c.onDisplayFinished){c.onDisplayFinished()}}else{if(!a._modeDisplayRuning){a._modeDisplayRuning=true;a.enabled=false;this._hiddenWithMode(function(){a.isShow=false;a.layer.hidden();a._modeDisplayRuning=false;a.enabled=true;c.destroy();c.onClose();if(c.onDisplayFinished){c.onDisplayFinished()}})}}},hidden:function(b){var c=this;var a=this.getProperty();if(a.displayMode=="normal"||b=="normal"){a.isShow=false;a.layer.hidden();this.onHidden();if(c.onDisplayFinished){c.onDisplayFinished()}}else{if(!a._modeDisplayRuning){a._modeDisplayRuning=true;a.enabled=false;this._hiddenWithMode(function(){a.isShow=false;a.layer.hidden();c.onHidden();a._modeDisplayRuning=false;a.enabled=true;if(c.onDisplayFinished){c.onDisplayFinished()}})}}},_showWithMode:function(a){var c=this.getProperty();var b=Core.System.winSize();var d=this;switch(c.displayMode){case"alpha":DialogDisplaySet.alpha.show(this.entity,20,a);break}},_hiddenWithMode:function(a){var c=this.getProperty();var d=this;var b=Core.System.winSize();switch(c.displayMode){case"alpha":DialogDisplaySet.alpha.hidden(this.entity,20,a);break}},destroy:function(){try{if(this.getProperty().nodes.iframe){this.getProperty().nodes.iframe.src=""}}catch(a){}this.entity&&this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(a){var b=this.getProperty();b.dragEntity.isLock=a;var c=this;if(a){c._updateLockArea();Core.Events.addEvent(window,function(){c._updateLockArea()},"resize")}},_updateLockArea:function(){var b=this.getProperty();var a=Core.System.winSize();if(b.isFixed){if($IE6){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height};Core.Events.addEvent(window,function(){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height}},"scroll");Core.Events.addEvent(window,function(){b.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+a.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+a.height}},"resize")}else{b.dragEntity.lockArea={left:0,right:a.width,top:0,bottom:a.height}}}else{b.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(a){return this.getProperty().layer.getNodes(a)},setFocus:function(){var b=this.getProperty();if(b.focusNode&&b.focusNode.style.display!="none"){try{b.focusNode.focus()}catch(a){}}else{if(this.entity.style.display!="none"){this.entity.focus()}}},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}};Core.String.byteLength=function(b){if(typeof b=="undefined"){return 0}var a=b.match(/[^\x00-\x80]/g);return(b.length+(!a?0:a.length))};Core.Array.ArrayWithout=function(){if(arguments.length<2){return arguments.length==1?arguments[0]:null}var d=[];var g=arguments[0];if(g===null||g.constructor!=Array){return null}if(arguments[1].constructor==Array){var b=[];b[0]=g;Core.Array.foreach(arguments[1],function(j,m){b[m+1]=j})}else{b=arguments}for(var c=0;c<g.length;c++){var f=true;for(var a=1;a<b.length;a++){if(g[c]==b[a]){f=false;break}}if(f){d.push(g[c])}}return d};Lib.register("util.LS",function(f){var b;var a=function(n,q){var m="data-sina-blog-storage",g="data-sina-blog-storage-keys",u=n.document,j=u.createElement("input"),t,v,s=Core.Array.ArrayWithout,o=function(A,C,y,B){j.load(m);y=j.getAttribute(g)||"";B=RegExp("\\b"+A+"\\b,?","i");var z=B.test(y)?1:0;y=C?y.replace(B,""):z?y:y===""?A:y.split(",").concat(A).join(",");j.setAttribute(g,y);j.save(m)};var p=document.body||document.getElementsByTagName("head")[0]||document.documentElement;j.id="____storage_container_box";j.type="hidden";p.appendChild(j);j.addBehavior("#default#userData");j.load(m);var r=j.getAttribute(g);v=r?r.split(","):[];t=v.length;return{key:function(y){if(isNaN(y)){y=0}return v[parseInt(y,10)]},getItem:function(y){j.load(m);return j.getAttribute(y)},setItem:function(y,z){j.setAttribute(y,z);j.save(m);this.length++;v.push(y);o(y)},removeItem:function(y){j.removeAttribute(y);j.save(m);this.length--;s(v,y);o(y,1)},clear:function(){j.load(m);var z=j.getAttribute(g).split(","),y=z.length;if(z[0]===""){return}for(var A=0;A<y;A++){j.removeAttribute(z[A]);j.save(m)}j.setAttribute(g,"");j.save(m);this.length=0},length:t}};var d=function(g){if(g.localStorage){return g.localStorage}else{if(g.sessionStorage){return g.sessionStorage}else{if(g.globalStorage){return g.globalStorage}else{return a(g)}}}};var c=function(){if(!b){b=d(window)}return b};return{key:function(g){return c().key(g)},getItem:function(g){return c().getItem(g)},setItem:function(g,j){return c().setItem(g,j)},removeItem:function(g){return c().removeItem(g)},clear:function(){return c().clear()}}});$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00004:"系统繁忙，请稍候再试。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='http://control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"});(function(){if(scope.blogOpener){scope.addBlogOpenerEvent=function(){};return}var p="http://control.blog.sina.com.cn/riaapi/reg/open_blog.php";var c=function(){this._hasInit=false};c.prototype={getCon:function(){return['<div class="CP_layercon8"><div class="nowOpenBlog"><strong>您的博客尚未开通,仅一步操作就能开通您的个人博客</strong><div class="boxA"><label>博客名称：</label><input id="blogNameInput_t" type="text" class="ipt" /><img style="display:none" id="blogNameIcon_t" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips"><p id="blogNameError_t" class="tip">名称不能为空</p></div><div  class="boxA"> <p>隐私设置：<input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label><input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label></p></div><div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div><div class="boxB"><p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p></div></div></div>'].join("")},_initDialog:function(){Lib.checkAuthor();this.key=o();this._dialog=winDialog.createCustomsDialog({content:this.getCon()},"openblog");this.bindEvent();n($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t"))},showDialog:function(q,v,u){v=v||false;if(!this._hasInit){this._initDialog();this._hasInit=true}var y=this;scope.whenOpenBlogCallback=q;if(!scope.hasOpenBlog){trace("这是一位后登陆的用户");var s=0;var r=setInterval(function(){trace("呀，怎么还没有出结果啊--"+s);if(scope.hasOpenBlog){clearInterval(r);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{trace("他们没有开通博客");y._showDialog(v)}}s++;if(s==10){Lib.checkAuthor();trace("等不及了，自己发吧。。。");clearInterval(r);(new Interface("http://control.blog.sina.com.cn/riaapi/profile/unread.php","jsload")).request({GET:{uid:$UID,product:"blog"},onSuccess:function(t){scope.hasOpenBlog=t.isbloguser==1?"open":"no";trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");y._showDialog(v)}}})}},10)}else{trace("这是已登陆的用户");if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");this._showDialog(v)}}if(u){$E("openBlogCancel").style.display="none";this._dialog.getNodes().btnClose.style.display="none"}},_showDialog:function(q){$E("blogNameInput_t").value=j();g($E("blogNameError_t"),$E("blogNameIcon_t"));$E("ErrTips_t").style.visibility="hidden";$E("blogNameIcon_t").style.display="none";this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle()},bindEvent:function(){var q=this;Core.Events.addEvent($E("openBlogCancel"),function(){q.closeDialog();return false});Core.Events.addEvent($E("openBlogOkBtn_t"),function(){f({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),openName:($E("blogNameInput_t").value||j()),isprivate:$E("openAll1_t").checked?0:1,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(r,s){if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback(r,s)}if($E("openedBlogTray")&&$E("openedBlogTray").style.display=="none"){$E("outOfOpenBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="none";$E("openedBlogTray").style.display=""}if($E("noOpendBlogSearchTip")&&$E("noOpendBlogSearchTip").style.display=="block"){$E("noOpendBlogSearchTip").style.display="none";$E("opendBlogSearchTip").style.display="block"}scope.hasOpenBlog="open";q.closeDialog();scope.whenOpenBlogCallback=function(){}}});return false})},closeDialog:function(){var q=this;this._dialog.hidden()}};function j(){var r=$nick;var q=Core.String.byteLength(r);while(q>18){r=r.substring(0,r.length-1);q=Core.String.byteLength(r)}return r+"的博客"}scope.openBlogGetShotName=j;function n(q,r,t,s){q.onfocus=function(){q.className="ipt focus";a(t,"");s.style.display=""};q.onblur=function(){q.className="ipt";m(q,r,s);a(t,"none")};q.onkeyup=function(){m(q,r,s)}}scope.openBlogNameEvent=n;function f(r){if(f.requestComplete===false){return}if(r.nameErrorEle.innerHTML){d(r.nameErrorEle.parentNode);setTimeout(function(){d(r.nameErrorEle.parentNode)},442);return}f.requestComplete=false;var q=r.from==="floatingLayer"?"openBlogOkBtn_t":"openBlogOkBtn";$E(q).className="loading";var s={loginName:o(),blogName:r.openName};new Interface(p,"jsload").request({GET:{uid:$UID,loginname:s.loginName,blogname:s.blogName,version:7,src:"layer",isprivate:r.isprivate},onSuccess:function(t){f.requestComplete=true;$E(q).className="btn";r.okCallback(t,s);s=null},onError:function(t){var z=$E("blogNameError"),y=$E("blogNameIcon"),v=$E("blogNameError_t"),u=$E("blogNameIcon_t");switch(t.code){case"A11008":if(z&&y){b(z,"输入内容有误，请修改",y)}if(v&&u){b(v,"输入内容有误，请修改",u)}break;case"A11010":if(z&&y){b(z,"输入内容有误，请修改",y)}if(v&&u){b(v,"输入内容有误，请修改",u)}break;default:b(r.errorEle,"系统繁忙，请稍后再试。");break}f.requestComplete=true;$E(q).className="btn"}})}scope.openBlogWhenOpenBlog=f;function d(r){for(var q=1;q<=55;q++){(function(s){setTimeout(function(){r.style.backgroundColor="rgb(255, "+ +(200+s)+", "+(200+s)+")"},s*8)})(q)}}function o(){var q=decodeURIComponent(Utils.Cookie.getCookie("SUP"));q=q.split("&name=")[1];q=decodeURIComponent(q.split("&")[0]);return q}function a(r,s){for(var q=0;r[q];q++){r[q].style.display=s}}function m(r,s,t){var u=r.value;if(/^(?:\s|[　])+|(?:\s|[　])+$/.test(u)){r.value=Core.String.trim(u);u=r.value}if(u){var q=Core.String.byteLength(u);if(q>24){b(s,"博客名称超长",t)}else{g(s,t)}}else{b(s,"博客名称不能为空",t)}}function b(r,s,q){r.innerHTML=s;r.style.display="block";if(r.id.indexOf("ErrTips")>=0){r.style.visibility="visible"}if(q){q.className="SG_icon SG_icon48 tips"}}function g(r,q){r.innerHTML="";r.style.display="none";if(q){q.className="SG_icon SG_icon49 tips"}}scope.blogOpener=new c();scope.addBlogOpenerEvent=function(q){Core.Events.addEvent(q,function(r){scope.blogOpener.showDialog(function(t,y){Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread");Lib.util.LS.removeItem("uid"+$UID);if(scope.$pageid=="fakeIndex"){window.location.href="http://i.blog.sina.com.cn/blogprofile/index.php?atten=1";return}if($E("openedBlogTray")){$E("openedBlogTray").style.display="";$E("noOpenedBlogTray").style.display="none";$E("outOfOpenBlogTray").style.display="none";if(y){$E("loginBarAppMenuLabel").innerHTML=y.loginNick}}else{var v=window;v.$tray&&v.$tray.renderLogin()}var u=function(){if(scope.___importV){scope.___importV();scope.___openBlogFlag=1}};var s={subText:!scope.___importV?['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""):"",icon:"03",funcOk:u,funcClose:u,width:300};winDialog.alert("开通博客成功",s,"unregister");var z=$E("commentNick");if(z){var A=z.firstChild;while(A){z.removeChild(A);A=z.firstChild}z.innerHTML=y.loginNick+":"}},true)},"click")}})();(function(){var a=function(b,c,d){Lib.checkAuthor();var f=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax");f.request({POST:{uid:b||$UID,aid:c||scope.$uid},onSuccess:function(){},onError:function(o){var n="";switch(o.code){case"A11007":n=$SYSMSG.A11007.replace("#{linkNewBlog}","http://login.sina.com.cn/hd/reg_sec.php?entry=blog");winDialog.alert(n,{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":n=$SYSMSG.A33003.replace("#{UID}",$UID);winDialog.alert(n);break;case"A33004":var j={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var g=$E("module_901_attention");g.className="SG_aBtn SG_aBtn_dis";g.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(m){}n=$SYSMSG.A33004;j.subText=j.subText.replace(/#{UID}/g,$UID);winDialog.alert(n,j,"attention");break;default:showError(o.code)}d(o.code)},onFail:function(){showError($SYSMSG.A00001)}})};Lib.Component.Attention=function(b,c,f){Lib.checkAuthor();var d=this;f=f||function(){};if(!$isLogin){var g=new Lib.Login.Ui();g.login(function(){scope.blogOpener.showDialog(function(){(Core.Function.bind3(a,null,[b,c,f]))()})},false,"referer:"+location.hostname+location.pathname+",func:0004")}else{scope.blogOpener.showDialog(function(){a(b,c,f)})}};Lib.Component.deleteAttention=function(b,c){winDialog.getDialog("attention").close();winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var d=$E("module_901_attention");d.className="SG_aBtn";d.innerHTML="<cite onclick=\"Lib.Component.Attention('"+$UID+"', '"+scope.$uid+"');\">加关注</cite>"},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){Lib.Component.isAttentioned()},textOk:"是",textCancel:"否"})};Lib.Component.isAttentioned=function(){winDialog.alert("已关注此人！",{subText:['<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention2" onclick="winDialog.getDialog(\'attention\').close();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03"},"attention")}})();$SetPV=function(b){b=window.parseInt(b);Lib.checkAuthor();if($isAdmin){$E("comp_901_pv").innerHTML='<strong><a title="您的访问统计" href="http://i.blog.sina.com.cn/blogprofile/profilevisitanaly.php" target="_blank">'+Core.String.formatNumber(b)+"</a></strong>"}else{$E("comp_901_pv").innerHTML="<strong>"+Core.String.formatNumber(b)+"</strong>"}var a=0;var c=[0,50,100,150,200,300,500,800,1500,3000,5000,10000,15000,25000,40000,70000,100000,150000,200000,500000,1000000,2000000,5000000,10000000,20000000,50000000,100000000,150000000,200000000,250000000,300000000,350000000,400000000,450000000,500000000,550000000];if(b>=50000000){a=Math.floor(b/50000000)+24}else{a=-1;c=c.join(",").replace(/(\d+)/g,function(f,d){if(window.parseInt(d)<=b){a++}})}if(scope.$pageid==="article"||scope.$pageid==="articleM"||scope.$pageid==="articletj"){scope.$rank=a}a=a.toString().replace(/(\d)/g,function(f,d){return'<img src="http://simg.sinajs.cn/blog7style/images/common/number/'+d+'.gif"/>'});$E("comp_901_grade").innerHTML=a};Sina.pkg("Utils.Form");Core.String.leftB=function(c,a){var b=c.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");c=c.slice(0,b.slice(0,a).replace(/\*\*/g," ").replace(/\*/g,"").length);if(Core.String.byteLength(c)>a){c=c.slice(0,c.length-1)}return c};Utils.Form.limitMaxLen=function(a,b){var c;var d=function(){c=a.value;var f=Core.String.byteLength(c);if(f>b){a.value=Core.String.leftB(c,b)}};Core.Events.addEvent(a,Core.Function.bind3(d,a),"keyup");Core.Events.addEvent(a,Core.Function.bind3(d,a),"blur");Core.Events.addEvent(a,Core.Function.bind3(d,a),"focus")};Lib.invite_tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="javascript:void(0)" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"请先登录。",A20101:"内容超长。",A20102:"请输入正确的登录名或密码。",A20103:"请输入正确的验证码。",A20104:"请把对方在黑名单中解除，再加为好友。",A20105:"你的好友数量达到上限，不能添加新好友。",A20106:"博主已设置为拒绝接受好友邀请，请不要打扰哦。",A20107:"不能加自己为好友。",A20108:"你们已经是好友。",A20109:"不能包含sina等特殊含义字符。",A23002:"您已被对方加入黑名单。",A20121:"参数格式不正确。",A20000:"参数格式不正确。",A20001:"内容超长。",A20002:"请输入正确的登录名或密码。",A20003:"请输入正确的验证码。",A20004:"不能包含sina等特殊含义字符。",A20005:"纸条内容不能为空。",A20006:"不能自己给自己发纸条",A20007:"请把对方在黑名单中解除，再发送纸条。",A20020:"给#{nick}的纸条发送失败！",A20008:"对不起，您短时间发表的纸条过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20999:"对不起，您短时间发送的好友请求过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20009:"博主已设置为拒绝接收所有纸条，请不要打扰哦。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",A20015:"发生错误，请稍作休息~",A30006:"该博主只接收来自好友的纸条，您还不是Ta的好友哦。",A10006:"对不起，您已被博主列入黑名单，无法发送小纸条。"});Lib.register("blogv.getVHTML",function(){return function(c,a){var f,b;if(isNaN(c)){c=-1}else{c=parseInt(c,10)}if(0==c){f="新浪个人认证";b=" SG_icon146"}else{if(0<c&&8>c){f="新浪机构认证";b=" SG_icon147"}}var d;if(!1!==a){a=!0}if(f){d='<img class="SG_icon '+b+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="'+f+'" alt="'+f+'" align="absmiddle" />'}else{d=""}if(d&&a){d='<a target="_blank" href="http://blog.sina.com.cn/v/verify">'+d+"</a>"}return d}});Lib.Invite_Base=Core.Class.create();Lib.Invite_Base.prototype={html:['<div class="CP_layercon2 addFriendItem">','<div class="toWho">#{head_image}<span>#{nickname}</span></div>','<div class="formTowho">','<div class="row1" style="display:#{login};">登录名：','<input id="invite_loginname" type="text" class="fm1" style="width:80px;"/>&nbsp;&nbsp;&nbsp;','密码：<input id="invite_password" type="password" class="fm1" style="width:73px;" maxlength="16"/>','&nbsp;&nbsp;<a target="_blank" href="http://login.sina.com.cn/getpass.html">找回密码</a><em class="SG_txtc">','|</em><a target="_blank" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp">注册</a>','<input id="saveOnline_invite" type="checkbox" checked value="" style="display:inline-block;margin-top:3px;"/><label for="saveOnline_invite" style="margin-top:10px; display:inline-block;">记住登录状态</label>','<span id="saveCaution_invite" style="color:#999; margin-left:10px; display:none;">建议在网吧/公用电脑上取消该选项</span>','</div><p id="invite_user_error" class="ErrTips" style="display:none;">请输入正确的登录名或密码</p>','<div class="row2"><textarea id="invite_content"></textarea></div>','<div class="row1"><span id="invite_limit" class="SG_floatR SG_txtc">您还可以输入#{content_length}个汉字</span>','验证码：<input type="text" id="invite_checkcode" maxlength="4"',' style="width:60px" class="fm1" name="input"/>&nbsp;','<img height="16" width="51" id="invite_checkimage" src="#{checkImage}" align="absmiddle" />&nbsp;','<a id="invite_checklink" href="#" onclick="return false;">换一下</a>','<p id="invite_code_error" class="ErrTips" style="display:none;"></p></div>','<div class="btn">','<a id="invite_submit" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>',"#{dialogTitle}</cite></a>&nbsp;&nbsp;",'<a id="invite_cancel" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>取消</cite></a>',"</div>","</div>","</div>"].join(""),dialogName:"invite",initialize:function(f,a){this.uid=f;this.onlineTime=a||15;Lib.checkAuthor();if(!this.isAllowSend()){return}var d={head_image:this.headImage!=null?this.headImage:'<img src="'+("http://portrait"+(this.uid%8+1)+".sinaimg.cn/"+this.uid+"/blog/50")+'" align="absmiddle" alt="'+scope.owenerNickName+'" title="'+scope.owenerNickName+'" />',nickname:this.title(),login:$isLogin?"none":"",checkImage:"http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),content_length:this.contentLength/2,dialogTitle:this.dialogTitle};var c=new Ui.Template(this.html).evaluate(d);if(this.dialog==null){window.$inviteDialog=this.dialog=winDialog.createCustomsDialog({content:"",title:this.dialogTitle,tpl:Lib.invite_tpl});this.dialog.addEventListener("hidden",function(){this.destroy()})}else{}this.dialog.setContent(c);this.dialog.setMiddle();this.dialog.show();this.dialog.setAreaLocked(true);Utils.Form.limitMaxLen($E("invite_content"),this.contentLength);Core.Events.addEvent("invite_submit",Core.Function.bind2(this.checkData,this));Core.Events.addEvent("invite_cancel",Core.Function.bind2(this.closeDailog,this));var b=function(){$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random()};Core.Events.addEvent("invite_checkimage",b);Core.Events.addEvent("invite_checklink",b);Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=setInterval(Core.Function.bind2(function(){var g=Core.String.byteLength($E("invite_content").value);var j=Math.max(0,Math.floor((this.contentLength-g)/2));$E("invite_limit").innerHTML="您还可以输入"+j+"个汉字"},this),500)},this),"focus");Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=null},this),"blur");this.initSaveCaution();this.reloadName()},isAllowSend:function(){return true},initSaveCaution:function(){var d=$E("saveOnline_invite");var a=$E("saveCaution_invite");if(!$isLogin){d[$IE?"onclick":"onchange"]=b}var c=1;function b(){if(d.checked){a.style.display="inline-block"}else{a.style.display="none"}if(c){var f="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00002&rnd="+Math.random();Utils.Io.JsLoad.request(f,{onComplete:function(){},onException:function(){}});c=null}}},reloadName:function(){var a=Lib.Login.info();var b=a.ln;if(b){$E("invite_loginname").value=b}},checkData:function(){if(!$isLogin){this.username=Core.String.trim($E("invite_loginname").value);this.password=Core.String.trim($E("invite_password").value);if(this.username==""||this.password==""){$E("invite_user_error").style.display="";return}else{$E("invite_user_error").style.display="none"}}this.checkcode=Core.String.trim($E("invite_checkcode").value);if(this.checkcode==""||this.checkcode.length<4){$E("invite_code_error").innerHTML="请输入正确的验证码";$E("invite_code_error").style.display="";return}else{$E("invite_code_error").style.display="none"}if(!$isLogin){if($E("saveOnline_invite").checked){v7sendLog("48_01_39_1")}else{v7sendLog("48_01_39_0")}this.login()}else{var a=this;scope.blogOpener.showDialog(function(){a.postContent()})}},login:function(){this.request=new Lib.Login.LoginPost(Core.Function.bind2(function(a){if(a.result){if(this.postContent){Lib.checkAuthor();$tray.renderLogin();var b=this;scope.blogOpener.showDialog(function(){b.postContent()})}}else{trace("登陆失败 ："+a.reason);$E("invite_user_error").style.display=""}},this),false,"referer:"+location.hostname+location.pathname+",func:000"+(/messagesend/.test(this.Interface.url.url)?"2":"3"));this.request.login(this.username,this.password,($E("saveOnline_invite").checked?this.onlineTime:null))},resultHTML:new Ui.Template(['<div class="CP_layercon1">','<div class="CP_prompt">','<img class="SG_icon #{icon}" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"',' width="50" height="50" align="absmiddle" />','<table class="CP_w_ttl"><tr><td>#{content}</td></tr></table>','<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" ','onclick="window.$inviteDialog && window.$inviteDialog.hidden();return false;"><cite> 确定 </cite></a></p>',"</div>","</div>"].join("")),postContent:function(){$tray.renderLogin();var a=this.Interface;var b={tuid:this.uid,fuid:$UID,authcode:Core.String.trim($E("invite_checkcode").value),content:$E("invite_content").value,varname:"addFriendRequest",version:7,rnd:new Date().valueOf()};a.request({GET:b,onSuccess:Core.Function.bind2(function(){v7sendLog("45_01_13_"+scope.$uid);var c={icon:"SG_icon203",content:this.successMSG()};this.dialog.setContent(this.resultHTML.evaluate(c));if(this.afterSubmit!=null){this.afterSubmit()}},this),onError:Core.Function.bind2(function(f){if(f.code=="A20109"||f.code=="A20004"){$E("invite_user_error").innerHTML=$SYSMSG[f.code];$E("invite_user_error").style.display=""}else{if(f.code=="A20003"||f.code=="A20103"){$E("invite_code_error").innerHTML=$SYSMSG[f.code];$E("invite_code_error").style.display="";$E("invite_checkimage").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random();$E("invite_checkcode").value=""}else{if(f.code=="A11007"){var d=$SYSMSG.A11007.replace("#{linkNewBlog}","http://blog.sina.com.cn/u/"+$UID);winDialog.alert(d)}else{var c={icon:"SG_icon202",content:$SYSMSG[f.code].replace(/#{nick}/,scope.owenerNickName)};this.dialog.setContent(this.resultHTML.evaluate(c))}}}if(this.afterSubmit!=null){this.afterSubmit()}},this),onFail:Core.Function.bind2(function(){var c={icon:"SG_icon202",content:$SYSMSG.A00001};this.dialog.setContent(this.resultHTML.evaluate(c))},this)})},closeDailog:function(){this.dialog.hidden()}};Lib.Invite=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"加好友",contentLength:200,title:function(){var b=isNaN(scope.owenerWType)?-1:parseInt(scope.owenerWType);var a=Lib.blogv.getVHTML(b);return'加"'+scope.owenerNickName+a+'"为好友'},successMSG:function(){return["邀请发送成功，请等待对方确认。",'<div class="CP_w_cnt SG_txtb" style="font-size:12px;font-weight:normal;">以后对方的动态（发博文，图片，投票等），都可以在<span style="color: red;">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a style="font-weight:normal;font-size:12px;" href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=addfiend" target="_blank">到个人中心查看其他好友动态&gt;&gt;</a></li>',"</ul>"].join("")},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/invitesend.php","jsload"),isAllowSend:function(){if(!scope||!scope.$private){return true}var a=scope.$private.invitationset||0;if(0===a){return true}else{winDialog.alert($SYSMSG.A20106);return false}}});Lib.invite=function(a){new Lib.Invite(a)};Lib.invite3=function(b,a){scope.owenerNickName=a;new Lib.Invite(b)};Lib.Scrip=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"发纸条",headImage:"",contentLength:300,title:function(){return"发纸条给："+scope.owenerNickName},successMSG:function(){return"给"+scope.owenerNickName+"的纸条发送成功！"},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/messagesend.php","jsload"),afterSubmit:function(){},isAllowSend:function(){if(!scope||!scope.$private){return true}var b=scope.$private.pageset||0;if(1===b){this._showMsg("A20009");return false}if($isLogin){var a=(-1!=$E("comp901_btn_invite").innerHTML.indexOf("已是好友"));if((2===b)&&!a){this._showMsg("A30006");return false}}return true},_showMsg:function(a){winDialog.alert($SYSMSG[a])}});Lib.scrip=function(a){new Lib.Scrip(a)};if(typeof SinaEx==="undefined"){SinaEx={}}SinaEx.findNode=function(a,d,c){for(var b=a[c];b;b=b[d]){if(b.nodeType==1){return b}}return null};SinaEx.prev=function(a){return SinaEx.findNode(a,"previousSibling","previousSibling")};SinaEx.next=function(a){return SinaEx.findNode(a,"nextSibling","nextSibling")};SinaEx.firstChild=function(a){return SinaEx.findNode(a,"nextSibling","firstChild")};SinaEx.parent=function(a,b){b=b.toLowerCase();while(a){if(a.nodeName.toLowerCase()===b){return a}a=a.parentNode}return null};SinaEx.createNode=function(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild};SinaEx.addClass=function(a,c){var b=a.className;if((" "+b+" ").indexOf(" "+c+" ")===-1){a.className=c+" "+b}};SinaEx.removeClass=function(a,c){var b=(" "+a.className+" ").replace(" "+c+" "," ");a.className=b.replace(/^\s+/,"").replace(/\s+$/,"")};if(document.documentElement.contains){SinaEx.contains=function(d,c){return d.contains?d.contains(c):true}}else{if(document.documentElement.compareDocumentPosition){SinaEx.contains=function(d,c){return d===c||!!(d.compareDocumentPosition(c)&16)}}else{SinaEx.contains=function(d,c){while(c){if(d===c){return true}c=c.parentNode}return false}}}$registComp(901,{baseHTML:['<div class="info"><div class="info_img" id="comp_901_head"><img src="http://portrait'+(scope.$uid*1%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" id="comp_901_head_image" width="180" height="180" alt="" /></div><div class="info_txt"><div class="info_nm"><img id="comp_901_online_icon" style="display:none;" class="SG_icon SG_icon1" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" /><span class="SG_txtb"><strong id="comp_901_nickname">&nbsp;</strong></span><span class="info_into"><a class="SG_linka" href="http://space.sina.com.cn/u/1406758883"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="空间" align="absmiddle" />进入我的空间</a></span><div class="clearit"></div></div><div class="info_btn1"><a href="http://you.video.sina.com.cn/'+scope.$uhost+'" class="SG_aBtn SG_aBtn_ico" target="_blank"><cite><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />播客</cite></a><a href="http://weibo.com/'+scope.$uid+'?source=blog" class="SG_aBtn SG_aBtn_ico"><cite><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />微博</cite></a><div class="clearit"></div></div><div class="SG_j_linedot"></div><div class="info_list"><ul class="info_list1"><li><span class="SG_txtc">博客等级：</span><span id="comp_901_grade">读取中…</span></li><li><span class="SG_txtc">博客积分：</span><span id="comp_901_score">读取中…</span></li></ul><ul class="info_list2"><li><span class="SG_txtc">博客访问：</span><span id="comp_901_pv">读取中…</span></li><li><span class="SG_txtc">关注人气：</span><span id="comp_901_attention">读取中…</span></li></ul></div><div class="clearit"></div></div><div class="clearit"></div></div>'].join(""),load:function(){Lib.checkAuthor();if($E("comp_901_head")==null){this.setContent(this.baseHTML)}if($isAdmin==false&&$isLogin){this.loadIsFriend()}else{if($isAdmin==false&&!$isLogin){this.isFriend=false;this.loadOnline()}else{this.isOnline=true}}if(scope.$pageid!="fakeIndex"){Lib.Uic.getNickName([scope.$uid],function(n){var t=Core.String.trim;var p=$E("ownernick")||$E("comp_901_nickname");var s=t(p.textContent||p.innerText);var r=t(p.innerHTML);if(Core.String.byteLength(n[scope.$uid])>20){var j=n[scope.$uid].replace(/(.{10})/g,"$1<br/>")}else{var j=n[scope.$uid]}if(!s&&s!=r){p.innerHTML=j+"&nbsp;"+r}else{if(s&&s!=r){try{var o=p.getElementsByTagName("a");var m=o&&o[0].innerHTML;p.innerHTML=j+'&nbsp;<a href="http://blog.sina.com.cn/v/verify" target="_blank">'+m+"</a>"}catch(q){}}else{p.innerHTML=j}}})}if($E("comp_901_nickname")){this.loadNickname()}else{this.renderHead();var f=$E("ownernick");var g=Core.String.trim;var b=Core.String.byteLength;var c,d;if(f){c=g(f.textContent||f.innerText).replace(/(\r|\n)/g,"");var a=b(c);scope.owenerNickName=c}}this.loadOtherInfo();if(scope.$pageid=="pageSetM"&&this.setManage&&scope.$private.ad==0&&scope.$private.adver==0&&scope.$private.p4p==0){this.setManage()}},fixNick:function(b){var c=Core.String.byteLength;var d=Core.String.leftB;var g=Core.String.trim;var a=c(b);var f;b=g(b);if(22<a){f=d(b,20);b=f+"<br>"+b.replace(f,"")}return b},showOnlineInfo:function(){if(!$isAdmin&&this.isOnline){Core.Dom.setStyle($E("comp_901_online_icon"),"display","");$E("comp_901_online_icon").alt="在线";$E("comp_901_online_icon").title="在线"}},showNickName:function(b){var a=b[scope.$uid]||"";a=Core.String.encodeHTML(a);var c=$E("comp_901_nickname");c.innerHTML=a;scope.owenerNickName=c.textContent||c.innerText;this.renderHead(a)},renderHead:function(a){if(!$isAdmin){if(a){$E("comp_901_head_image").title=a}}else{$E("comp_901_head").innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/nick.php" title="点击上传头像" target="_blank"><img id="comp_901_head_image" width="180" height="180" alt="点击上传头像" src="http://portrait'+(scope.$uid*1%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" /></a>'}},loadOtherInfo:function(){this.loadPv();this.loadGoldpan();this.loadAttention();if(scope.$pageid=="index"||scope.$pageid=="indexM"||scope.$pageid=="pageSetM"){this.loadAdManage()}},loadNewIcon:function(){var b=$C("a");b.href="http://move.blog.sina.com.cn/";b.target="_blank";b.position="absolute";var a=$C("img");a.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";a.className="fiveyearsIcon";if($IE6){a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png',sizingMethod='image')"}else{a.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/move/move_hz.png)"}a.alt="邀请MSN好友获得朋友徽章";a.title="邀请MSN好友获得朋友徽章";a.style.border="none";b.appendChild(a);$E("comp_901_head").appendChild(b);b.onclick=function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnGuideCount.php?type=hitMedal")};b=null},loadPv:function(){var c=document.referrer=="0"?"":encodeURIComponent(document.referrer);if(scope.totalPv&&!isNaN(scope.totalPv)){$SetPV(scope.totalPv)}else{var a="";if(scope.$articleid){a="http://comet.blog.sina.com.cn/api?maintype=hits&act=4&aid="+scope.$articleid+"&ref="+c}else{var b=(scope.$uid*1).toString(16);b.length<8?b=(("00000000"+b).substr(b.length,8)):b;a="http://comet.blog.sina.com.cn/api?maintype=hits&act=3&uid="+b+"&ref="+c}Utils.Io.JsLoad.request(a,{onComplete:function(d){if(d&&typeof d.pv!="undefined"){scope.totalPv=d.pv;$SetPV(d.pv)}},onException:function(){$SetPV(0)}})}},loadBadge:function(g){var j=["点亮荣誉勋章","新新博主","新锐博主","先锋博主","精英博主","风云博主","资深博主","元老博主",0,0,"图片博主","兑换图片博主服务","私密博文","兑换私密博文","金笔","兑换金笔"];var d='<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_action.php" title="[title]"><img title="[title]" alt="[title]" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="badge" style="background-image:url([imgPath].png);_background-image: url([imgPath].gif);"></a>';var b=$E("comp_901_badge");if(!b){return}var m=[];if(g.medal>0){g.medal>7?g.medal=7:"";m.push({medal:g.medal,title:j[g.medal]})}else{m.push({medal:8,title:j[0]})}if(g.pic_vip==1){m.push({medal:10,title:j[10]})}else{m.push({medal:11,title:j[11]})}if(g["private"]==1){m.push({medal:12,title:j[12]})}else{m.push({medal:13,title:j[13]})}if(g.goldpen>0){j[14]="现有金笔"+g.goldpen/1+"支";m.push({medal:14,title:j[14]})}else{m.push({medal:15,title:j[15]})}var a="";for(var f=0;f<m.length;f++){var o=m[f];var c=o.medal<10?("0"+o.medal):o.medal;imgPath="http://simg.sinajs.cn/blog7style/images/common/badge/badge"+c;a+=d.replace(/\[imgPath\]/g,imgPath).replace(/\[title\]/g,o.title)}Core.Dom.insertHTML(b,a,"beforeend")},loadGoldpan:function(){var b=$E("comp_901_d_goldpen");var a=$E("comp_901_r_goldpen");if(b&&a){Utils.Io.JsLoad.request("http://comet.blog.sina.com.cn/api?maintype=goldpen&uid="+scope.$uid,{onComplete:function(c){if(c){a.innerHTML=c.donate;b.innerHTML=c.receive}},onException:function(){}})}},loadScore:function(){setTimeout(function(){Utils.Io.JsLoad.request("http://blogcnfv5.sinajs.cn/blogscr?uid="+scope.$uid+"&varname=blogScore&.js",{onComplete:function(){if(typeof blogScore!="undefined"||$E("comp_901_score")==null){var m=blogScore.coefficient.a;var j=blogScore.coefficient.b;var g=blogScore.coefficient.c;var f=blogScore.coefficient.d;var n=blogScore.x;var d=blogScore.y;var a=blogScore.z;var b=blogScore.w;var c=n*m+d*j+a*g+b*f;$E("comp_901_score").innerHTML="<strong>"+Core.String.formatNumber(c)+"</strong>"}},noreturn:true})},1)},loadAttention:function(){var c=this;var d=new Interface("http://blogtj.sinajs.cn/api/get_attention_num.php","jsload");var f={uid:scope.$uid,suid:$isLogin?$UID:"0",attention:"suid",userpointuid:scope.$uid,s:"1"};if(this.mashAddFriend){var b=scope.$uid;var a=$UID;if(b&&a){f.friendattuid=b;f.friendattsuid=a}else{this.mashAddFriend=false}}d.request({GET:f,onSuccess:Core.Function.bind2(function(m){Lib.checkAuthor();if($E("comp_901_attention")){var g=Core.String.formatNumber(m.num[scope.$uid]);$E("comp_901_attention").innerHTML="<strong>"+(g<0?0:g)+"</strong>"}if(m.is_attention&&m.is_attention[scope.$uid]==1){this.isAttentioned=true;if($E("module_901_attention")){$E("module_901_attention").innerHTML="已关注"}}if(typeof m.userpoint!="undefined"){if($E("comp_901_score")){$E("comp_901_score").innerHTML='<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_action.php" title="积分"><strong>'+m.userpoint+'</strong><img width="15" height="15" align="top" title="积分" alt="积分" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon11">'}}if(this.mashAddFriend){var j=[{uid:scope.$uid,status:m.friendattr}];this.friendSuccessCallback(j)}if(m.svr_time){scope.$svr_time=m.svr_time}this.loadBadge(m)},this),onError:function(){if($E("comp_901_attention")){$E("comp_901_attention").innerHTML="<strong>0</strong>"}if(c.mashAddFriend){c.friendErrorCallback()}c.loadBadge()},onFail:function(){if($E("comp_901_attention")){$E("comp_901_attention").innerHTML="<strong>0</strong>"}if(c.mashAddFriend){c.friendErrorCallback()}c.loadBadge()}})},loadWorldCupIcon:function(){if(scope.$isWorldcupUser==1){var b=$C("a");b.href="http://blog.2010.sina.com.cn/yunying/2010worldcup/";b.target="_blanks";var a=$C("img");a.id="comp_901_wcIcon";a.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";a.className="worldcup_icon worldcup_icon_l";a.alt="记录激动时刻，赢取超级大奖！快一起参加吧！";a.title="记录激动时刻，赢取超级大奖！快一起参加吧！";b.appendChild(a);$E("comp_901_head").appendChild(b)}},load7YearsIcon:function(){var b=$E("comp_901_head");var d={medal0:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_wmm.png",medal1:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xx.png",medal2:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xr.png",medal3:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xf.png",medal4:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_jy.png",medal5:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_fy.png?v20120917",medal6:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_zs.png",medal7:"http://simg.sinajs.cn/blog7style/images/activity/blog7year/icon_yl.png"};var f=scope.$private.medal7;f=7<f?7:f;if(f){var c=$C("a");c.setAttribute("target","_blank");c.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var a=$C("img");a.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";a.className="sevenyearsIcon";if($IE6){a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d["medal"+f]+"',sizingMethod='image')"}else{a.style.backgroundImage="url("+d["medal"+f]+")"}a.style.border="none";c.appendChild(a);$E("comp_901_head").appendChild(c)}else{if(!scope.$private.medal&&$UID==scope.$uid){var c=$C("a");c.setAttribute("target","_blank");c.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var a=$C("img");a.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";a.className="sevenyearsIcon";if($IE6){a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d.medal0+"',sizingMethod='image')"}else{a.style.backgroundImage="url("+d.medal0+")"}a.style.border="none";c.appendChild(a);$E("comp_901_head").appendChild(c)}}},load5YearsIcon:function(){if(scope.$private.medal7){return}trace("【活动】显示用户勋章。");try{var n=["纪念勋章","一","二","三","四","五"];var a=scope.$private.medal;if(a>0||a===0){var m=$C("a");m.setAttribute("target","_blank");m.setAttribute("href","http://control.blog.sina.com.cn/blog_7years/index.php");var j=$C("img");j.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";j.className="fiveyearsIcon";if($IE6){j.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+a+"y.png',sizingMethod='image')"}else{j.style.backgroundImage="url(http://simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+a+"y.png)"}j.alt=a>0?(n[a]+"周年勋章"):(n[0]);j.title=a>0?(n[a]+"周年勋章"):(n[0]);j.style.border="none";m.appendChild(j);$E("comp_901_head").appendChild(m);if($UID==scope.$uid){var d=$C("span");var c="updateIcon_1";var b="updateIcon_2";d.className=c;m.appendChild(d);var g=0;setInterval(function(){if(g%2==1){d.className=c;i=0}else{d.className=b}g++},500)}trace("【活动】显示用户勋章完成。")}else{trace("【活动】用户还没有获得勋章。")}}catch(f){trace("【活动】显示用户勋章发生异常。")}},loadPhotoCount:function(){},loadVideoCount:function(){},loadAdManage:function(){if($isAdmin&&scope.$private!=null&&scope.$private.ad!=null&&scope.$private.ad!=0&&$E("comp_901_adlink")==null){Debug.info("添加广告共享计划管理链接");var b=['<div class="info_locate2"><div class="SG_j_linedot"/></div><div id="comp_901_adlink" class="info_AD"><a href="http://share.sass.sina.com.cn/widget_ad/widget_ad_index.php" target="_blank">管理广告共享计划</a></div>'].join("");var a=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");if(a){a=a[0].lastChild;Core.Dom.insertHTML(a,b,"BeforeBegin")}}},showVisitButton:function(){if($isAdmin){return}if($E("info_locate_id")){var f=$E("comp901_btn_invite");if(f){f.href="javascript:void(0)";if(this.isFriend==false){f.innerHTML="<cite>加好友</cite>";f.onclick=function(){if(!$isLogin){v7sendLog("48_01_28")}Lib.invite(scope.$uid);return false}}else{f.innerHTML="<cite>已是好友</cite>"}}f=$E("comp901_btn_sendpaper");if(f){f.href="javascript:void(0)";f.onclick=function(){if(!$isLogin){v7sendLog("48_01_27")}Lib.scrip(scope.$uid);return false}}f=$E("comp901_btn_msninfo");if(f){f.onclick=function(){if(!$isLogin){v7sendLog("48_01_29")}};f.href="http://blog.sina.com.cn/s/profile_"+scope.$uid+".html#write"}f=$E("comp901_btn_follow");if(f){var b=this;if(this.isAttentioned){f.innerHTML="<cite>已关注</cite>"}else{f.innerHTML="<cite>加关注</cite>"}f.onclick=function(){if(b.isAttentioned){b.deleteAttention()}else{Lib.Component.Attention();this.innerHTML="<cite>已关注</cite>";b.isAttentioned=true}return false}}return}else{var c;var a="";if(this.isFriend==false){a="Lib.invite("+scope.$uid+');return false;" class="SG_aBtn"><cite>加好友'}else{a+="><cite>已是好友"}var d=['<div id="info_locate_id" class="info_locate"><div class="SG_j_linedot"></div>','<div class="info_btn2">','<p><a href="#" onclick="'+a,"</cite></a>",'<a href="#" onclick="Lib.scrip('+scope.$uid+');return false;" class="SG_aBtn">',"<cite>发纸条</cite></a></p>",'<p><a href="http://blog.sina.com.cn/s/profile_'+scope.$uid+'.html#write" class="SG_aBtn" target="_blank">',"<cite>写留言</cite></a>",'<a id="module_901_attention" href="#" onclick="return false;" class="SG_aBtn'+(this.isAttentioned?" SG_aBtn_dis":"")+'">','<cite onclick="Lib.Component.'+(this.isAttentioned?" isAttentioned":"Attention")+'();">'+(this.isAttentioned?"已":"加")+"关注</cite></a></p>",'<div class="clearit"></div>',"</div></div>"].join("");if(this.size==210){c=Core.Dom.getElementsByClass(this.getContent(),"div","info_btn1");if(c){c=c[0];Core.Dom.insertHTML(c,d,"AfterEnd")}}else{c=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");if(c){c=c[0];Core.Dom.insertHTML(c,d,"BeforeEnd")}}}},deleteAttention:function(){var a=this;winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var b=$E("comp901_btn_follow");b.className="SG_aBtn";b.innerHTML="<cite>加关注</cite>";a.isAttentioned=false},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){return},textOk:"是",textCancel:"否"})}},901);$registComp(903,{load:function(){if($E("atcPicList")){this.loadPicture_new()}else{this.loadArticle()}},loadArticle:function(){var a=(typeof $tag_code!="undefined")?$tag_code:"";Utils.Io.Ijax.request("http://tag.blog.sina.com.cn/tag/tag_walist_v7.php",{GET:{blog_id:scope.$articleid,tag:encodeURI($tag),tag_code:a},onComplete:function(b){this.loadPicture('<div class="atcTitList relaList">'+b+"</div>")}.bind2(this),onException:function(){}})},loadPicture:function(a){var b="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(Math.random()*3)+"_v7.html";Utils.Io.Ajax.request(b,{onComplete:function(c){var d=/<ul>\s+<\/ul>/i.test(c);this.getContent().innerHTML=a.replace(/<!-- relative_pic_blog-->/,d?"":c)}.bind2(this),onException:function(){}})},loadPicture_new:function(a){var b="http://blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(Math.random()*3)+"_v7.html";Utils.Io.Ajax.request(b,{onComplete:function(c){var d=$E("atcPicList");d.innerHTML=c}.bind2(this),onException:function(){}})},articleCate:{"105":"105","102":"117","104":"104","149":"149","113":"113","153":"117","111":"117","152":"122","122":"122","131":"131","127":"108","134":"149","145":"108","108":"108","130":"130","116":"116","129":"129","136":"129","125":"125","141":"108","118":"118","117":"117"}},"dymanic");$registComp(904,{load:function(){if(Core.Dom.byClz(this.getContent(),"div","wdtLoading").length>0){var a="http://blog.sina.com.cn/main/top_new/article_sort/"+scope.$sort_id+"_day.v7.html";Utils.Io.Ajax.request(a,{onComplete:function(b){b='<div class="atcTitList relaList">'+b+"</div>";this.setContent(b)}.bind2(this),onException:function(){this.showError()}.bind2(this)})}else{}}},"dymanic");Core.String.shorten=function(b,a,c){if(Core.String.byteLength(b)<=a){return b}if(c!=""){c=c||"..."}else{c=""}return Core.String.leftB(b,a)+c};$registComp(909,{load:function(){if($E("tj_id")){this.showTJList($E("tj_id"))}},showTJList:function(a){Utils.Io.JsLoad.request("http://blogtj.sinajs.cn/api/tj/get_tj_article_info.php",{GET:{uid:scope.$uid},onComplete:(function(j){var n='<li><p><span class="SG_dot"></span><a href="#{href}" target="_blank">#{content}</a></p><div class="w_list SG_txtc"><a href="#{srcHref}" target="_blank">#{src}</a></div></li>';var f="";var g=j.data;var b=j.data.length>5?5:j.data.length;if(b===0){a.innerHTML='<li class="no_text">暂无被推荐博文</li>';return}for(var d=0;d<b;d++){var m={};m.href="http://blog.sina.com.cn/s/blog_"+g[d].blog_id+".html?tj=1";m.content=Core.String.byteLength(g[d].blog_title)>26?Core.String.shorten(g[d].blog_title,26,"…"):g[d].blog_title;m.content=Core.String.encodeHTML(m.content);m.srcHref=g[d].tj_chanel_id_url;m.src=g[d].tj_chanel_id_str;var c=new Ui.Template(n).evaluate(m);f+=c}a.innerHTML=f}).bind2(this),onException:(function(){this.showError()}).bind2(this)})}},"dymanic");Core.String.toInt=function(b,a){return parseInt(b,a)};Core.String.a2u=function(a){return a.replace(/\\u[\da-fA-F]{4}/gi,function(b){b=Core.String.toInt(b.substr(2),16);return String.fromCharCode(b)})};Lib.register("util.cutNickName",function(){return function(f,d,a){var b=Core.String.byteLength;var c=Core.String.leftB;a=a||6;if(0<=d&&8>d){return b(f)>a?c(f,a-2)+"…":c(f,a)}else{return b(f)>a+2?c(f,a)+"…":c(f,a+2)}}});$registComp("12",{Interface:new Interface("http://footprint.cws.api.sina.com.cn/list.php","jsload"),PromoteUserBlogInterface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/AdTaskTools.php","jsload"),isDisabled:function(){var a=$_GLOBAL.disableVisitor;if(a&&a.indexOf("|"+this.requestParam.uid+"|")>-1){this.showDisabled();return true}return false},_getMessage:function(a){if(!a){a={}}var c=Lib.blogv.getVHTML;var b=Lib.util.cutNickName;this.Interface.request({GET:this.requestParam,onSuccess:Core.Function.bind2(function(d){Core.Array.foreach(d.record,Core.Function.bind2(function(g){g.vString=this.formatTime(g.vtime,d.stime);var f=Core.String.a2u(g.name);if(isNaN(g.wtype)){g.wtype=-1}g.wtype=parseInt(g.wtype,13);g.shortName=b(f,g.wtype,9);if(a[g.uid]){g.isPromote=true}g.userV=c(g.wtype);g.shortName=Core.String.encodeHTML(g.shortName)},this));this.cacheData=d.record;this.total=d.total;this["render_"+this.size](this.cacheData);a=null},this),onError:Core.Function.bind2(function(d){this.showError($SYSMSG[d.code])},this),onFail:Core.Function.bind2(function(){this.showError($SYSMSG.A80101)},this)})},load:function(){if(this.requestParam==null){this.show("请提供访客组件的接口参数")}else{Lib.checkAuthor();if(!$isLogin){this.requestParam.varname="requestId_visitor_list"}if(scope.unreadMsg&&scope.unreadMsg.foot==0){this.requestParam.add=1}if(this.isDisabled()){return}var a=this;a._getMessage({"1259295385":true})}},formatTime:function(f,m){var g="";var b=new Date(m*1000);var d=new Date(f*1000);if(b.getFullYear()==d.getFullYear()&&b.getMonth()==d.getMonth()&&b.getDate()==d.getDate()){var a=Math.max(0,m-f);Debug.warning("diffTime : "+a);if(a<60*60){g=Math.ceil(a/60)+"分钟前"}else{var j=new Date(f*1000);g=("今天0"+j.getHours()+":0"+j.getMinutes()).replace(/(\d{3,3})/g,function(o,n){return n.substr(1)})}}else{var c=new Date(f*1000);g=(c.getMonth()+1)+"月"+c.getDate()+"日"}return g},reload:function(d,a,c){var b=d==null||(d&&(d==210||d==510||d==730));if(!b){Debug.error("请检查传入的组件尺寸是否正确。"+d);return}this.size=d||this.size;this.getContent().innerHTML='<div class="wdtLoading"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>';if(c==true||this.cacheData==null){this.load()}else{this["render_"+this.size]()}}},"dynamic");Lib.deleteVisitByUid=function(d,g,c,a){Lib.checkAuthor();if(!$isLogin){var f=new Lib.Login.Ui();f.login(Core.Function.bind3(Lib.deleteWallByMsgid,null,arguments));return}Debug.log("删除访客："+d);var b="";if($isAdmin){b=$SYSMSG.A80203}else{if($isLogin){b=$SYSMSG.A80201}else{return true}}winDialog.confirm(b,{funcOk:function(){var j=new Interface("http://footprint.cws.api.sina.com.cn/del.php","jsload");var m={pid:g,uid:scope.$uid,deleteuid:d};if(a!=null){m.subid=a}if($E("comp_12_deleteToBlack")&&$E("comp_12_deleteToBlack").checked==true){m.inblack=1}j.request({GET:m,onSuccess:function(){if(c){c(null,null,true)}else{Debug.log("Reload page");window.location.reload()}}})},subText:$isAdmin?$SYSMSG.A80204:$SYSMSG.A80202,textOk:"是",textCancel:"否",icon:"04"})};$SYSMSG.extend({B80001:"暂无访客",B80002:"暂无留言",B80003:"暂无博客评论",B80004:"暂无好友",B80005:"暂无图片专辑",B80006:"暂无视频",B80007:"暂无归档博文",B80101:"你确定删除此评论吗？<br/>删除后不可恢复",B80102:"你确定删除此留言吗？<br/>删除后不可恢复",B80103:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_2_deleteToBlack" class="CP_w_fm1" /><label for="comp_2_deleteToBlack" >将此人加入黑名单</label></li></ul>'].join(""),A00101:'<div class="SG_nodata">留言板非公开</div>',B36023:"对不起，黑名单已达到上限"});scope.getPromoteURL=function(b){var a="http://blog.sina.com.cn/u/"+b.uid;var d="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,290418,295665&cid=0,0,0&sid=288937&advid=358&camid=37389&show=ignore";if(b.isPromote){a=d+($UID?"&kv={0}|99999&url={1}".format($UID,a):"&url={0}".format(a))}if(b.uid==1259295385){var c="http://blog.sina.com.cn/u/"+b.uid;a="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url="+c}return a};$registComp(12,{requestParam:{uid:scope.$uid,pagesize:"18",pid:1},html:["<li ","onmouseover=\"if(this.childNodes[2].className=='del'){this.childNodes[2].style.display='';}\" ","onmouseout=\"if(this.childNodes[2].className=='del'){this.childNodes[2].style.display='none';}\">",'<span class="pt_imgs"><img class="SG_icon SG_icon35" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="#{name}" align="absmiddle" /></span>','<span class="pt_nms"><a suda-uatrack="key=blog_article&value=h_article51" href="#{uhref}" target="_blank" title="#{name}">#{shortName}</a>#{userV}</span>',"#{manage}",'<span class="pt_tms">#{vString}</span>',"</li>"].join(""),render_210:function(a){a=a||this.cacheData;a=a.slice(0,12);this.parseToHTML(a)},render_510:function(a){a=a||this.cacheData;a=a.slice(0,12);this.parseToHTML(a)},render_730:function(a){a=a||this.cacheData;this.parseToHTML(a)},parseToHTML:function(f){if(f.length==0){this.showEmpty()}else{Lib.checkAuthor();Core.Array.foreach(f,Core.Function.bind2(function(g){g.manage=(g.uid==$UID)?'<span class="del" style="display: none;" onmouseover="this.style.display = \'\';" onmouseout="this.style.display = \'none\';"><img class="SG_icon SG_icon6" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="删除访问记录" onclick="Lib.deleteVisitByUid(\''+g.uid+"', 1, Core.Function.bind2(Lib.Component.instances["+this.compId+"].reload, Lib.Component.instances["+this.compId+"])"+(scope.$articleid==null?"":",'"+scope.$articleid+"'")+');return false;" align="absmiddle" /></span>':"";g.uhref=scope.getPromoteURL(g)},this));var a=new Ui.Template(this.html);var b='<ul class="ad_ptlist">'+a.evaluateMulti(f)+"</ul>";if((scope.$pageid=="indexM"||scope.$pageid=="pageSetM")&&$isAdmin==true&&((this.size<730&&this.total>12)||(this.size==730&&this.total>18))){b+='<div class="moreLink SG_j_linedot1"><span class="SG_more"><a href="http://control.blog.sina.com.cn/blogprofile/visitor.php?showtype=1" target="_blank">更多</a>&gt;&gt;</span></div>'}else{b+='<div class="moreLink" style="padding-top:0;"></div>'}this.show(b);var d="1062753310";var c=$E("linkVisited_"+d);c&&(c.href="http://sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url=http://blog.sina.com.cn/u/"+d)}if(scope.$pageid=="pageSetM"&&this.setManage){this.setManage()}},showEmpty:function(){this.setContent('<div class="SG_nodata">'+$SYSMSG.B80001+"</div>")},showDisabled:function(){var a="尊敬的用户您好，为了给大家提供更好的服务，近期访客组件进行升级维护，维护过程中将影响部分用户无法正常浏览，给您带来不便敬请谅解！感谢您对新浪博客一直以来的支持！";this.setContent('<div class="SG_nodata" style="padding-left:1.5em; padding-right:1.5em; text-indent:2em; text-align:left">'+a+"</div>")},setManage:function(){if($isAdmin&&this.getManage()){this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>'}}},12);$registComp(47,{requestParam:{uid:scope.$uid,pagesize:"12",pid:1,subid:scope.$articleid}},12);$registComp(102,{load:function(){trace("comp_1023");this.loadArticle()},loadArticle:function(){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/photoblog/get_hotblog_list.php",{GET:{uid:scope.$uid,version:7},onComplete:function(f){trace("---------------code:"+f.code);var g=['<div class="photoBlog">'];var c=f;var d=c.data;for(var j=0,a=d.length;j<a;j++){var b=d[j].tj?d[j].tj:"";g.push('<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="');g.push(d[j].blogurl);g.push('" target="_blank"><img class="borderc" src="');g.push(d[j].picurl);g.push('" alt="');g.push(d[j].title);g.push('" title="');g.push(d[j].title);g.push('"/></a></td></tr></table></div><p class="photoBlog_nm">');g.push(b);g.push('<a href="');g.push(d[j].blogurl);g.push('" target="_blank">');g.push(d[j].title);g.push("</a></p><p>阅读(");g.push(d[j].hitsnum);g.push(") 评论(");g.push(d[j].commentnum);g.push(")</p></div>")}g.push("</div>");this.getContent().innerHTML=g.join("")}.bind2(this),onException:function(){trace("connect error")}})},tpl:'<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="{0}" target="_blank"><img class="borderc" src="{5}" alt="{7}" title="{7}"/></a></td></tr></table></div><p class="photoBlog_nm">{6}<a href="{0}" target="_blank">{1}</a> <span class="count">({2}张)</span></p><p>阅读({3}) 评论({4})</p></div>'},"dymanic");var DialogManager={dialogs:[],activeDialog:{},backShadow:null,create:function(c,b){var d=this;var a=new Dialog(c);this.dialogs.push(a);this.activeDialog=a;a.name=b||a.getUniqueID();a.entity.style.zIndex=1024;a.onDrag=function(){if($IE6){if(this.getProperty().isFixed){this.setPosition({x:(parseInt(this.entity.style.left)-document.documentElement.scrollLeft),y:(parseInt(this.entity.style.top)-document.documentElement.scrollTop)})}}else{if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})}}};a.onClose=function(){d.removeDialog(this.name);d.updateActiveDialog();d.updateShadow();if(d.activeDialog){d.activeDialog.setFocus()}};a.onHidden=function(){this.isHidden=true;if(this==d.activeDialog){d.activeDialog=null}d.updateActiveDialog();d.updateShadow();if(d.activeDialog){d.activeDialog.setFocus()}};a.onShow=function(){if(this.isHidden){this.isHidden=false;var g,f=d.dialogs.length;for(g=0;g<f;g++){if(d.dialogs[g]==this){document.body.appendChild(d.dialogs[g].entity);d.dialogs.push(d.dialogs[g]);d.dialogs.splice(g,1)}}d.activeDialog=this;d.backShadow.show();d.updateShadow()}};if(this.backShadow.isShow){this.updateShadow()}else{this.backShadow.show()}a.hidden();return a},getDialog:function(b){var c=0,a=this.dialogs.length;for(c=0;c<a;c++){if(this.dialogs[c].name==b){return this.dialogs[c]}}},removeDialog:function(b){var c=0,a=this.dialogs.length;for(c=a-1;c>=0;c--){if(this.dialogs[c].name==b){this.dialogs.splice(c,1);this.activeDialog=this.dialogs[this.dialogs.length-1];break}}},updateActiveDialog:function(){var b,a=this.dialogs.length;for(b=a-1;b>=0;b--){if(!this.dialogs[b].isHidden){this.activeDialog=this.dialogs[b];break}}},updateShadow:function(){if(this.activeDialog&&!this.activeDialog.isHidden){this.backShadow.insertBefore(this.activeDialog.entity);this.activeDialog.updateFixed()}else{this.backShadow.hidden()}},close:function(b){if(!b){if(this.activeDialog){this.activeDialog.close()}return}var c,a=this.dialogs.length;for(c=a-1;c>=0;c--){if(this.dialogs[c].name==b){this.dialogs[c].close();break}}}};var BackShadow=function(b){this.entity=null;this.isShow=false;this._ie6Fixed=function(){if(c.entity){c.entity.style.top=document.documentElement.scrollTop+"px";c.entity.style.left=document.documentElement.scrollLeft+"px";if(c.ifm){c.ifm.style.top=c.entity.style.top;c.ifm.style.left=c.entity.style.left}c.updateSize()}};var c=this;(function a(){c.entity=$C("div");c.entity.style.position="absolute";c.entity.style.width=c.getAreaWidth()+"px";c.entity.style.height=c.getAreaHeight()+"px";c.entity.style.left="0px";c.entity.style.top="0px";c.entity.style.zIndex=1024;c.entity.style.backgroundColor="black";document.body.appendChild(c.entity);c._setOpacity(c.entity,isNaN(b)?0.5:b);if($IE6){c.entity.style.top=document.documentElement.scrollTop+"px";c.addIframe()}Core.Events.addEvent(window,function(){if(c.entity){if($IE6&&c.isShow){document.documentElement.scrollLeft=0;c._ie6Fixed()}setTimeout(function(){c.updateSize()},1)}},"resize");c.setFixed(true);c.hidden()})()};BackShadow.prototype={show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display=""}this.isShow=true;this.onShow()},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}this.isShow=false;this.onHidden()},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},addIframe:function(){this.ifm=$C("iframe");this._setOpacity(this.ifm,0);this.ifm.style.position="absolute";this.ifm.style.zIndex=this.entity.style.zIndex;this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;this.ifm.style.width=this.entity.style.width;this.ifm.style.height=this.entity.style.height;document.body.insertBefore(this.ifm,this.entity)},insertBefore:function(a){document.body.insertBefore(this.entity,a);if(this.ifm){document.body.insertBefore(this.ifm,this.entity)}},updateSize:function(){this.entity.style.width=this.getAreaWidth()+"px";this.entity.style.height=this.getAreaHeight()+"px";if(this.ifm){this.ifm.style.width=this.getAreaWidth()+"px";this.ifm.style.height=this.getAreaHeight()+"px"}},getAreaHeight:function(){return document.documentElement.clientHeight},getAreaWidth:function(){return document.documentElement.clientWidth},setFixed:function(a){if($IE6){var b=this;if(a){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}}else{this.entity.style.position=a?"fixed":"absolute"}},_setOpacity:function(b,a){if($IE&&$IE<=9){b.style.filter="alpha(opacity="+a*100+")"}else{b.style.opacity=a}},onShow:function(){},onHidden:function(){}};function CustomsDialog(c,b){this.nodesPattern=/[^\{\}]+(?=\})/g;this._dialog=DialogManager.create(c,b);this.entity=this._dialog.entity;this.templateString="";this.nodes={};var d=this;(function a(){d._dialog.onDrag=function(){if($IE6){if(this.getProperty().isFixed){this.setPosition({x:(parseInt(this.entity.style.left)-document.documentElement.scrollLeft),y:(parseInt(this.entity.style.top)-document.documentElement.scrollTop)})}}else{if(this.getProperty().isFixed){this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})}}d.onDrag()};d.updateNodes();if(d.nodes.btnClose){Core.Events.addEvent(d.nodes.btnClose,function(){var f=Core.Events.getEvent();if(f){f.cancelBubble=true}},"mousedown")}})();this._hiddenDialog=function(){d.hidden()};this._closeDialog=function(){d.close()}}CustomsDialog.prototype={isSetMiddle:false,setContent:function(a){var c=a;this.templateString=c.match(this.nodesPattern);var b=new Ui.Template(c);this.nodes.content.innerHTML=b.evaluate(this.getContentNodes("i"));this.updateNodes()},setTitle:function(a){if(this.nodes.titleName){this.nodes.titleName.innerHTML=a}},setHelp:function(a){if(this.nodes.btnHelp){if(a){this.nodes.btnHelp.href=a}else{this.nodes.btnHelp.innerHTML=""}}},setClose:function(a){var b=this;if(b.nodes.btnClose){a=a||"hidden";switch(a){case"hidden":Core.Events.addEvent(b.nodes.btnClose,b._hiddenDialog,"click");break;case"close":Core.Events.addEvent(b.nodes.btnClose,b._closeDialog,"click");break}}},setPosition:function(a,b){this._dialog.setPosition({x:a,y:b})},setMiddle:function(){var d=Core.System.winSize();var g,f;var n=this._dialog.entity.style.display;this._dialog.setPosition({x:-10000});this._dialog.entity.style.display="";var a=this.nodes.titleBar?this.nodes.titleBar.offsetHeight:0;var j=d.height-this.nodes.content.offsetHeight-a;var c=(Math.sqrt(5)-1)/2;var b=1;var m=j*c/(c+b);g=d.width/2-this.nodes.content.offsetWidth/2;g=g<0?0:g;f=m<0?0:m;if(!this._dialog.getProperty().isFixed){g=g+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);f=f+Math.max(document.documentElement.scrollTop,document.body.scrollTop)}this._dialog.entity.style.display=n;this._dialog.setPosition({x:g,y:f});this.isSetMiddle=true},setSize:function(a,b){this._dialog.setSize({width:a,height:b})},setFixed:function(a){this._dialog.setFixed(a)},setAreaLocked:function(a){this._dialog.setAreaLocked(a)},setFocusNode:function(a){this._dialog.getProperty().focusNode=a},setDisplayMode:function(a){this._dialog.getProperty().displayMode=a||"normal"},getWidth:function(){return this._dialog.getProperty().width},getHeight:function(){return this._dialog.getProperty().height},getX:function(){return this._dialog.getProperty().x},getY:function(){return this._dialog.getProperty().y},show:function(){if(this.isSetMiddle){this.setMiddle()}this._dialog.show();this.onShow()},hidden:function(){this._dialog.hidden();this.onHidden()},close:function(){var a=this;a._dialog.close();a.onClose();if(a.nodes.btnClose){Core.Events.removeEvent(a.nodes.btnClose,a._hiddenDialog,"click");Core.Events.removeEvent(a.nodes.btnClose,a._CloseDialog,"click")}},updateNodes:function(){this.nodes=this._dialog.getNodes();var a=this.getContentNodes();for(k in a){this.nodes[k]=a[k]}},getContentNodes:function(g){var a=g||"o";var c;var b={};var f=this.templateString;if(f){for(c=0;c<f.length;c++){var d=f[c];switch(a){case"o":b[d]=$E(this.nodes.content.id+"_"+d);break;case"i":b[d]=this.nodes.content.id+"_"+d;break}}}return b},setOnDisplaied:function(a){this._dialog.onDisplaied=a},setOnDisplayFinished:function(a){this._dialog.onDisplayFinished=a},onDrag:function(){},onShow:function(){},onHidden:function(){},onClose:function(){}};var LayerTemplate={alert:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容区域 --><div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a></div></div><!-- 内容区域 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',confirm:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容开始 --><div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="http://simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a><a class="gBtnb gBtnbClr" id="#{linkCancel}" href="javascript:;"><cite id="#{btnCancel}"><em id="#{cancel}"></em></cite></a></div></div><!-- 内容结束 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',iframe:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><div id="#{loadState}">Loading...</div><iframe style="width:100%;height:500px;" id="#{iframe}" src="#{iframeURL}"></iframe></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',customs:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><!-- 内容区域 --><!-- 内容区域 --></div></td><td class="tbgright"><div></div></td></tr></tbody></table>'};(function(){var a=function(b,c){this.template=c||{};DialogManager.backShadow=b};a.prototype={iconSet:{"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},alert:function(j,b,f){b=b||{};var d=DialogManager.create(b.template||this.template.alert||LayerTemplate.alert,f);var g=Core.System.winSize();var c=d.getNodes();d.onDisplaied=b.funcDisplaied;d.onDisplayFinished=b.funcDisplayFinished;d.setSize({width:b.width,height:b.height});d.setFixed(true);this._setDialogMiddle(d);d.show();d.setAreaLocked(true);c.linkOk.focus();c.text.innerHTML=j;if(c.titleName){c.titleName.innerHTML=b.title||"提示"}if(c.icon){c.icon.className=b.icon?this.iconSet[b.icon]["class"]:this.iconSet["01"]["class"];c.icon.alt=b.icon?this.iconSet[b.icon]["alt"]:this.iconSet["01"]["alt"]}c.ok.innerHTML=b.textOk||"确定";if(c.subText){c.subText.innerHTML=b.subText||""}d.getProperty().focusNode=c.linkOk;Core.Events.addEvent(c.btnOk,function(){if(b.funcOk&&d.getProperty().enabled){b.funcOk();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(c.linkOk,function(){var m=Core.Events.getEvent();if(m.keyCode=="13"){if(b.funcOk&&d.getProperty().enabled){b.funcOk()}d.close()}},"keydown");Core.Events.addEvent(c.btnClose,function(){if(b.funcClose&&d.getProperty().enabled){b.funcClose()}d.close()},"click");Core.Events.addEvent(c.btnClose,function(){var m=Core.Events.getEvent();m.cancelBubble=true},"mousedown")},newAlert:function(d,b,c){b.template=this.template.newAlert;this.alert(d,b,c)},confirm:function(j,b,f){b=b||{};var d=DialogManager.create(b.template||this.template.confirm||LayerTemplate.confirm,f);var g=Core.System.winSize();var c=d.getNodes();d.onDisplaied=b.funcDisplaied;d.onDisplayFinished=b.funcDisplayFinished;d.setSize({width:b.width,height:b.height});d.setFixed(true);this._setDialogMiddle(d);d.show();d.setAreaLocked(true);if(b.defaultButton==0){c.linkCancel.focus();d.getProperty().focusNode=c.linkCancel}else{c.linkOk.focus();d.getProperty().focusNode=c.linkOk}c.text.innerHTML=j;if(c.titleName){c.titleName.innerHTML=b.title||"提示"}if(c.icon){c.icon.className=b.icon?this.iconSet[b.icon]["class"]:this.iconSet["04"]["class"];c.icon.alt=b.icon?this.iconSet[b.icon]["alt"]:this.iconSet["04"]["alt"]}c.ok.innerHTML=b.textOk||"确定";c.cancel.innerHTML=b.textCancel||"取消";if(c.subText){c.subText.innerHTML=b.subText||""}Core.Events.addEvent(c.btnOk,function(){if(b.funcOk&&d.getProperty().enabled){b.funcOk();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(c.linkOk,function(){var m=Core.Events.getEvent();if(m.keyCode=="13"){if(b.funcOk&&d.getProperty().enabled){b.funcOk()}d.close()}},"keydown");Core.Events.addEvent(c.btnCancel,function(){if(b.funcCancel&&d.getProperty().enabled){b.funcCancel();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(c.linkCancel,function(){var m=Core.Events.getEvent();if(m.keyCode=="13"){if(b.funcCancel&&d.getProperty().enabled){b.funcCancel()}d.close()}},"keydown");Core.Events.addEvent(c.btnClose,function(){if(b.funcClose&&d.getProperty().enabled){b.funcClose();Core.Events.stopEvent()}d.close();return false},"click");Core.Events.addEvent(c.btnClose,function(){var m=Core.Events.getEvent();m.cancelBubble=true},"mousedown")},newConform:function(d,b,c){b.template=this.template.newConfirm;this.confirm(d,b,c)},showIframe:function(b,j){b=b||{};var g=DialogManager.create(this.template.iframe||LayerTemplate.iframe,j);var m=Core.System.winSize();var d=g.getNodes();g.setSize({width:b.width||320,height:b.height||150});var f=m.width/2-g.getProperty().width/2<0?0:m.width/2-g.getProperty().width/2;var c=m.height/2-g.getProperty().height/2<0?0:m.height/2-g.getProperty().height/2;if(b.fixed){g.setPosition({x:f,y:c})}else{g.setPosition({x:f+document.documentElement.scrollLeft,y:c+document.documentElement.scrollTop})}if(!$IE6){g.getProperty().displayMode="alpha"}g.setFixed(!!b.fixed);g.show();g.setAreaLocked(true);d.titleName.innerHTML=b.title||"";d.iframe.src=b.url||"about:blank";Core.Events.addEvent(d.iframe,function(){d.iframe.style.display="";d.loadState.style.display="none"},"load");Core.Events.addEvent(d.btnClose,function(){g.close()},"click");Core.Events.addEvent(d.btnClose,function(){var n=Core.Events.getEvent();n.cancelBubble=true},"mousedown")},createCustomsDialog:function(b,c){b=b||{};var d=new CustomsDialog(b.tpl||this.template.customs||LayerTemplate.customs,c);b.content&&d.setContent(b.content);d.setTitle(b.title||"提示");d.setHelp(b.help||"");d.setClose("hidden");d.setOnDisplaied(b.funcDisplaied);d.setOnDisplayFinished(b.funcDisplayFinished);return d},getDialog:function(b){return DialogManager.getDialog(b)},close:function(b){DialogManager.close(b)},_setDialogMiddle:function(c){var j=Core.System.winSize();var b=c.getNodes();var n,m;var q=c.entity.style.display;c.setPosition({x:-10000});c.entity.style.display="";var d=b.titleBar?b.titleBar.offsetHeight:0;var o=j.height-b.content.offsetHeight-d;var g=(Math.sqrt(5)-1)/2;var f=1;var p=o*g/(g+f);n=j.width/2-b.content.offsetWidth/2;n=n<0?0:n;m=p<0?0:p;if(!c.getProperty().isFixed){n=n+document.documentElement.scrollLeft;m=m+document.documentElement.scrollTop}c.entity.style.display=q;c.setPosition({x:n,y:m})}};Sina.Ui.WindowDialog=a})();Core.String.expand=function(b){var a=b.replace(/([\u00ff-\ufffe])/gi,"\uffff$1");return a};Core.String.collapse=function(a){return a.replace(/\uffff/gi,"")};scope.searchFilm=function(o){var f=$E("loginBarSearchForm");var b=f.action;var g=$E("loginBarSearchT");var j=$E("loginBarSearchS");var n=$E("loginBarSearchTS");var m=$E("loginBarSearchType");var p=$E("loginBarSearchSType");var c=$E("loginBarSearchInput");var d={url:b,loginBarSearchT:g.value,loginBarSearchS:j.value,loginBarSearchS:j.value,loginBarSearchType:m.value,loginBarSearchSType:p.value,loginBarSearchInput:c.value};c.value="影评 "+o;g.value="blog";p.value="tag";f.action="http://uni.sina.com.cn/c.php";f.submit();f.action=d.url;g.value=d.loginBarSearchT;j.value=d.loginBarSearchS;j.value=d.loginBarSearchS;m.value=d.loginBarSearchType;p.value=d.loginBarSearchSType;c.value=d.loginBarSearchInput};$registComp(122,{getLatestComm:new Interface("http://control.blog.sina.com.cn/riaapi/film/get_latest_filmcomment.php","jsload"),load:function(){this.getLatestComm.request({onSuccess:Core.Function.bind2(function(a){trace("---------ok----------");this.cacheData=a;this.toHTML(this.cacheData)},this),onError:Core.Function.bind2(function(a){trace("---------error----------");this.showError(a.code)},this),onFail:Core.Function.bind2(function(a){this.showError($SYSMSG.A80101)},this)})},toHTML:function(H){var F=H;if(H.length==0){this.handleEmpty();return}var r=11,p=12;for(var B=0,C=H.length;B<C;B++){var G=H[B]["filmname"];H[B]["filmname_limit"]=G;for(var A=0,q=H[B]["comment"].length;A<q;A++){H[B]["comment"][A].title_limit=s(H[B]["comment"][A].title,p)}H[B]["num"]=Core.String.formatNumber(H[B]["num"])}function z(d,j){d=Core.String.expand(d);if(d.length<=j){j=d.length-1}d=d.substr(0,j)+" "+d.substr(j);d=Core.String.collapse(d);return d}function s(m,d){var j=Core.String.expand(m);if(j.length>d){j=j.substr(0,d)}j=Core.String.collapse(j);return j}var t="";for(var y=0,a=H.length;y<a;y++){var c=H[y].type==2?"movie":"tv";var g="http://data.ent.sina.com.cn/"+c+"/"+H[y]["filmid"]+".html";var G=H[y]["filmname"],D=H[y]["filmname_limit"];var E=H[y]["imgurl"],o=H[y]["num"];t+=['<li class="cur">','<a href="'+g+'" target="_blank" title="'+G+'"><img alt="'+G+'" src="'+E+'"></a>','<p>共<strong><a href="javascript:void(0);" onclick="scope.searchFilm(\''+G+"')\">"+o+"</a></strong>篇</p>","<ul>"].join("");for(var v=0,b=H[y]["comment"].length;v<b;v++){t+='<li><a title="'+H[y]["comment"][v].title+'" href="'+H[y]["comment"][v].url+'" target="_blank">'+H[y]["comment"][v].title_limit+"</a></li>"}var u=y==a-1?"":'<div class="SG_j_linedot"></div>';t+=["</ul>",u,'<div class="clearit"></div>',"</li>"].join("")}var f=['<div class="hotmovies">',"<ul>",t,"</ul>",'</div><div class="clearit"></div>'].join("");this.setContent(f)},handleEmpty:function(){trace("没有最新影评数据");var a=['<div class="SG_nodata">',"<p>还没有影评。</p>","</div>"].join("");this.setContent(a)}},"dynamic");Lib.Component.renderByList=function(a){Core.Array.foreach(a,function(d){try{if($E("module_"+d)!=null){var b=Lib.Component.instances[d]||new Lib.Component["Comp_"+d](d);if(b.size!=null&&b.load!=null){b.size=Lib.Component.compSize[d];try{b.load()}catch(c){}Debug.log("组件："+d+" 初始化成功")}else{Debug.error("组件："+d+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+d+" 初始化失败，页面内缺少组件的HTML节点")}}catch(c){Debug.error(c.message||"组件："+d+" 初始化失败，请确认该组件类是否定义过")}finally{}})};Lib.Component.lazyRenderByList=function(a){var b=[];Core.Array.foreach(a,function(f){try{if($E("module_"+f)!=null){var c=Lib.Component.instances[f]||new Lib.Component["Comp_"+f](f);if(c.size!=null&&c.load!=null){c.size=Lib.Component.compSize[f];try{b.push({dom:$E("module_"+f),callback:Lib.Component.instances[f].load.bind2(Lib.Component.instances[f])})}catch(d){}Debug.log("组件："+f+" 初始化成功")}else{Debug.error("组件："+f+" 初始化失败，组件尺寸信息不存在")}}else{Debug.error("组件："+f+" 初始化失败，页面内缺少组件的HTML节点")}}catch(d){Debug.error(d.message||"组件："+f+" 初始化失败，请确认该组件类是否定义过")}finally{}});Lib.LazyLoad(b,{})};$registJob("articleComp1",function(){var a=[901,102,122];if(Lib.Component.getInitCompSize()===null){Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。");return}trace("文章页组件渲染列表: "+a.toString());Lib.Component.renderByList(a)});$registJob("articleComp2",function(){var a=[903,904,909,47];if(Lib.Component.getInitCompSize()===null){Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。");return}trace("文章页组件渲染列表: "+a.toString());Lib.Component.lazyRenderByList(a)});Ui.Pagination={config:{pageNode:null,nodeClassNamePrefix:"CP",curPage:1,maxPage:1,minPage:1,pageTpl:"@page@.html",type:1,showPrevNext:true,viewSize:5,dotIsPage:false,dotRate:5,showGoto:false,countTpl:"",language:"zh-cn",theme:1,showLastPage:true,showTotal:false},_list:{},_resource:{"en-us":["Pages (@data@): ","Go to First Page","Go to Previous Page (@data@)","Go to Page @data@","Go to Next Page (@data@)","Go to Last Page","Current Page in View"],"zh-cn":["共 @data@ 页","跳转至第一页","跳转至前 @data@ 页","跳转至第 @data@ 页","跳转至后 @data@ 页","跳转至最后一页","当前所在页"]},_template:'<li class="#{class}" title="#{title}">#{link}</li>',init:function(d){var b=$E(d.pageNode);if(b==null){trace("分页指定的父容器不存在");return}Ui.Pagination._list[b.id]={};var c=Ui.Pagination._list[b.id];for(var a in this.config){c[a]=(d[a]===undefined)?this.config[a]:d[a]}if(c.type==2){c.viewSize=4}c.minPage=Math.min(c.minPage,c.maxPage)*1;c.maxPage=Math.max(c.minPage,c.maxPage)*1;c.curPage=(c.curPage>c.maxPage)?c.minPage:c.curPage;c.curPage=c.curPage*1;if(c.curPage+c.viewSize>=100){c.viewSize=3}this._cache_node=c;return this},show:function(n,c){c=c*1;var b=this._cache_node;if(n!=null){this._cache_node=b=Ui.Pagination._list[n.id];b.curPage=c}var j=[];if(b.viewSize*2+1>=b.maxPage){j[1]=b.minPage;j[2]=b.maxPage}else{if(b.curPage<=b.minPage+b.viewSize){j[1]=b.minPage;j[2]=b.minPage+(b.viewSize*2-1);j[3]=b.maxPage}else{if(b.curPage>=b.maxPage-b.viewSize){j[0]=b.minPage;j[1]=b.maxPage-(b.viewSize*2-1);j[2]=b.maxPage}else{j[0]=b.minPage;j[1]=b.curPage-(b.viewSize-1);j[2]=b.curPage+(b.viewSize-1);j[3]=b.maxPage}}}var f=[];if(b.countTpl!=null){f.push(this._createPage("","","","",b.countTpl))}if(b.type!=2&&b.curPage!=b.minPage){if(b.type==3){f.push(this._createPage(b.nodeClassNamePrefix+"_s_pgprev",b.curPage-1,3,b.curPage-1,"上页"))}else{f.push(this._createPage(b.nodeClassNamePrefix+"_pgprev",b.curPage-1,3,b.curPage-1,"< 上一页"))}}if(b.type!=3){if(j[0]!=null){var d=(j[0]==b.curPage)?this._createPage(b.nodeClassNamePrefix+"_pgon",1,6,"",j[0]):this._createPage("",1,1,j[0],j[0]);f.push(d)}if(b.type==1&&j[0]!=null){f.push(this._createPage(b.nodeClassNamePrefix+"_pgelip","","","","..."))}for(var a=j[1];a<=j[2];a++){if(a==j[1]&&a!=b.minPage&&b.type==2){var m=b.curPage-b.dotRate;m=m<b.minPage?b.minPage:m;f.push(this._createPage(b.nodeClassNamePrefix+"_pgelip",b.viewSize+1,2,b.curPage-b.viewSize-1,"..."))}else{if(a==j[2]&&a!=b.maxPage&&b.type==2){var g=b.curPage+b.dotRate;g=g>b.maxPage?b.maxPage:g;f.push(this._createPage(b.nodeClassNamePrefix+"_pgelip",b.viewSize+1,4,b.curPage+b.viewSize+1,"..."))}else{d=(a==b.curPage)?this._createPage(b.nodeClassNamePrefix+"_pgon",1,6,"",a):this._createPage("",a,3,a,a);f.push(d)}}}if(b.type==1&&j[3]!=null){f.push(this._createPage(b.nodeClassNamePrefix+"_pgelip","","","","..."))}if(j[3]!=null&&b.showLastPage){d=(j[3]==b.curPage)?this._createPage(b.nodeClassNamePrefix+"_pgon",b.curPage-1,3,"",j[3]):this._createPage("",1,5,j[3],j[3]);f.push(d)}}else{f.push(this._createPage(b.nodeClassNamePrefix+"_s_pgnum","","","","<strong>"+b.curPage+"</strong>/"+b.maxPage))}if(b.type!=2&&b.curPage!=b.maxPage){if(b.type==3){f.push(this._createPage(b.nodeClassNamePrefix+"_s_pgnext",b.curPage+1,3,b.curPage+1,"下页"))}else{f.push(this._createPage(b.nodeClassNamePrefix+"_pgnext",b.curPage+1,3,b.curPage+1,"下一页 >"))}}if(b.showTotal==true){f.push(this._createPage(b.nodeClassNamePrefix+"_pgttl","","","","共"+b.maxPage+"页"))}$E(b.pageNode).innerHTML='<ul class="'+b.nodeClassNamePrefix+'_pages">'+f.join("")+"</ul>"},_createPage:function(f,j,c,b,g){if(g==""){return""}var d=(j===""||c=="")?"":this._getTips(j,c);var a=(b!=="")?("<a "+this._getUrl(b)+">"+g+"</a>"):g;return this._template.replace(/(#\{\w+\})/g,function(n,m){switch(m){case"#{class}":return f;case"#{title}":return d;case"#{link}":return a}})},showPage:function(a,b){this._cache_node=Ui.Pagination._list[a];var c=this._cache_node.pageTpl(b);if(c!=false){Ui.Pagination.show($E(a),b)}},_getUrl:function(a){if(typeof this._cache_node.pageTpl=="string"){return'href="'+this._cache_node.pageTpl.replace(/@page@/,a)+'"'}else{return"href=\"javascript:Ui.Pagination.showPage('"+this._cache_node.pageNode+"',"+a+');"'}},_getTips:function(a,b){return(this._resource[this._cache_node.language][b]).replace(/@data@/g,a)}};var CommentV2={};Utils.Json={eval:function(str){return eval("("+str+")")},flatten:function(a){var b=Utils.Json;if(a==null){return null}else{if(a.constructor.toString()==String){return b.str2json(a)}else{if(a.constructor.toString()==Array){return b.arr2json(a)}else{if(a.constructor.toString()==Object){return b.obj2json(a)}else{if(a.constructor.toString()==Boolean){return b.bool2json(a)}else{if(a.constructor.toString()==Number){return b.num2json(a)}else{if(a.constructor.toString()==Date){return b.date2json(a)}else{return null}}}}}}}},arr2json:function(a){var c=Utils.Json;var g=[];var b=a.length;var f;for(var d=0;d<b;++d){f=c.flatten(a[d]);if(f){g.push(f)}}return"["+g.join(",")+"]"},obj2json:function(a){var b=Utils.Json;var f=[];var d;for(var c in a){d=b.flatten(a[c]);if(d){f.push(b.flatten(c)+":"+d)}}return"{"+f.join(",")+"}"},date2json:function(a){function b(c){return c<10?"0"+c:c}return'"'+a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'},stringify:function(b){var a=Utils.Json;return a.flatten(b)},parse:function(jsonStr){return Utils.Json.eval(jsonStr)},num2json:function(a){return a?String(a):"0"},bool2json:function(a){return String(a)},str2json:function(b){var a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(b)){return'"'+b.replace(/([\x00-\x1f\\"])/g,function(f,d){var g=a[d];if(g){return g}g=d.charCodeAt();return"\\u00"+Math.floor(g/16).toString(16)+(g%16).toString(16)})+'"'}return'"'+b+'"'}};$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用",B36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！","36999":"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",B11113:"积分不足，神回复失败",B11114:"操作失败，神回复不合法",A00004:"此评论不存在或已被博主删除",A00011:"请登录后再进行评论"});CommentV2.List=function(a){this.containerNode="",this.type="",this.operation="",this.data="",this.page=1,this.total=0,this.url="";this.trim=Core.String.trim;this.jsonUtil=Utils.Json;this.init(a)}.$define({init:function(a){trace("super init");this.__merge(a);this.load(this.page)},__merge:function(b){for(var a in b){this[a]=b[a]}},load:function(a){},render:function(){},bindEvent:function(){var a=this;if(!scope.commentlistIsBind){this.addEvent(this.containerNode,a.delegate.bind2(a),"click");this.onListener()}scope.commentlistIsBind=true},delegate:function(m){trace("CommentV2.CommentList.delegate");m=m||window.event;var b=m.target||m.srcElement;var j,f,g,d,c;j=this.getTarget(b,this.containerNode);if(j){f=this.getType(j);if(f){g=f.split("_")[0];d=f.split("_")[1];c=this.str2obj(this.getData(j));if(g=="comment"){var a=$E("comment_"+c.commentid);this[d]({type:g,operation:d,articleid:scope.$articleid,data:c,containerNode:a,node:j})}else{var a=$E("reply_"+c.replyid);this.replyList[c.commentid][d]({type:g,operation:d,articleid:scope.$articleid,data:c,containerNode:a,node:j})}}}},onListener:function(){Lib.Listener.on({name:"commentlist-commentadd",callBack:this.add,scope:this})},removeEvent:function(){trace("CommentV2.CommentList.removeEvent");this.removeEvent(this.containerNode,this.delegate,"click")},toggle:function(){this.isDisplay()?this.hide():this.show()},show:function(){this.containerNode.style.display=""},hide:function(){this.containerNode.style.display="none"},isDisplay:function(){return this.containerNode?this.containerNode.style.display!=="none":false},error:function(a){this.containerNode.innerHTML='<li class="CP_litem"><div class="CP_cmt_none">'+$SYSMSG[a]+"</div></li>"},paging:function(){},add:function(){},del:function(){},report:function(){},reply:function(){},share:function(){},obj2str:function(a){return encodeURIComponent(this.jsonUtil.flatten(a))},str2obj:function(str){return this.jsonUtil.eval(decodeURIComponent(str))},getTarget:function(b,a){while(b&&b!==a){if(b.tagName.toLowerCase()=="a"){return b}b=b.parentNode}return null},getType:function(a){return a&&a.getAttribute("action-type")},getData:function(a){return a&&a.getAttribute("action-data")}});Core.Dom.getElementsByAttr=function(f,d,g){var b=[];for(var c=0,a=f.childNodes.length;c<a;c++){if(f.childNodes[c].nodeType==1){if(f.childNodes[c].getAttribute(d)==g){b.push(f.childNodes[c])}if(f.childNodes[c].childNodes.length>0){b=b.concat(arguments.callee.call(null,f.childNodes[c],d,g))}}}return b};(function(){var a={},b=document.selection;a.selectionStart=function(d){if(!b){try{return d.selectionStart}catch(m){return 0}}var n=b.createRange(),j,c,g=0;var f=document.body.createTextRange();try{f.moveToElementText(d)}catch(m){}for(g;f.compareEndPoints("StartToStart",n)<0;g++){f.moveStart("character",1)}return g};a.selectionBefore=function(c){return c.value.slice(0,a.selectionStart(c))};a.selectText=function(f,d,g){f.focus();if(!b){f.setSelectionRange(d,g);return}var j=f.createTextRange();j.collapse(1);j.moveStart("character",d);j.moveEnd("character",g-d);j.select()};a.insertText=function(g,j,d,m){g.focus();m=m||0;if(!b){var n=g.value,p=d-m,f=p+j.length;g.value=n.slice(0,p)+j+n.slice(d,n.length);a.selectText(g,f,f);return}var o=b.createRange();o.moveStart("character",-m);o.text=j};a.replaceText=function(g,j){g.focus();var n=g.value;var m=a.getSelectedText(g);var f=m.length;if(m.length==0){a.insertText(g,j,a.getCursorPos(g))}else{var p=a.getCursorPos(g);if(b){var o=b.createRange();o.text=j;a.setCursor(g,p+j.length)}else{var d=p+m.length;g.value=n.slice(0,p)+j+n.slice(p+f,n.length);a.setCursor(g,p+j.length);return}}};a.getCursorPos=function(g){var f=0;if($IE){g.focus();var c=null;c=b.createRange();var d=c.duplicate();d.moveToElementText(g);d.setEndPoint("EndToEnd",c);g.selectionStartIE=d.text.length-c.text.length;g.selectionEndIE=g.selectionStartIE+c.text.length;f=g.selectionStartIE}else{if(g.selectionStart||g.selectionStart=="0"){f=g.selectionStart}}return f};a.getSelectedText=function(f){var d="";var c=function(g){if(g.selectionStart!=undefined&&g.selectionEnd!=undefined){return g.value.substring(g.selectionStart,g.selectionEnd)}else{return""}};if(window.getSelection){d=c(f)}else{d=b.createRange().text}return d};a.setCursor=function(f,g,c){g=g==null?f.value.length:g;c=c==null?0:c;f.focus();if(f.createTextRange){var d=f.createTextRange();d.move("character",g);d.moveEnd("character",c);d.select()}else{f.setSelectionRange(g,g+c)}};a.unCoverInsertText=function(g,m,f){f=(f==null)?{}:f;f.rcs=f.rcs==null?g.value.length:f.rcs*1;f.rccl=f.rccl==null?0:f.rccl*1;var j=g.value,c=j.slice(0,f.rcs),d=j.slice(f.rcs+f.rccl,j==""?0:j.length);g.value=c+m+d;this.setCursor(g,f.rcs+(m==null?0:m.length))};CommentV2.TextAreaUtils=a})();window.WEIBOFACEDATA=[{phrase:"[草泥马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]",picid:""},{phrase:"[神马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_thumb.gif",value:"[神马]",picid:""},{phrase:"[浮云]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]",picid:""},{phrase:"[给力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_thumb.gif",value:"[给力]",picid:""},{phrase:"[围观]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_thumb.gif",value:"[围观]",picid:""},{phrase:"[威武]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_thumb.gif",value:"[威武]",picid:""},{phrase:"[熊猫]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_thumb.gif",value:"[熊猫]",picid:""},{phrase:"[兔子]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_thumb.gif",value:"[兔子]",picid:""},{phrase:"[奥特曼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]",picid:""},{phrase:"[囧]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_thumb.gif",value:"[囧]",picid:""},{phrase:"[互粉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_thumb.gif",value:"[互粉]",picid:""},{phrase:"[礼物]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_thumb.gif",value:"[礼物]",picid:""},{phrase:"[呵呵]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]",picid:""},{phrase:"[嘻嘻]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_thumb.gif",value:"[嘻嘻]",picid:""},{phrase:"[哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",value:"[哈哈]",picid:""},{phrase:"[可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_thumb.gif",value:"[可爱]",picid:""},{phrase:"[可怜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_thumb.gif",value:"[可怜]",picid:""},{phrase:"[挖鼻屎]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_thumb.gif",value:"[挖鼻屎]",picid:""},{phrase:"[吃惊]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_thumb.gif",value:"[吃惊]",picid:""},{phrase:"[害羞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_thumb.gif",value:"[害羞]",picid:""},{phrase:"[挤眼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_thumb.gif",value:"[挤眼]",picid:""},{phrase:"[闭嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_thumb.gif",value:"[闭嘴]",picid:""},{phrase:"[鄙视]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_thumb.gif",value:"[鄙视]",picid:""},{phrase:"[爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_thumb.gif",value:"[爱你]",picid:""},{phrase:"[泪]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_thumb.gif",value:"[泪]",picid:""},{phrase:"[偷笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_thumb.gif",value:"[偷笑]",picid:""},{phrase:"[亲亲]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_thumb.gif",value:"[亲亲]",picid:""},{phrase:"[生病]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_thumb.gif",value:"[生病]",picid:""},{phrase:"[太开心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_thumb.gif",value:"[太开心]",picid:""},{phrase:"[懒得理你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_thumb.gif",value:"[懒得理你]",picid:""},{phrase:"[右哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_thumb.gif",value:"[右哼哼]",picid:""},{phrase:"[左哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_thumb.gif",value:"[左哼哼]",picid:""},{phrase:"[嘘]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_thumb.gif",value:"[嘘]",picid:""},{phrase:"[衰]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",value:"[衰]",picid:""},{phrase:"[委屈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_thumb.gif",value:"[委屈]",picid:""},{phrase:"[吐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_thumb.gif",value:"[吐]",picid:""},{phrase:"[打哈欠]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_thumb.gif",value:"[打哈欠]",picid:""},{phrase:"[抱抱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_thumb.gif",value:"[抱抱]",picid:""},{phrase:"[怒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_thumb.gif",value:"[怒]",picid:""},{phrase:"[疑问]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_thumb.gif",value:"[疑问]",picid:""},{phrase:"[馋嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_thumb.gif",value:"[馋嘴]",picid:""},{phrase:"[拜拜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_thumb.gif",value:"[拜拜]",picid:""},{phrase:"[思考]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_thumb.gif",value:"[思考]",picid:""},{phrase:"[汗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_thumb.gif",value:"[汗]",picid:""},{phrase:"[困]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_thumb.gif",value:"[困]",picid:""},{phrase:"[睡觉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_thumb.gif",value:"[睡觉]",picid:""},{phrase:"[钱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_thumb.gif",value:"[钱]",picid:""},{phrase:"[失望]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_thumb.gif",value:"[失望]",picid:""},{phrase:"[酷]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_thumb.gif",value:"[酷]",picid:""},{phrase:"[花心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_thumb.gif",value:"[花心]",picid:""},{phrase:"[哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_thumb.gif",value:"[哼]",picid:""},{phrase:"[鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_thumb.gif",value:"[鼓掌]",picid:""},{phrase:"[晕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_thumb.gif",value:"[晕]",picid:""},{phrase:"[悲伤]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_thumb.gif",value:"[悲伤]",picid:""},{phrase:"[抓狂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_thumb.gif",value:"[抓狂]",picid:""},{phrase:"[黑线]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_thumb.gif",value:"[黑线]",picid:""},{phrase:"[阴险]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_thumb.gif",value:"[阴险]",picid:""},{phrase:"[怒骂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_thumb.gif",value:"[怒骂]",picid:""},{phrase:"[心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_thumb.gif",value:"[心]",picid:""},{phrase:"[伤心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",value:"[伤心]",picid:""},{phrase:"[猪头]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",value:"[猪头]",picid:""},{phrase:"[ok]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_thumb.gif",value:"[ok]",picid:""},{phrase:"[耶]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_thumb.gif",value:"[耶]",picid:""},{phrase:"[good]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_thumb.gif",value:"[good]",picid:""},{phrase:"[不要]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_thumb.gif",value:"[不要]",picid:""},{phrase:"[赞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_thumb.gif",value:"[赞]",picid:""},{phrase:"[来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_thumb.gif",value:"[来]",picid:""},{phrase:"[弱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_thumb.gif",value:"[弱]",picid:""},{phrase:"[蜡烛]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_thumb.gif",value:"[蜡烛]",picid:""},{phrase:"[钟]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_thumb.gif",value:"[钟]",picid:""},{phrase:"[话筒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_org.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_thumb.gif",value:"[话筒]",picid:""},{phrase:"[蛋糕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",hot:false,common:true,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",value:"[蛋糕]",picid:""},{phrase:"[微博益起来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_thumb.gif",value:"[微博益起来]",picid:""},{phrase:"[微公益爱心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_thumb.gif",value:"[微公益爱心]",picid:""},{phrase:"[笑哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_thumb.gif",value:"[笑哈哈]",picid:""},{phrase:"[转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_thumb.gif",value:"[转发]",picid:""},{phrase:"[得意地笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_thumb.gif",value:"[得意地笑]",picid:""},{phrase:"[moc转发]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_thumb.gif",value:"[moc转发]",picid:""},{phrase:"[劲能样]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_thumb.gif",value:"[劲能样]",picid:""},{phrase:"[bm可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_thumb.gif",value:"[bm可爱]",picid:""},{phrase:"[xkl转圈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_thumb.gif",value:"[xkl转圈]",picid:""},{phrase:"[ppb鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_thumb.gif",value:"[ppb鼓掌]",picid:""},{phrase:"[din推撞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_thumb.gif",value:"[din推撞]",picid:""},{phrase:"[xb压力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_thumb.gif",value:"[xb压力]",picid:""},{phrase:"[放假啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_thumb.gif",value:"[放假啦]",picid:""},{phrase:"[国旗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_thumb.gif",value:"[国旗]",picid:""},{phrase:"[带着微博去旅行]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_thumb.gif",value:"[带着微博去旅行]",picid:""},{phrase:"[玩去啦]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_thumb.gif",value:"[玩去啦]",picid:""},{phrase:"[ali哇]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_thumb.gif",value:"[ali哇]",picid:""},{phrase:"[酷库熊顽皮]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_thumb.gif",value:"[酷库熊顽皮]",picid:""},{phrase:"[BOBO爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_thumb.gif",value:"[BOBO爱你]",picid:""},{phrase:"[偷乐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_thumb.gif",value:"[偷乐]",picid:""},{phrase:"[泪流满面]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_thumb.gif",value:"[泪流满面]",picid:""},{phrase:"[lt切克闹]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_thumb.gif",value:"[lt切克闹]",picid:""},{phrase:"[江南style]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_org.gif",hot:true,common:false,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_thumb.gif",value:"[江南style]",picid:""}];if(document.documentElement.contains){Core.Dom.contains=function(a,b){return a.contains?a.contains(b):true}}else{if(document.documentElement.compareDocumentPosition){Core.Dom.contains=function(a,b){return a===b||!!(a.compareDocumentPosition(b)&16)}}else{Core.Dom.contains=function(a,b){while(b){if(a===b){return true}b=b.parentNode}return false}}}var Tabs=Core.Class.create();Tabs.prototype={initialize:function(c,b){b=b||{};var a=b.className||"";this.tabsArr=[];this.htmlEle=$C("ul");this.htmlEle.className=a;c.appendChild(this.htmlEle)},add:function(a){this.tabsArr.push(a);this.htmlEle.appendChild(a.element);Core.Events.addEvent(a.element,Core.Function.bind3(this.swapTags,this,[a]))},swapTags:function(b){if(b.isFocus==false){for(var a=0;a<this.tabsArr.length;a++){this.tabsArr[a].setAbort()}b.setFocus()}else{return}}};var Tab=Core.Class.create();Tab.prototype={isShow:true,initialize:function(c,a){this.id=Core.Math.getUniqueId();this.option=a||{};var b=a.isFocus||false;this.className=a.className||"";this.focus=a.onfocus?[a.onfocus]:[];this.abotrts=a.onabort?[a.onabort]:[];this.element=$C("li");if(a.cls){this.element.className=a.cls}b?this.setFocus():this.setAbort();this.element.innerHTML=c},setAbort:function(){if(this.isFocus==false){return}if(this.option.cls){this.element.className=this.option.cls}else{this.element.className=""}this.isFocus=false;this.onabort()},setFocus:function(){this.element.className=this.className;this.isFocus=true;this.onfocus()},onabort:function(){for(var a=0;a<this.abotrts.length;a++){this.abotrts[a]()}},onfocus:function(){for(var a=0;a<this.focus.length;a++){this.focus[a]()}},addOnAbort:function(a){this.abotrts.push(a)},addOnFocus:function(a){this.focus.push(a)},hidden:function(){this.element.style.display="none"},hidden:function(){this.element.style.display="none";this.isShow=false},show:function(){this.element.style.display="block";this.isShow=true}};Lib.register("util.JSON",function(b){var a=(function(d,f){if(d.JSON){return d.JSON}var c={parse:function(g){return new Function("return "+g)()},stringify:function(j){if(j instanceof Object){var n="";if(j.constructor===Array){for(var g=0;g<j.length;n+=this.stringify(j[g])+",",g++){}return"["+n.substr(0,n.length-1)+"]"}if(j.toString!==Object.prototype.toString){return'"'+j.toString().replace(/"/g,"\\$&")+'"'}for(var m in j){n+='"'+m.replace(/"/g,"\\$&")+'":'+this.stringify(j[m])+","}return"{"+n.substr(0,n.length-1)+"}"}return typeof j==="string"?'"'+j.replace(/"/g,"\\$&")+'"':String(j)}};return c})(window);return a});CommentV2.FaceDialog=Core.Class.create();CommentV2.FaceDialog.prototype={initialize:function(a,b){this._src=a;this._tarea=b;this._json=Lib.util.JSON;this.dialog=new Dialog(this._tpl);this.dialogNodes=this.dialog.getNodes();var c=this.getSrcPos(a);this.faceDatas={};this.generaFaces=[];this.hotFaces=[];this.dialog.setPosition(c);this.dialog.show();this.initTab();this._bindEvents()},_tpl:['<table class="CP_w" id="#{entity}">',"<thead>","<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong>插入表情</strong><cite><a href="#" id="#{close}"class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemList" id="#{facelistbox}">','<div class="CP_w_tag" id="#{facetabs}" style="display:none"></div>','<div id="#{general}">','<div class="tab_subsort" id="#{generaltabs}" style="display:none"></div>','<div class="details">','<ul class="face_tp face_lt" id="#{hotFace}"></ul>','<ul class="face_tp" id="#{inner}"></ul>','<div class="SG_page" id="#{page}"><ul id="#{pagelist}" class="SG_pages"></ul></div>',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),_bindEvents:function(){var a=this;Core.Events.addEvent(this.dialogNodes.close,function(b){var b=Core.Events.getEvent();Core.Events.stopEvent(b);a.dialog.hidden()},"click");Core.Events.addEvent(document.body,function(b){var b=Core.Events.getEvent();var c=b.target||b.srcElement;if(!Core.Dom.contains(a.dialogNodes.entity,c)&&(c!=a._src)){a.dialog.hidden()}},"click");this.bindDelegateAction()},getSrcPos:function(){var a=this._src;var b=Core.Dom.getXY(a);var c=a.offsetHeight;var d={};d.x=b[0];d.y=b[1]+c+5;return d},show:function(){this.dialog.show()},initTab:function(){this.tab=new Tabs(this.dialogNodes.facetabs,{});highTab=new Tab("<div><em>常用表情</em></div>",{isFocus:true,className:"cur"});highTab.addOnFocus(Core.Function.bind3(this.initGeneralFace,this));this.tab.add(highTab);this.initGeneralFace()},getFaceData:function(a){if(this.faceDatas.face){return}var c=this;if(!window.WEIBOFACEDATA){var b="http://i2.api.weibo.com/2/emotions.json?source=1617465124&type=face&language=cnname&callback=jsonpfacedata";window.jsonpfacedata=function(d){if(d.code==1&&d.data){window.WEIBOFACEDATA=d.data;c.faceDatas.face=c.formartFaceData(d.data);a()}};Utils.Io.JsLoad.request(b,{onComplete:function(d){}.bind2(this),charset:"UTF-8"})}else{this.faceDatas.face=c.formartFaceData(window.WEIBOFACEDATA);a()}},formartFaceData:function(f){var c={};for(var b=0,a=f.length;b<a;b++){var d=f[b];if(!d.category){d.category="默认"}if(d.hot){this.hotFaces.push(d)}else{if(c[d.category]){c[d.category].push(d)}else{c[d.category]=[];this.generaFaces.push(d.category);c[d.category].push(d)}}}return c},initGeneralFace:function(){this.getFaceData(this.initGeneralTab.bind2(this))},initGeneralTab:function(){var a=this.initGeneralTabList();this.initGeneralTabPage(a)},initGeneralTabList:function(){var d=new Tabs(this.dialogNodes.generaltabs,{});d.add=function(j){this.tabsArr.push(j);this.htmlEle.appendChild(j.element);var m=this;Core.Events.addEvent(j.element,function(n){var n=Core.Events.getEvent();Core.Events.stopEvent(n);m.swapTags(j)})}.bind2(d);for(var c=0,a=this.generaFaces.length;c<a;c++){var g=this.generaFaces[c];var b=false;if(c==0){b=true}var f=new Tab('<a href="#">'+g+"</a>",{isFocus:b,className:"cur"});f.addOnFocus(Core.Function.bind3(this.showGeneralFaces,this,[g]));if(c>4){f.hidden()}d.add(f);if(c==0){this.showGeneralFaces(g)}}return d},initGeneralTabPage:function(o){var a='<div class="btn_func" ><a href="#" node-type="generalTabPagePre" class="arrow_preview"></a><a href="#" node-type="generalTabPageNext" class="arrow_next"></a></div>';Core.Dom.insertHTML(this.dialogNodes.generaltabs,a,"BeforeEnd");var d=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPagePre")[0];var g=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPageNext")[0];var f=1;var b=5;var m=[];var c=o.tabsArr.slice(f-1,b);var n=this.generaFaces.length;var q=n%b;var j=q>0?((n-q)/b+1):n/b;Core.Events.addEvent(d,function(r){var r=Core.Events.getEvent();Core.Events.stopEvent(r);if(f<=1){f=1;return}else{f--}p()});Core.Events.addEvent(g,function(r){var r=Core.Events.getEvent();Core.Events.stopEvent(r);if(f>=j){f=j;return}else{f++}p()});function p(){m=c;c=o.tabsArr.length>=f*b-1?o.tabsArr.slice((f-1)*b,f*b):o.tabsArr.slice((f-1)*b);for(var r=m.length-1;r>=0;--r){var t=m[r];t.hidden()}for(var u=c.length-1;u>=0;--u){var s=c[u];s.show()}}},showTheHotFace:function(){if(this.hotFaces){var b=this.hotFaces.slice(0,12);var a=this.setHotFaceList(b)}},memoryFocusTab:function(a){this.dialogNodes.generaltabs.setAttribute("data-focustab",a)},showGeneralFaces:function(b){this.memoryFocusTab(b);if(this.faceDatas.face&&this.faceDatas.face[b]){if(b=="默认"){this.dialogNodes.hotFace.style.display="block"}else{this.dialogNodes.hotFace.style.display="none"}var a=this.faceDatas.face[b];this.setGeneralFaceList(a)}},setHotFaceList:function(b){var a=this.getFaceItemsTpl(b);this.dialogNodes.hotFace.innerHTML=a},setGeneralFaceList:function(b){var a=this.getFaceListPageData(b);this.initFaceListPage(a);this.updateGeneralFaceList(b,a)},updateGeneralFaceList:function(c,b){var c=this.getFaceListData(c,b);var a=this.getFaceItemsTpl(c);this.dialogNodes.inner.innerHTML=a},getFaceItemsTpl:function(f){var d=[];for(var b=0,a=f.length;b<a;b++){var c=f[b];d.push('<li action-type="insert" action-data="'+c.phrase+'"><img src="'+c.icon+'" alt="'+c.phrase+'" title="'+c.phrase+'"></li>')}return d.join("")},getFaceListPageData:function(b){var a={};a.step=72;a.focus=1;a.total=b.length;a.totalpage=a.total>a.step?(a.total%a.step>0?((a.total-a.total%a.step)/a.step+1):a.total/a.step):1;this.dialogNodes.page.setAttribute("data-page",this._json.stringify(a));return a},initFaceListPage:function(c){var a=[];if(c.totalpage>1){this.dialogNodes.page.style.display="block";for(var b=1;b<=c.totalpage;b++){if(b==c.focus){a.push('<li class="SG_pgon">'+b+"</li>")}else{a.push('<li><a href="#" action-type="facePageNums">'+b+"</a></li>")}}this.dialogNodes.pagelist.innerHTML=a.join("")}else{this.dialogNodes.page.style.display="none"}},getFaceListData:function(j,g){var f=g.step;var d=g.total;var a=g.totalpage;var b=g.focus;if(b<1){b=1}if(b>a){b=a}var c=f<d?j.slice((b-1)*f,b*f):j;return c},bindDelegateAction:function(){Core.Events.addEvent(this.dialogNodes.facelistbox,function(g){a(g);c(g)});var f=this;function c(p){var g=Lib.util.getActionData(p,"facePageNums");if(g){Core.Events.stopEvent(p);var j=g.targetEl.innerHTML;var n=f._json.parse(f.dialogNodes.page.getAttribute("data-page"));n.focus=j-0;f.dialogNodes.page.setAttribute("data-page",f._json.stringify(n));f.initFaceListPage(n);var o=f.dialogNodes.generaltabs.getAttribute("data-focustab");var m=f.faceDatas.face[o];f.updateGeneralFaceList(m,n)}}function a(m){var g=Lib.util.getActionData(m,"insert");if(g){var n=g.data;var j=CommentV2.TextAreaUtils.selectionStart(f._tarea);CommentV2.TextAreaUtils.insertText(f._tarea,n,j);f.dialog.hidden()}}Core.Events.addEvent(this.dialogNodes.facelistbox,function(g){d(g)},"mouseover");function d(j){var g=Lib.util.getActionData(j,"insert");if(g){g.targetEl.className="hover"}}Core.Events.addEvent(this.dialogNodes.facelistbox,function(g){b(g)},"mouseout");function b(j){var g=Lib.util.getActionData(j,"insert");if(g){g.targetEl.className=""}}}};CommentV2.autoHeightTextArea=function(c){var j=Core.Dom.getStyle;var d=Core.Events.addEvent;function g(q){var t;if(!q.defaultHeight){q.defaultHeight=parseInt(j(q,"height"),10)||parseInt(q.offsetHeight,10)||20}if($IE){var r=parseInt(j(q,"paddingTop"),10)+parseInt(j(q,"paddingBottom"),10);t=Math.max(q.scrollHeight-r,q.defaultHeight)}else{var r=$MOZ?0:parseInt(j(q,"paddingTop"),10)+parseInt(j(q,"paddingBottom"),10);var s=$E("_____textarea_____");if(!s){s=$C("textarea");s.id="_____textarea_____";document.body.appendChild(s)}if(s.currentTarget!=q){var p=[];p.push("width:"+j(q,"width"));p.push("font-size:"+j(q,"fontSize"));p.push("font-family:"+j(q,"fontFamily"));p.push("line-height:"+j(q,"lineHeight"));p.push("padding-left:"+j(q,"paddingLeft"));p.push("padding-right:"+j(q,"paddingRight"));p.push("padding-top:"+j(q,"paddingTop"));p.push("padding-bottom:"+j(q,"paddingBottom"));p.push("top:-1000px");p.push("height:0px");p.push("position:absolute");p.push("overflow:hidden");p.push("");p=p.join(";");s.style.cssText=p}s.value=q.value;t=Math.max(s.scrollHeight-r,q.defaultHeight);s.currentTarget=q}return t}function o(q){var r;var p=[];p.push("width:"+j(q,"width"));p.push("font-size:"+j(q,"fontSize"));p.push("font-family:"+j(q,"fontFamily"));p.push("line-height:"+j(q,"lineHeight"));p.push("padding-left:"+j(q,"paddingLeft"));p.push("padding-right:"+j(q,"paddingRight"));p.push("padding-top:"+j(q,"paddingTop"));p.push("padding-bottom:"+j(q,"paddingBottom"));p.push("top:-1000px");p.push("height:0px");p.push("position:absolute");p.push("overflow:hidden");p.push("");p=p.join(";");return p}var f=c.textArea,n=c.maxHeight,m=c.inputListener,a=f.style,b;(b=function(){(typeof m==="function")&&m();setTimeout(function(){var r=g(f)||0,p;n=n||r;var q=r>n;p=q?n:r;a.overflowY=q?"auto":"hidden";a.height=Math.min(n,r)+"px"},0)})();if(!f.binded){d(f,b,"keyup");d(f,b,"focus");d(f,b,"blur");f.binded=true;f.style.overflow="hidden"}};CommentV2.CommentArea=Core.Class.create();CommentV2.CommentArea.prototype={initialize:function(a){this._container=a.container;this._place=a.place||"BeforeEnd";this._maxtext=(a.maxtext||140)*2;this._sid=a.sid||new Date().getTime();a.shownum=a.shownum||"yes";this._shownum=a.shownum=="yes"?1:0;a.autolineheight=a.autolineheight||"no";this._autolineheight=a.autolineheight=="no"?0:1;a.alertnotice=a.alertnotice||"yes";this._alertnotice=a.alertnotice=="yes"?1:0;this._maxheight=a.maxheight||100;this._okhandler=a.okhandler||function(){};this._initTareBox();this._initDom();this._bindEvent();this._clock=null},setReplyData:function(a,b){this._plugs=a;this._replaydata=b},setValues:function(a){var c=a.comment;var b=CommentV2.TextAreaUtils.selectionStart(this._tarea);this._tarea.value="";CommentV2.TextAreaUtils.insertText(this._tarea,c,b);CommentV2.TextAreaUtils.setCursor(this._tarea,0);this._checkNum()},getValue:function(){return this._tarea.value},_setTpl:function(a){this.tpl=['<div id="tare'+this._sid+'">','<div class="count" node-type="num">您还能输入'+(this._maxtext/2)+"字</div>",'<textarea  node-type="textEl"></textarea>','<div class="func"> <a href="#" class="fico" node-type="faceBtn"></a>','<div class="fr">',"<label>",'<input node-type="shareIpt" type="checkbox">',"将评论分享到微博 </label>",'<a href="#" class="SG_aBtn btn_reply" node-type="subtnEl"><cite>回复</cite></a></div>',"</div>","</div>"].join("")},_initTareBox:function(){this._setTpl();Core.Dom.insertHTML(this._container,this.tpl,this._place);this._selfcontainer=$E("tare"+this._sid)},_initDom:function(){var a=this._selfcontainer;if(!a){return}this._tarea=Core.Dom.getElementsByAttr(a,"node-type","textEl")[0];this._num=Core.Dom.getElementsByAttr(a,"node-type","num")[0];this._subtn=Core.Dom.getElementsByAttr(a,"node-type","subtnEl")[0];this._facebtn=Core.Dom.getElementsByAttr(a,"node-type","faceBtn")[0];this._shareitp=Core.Dom.getElementsByAttr(a,"node-type","shareIpt")[0];this._shareitp.checked=Utils.Cookie.getCookie("acp_bb")=="1"?false:true;if(!this._shownum){this._num.style.display="none"}},_bindEvent:function(){var a=this;Core.Events.addEvent(this._shareitp,function(b){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_09")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_13")}},"click");Core.Events.addEvent(this._tarea,this._checkNum.bind2(this),"keydown");Core.Events.addEvent(this._tarea,function(b){a._checkNum();var b=Core.Events.getEvent();var c=b.target||b.srcElement;a._checkValue()},"keyup");Core.Events.addEvent(this._tarea,this._bindKeyEvent.bind2(this),"keydown");Core.Events.addEvent(this._subtn,function(b){var b=Core.Events.getEvent();if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}a._submitForm()},"click");Core.Events.addEvent(this._facebtn,function(b){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_11")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_15")}var b=Core.Events.getEvent();if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}a._showFacePanel()},"click");if(this._autolineheight){CommentV2.autoHeightTextArea({textArea:this._tarea,maxHeight:this._maxheight,inputListener:function(){trace("--autoHeightTextArea--")}})}},_checkValue:function(){},_checkNum:function(){var b=this._getUnoccupiedNum();if(this._shownum){var a=b>=0?"还可以输入"+b+"字":'<em class="red">已超出'+(-b)+"字</em>";this._num.innerHTML=a}},_jsOverflow:function(){var a=this._getUnoccupiedNum();return a<0?true:false},_getUnoccupiedNum:function(){var d=this._tarea.value;var b=this._getLen(d);var a=this._maxtext;var c=(a-b)%2==0?(a-b)/2:(a-b-1)/2;return c},_getLen:function(d){if(!d){return 0}var c=d.match(/[^\x00-\xff]/g);return d.length+(c?c.length:0)},_bindKeyEvent:function(a){if(a.keyCode==13&&a.ctrlKey){this._submitForm()}},_validate:function(){var a=this;if(Core.String.trim(this._tarea.value)==""){winDialog.alert($SYSMSG.B36041,{icon:"01",funcOk:function(){a._tarea.focus()}});return false}if(this._jsOverflow()){winDialog.alert($SYSMSG.B36208,{icon:"01",funcOk:function(){a._tarea.focus()}});return false}return true},_submitForm:function(){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_10")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_14")}if(!this._validate()){return}if(this._plugs){this._replaydata.reply_content=Core.String.trim(this._tarea.value);this._replaydata.is_t=this._shareitp.checked?1:0;this._setShareWbSign();this._plugs.add(this._replaydata,this.successFun.bind2(this),this.errorFun.bind2(this))}},_setShareWbSign:function(){if(this._shareitp){if(this._shareitp.checked){if($E("bb")){$E("bb").checked=true}if(Utils.Cookie.getCookie("acp_bb")=="1"){Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")}}else{if($E("bb")){$E("bb").checked=false}if(Utils.Cookie.getCookie("acp_bb")!="1"){Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")}}}},successFun:function(a){this._tarea.value="";this._checkNum();var b=this;if(this._alertnotice){winDialog.alert("发布成功",{icon:"03",funcOk:function(){b._plugs.sucOkFun&&b._plugs.sucOkFun()}})}this._okhandler()},errorFun:function(b){if(scope.$PRODUCT_NAME=="blog7"){v7sendLog("32_01_12")}if(scope.$PRODUCT_NAME=="blog7icp"){v7sendLog("32_01_16")}var a=b?$SYSMSG[b.code]:"发布失败，请稍后再试";winDialog.alert(a,{icon:"01",funcOk:function(){_this._plugs.errOkFun&&_this._plugs.errOkFun()}})},_showFacePanel:function(){if(!this.facedialog){this.facedialog=new CommentV2.FaceDialog(this._facebtn,this._tarea)}else{this.facedialog.show()}}};(function(){function a(c,b){this.tempDiv=document.createElement("div");this.tempDiv.id="TempNodeForTest";this.tempDiv.innerHTML=c;this.charCount=0;this.limit=b}a.prototype.cut=function(){var b=document.createElement("div");this.searchEnd(this.tempDiv,b);return b.innerHTML};a.prototype.searchEnd=function(m,b){var g;var f;for(var c=0;c<m.childNodes.length;c++){g=m.childNodes[c];if(g.nodeType!=3){f=g.cloneNode(true);b.appendChild(f);if(g.childNodes.length===0){continue}f.innerHTML="";var d=this.searchEnd(g,f);if(d){return d}else{continue}}if(Core.String.byteLength(g.nodeValue)+this.charCount>=this.limit){f=g.cloneNode(true);f.nodeValue=g.nodeValue.substr(0,this.limit-this.charCount);b.appendChild(f);return true}f=g.cloneNode(true);b.appendChild(f);this.charCount+=Core.String.byteLength(g.nodeValue)}return false};Core.String.cutHtmlString=function(c,d){var b=new a(c,d);return b.cut()}})();Lib.HtmlTemplate=function(a,b){this.uniqueID=b}.$extends(Ui.Template).$define({getHtmlString:function(){if(!this._htmlStr){this._htmlStr=this.evaluate(this.getNodeIds())}return this._htmlStr},getNodeIds:function(){if(!this._nodes){var f=/\{[^\}]+(?=\})/g,b,a={},d,c,g=this._getUniqueID();this.__templateNodesIDs=this.tmpl.match(f);d=this.__templateNodesIDs;if(d){b=d.length;while(b--){c=d[b].replace("{","");a[c]="_"+g+"_"+c}}this._nodes=a}return this._nodes},getNodeId:function(a){if(!this._nodes){this.getNodeIds()}return this._nodes[a]},getNode:function(a){var b=this.getNodeId(a);return !b?null:$E(b)},_getUniqueID:function(){if(!this.uniqueID){this.uniqueID=parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()}return this.uniqueID}});CommentV2.Add=function(a){var a=a||{};this.tpl=a.tpl||"";this.url=a.url||"";this.type=a.type||"comment";this.data=a.data||"";this.jsonUtil=Utils.Json;this.leftB=Core.String.leftB;this.cutHtmlString=Core.String.cutHtmlString;this.loader=new Interface(this.url,"ijax");this.init()}.$define({init:function(){trace("CommentV2.Add.Init");if(!this.tpl){this.tpl=this.getTpl()}Lib.checkAuthor()},post:function(d,c,b){var a=this;if(!$isLogin){new Lib.Login.Ui().login(function(){scope.blogOpener.showDialog(function(){d.uid=$UID;d.login_name=scope.$loginNick||$nick;a.post(d,c,b)})});return}trace("CommentV2.Add.Post");trace(d);this.loader.request({POST:d,returnType:"json",onSuccess:function(g){trace("reply_add_succ");var j=g.comment_reply_data[0];j.action_data=a.obj2str({articleid:scope.$articleid,commentid:j.stair_cms_id,replyid:j.id,comm_uid:j.comm_uid,uname:j.uname,source_uid:j.source_uid,cms_body:j.cms_body,ulink:j.ria_index_url,source_ulink:j.source_ria_index_url,src_uid:j.src_uid});var f=a.render(j,-1,d.cms_reply_num);a.appendItem(f,j.stair_cms_id);if(c&&typeof c==="function"){c(g)}},onError:function(f){trace("reply_add_error");if(b&&typeof b==="function"){b(f)}},onFail:function(f){trace("reply_add_fail");if(b&&typeof b==="function"){b(f)}}})},render:function(o,j,g){var n=$C("li");n.className="SG_j_linedot1";o.cms_body=decodeURIComponent(o.cms_body);o.vimg=o.vimg?o.vimg:"";o.source_vimg=o.source_vimg?o.source_vimg:"";o.from="";if(o.fromProduct=="weibo"){var d='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif">';o.user_from_weibo='来自<a target="_blank" href="'+o.ulink+'">'+d+o.weibo_uname+"</a>的评论"}o.cms_reply_num=o.cms_reply_num?"("+o.cms_reply_num+")":"";o.show_more="none";o.moreInfo="";if(this.type==="comment"){o.god_comment=o.god==1?'<span class="god_reply">神评</span>':"";n.id="cmt_"+o.id;if(j===0){n.className=""}if(o.comm_uid==0){o.user_image_place='<img src="'+o.user_image+'">';o.user_nick_place=o.uname}else{o.user_image_place='<a href="'+o.ria_index_url+'" target="_blank"><img src="'+o.user_image+'"></a>';o.user_nick_place='<a href="'+o.ria_index_url+'">'+o.uname+"</a>"}if(o.fromProduct==="blog"){function c(q){var p=document.createElement("DIV");p.innerHTML=q;return p.textContent||p.innerText||""}var f=this.__getLen(c(o.cms_body));if(f>280){o.show_more="";o.moreInfo='<div class="SG_revert_Inner SG_txtb" id="body_cmt_full_'+o.id+'" style="display:none;">'+o.cms_body+'<a href="javascript:void(0);" class="btn_artsq" style="display:"";" action-type="comment_more" action-data="'+o.action_data+'"></a></div>';o.cms_body=this.cutHtmlString(o.cms_body,280)}}}else{if(this.type==="reply"){n.id="reply_"+o.id;if(g>=1&&j===(g-1)){n.className=""}if(g==0&&j==-1){n.className=""}if(o.source_uid==0){o.soure_user_info="&nbsp;"+o.source_uname+"&nbsp;："}else{o.soure_user_info='&nbsp;<a href="'+o.source_ria_index_url+'" target="_blank">'+o.source_uname+"</a>"+o.source_vimg+"："}}}if($UID&&(o.comm_uid==$UID||o.src_uid==$UID)){o.show_del=""}else{o.show_del="none"}if(o.fromProduct!="qing"){o.show_report=""}else{o.show_report="none"}var m=new Date();var b=new Date(o.cms_pubdate.replace(/-/g,"/"));o.cms_pubdate=this.dateFormat(m,b);var a=new Lib.HtmlTemplate(this.tpl).evaluate(o);n.innerHTML=a;return n},appendItem:function(b,c){var a=$E("comment_"+c+"_replylist");a.insertBefore(b,a.firstChild);a.style.display=""},getTpl:function(){if(this.type==="comment"){return'<div class="SG_revert_Left">#{user_image_place}</div><div class="SG_revert_Cont"><p><span class="SG_revert_Tit">#{user_nick_place}#{god_comment}</span>#{vimg}</p><div class="SG_revert_Inner SG_txtb" id="body_cmt_#{id}">#{cms_body}<a href="javascript:void(0);" class="btn_artzk" style="display:#{show_more}" action-type="comment_more" action-data="#{action_data}"></a></div>#{moreInfo}<p class="myReFrom"><em class="SG_txtc">#{cms_pubdate}</em>#{user_from_weibo}<span class="SG_revert_Func"><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_report" action-data="#{action_data}" style="display:#{show_report}"><cite>举报</cite></a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_share" action-data="#{action_data}" style="display:#{show_share}"><cite>分享</cite></a><a href="javascript:void(0);" class="SG_a_fucs" action-type="comment_reply" action-data="#{action_data}" style="display:#{show_reply}"><cite>回复#{cms_reply_num}</cite></a></span></p><div class="SG_reply" id="comment_#{id}" style="display:none;"></div></div>'}else{return'<div class="img"><a href="#{ria_index_url}" target="_blank"><img src="#{user_image}"></a></div><div class="txt"><p'+($FF?' style="white-space:pre-wrap;"':"")+'><a href="#{ria_index_url}" target="_blank">#{uname}</a>#{vimg}&nbsp;回复#{soure_user_info}#{cms_body}(#{cms_pubdate})</p></div><div class="links"><a href="javascript:void(0);" action-type="reply_report" action-data="#{action_data}" style="display:#{show_report}">举报</a><a href="javascript:void(0);" action-type="reply_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" action-type="reply_share" action-data="#{action_data}" style="display:#{show_share}">分享</a><a href="javascript:void(0);" class="links_s" action-type="reply_reply" action-data="#{action_data}" style="display:#{show_reply}">回复</a></div>'}},__getLen:function(d){if(!d){return 0}var c=d.match(/[^\x00-\xff]/g);return d.length+(c?c.length:0)},obj2str:function(a){return encodeURIComponent(this.jsonUtil.flatten(a))},str2obj:function(str){return this.jsonUtil.eval(decodeURIComponent(str))},dateFormat:function(s,o){var g="月";var u="日";var b="今天";var q="秒前";var j="分钟前";var a=s.getFullYear();var r=o.getFullYear();var t=s.getMonth()+1;var p=o.getMonth()+1;var f=s.getDate();var d=o.getDate();var m=s.getHours();var c=o.getHours();if(c<10){c="0"+c}c="&nbsp;"+c;var n=o.getMinutes();if(n<10){n="0"+n}var v=s-o;v=v>0?v:0;v=v/1000;if(a!=r){return r+"-"+p+"-"+d+" "+c+":"+n}else{if(t!=p||f!=d){return p+g+d+u+c+":"+n}else{if(m!=c&&v>(60*60)){return b+c+":"+n}else{if(v<51){v=v<1?1:v;return(Math.floor((v-1)/10)+1)+"0"+q}else{return Math.floor((v/60)+1)+j}}}}return""}});Core.Dom.opacity=function(b,a){b=typeof b=="string"?$E(b):b;b.style.filter="alpha(opacity="+a+")";b.style.opacity=a/100};Core.Dom.insertAfter=function(c,b){var a=b.parentNode;if(a.lastChild==b){a.appendChild(c)}else{a.insertBefore(c,b.nextSibling)}return c};Core.Dom.wrap=function(c,a){var b=$C(a);Core.Dom.insertAfter(b,c);b.appendChild(c);return b};Ui.Slide=Core.Class.create();Ui.Slide.prototype={node:null,container:null,status:"show",offset:0,onSlideIn:new Function(),onSlideOut:new Function(),initialize:function(b,a){var a=a||{};this.node=$E(b);this.container=Core.Dom.wrap(this.node,"div");this.container.style.overflow="hidden";this.offset=this.node.offsetHeight;this.opacity=true;this.animation=a.animation||"strongEaseOut";this.duration=a.duration||1;this.container.style.height=this.offset+"px";this.node.style.marginTop="0px"},slideIn:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",1,this.duration,this.animation,{})}new Ui.tween(this.container,"height",this.offset,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(b){}.bind2(this),end:this.onSlideIn})},slideOut:function(a){a=a||{};if(this.opacity){new Ui.tween(this.node,"opacity",0,this.duration,this.animation,{})}new Ui.tween(this.container,"height",0,this.duration,this.animation,a);new Ui.tween(this.node,"marginTop",-this.offset,this.duration,this.animation,{end:this.onSlideOut})},show:function(){if(this.opacity){}this.container.style.height=this.offset+"px";this.node.style.marginTop=0+"px"},hide:function(){if(this.opacity){}this.container.style.height=0+"px";this.node.style.marginTop=-this.offset+"px"}};CommentV2.Delete=function(a){Lib.checkAuthor()}.$define({deleteComment:function(d,c){trace("CommentV2.CommentDel.deleteComment");var b=this;var g=d.data;var a="",f="",j="确认需要删除此条评论？<br/>删除后不可恢复。";if($UID==g.comm_uid||g.comm_uid==0){a=' style="display:none" '}if(g.fromProduct!=="qing"){f="<div "+a+'><input id="cbAddToBlock_'+g.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+g.commentid+'">将此人加入黑名单</label></div>'}this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_post.php","ijax");winDialog.confirm(j,{subText:f,textOk:"删除",funcOk:function(){var m={POST:{article_id:g.articleid,cms_id:g.commentid,cms_uid:g.comm_uid,login_uid:$UID,inblack:$E("cbAddToBlock_"+g.commentid).checked?1:0},onSuccess:function(p){var o=$E("body_cmt_"+g.commentid).parentNode.parentNode;var n=new Ui.Slide(o);n.onSlideOut=function(){Core.Dom.removeNode(o)};n.slideOut();if(c&&typeof c==="function"){c(p)}},onError:function(n){b.showError(n)},onFail:function(n){b.showError(n)}};b.del_url.request(m)}})},deleteReply:function(d,c){trace("CommentV2.CommentDel.deleteReply");var b=this;var g=d.data;var a="",f="",j="确认需要删除此条回复？<br/>删除后不可恢复。";if($UID==g.comm_uid){a=' style="display:none" '}if(g.fromProduct!=="qing"){f="<div "+a+'><input id="cbAddToBlock_'+g.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+g.commentid+'">将此人加入黑名单</label></div>'}this.del_url=new Interface("http://control.blog.sina.com.cn/admin/comment_new/cms_del_usereply_post.php","ijax");winDialog.confirm(j,{subText:f,textOk:"删除",funcOk:function(){var m={POST:{article_id:g.articleid,cms_id:g.replyid,cms_uid:g.comm_uid,login_uid:$UID,source_uid:g.source_uid,stair_cmsid:g.commentid,inblack:$E("cbAddToBlock_"+g.commentid).checked?"1":"0"},onSuccess:function(p){var o=$E("reply_"+g.replyid);var n=new Ui.Slide(o);n.onSlideOut=function(){Core.Dom.removeNode(o)};n.slideOut();if(c&&typeof c==="function"){c(p)}},onError:function(n){b.showError(n)},onFail:function(n){b.showError(n)}};b.del_url.request(m)}})},showError:function(a){if(a.code=="B00006"){return}winDialog.alert(($SYSMSG[a.code]||"删除失败，请重试"),{icon:"02"})}});Core.String.decodeHTML=function(a){var b=document.createElement("div");b.innerHTML=a;return b.innerText==undefined?b.textContent:b.innerText};Utils.Form.Radio={};Utils.Form.Radio.get=function(a){if(!a){return""}var c=a.length;if(c==undefined){if(a.checked){return a.value}else{return""}}for(var b=0;b<c;b++){if(a[b].checked){return a[b].value}}return""};Utils.Form.Radio.set=function(a,c){if(!a){return}var d=a.length;if(d==undefined){a.checked=(a.value==c.toString());return}for(var b=0;b<d;b++){a[b].checked=false;if(a[b].value==c.toString()){a[b].checked=true}}};scope.reportMainTpl=['<div id="#{panel}" class="blog_report">','<div id="#{titleBar}" class="BRpt_topTit">','<a href="#" onclick="return false;" id="#{btnClose}" title=""><img src="http://simg.sinajs.cn/blog7style/images/common/report/icon_clo.gif" /></a>',"</div>",'<div id="#{content}" class="BRpt_mid">',"</div>","</div>"].join("");scope.reportStartTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_RtConn">','<p id="#{resumeInfo}" class="Brpt_RtInf"></p>','<textarea id="#{resumeContent}" readonly="readonly" class="Brpt_RtTxt"></textarea>','<p class="Brpt_Rhost"><input type="checkbox" id="#{cbBlogHost}" /><label for="#{cbBlogHost}">同时举报博主</label></p>','<div class="clear"></div>','<div class="Brpt_choCla">','<p class="claTit">请选择您举报类别（<span class="cho">必选</span>）：</p>','<p class="cla_conn">','<input id="ero" value="1" type="radio" name="chocla" /><label for="ero">色情</label>','<input id="pol" value="2" type="radio" name="chocla" /><label for="pol">政治</label>','<input id="adv" value="5" type="radio" name="chocla" /><label for="adv">广告</label>','<input id="oth" value="4" type="radio" name="chocla" /><label for="oth">其他</label>',"</p>",'<p>对部分内容(个人侵权、企业侵权等)的举报投诉，请拨打新浪网客服电话4006900000，转人工服务、索取《新浪网删帖申请文档》并提供相关证明材料。<br/><span style="color:red;">新浪网删帖不收取任何费用</span></p>',"</div>",'<p class="Brpt_othInt">您可以填写更多举例说明：</p>','<textarea id="#{reportReason}" class="Brpt_RtTxt"></textarea>',"</div>",'<div class="Brpt_RCBtn">','<a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a>','<a class="BRpt_btn" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>取消</span></a>','<div class="clearit"></div>',"</div>"].join("");scope.reportBadTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_exclt">','<p class="Brpt_extP1">您已经成功举报了该信息，工作人员会尽快处理。</p>','<p class="Brpt_extP2">再次感谢您对新浪博客的支持！</p>','<div class="Brpt_extBtn"><a class="BRpt_btn" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>',"</div>"].join("");scope.reportSuccessTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_extRst">','<p class="Brpt_eRTit">举报完成！感谢您对我们工作的支持，我们将在24小时内处理。</p>','<div class="Brpt_eRmtd">','<p class="tit">您还可以：</p>','<div class="conn">','<p class="mtd">','<input type="checkbox" id="#{cbCustom}"/>','<label for="#{cbCustom}">我是新浪博客用户，我要接收处理结果</label><span id="#{guestText}">(您还没有登录)</span>',"</p>","</div>",'<div class="conn2">','<p class="mtd"><input type="checkbox" id="#{cbOtherMethod}" /><label for="#{cbOtherMethod}">我要通过其他方式接收处理结果</label></p>','<div id="#{userForm}" style="display:none;">','<p class="perInf"><span>您的姓名：</span><input id="#{userName}" type="text" /></p>','<p class="perInf"><span>您的邮箱：</span><input id="#{userEmail}" type="text" /></p>','<p class="perInf"><span>您的电话：</span><input id="#{userTel}" type="text" /></p>',"</div>","</div>","</div>",'<div class="Brpt_eRBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>'].join("");scope.reportFinishedTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_thx">',"<p>再次感谢您对新浪博客举报的大力支持！</p>",'<div class="Brpt_thxBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>关闭</span></a></div>',"</div>"].join("");scope.GeneralReport=Core.Class.create();scope.GeneralReport.prototype={type:"",_hashType:{comment:{"class":"2",initFunction:null},blog:{"class":"1",initFunction:null},guestBook:{"class":"3",initFunction:null},friend:{"class":"4",initFunction:null},photoComment:{"class":"5",initFunction:null},paperlist:{"class":"6",initFunction:null}},dataInterface:null,canSubmit:true,bodyID:"",reportUID:"",userNameInfo1:"",userNameInfo2:"",titleInfo:"",nickName:"",contentInfo:"",tUID:"",_isInitDialog:false,_dialog:null,initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_content.php?version=7","ijax");this._hashType.comment["initFunction"]=this._commentInit;this._hashType.blog["initFunction"]=this._blogInit;this._hashType.guestBook["initFunction"]=this._guestBookInit;this._hashType.friend["initFunction"]=this._friendInit;this._hashType.photoComment["initFunction"]=this._photoCommentInit;this._hashType.paperlist["initFunction"]=this._paperlistInit},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true;this._hashType[this.type]["initFunction"].call(this)},hidden:function(){this._dialog.hidden()},clear:function(){var a=this._dialog.nodes;a.resumeInfo.innerHTML="";a.resumeContent.value="";a.cbBlogHost.checked=false;Utils.Form.Radio.set($N("chocla"),"");a.reportReason.value=""},submit:function(){var a=this;this.dataInterface.request({POST:{body_id:a.bodyID,"class":a._hashType[a.type]["class"],type:Utils.Form.Radio.get($N("chocla")),fnickname:a.nickName,fuid:a.reportUID,tuid:a.tUID,reason:a._dialog.nodes.reportReason.value,is_report:a._dialog.nodes.cbBlogHost.checked},onSuccess:function(b){a.canSubmit=true;a.onSuccessed(b)},onError:function(b){a.canSubmit=true;a.onError(b)},onFail:function(){a.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportStartTpl});var a=this,b=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){a.clear()});Core.Events.addEvent(b.btnOk,function(){if(a.canSubmit){a.canSubmit=false;a.submit()}},"click");Core.Events.addEvent(b.btnCancel,function(){a._dialog.hidden()},"click");Utils.Form.limitMaxLen(b.reportReason,400)},_commentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在博文"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=false},_blogInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"发表的"+this.titleInfo+"，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=false},_guestBookInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在"+this.userNameInfo2+"博客的留言，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=false},_friendInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发的好友申请，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=true},_photoCommentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在图片"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=false},_paperlistInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发送的纸条，摘要如下：";this._dialog.nodes.resumeContent.value=this.contentInfo;this._dialog.nodes.cbBlogHost.checked=false},onSuccessed:function(a){},onError:function(a){}};Utils.Form.inputListen=function(b,d,g){b=$E(b);if(typeof d!="undefined"){d=isNaN(d)?null:d*1}if(b==null||d==null||b.nodeType!=1){return false}g=g||{};var f=g.limitRe;var a=g.doubleByte;a=a==null?true:a;var j=function(){try{var m=Core.Events.getEvent();if(m){var q=m.which||m.keyCode;if(q==37||q==39){return false}}}catch(o){}var n=b.max;while(f!=null&&f.test(b.value)){b.value=b.value.replace(f,"")}if(a==true){if(Core.String.byteLength(b.value)>n){var p=b.value.substr(0,n);while(Core.String.byteLength(p)>n){p=p.replace(/.$/,"")}b.value=p;b.maxLength=p.length}else{b.maxLength=n-b.value.replace(/[\x00-\xff]/g,"").length}}else{b.maxLength=n}if(n<b.value){b.value=b.value.substr(0,n)}};var c=function(){if(f!=null&&f.test(b.value)){b.value=b.value.replace(f,"")}};b.max=d;b.maxLength=d;j();if(b.beWatched==null){b.beWatched=true;if(!$IE){Core.Events.addEvent(b,j,"input")}else{Core.Events.addEvent(b,j,"keyup");Core.Events.addEvent(b,j,"keypress");Core.Events.addEvent(b,j,"mouseout")}Core.Events.addEvent(b,c,"blur")}};scope.SuccessedReport=Core.Class.create();scope.SuccessedReport.prototype={loginUI:null,_isInitDialog:false,canSubmit:true,dataInterface:null,dataID:"",bodyID:"",userInfo:{nickName:""},initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_userinfo.php?version=7","ijax");this.loginUI=new Lib.Login.Ui()},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true},displayUserInfo:function(a){this._dialog.nodes.userForm.style.display=a===false?"none":""},login:function(){var a=this;this.loginUI.login(function(){a.submit()})},clear:function(){var a=this._dialog.nodes;a.cbCustom.checked=false;a.cbOtherMethod.checked=false;a.userForm.style.display="none";a.userName.value="";a.userEmail.value="";a.userTel.value=""},hidden:function(){this._dialog.hidden()},submit:function(){var a=this,b=this._dialog.nodes;Lib.checkAuthor();a.canSubmit=false;this.dataInterface.request({POST:{id:a.dataID,body_id:a.bodyID,nickname:typeof($nick)=="undefined"?"":$nick,name:b.userName.value,email:b.userEmail.value,phone:b.userTel.value,uid:$UID,is_login:b.cbCustom.checked?"1":"0"},onSuccess:function(c){a.canSubmit=true;a.onSuccessed(c)},onError:function(c){a.canSubmit=true;a.onError(c)},onFail:function(){a.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportSuccessTpl});var a=this,b=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){a.clear()});Lib.checkAuthor();b.guestText.style.display=$isLogin?"none":"";Core.Events.addEvent(b.btnOk,function(){if(a.canSubmit){Lib.checkAuthor();if(!$isLogin&&b.cbCustom.checked){a.login()}else{a.submit()}}},"click");Core.Events.addEvent(b.cbOtherMethod,function(){a.displayUserInfo(b.cbOtherMethod.checked)},"click");Utils.Form.inputListen(b.userName,100);Utils.Form.inputListen(b.userEmail,200);Utils.Form.inputListen(b.userTel,100)},onSuccessed:function(a){},onError:function(a){}};$SYSMSG.extend({B04102:"您输入的电子邮件格式错误，请重新输入",B04105:"很抱歉，您输入的内容过多，请删减后重新提交",B04107:"您要举报的内容已经不存在，感谢您的支持",B04108:"举报分类错误",B04109:"您还没有选择举报类别，请选择后继续操作",B04110:"您的昵称为空，请输入后继续操作",B04111:"系统繁忙，请稍后再试",B04112:"您已经举报过该用户，再次感谢您的支持",B04113:"系统繁忙，请稍后再试",B04114:"系统繁忙，请稍后再试",B04115:"系统繁忙，请稍后再试",B04116:"系统繁忙，请稍后再试"});Lib.BlogReport=Core.Class.create();Lib.BlogReport.prototype={generalReport:null,successedReport:null,badReport:null,finishedReport:null,isBRInit:false,isFRInit:false,initialize:function(){this.generalReport=new scope.GeneralReport();this.successedReport=new scope.SuccessedReport()},start:function(g,j,c,n,o,p,d,b,m){var f=this,a=this.generalReport;b=Core.String.decodeHTML(b);a.nickName=j;a.type=g;a.reportUID=n;a.userNameInfo1=o;a.userNameInfo2=p;a.titleInfo=d;a.contentInfo=Core.String.byteLength(b)>800?Core.String.shorten(b,800):b;a.bodyID=c;a.tUID=m?m:"";a.onSuccessed=function(q){f.reportSuccess(j,c,q.dataID);this.hidden()};a.onError=function(q){if(q.code==="B04112"){f.showBad();this.hidden()}else{winDialog.alert($SYSMSG[q.code])}};a.show()},showBad:function(){var a=this;if(!this.isBRInit){this.badReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportBadTpl});Core.Events.addEvent(this.badReport.nodes.btnOk,function(){a.badReport.hidden()},"click")}this.badReport.setAreaLocked(true);this.badReport.setMiddle();this.badReport.show()},reportSuccess:function(f,a,d){var c=this,b=this.successedReport;b.bodyID=a;b.dataID=d;b.userInfo.nickName=f;b.onSuccessed=function(g){c.finished();this.hidden()};b.onError=function(g){winDialog.alert($SYSMSG[g.code])};b.show()},finished:function(){var a=this;if(!this.isFRInit){this.finishedReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportFinishedTpl});Core.Events.addEvent(this.finishedReport.nodes.btnCancel,function(){a.finishedReport.hidden()},"click")}this.finishedReport.setAreaLocked(true);this.finishedReport.setMiddle();this.finishedReport.show()}};CommentV2.Report=function(){this.BR=new Lib.BlogReport();this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload")}.$define({commentReport:function(a){trace("CommentV2.Report.commentReport");var b={cms_id:a.commentid,uid:a.src_uid};this.setReport(a,b)},replyReport:function(a){trace("CommentV2.Report.replyReport");var b={cms_id:a.replyid,uid:a.src_uid};this.setReport(a,b)},setReport:function(f,b){var p=this;var o=scope.$articleid,a=f.commentid,d=o+"_"+a,g=f.uname,j=f.comm_uid,m="",n="",c='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+o+'.html">'+$E("t_"+o).innerHTML+"</a>";f.ulink=f.ulink?f.ulink:"http://blog.sina.com.cn/u/"+f.comm_uid;if(f.comm_uid!=0){m='<a href="'+f.ulink+'" target="_blank">'+g+"</a>"}else{m="<strong>"+g+"</strong>"}this.getInterface.request({GET:b,onSuccess:function(q){var r=q.cms_body;p.BR.start("comment",g,d,j,m,n,c,r)},onError:function(q){},onFail:function(){}})}});CommentV2.Share=function(){trace("CommentV2.Share");this.shorten=Core.String.shorten;this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");this.getWeiboNameInterface=new Interface("http://i2.api.weibo.com/2/users/show.json","jsload")}.$define({commentShare:function(b){var a=this;this.data=b||{};this.__commentShare()},replyShare:function(d){var b=this;this.data=d||{};this.type="reply";var a=this.data.replyid;var c=this.data.src_uid;this.__getCmsBody(a,c)},__getCmsBody:function(a,c){var b=this;var d={cms_id:a,uid:c,origin:1};this.getInterface.request({GET:d,onSuccess:b.__getWeiboName.bind2(b),onError:function(f){},onFail:function(){}})},__getWeiboName:function(b){var a=this;this.body=b.cms_body;this.uid=b.uid;this.src_title=b.src_title;window.jsonpweiboname=function(d){if(d.code==1&&d.data){a.name=encodeURIComponent("@"+d.data.name)}else{a.name=encodeURIComponent(" "+a.data.uname)||""}a.__share()};var c={uid:this.uid,source:"1617465124",callback:"jsonpweiboname"};this.getWeiboNameInterface.request({GET:c,onSuccess:function(){},onError:function(){},onFail:function(){}})},__share:function(){var m=this.body;if(this.type==="comment"){if(this.data.fromProduct==="blog"){var p=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var c=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;m=m.replace(p,"[$2]");m=m.replace(c,"[$3]")}else{var g=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/ig;m=m.replace(g,"[$1]")}}m=encodeURIComponent(this.shorten(m,100));var b=encodeURIComponent(location.href);var j=encodeURIComponent(this.src_title)||encodeURIComponent($E("t_"+scope.$articleid).innerHTML);var o="分享"+this.name+" 对博文【"+j+"】的评论："+m+" 查看原文：";var q=encodeURIComponent(o);var n="http://v.t.sina.com.cn/share/share.php?",a="新浪-博客",d="http://blog.sina.com.cn",s="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+q+"&url="+encodeURIComponent(document.location)+"&source="+a+"&sourceUrl="+encodeURIComponent(d)+"&content=utf-8&appkey=1617465124";window.open(s,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)},__commentShare:function(){var p=$E("t_"+scope.$articleid).innerHTML;p=p.replace(/\&nbsp\;/g," ");var b=this.data.commentid;var g=$E("body_cmt_"+b);var m,c;if(typeof g.innerText==="string"){m=g.innerText}else{m=g.textContent}if(this.data.fromProduct==="blog"){var o=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var d=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;m=m.replace(o,"[$2]");m=m.replace(d,"[$3]");c=" "+this.data.uname}else{var j=/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/ig;m=m.replace(j,"[$1]");c="@"+this.data.uname}m=this.shorten(m,100);p=this.shorten(p,60);var n="分享"+c+" 对博文【"+p+"】的评论："+m+" 查看原文：";var s=encodeURIComponent(n),a="新浪-博客",f="http://blog.sina.com.cn",q="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+s+"&url="+encodeURIComponent(document.location)+"&source="+a+"&sourceUrl="+encodeURIComponent(f)+"&content=utf-8&appkey=1617465124";window.open(q,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}});CommentV2.ReplyList=function(a){this.type="reply";this.cmtAdd=new CommentV2.Add({type:this.type,url:"http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_post.php?domain=2",tpl:a.replyTpl||""});this.ownerNickName=a.data.ownerNickName||"";this.cmtDel=new CommentV2.Delete();this.cmtReport=new CommentV2.Report();this.cmtShare=new CommentV2.Share();this._openAreas={}}.$extends(CommentV2.List).$define({load:function(c){var a=this;this.initContainerAndTextArea();this.show();if(this.data.cms_reply_num==0){return}this.showLoading();this.page=c;var b={article_id:this.articleid,comment_id:this.data.commentid,page:this.page};this.url="http://control.blog.sina.com.cn/admin/comment_new/cms_usereply_list.php?domain=2";this.loader=new Interface(this.url,"ijax");this.loader.request({POST:b,returnType:"json",onSuccess:a.render.bind2(a),onError:function(d){trace("reply list onerror");this.error(d.code)}.bind2(a),onFail:function(d){trace("reply list onfail");this.error(d.code)}.bind2(a)})},render:function(a){this.renderList(a);this.paging()},initContainerAndTextArea:function(a){if(this.containerIsReady){return}var b='<div class="SG_reply_con borderc"><div class="bd"><div id="comment_'+this.data.commentid+'_textarea"></div><div class="reply_list"><ul id="comment_'+this.data.commentid+'_replylist" style="display:none;"></ul></div><div class="rp2" id="loading_'+this.data.commentid+'" style="display:none"><div class="SG_reply_con"><div class="bd"><div class="loading"><span class="ico_loading"></span><p>正在加载，请稍后...</p></div></div></div></div><div class="SG_page" style="display:none;"><ul class="SG_pages" id="comment_'+this.data.commentid+'_pages"></ul></div></div></div>';this.containerNode.innerHTML=b;this.renderTextArea();this.containerIsReady=1},renderTextArea:function(){var b=new CommentV2.CommentArea({container:$E("comment_"+this.data.commentid+"_textarea")});var c=this.data;var d=$E("ownernick");var a=d?this.trim(d.innerHTML):"";b.setReplyData(this,{article_id:this.articleid,reply_cmsid:c.commentid,stair_cmsid:c.commentid,src_uname:this.data.ownerNickName||a,blog_title:$E("t_"+this.articleid)?this.trim($E("t_"+this.articleid).innerHTML):"",uid:$UID,source_uid:c.comm_uid,source_uname:c.uname,login_name:scope.$loginNick,is_t:0,source_ulink:c.ulink})},renderList:function(m){Lib.checkAuthor();if(m==""){this.error($isAdmin?"B36021":"B36020")}else{var c=document.createDocumentFragment();var b;this.total=m&&m.cms_usereply_totalnum;this.total=parseInt(this.total,10);this.hideLoading();if(this.total==0){this.show();return}var g=m.comment_reply_data;var a=g.length;var f=m.blog_id;for(var d=0;d<a;d++){var j=g[d];j.action_data=this.obj2str({articleid:f,commentid:j.stair_cms_id,replyid:j.id,comm_uid:j.comm_uid,uname:j.uname,source_uid:j.source_uid,ulink:j.ria_index_url,source_ulink:j.ulink,src_uid:j.src_uid});b=this.cmtAdd.render(j,d,a);c.appendChild(b)}$E("comment_"+this.data.commentid+"_replylist").appendChild(c);$E("comment_"+this.data.commentid+"_replylist").style.display="";location.hash="cmt_"+this.data.commentid}},show:function(){CommentV2.ReplyList.$super.show.call(this);v7sendLog("32_01_01");var a=this.node.innerHTML;a=a.replace(/回复|取消回复/,"取消回复");this.node.innerHTML=a},hide:function(){CommentV2.ReplyList.$super.hide.call(this);v7sendLog("32_01_02");var a=this.node.innerHTML;a=a.replace("取消","");this.node.innerHTML=a},showLoading:function(){$E("comment_"+this.data.commentid+"_replylist").innerHTML="";$E("loading_"+this.data.commentid).style.display=""},hideLoading:function(){$E("loading_"+this.data.commentid).style.display="none"},paging:function(){var c=this;var d=$E("comment_"+this.data.commentid+"_pages");if(d){var b=20,a=0;if(this.total%b==0){a=Math.ceil(this.total/b)}else{a=Math.floor(this.total/b)+1}if(this.total>b){d.parentNode.style.display="block";d.style.display="block";Ui.Pagination.init({pageNode:"comment_"+c.data.commentid+"_pages",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:a,pageTpl:function(f){c.load(f);location.hash=""}}).show()}else{d.parentNode.style.display="none"}}},setSrcComment:function(g,c,b){var d={cms_id:g,uid:c,origin:1};var f=this;var a=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");a.request({GET:d,onSuccess:function(o){var m=o.cms_body;var j=o.nick_name;var n=o.source_uname;if(m){var p="//@"+j+" 回复 @"+n+" :"+m;b.setValues({comment:p})}}.bind2(this),onError:function(j){if(j&&j.code){winDialog.alert($SYSMSG[j.code],{funcOk:function(){}})}},onFail:function(j){if(j&&j.code){winDialog.alert($SYSMSG[j.code],{funcOk:function(){}})}}})},reply:function(c){var b=this;if(!c.containerNode.isInited){v7sendLog("32_01_05");c.node.innerHTML="<cite>取消回复</cite>";var g='<div class="SG_reply_con"><div class="bd" id="reply_'+c.data.replyid+'_textarea"></div></div>';var j=document.createElement("div");j.className="SG_reply borderc rp2";j.innerHTML=g;j.id="reply_"+c.data.replyid+"_textcon";c.containerNode.appendChild(j);c.containerNode.isInited=true;var f=$E("reply_"+c.data.replyid+"_textarea");var d=c.data;this._openAreas[c.data.replyid]=new CommentV2.CommentArea({container:f,autolineheight:"yes",sid:new Date().getTime(),shownum:"no",okhandler:function(){var m=$E("reply_"+c.data.replyid+"_textcon");if(m){m.style.display="none";c.node.innerHTML="<cite>回复</cite>"}}});this._openAreas[c.data.replyid].setReplyData(b,{article_id:c.articleid,reply_cmsid:d.replyid,stair_cmsid:d.commentid,src_uname:this.ownerNickName,blog_title:$E("t_"+c.articleid).innerHTML,uid:$UID,source_uid:d.comm_uid,source_uname:d.uname,login_name:scope.$loginNick,is_t:0,source_ulink:d.source_ulink});this.setSrcComment(d.replyid,d.src_uid,this._openAreas[c.data.replyid])}else{var a=$E("reply_"+c.data.replyid+"_textcon");if(a.style.display=="none"){v7sendLog("32_01_05");a.style.display="";if(this._openAreas[c.data.replyid].getValue()==""){this.setSrcComment(c.data.replyid,c.data.src_uid,this._openAreas[c.data.replyid])}c.node.innerHTML="<cite>取消回复</cite>"}else{a.style.display="none";c.node.innerHTML="<cite>回复</cite>"}}},add:function(c,b,a){trace("CommentV2.ReplyList.add");trace(c);c.cms_reply_num=this.total;this.cmtAdd.post(c,function(){this.total++;var f=this.node.innerHTML;this.node.innerHTML=f.replace(/(\d+)/,this.total);var f=$E("c_"+this.articleid).innerHTML;var d=parseInt(/(\d+)/.exec(f)[0],10);d++;$E("c_"+this.articleid).innerHTML="("+d+")";b()}.bind2(this),a)},share:function(a){trace("CommentV2.ReplyList.share");v7sendLog("32_01_06");this.cmtShare.replyShare(a.data)},del:function(a){trace("CommentV2.ReplyList.del");v7sendLog("32_01_08");this.cmtDel.deleteReply(a,this.delSucc.bind2(this))},delSucc:function(b){this.total=this.total--?this.total:0;var c=this.node.innerHTML;this.node.innerHTML=c.replace(/(\d+)/,this.total);var c=$E("c_"+this.articleid).innerHTML;var a=parseInt(/(\d+)/.exec(c)[0],10);a=a--?a:0;$E("c_"+this.articleid).innerHTML="("+a+")";if(this.total==0){$E("comment_"+this.data.commentid+"_replylist").style.display="none"}},report:function(a){trace("CommentV2.ReplyList.report");v7sendLog("32_01_07");this.cmtReport.replyReport(a.data)}});CommentV2.CommentList=function(a){this.ownerNickName="";this.type="comment";this.defaultAnchor="#comment";this.replyList={};this.addEvent=Core.Events.addEvent;this.removeEvent=Core.Events.removeEvent;this.cmtAdd=new CommentV2.Add({type:this.type,tpl:a.commentTpl||""});this.cmtDel=new CommentV2.Delete();this.cmtReport=new CommentV2.Report();this.cmtShare=new CommentV2.Share();this.bindEvent()}.$extends(CommentV2.List).$define({load:function(b){var a=this;this.page=b;this.url=this.purl+"_"+this.page+".html?comment_v=articlenew";this.loader=new Interface(this.url,"ajax");this.loader.request({GET:{url_random:0},returnType:"json",onSuccess:a.render.bind2(a),onError:function(c){switch(c.code){case"B36020":case"B36021":case"A00001":this.error(c.code);break;default:this.showError(c.code);this.error("B36110");break}}.bind2(this),onFail:function(){this.error("B36110")}.bind2(this)})},render:function(g){Lib.checkAuthor();this.containerNode.innerHTML="";if(g==""){this.error($isAdmin?"B36021":"B36020");return}else{var c=document.createDocumentFragment();var b,f;this.total=g.comment_total_num;if(this.total==0){this.renderNoComment()}for(var d=0,a=g.comment_data.length;d<a;d++){f=g.comment_data[d];f.action_data=this.obj2str({commentid:f.id,articleid:scope.$articleid,fromProduct:f.fromProduct,comm_uid:f.comm_uid,uname:f.uname,ulink:f.ulink,src_uid:f.src_uid,cms_reply_num:f.cms_reply_num});b=this.cmtAdd.render(f,d);c.appendChild(b)}this.containerNode.appendChild(c)}this.anchor();this.paging();this.sendEvents(g)},sendEvents:function(a){Lib.Listener.notify("commentlist-isready",a);scope.$commentlistIsReady=1},renderNoComment:function(){this.containerNode.innerHTML='<li><div class="noCommdate"><span class="SG_txtb">做第一个评论者吧！ <img class="SG_icon SG_icon134" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="" align="absmiddle"><a href="#post">抢沙发&gt;&gt;</a></span></div></li>'},add:function(d){var c=d.item,b=d.fun;var a=this.cmtAdd.render(d.item);b(a)},del:function(a){trace("CommentV2.CommentList.del");this.cmtDel.deleteComment(a,this.delSucc.bind2(this))},delSucc:function(b){this.total=b&&b.staircms_total_num;var c=$E("c_"+scope.$articleid).innerHTML;var a=parseInt(/(\d+)/.exec(c)[0],10);a=a--?a:0;$E("c_"+scope.$articleid).innerHTML="("+a+")";if(this.total==0){this.renderNoComment()}else{if(this.containerNode.getElementsByTagName("li").length==0){this.page--;this.load(this.page)}}},reply:function(a){trace("CommentV2.CommentList.reply");var b=this;Lib.Uic.getNickName([scope.$uid],function(c){b.ownerNickName=c[scope.$uid]||"";a.replyTpl=b.replyTpl||"";a.data.ownerNickName=b.ownerNickName;var d=a.data.commentid;if(b.replyList[d]){b.replyList[d].toggle()}else{b.replyList[d]=new CommentV2.ReplyList(a)}})},report:function(a){trace("CommentV2.CommentList.report");this.cmtReport.commentReport(a.data)},share:function(a){trace("CommentV2.CommentList.share");this.cmtShare.commentShare(a.data)},more:function(b){trace("CommentV2.CommentList.more");var d=b.data.commentid;var c=$E("body_cmt_"+d);var a=$E("body_cmt_full_"+d);if(b.node.className=="btn_artzk"){v7sendLog("32_01_03");c&&(c.style.display="none");a&&(a.style.display="")}else{if(b.node.className=="btn_artsq"){v7sendLog("32_01_04");c&&(c.style.display="");a&&(a.style.display="none")}}},paging:function(){var c=this;var d=$E("commentPaging");if(d){var b=50,a=0;if(this.total%b==0){a=Math.ceil(this.total/b)}else{a=Math.floor(this.total/b)+1}if(this.total>b){d.parentNode.style.display="block";$E("commentPaging").style.display="block";Ui.Pagination.init({pageNode:"commentPaging",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:a,pageTpl:function(f){c.load(f)}}).show();d.onclick=this.sudaClick}else{d.parentNode.style.display="none"}}},sudaClick:function(a){var b=(a&&a.target)||(window.event&&window.event.srcElement);if(b&&b.tagName&&b.tagName.toLowerCase()=="a"){Lib.sendSuda(function(){try{SUDA.log("","blog_blogcomment_page")}catch(c){}})}else{return}},anchor:function(){var a=window.location.href;var b="#comment";var c=new RegExp("("+b+")\\d*");if(a.indexOf(b)!=-1){window.location.href=a.replace(c,"$1"+this.page)}else{if(this.page>1){window.location.href=b+this.page}}},showError:function(a){winDialog.alert(($SYSMSG[code]),{icon:"02"})}});Sina.pkg("Utils.Flash");if(typeof deconcept=="undefined"){var deconcept=new Object()}if(typeof deconcept.util=="undefined"){deconcept.util=new Object()}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object()}deconcept.SWFObject=function(f,d,r,j,n,p,s,g,a,m){if(!document.getElementById){return}this.DETECT_KEY=m?m:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(f){this.setAttribute("swf",f)}if(d){this.setAttribute("id",d)}if(r){this.setAttribute("width",r)}if(j){this.setAttribute("height",j)}if(n){this.setAttribute("version",new deconcept.PlayerVersion(n.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(p){this.addParam("bgcolor",p)}var b=s?s:"high";this.addParam("quality",b);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var o=(g)?g:window.location;this.setAttribute("xiRedirectUrl",o);this.setAttribute("redirectUrl","");if(a){this.setAttribute("redirectUrl",a)}};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?"expressinstall.swf":a;this.setAttribute("useExpressInstall",true)},setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var b;var c=this.getVariables();for(b in c){a[a.length]=b+"="+c[b]}return a},getSWFHTML:function(){var c="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}c='<embed pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';c+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var d=this.getParams();for(var a in d){c+=[a]+'="'+d[a]+'" '}var b=this.getVariablePairs().join("&");if(b.length>0){c+="flashvars="+b+'&realfull=1&moz=1"'}c+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}c='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';c+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var d=this.getParams();for(var a in d){c+='<param name="'+a+'" value="'+d[a]+'" />'}var b=this.getVariablePairs().join("&");if(b.length>0){c+='<param name="flashvars" value="'+b+'" />'}c+="</object>"}return c},write:function(b){if(this.getAttribute("useExpressInstall")){var c=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(c)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}var d=(typeof b=="string")?document.getElementById(b):b;var a=document.title;d.innerHTML=this.getSWFHTML();if(a!==document.title){document.title=a}return true}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var d=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){d=new deconcept.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var c=1;var b=3;while(c){try{b++;c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);d=new deconcept.PlayerVersion([b,0,0])}catch(f){c=null}}}else{try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");d=new deconcept.PlayerVersion([6,0,21]);c.AllowScriptAccess="always"}catch(f){if(d.major==6){return d}}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(c!=null){d=new deconcept.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(","))}}}return d};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};deconcept.util={getRequestParameter:function(d){var c=document.location.search||document.location.hash;if(d==null){return c}if(c){var b=c.substring(1).split("&");for(var a=0;a<b.length;a++){if(b[a].substring(0,b[a].indexOf("="))==d){return b[a].substring((b[a].indexOf("=")+1))}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var b=document.getElementsByTagName("OBJECT");for(var c=b.length-1;c>=0;c--){b[c].style.display="none";for(var a in b[c]){if(typeof b[c][a]=="function"){b[c][a]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject;Core.Dom.getTop=function(a){var c=0;var b=$E(a);if(typeof b.offsetParent!="unknown"){while(b.offsetParent){c+=b.offsetTop;b=b.offsetParent}}else{if(b.y){c+=b.y}}return c};Core.Dom.getLeft=function(a){var c=0;var b=$E(a);if(typeof b.offsetParent!="unknown"){while(b.offsetParent){c+=b.offsetLeft;b=b.offsetParent}}else{if(b.x){c+=b.x}}return c};Lib.applyIf=function(d,a,c){if(c){Lib.applyIf(d,c)}if(d&&a&&Lib.isObject(a)){for(var b in a){if(a.hasOwnProperty(b)&&!d[b]){d[b]=a[b]}}}return d};Lib.isObject=function(a){return Object.prototype.toString.call(a)==="[object Object]"};Lib.apply=function(g,c,f,a,b){if(f){Lib.applyIf(g,f)}for(var d in c){if(b&&g[d]&&!Lib.isObject(g[d])){continue}if(c.hasOwnProperty(d)){if(a&&Lib.isObject(c[d])){g[d]=Lib.apply(g[d]||{},c[d],a,b)}else{g[d]=c[d]}}}return g};Lib.Panel=Core.Class.create();Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:false,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(a){Lib.apply(this,a);var b=this;this.uniqueID=this._getUniqueID();this._ie6Fixed=function(){if(b.entity){b.entity.style.left=document.documentElement.scrollLeft+b.x+"px";b.entity.style.top=document.documentElement.scrollTop+b.y+"px"}if(b.backIframe){b.backIframe.style.left=b.entity.style.left;b.backIframe.style.top=b.entity.style.top}}},getNode:function(a){return this.tpl.getNode(a)},setTemplate:function(a){this.template=a;if(this.entity&&this.entity.parentNode){this.entity.parentNode.removeChild(this.entity);this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)}this.entity=$C("div");var c=$C("div");var b=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=b;c.innerHTML=b.getHtmlString();c.style.display="none";if(this.appendTo){$E(this.appendTo).appendChild(c)}else{document.body.appendChild(c)}this.entity=$E("_"+this.uniqueID+"_panel");if(this.isPostion){this.entity.style.position="absolute"}this.entity.style.display="none";if(this.appendTo){$E(this.appendTo).replaceChild(this.entity,c)}else{document.body.replaceChild(this.entity,c)}c=null;if(!this.noIframe){this.backIframe=$C("iframe");this.backIframe.style.display="none";this.backIframe.style.border="none";this.backIframe.style.zIndex=this.entity.style.zIndex-1;document.body.appendChild(this.backIframe);this._updateBackIframe()}},setPosition:function(a,b){this.x=a;this.y=b;this.entity.style.left=a+"px";this.entity.style.top=b+"px";if($IE6&&this.isFixed){this.entity.style.left=a+document.documentElement.scrollLeft+"px";this.entity.style.top=b+document.documentElement.scrollTop+"px"}if(this.backIframe){this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top}},setFixed:function(a){this.isFixed=a;if($IE6){var b=this;this.entity.style.position="absolute";if(this.isFixed){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}return}this.entity.style.position=this.isFixed?"fixed":"absolute";if(this.backIframe){this.backIframe.style.position=this.entity.style.position}},show:function(){this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none";this.isHidden=!0;this.isShow=!1;if(this.backIframe){this.backIframe.style.display="none"}},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.backIframe){this.backIframe.parentNode.removeChild(this.backIframe);this.backIframe=null}},showWithDom:function(d,b,c){var a=Core.Dom.getLeft(d)+d.offsetWidth+b;var f=Core.Dom.getTop(d)+d.offsetHeight+c;if($IE6&&this.isFixed){a=a-document.documentElement.scrollLeft;f=f-document.documentElement.scrollTop}this.setPosition(a,f);this.show()},getWidth:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=a;this.entity.style.visibility=b;return w},getHeight:function(){var a=this.entity.style.display;var b=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=a;this.entity.style.visibility=b;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(j){var b=j||"o";var a=/[^\{\}]+(?=\})/g;var d;var c={};var g=this.template.match(a);if(g){for(d=0;d<g.length;d++){var f=g[d];switch(b){case"o":c[f]=$E("_"+this.uniqueID+"_"+f);break;case"i":c[f]="_"+this.uniqueID+"_"+f;break}}}return c},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0);this.backIframe.style.display="";this.backIframe.style.position=this.entity.style.position;this.backIframe.style.width=this.entity.offsetWidth+"px";this.backIframe.style.height=this.entity.offsetHeight+"px";this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(Math.random()*1000).toString()+(new Date).getTime().toString()}};var showUpTips=function(){winDialog.alert('您可以在<a href="http://get.adobe.com/flashplayer/" target="_blank">此处下载免费的Adobe flash player installer</a>。成功安装程序后，可返回此处查看。',{icon:"01"})};scope.magicCfg={};window.$magicFacePlay=function(b){var g;if(!scope.flashVersion){scope.flashVersion=deconcept.SWFObjectUtil.getPlayerVersion()}g=scope.flashVersion;if(g.major<9){showUpTips();return}Core.Events.stopEvent();var j={alphaNodeId:"alphaNode",containerDiv:"magicFaceCon"};var d=['<div id="magicFaceCon" title="" alt="" style="height:360px; width:360px;">',"</div>"].join("");scope.magicCfg.layer=new Lib.Panel();scope.magicCfg.layer.setTemplate('<div style="position:absolute;z-index:2000;" id="#{panel}" title="" alt="">'+d+"</div>");scope.magicCfg.layer.show();var c="magicFace";var f=function(){scope.magicCfg.shadow=new BackShadow(0.4);scope.magicCfg.shadow.entity.setAttribute("title","点击关闭动画");scope.magicCfg.shadow.entity.setAttribute("alt","点击关闭动画");scope.magicCfg.shadow.entity.onclick=m;Core.Events.addEvent(document,n,"keydown");scope.magicCfg.shadow.show();var t=Core.System.winSize();var s=Core.System.getScrollPos(document);var q=t.width/2-360/2+s[1];var p=t.height/2-360/2+s[0];scope.magicCfg.layer.setPosition(q,p);var o=document.createElement("div");o.id="___flashOverlay";o.style.cssText="cursor:pointer;visibility:hidden;background:white;;z-index:3000;position:absolute;width:360px;height:360px;top:"+p+"px;left:"+q+"px";document.body.appendChild(o);if(document.all){o.style.filter="Alpha(Opacity=0)"}else{o.style.opacity=0}o.style.visibility="visible";Core.Events.addEvent(o,function(){window.open("http://blog.sina.com.cn/myshow2010")});o=null;var r=new Utils.Flash.swfObject("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/"+b+"?t="+Core.Math.getUniqueId(),c,360,360,9,"#FFFFFF");r.addParam("quality","high");r.addParam("wmode","transparent");r.addParam("allowScriptAccess","always");r.write(j.containerDiv)};var m=function(){trace("swf remove!!!");var o=$E(j.containerDiv);if(o){o.innerHTML=""}window.clearInterval(a);Core.Events.removeEvent(document,n,"keydown");try{scope.magicCfg.shadow.close();scope.magicCfg.layer.close();Core.Events.stopEvent()}catch(p){}if($E("___flashOverlay")){document.body.removeChild($E("___flashOverlay"))}};var n=function(p){var o=p.keyCode||p.which||p.charCode;if(o===27){m();Core.Events.removeEvent(document,n,"keydown");Core.Events.stopEvent();return false}};f();var a=window.setInterval(function(){trace("……追踪 进度……");var s=$E(c);var o=0;if(s&&s.PercentLoaded()==100){s.onclick=function(){Core.Events.stopEvent()};trace("swf 加载完毕了………………");var p=s.parentNode;var t=Core.System.getScrollPos(document);var u=Core.System.winSize();var r=u.width/2-p.offsetWidth/2+t[1];var q=u.height/2-p.offsetHeight/2+t[0];scope.magicCfg.layer.setPosition(r,q);scope.magicCfg.layer.show();trace("flash size x="+p.offsetWidth+"  y="+p.offsetHeight);window.clearInterval(a);a=window.setInterval(function(){var z=s.CurrentFrame();var v;try{v=s.TotalFrames()}catch(y){v=s.TotalFrames}if(z<0){return}if(z<v&&o<=z){o=z}else{m()}},80)}},100)};$registJob("articleCommentV2",function(){Lib.LazyLoad([$E("article_comment_list")],{callback:function(){if(!scope.$comment_is_load_page_1&&scope.$private.cms!=1&&scope.$isCommentAllow!=1){var a=new CommentV2.CommentList({purl:"http://blog.sina.com.cn/s/comment_"+scope.$articleid,containerNode:$E("article_comment_list")})}}})});if(typeof App=="undefined"){var App={}}$ScriptLoader={callback:{},response:function(d,b){var m=(scope.$uid*1).toString(16);var s=m.length;if(8>s){for(var g=0,o=8-s;g<o;g++){m="0"+m}}var q={};for(var u in b){q[m+"01"+u]=b[u]}this.callback[d].func(q);var j=scope.$pageid;if(j=="article_new"||j=="articleM_new"||j=="article"||j=="articleM"||!j.indexOf("articletj")){var c=scope.useNewInterfaceToGetNum;if(!c){scope.useNewInterfaceToGetNum={};c=scope.useNewInterfaceToGetNum}var p=0;for(var r in b){p=b[r]["d"];break}if(c){var t="digg_m_"+scope.$articleid;var f={};f[t]=p;if(c.onSuccess){c.onSuccess(f)}else{var n=0;var a=setInterval(function(){if(n>300){clearInterval(a);if(c&&c.onException){c.onException(f)}return}if(c&&c.onSuccess){clearInterval(a);c.onSuccess(f)}n++},100)}}}}};App.getArticlesDetailNumber=function(o,d,f){if(d==null||d.length==0){return{}}o=o||scope.$uid;var j=(scope.$uid*1).toString(16);var q=j.length;if(8>q){for(var g=0,n=8-q;g<n;g++){j="0"+j}}var p=[];Core.Array.foreach(d,function(r){p.push(r.replace(j+"01",""))});var c=$C("script");var m=Math.ceil(Math.random()*10000);while($ScriptLoader.callback[m]!=null){m=Math.ceil(Math.random()*10000)}var b="aritlces_number_"+m;$ScriptLoader.callback[b]={func:f,uid:o};var a="http://comet.blog.sina.com.cn/api?maintype=num&uid="+j+"&aids="+p.join(",")+"&requestId="+b;if(scope.$pageid=="indexM"||scope.$pageid=="index"){a+="&fetch=r,c,z,f"}if(scope.$pageid=="articlelist"||scope.$pageid=="articlelistM"){a+="&fetch=c,r"}c.src=a;c.charset="utf-8";c.onload=c.onerror=c.onreadystatechange=Core.Function.bind2(function(){if(c&&c.readyState&&c.readyState!="loaded"&&c.readyState!="complete"){return}c.onload=c.onreadystatechange=c.onerror=null;c.src="";c.parentNode.removeChild(c);c=null},this);document.getElementsByTagName("head")[0].appendChild(c)};$registJob("articleNumberV2",function(){Lib.checkAuthor();if(scope.$pn_x_rank=="1"&&!$isAdmin){return false}var b=scope.$uid;var a=scope.$articleid;App.getArticlesDetailNumber(b,[a],function(c){var f=c[a];for(var d in f){if(scope.$pageid==="articletjTech"){if(d==="c"){$E("comment_tj_"+a).innerHTML="评论("+f[d]+")"}}if($E(d+"_"+a)){$E(d+"_"+a).innerHTML="("+f[d]+")"}}if(scope.$pageid==="articleM"&&f.z){$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=f.z)}})});Core.Events.fireEvent=function(b,c){var a;b=$E(b);if(b.fireEvent){b.fireEvent("on"+c)}else{if($MOBILE){a=document.createEvent("HTMLEvents")}else{a=document.createEvent("MouseEvents")}a.initEvent(c,true,true);b.dispatchEvent(a)}};scope.faceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");Lib.Face=Core.Class.create();Lib.Face.prototype={dialog:null,dialogNodes:null,tabs:null,faceConfig:null,template:null,txtContentArea:null,x:0,y:0,isShowed:false,_isInitDialog:false,insertImageFile:"",initialize:function(b,a){var c=this;this.txtContentArea=b;this.template=a;window.$insertFace=function(f,d){c.insertFace(f,d)}},load:function(){var a=this;this.dialog=new Dialog(this.template||scope.faceTemplate);this.dialogNodes=this.dialog.getNodes();this.tabs=new Tabs(this.dialogNodes.faceTab);Core.Events.addEvent(this.dialog.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(document.body,function(){a.hidden()},"mousedown");this.initFaceConfig(function(){if(a.tabs.tabsArr[0]){a.tabs.tabsArr[0].setFocus()}Core.Events.addEvent(a.dialogNodes.btnClose,function(){a.hidden()},"mousedown");a.onInitialized()});this._isInitDialog=true},initFaceConfig:function(a){var b=this;Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig&"+(new Date()).getTime(),{onComplete:function(c){b.faceConfig=c;b.initFaceData();if(a){a()}},charset:"gb2312"})},initFaceData:function(){var a,b=this;for(a in this.faceConfig){this.addTab(a,this.faceConfig[a]["name"],this.faceConfig[a]["data"])}},onInitialized:function(){},textWatchOn:function(){var a=this.txtContentArea;var b=function(){if(a.createTextRange){a.caretPos=document.selection.createRange().duplicate()}};Core.Events.addEvent(a,b,"keyup");Core.Events.addEvent(a,b,"focus");Core.Events.addEvent(a,b,"select");Core.Events.addEvent(a,b,"click")},addTab:function(b,a,d){var f=this;var c=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+b+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+a+"</a></span><em>("+d.length+")</em>",{isFocus:false,className:"cur"});c.addOnAbort(function(){c.content.style.display="none"});c.addOnFocus(function(){if(!c.isShowed){c.isShowed=true;c.content=$C("ul");c.content.innerHTML=f._getTabContent(b,d);f.dialogNodes.faceContent.appendChild(c.content)}c.content.style.display=""});this.tabs.add(c)},_getTabContent:function(c,d){var g=[],f;var b,a=d.length;for(b=0;b<a;b++){f=d[b]["name"];f=Core.String.byteLength(f)>8?Core.String.leftB(f,6)+"...":f;g.push("<li><a onclick=\"$insertFace('"+d[b]["code"]+"','"+d[b]["name"]+'\');return false;" href="#"><img style="width:50px;height:50px;" title="'+d[b]["name"]+'" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+d[b]["code"]+'T.gif"/></a><span>'+f+"</span></li>")}return g.join("")},insertFace:function(f,c){this.insertImageFile=f+"T.gif";this.onInsert();if(!this.txtContentArea){return}var j="[emoticons="+f+"]"+c+"[/emoticons]";if($IE){if(this.txtContentArea.createTextRange&&this.txtContentArea.caretPos){var d=this.txtContentArea.caretPos;d.text=d.text.charAt(d.text.length-1)==" "?j+" ":j;this.txtContentArea.focus()}else{this.txtContentArea.value+=j;this.txtContentArea.focus()}}else{if(this.txtContentArea.setSelectionRange){var b=this.txtContentArea.selectionStart;var g=this.txtContentArea.selectionEnd;var m=this.txtContentArea.value.substring(0,b);var a=this.txtContentArea.value.substring(g);this.txtContentArea.value=m+j+a}else{this.txtContentArea.value+=j}}this.hidden();return false},onInsert:function(){},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){!this._isInitDialog&&this.load();this.dialog.show();this.isShowed=true},hidden:function(){this.isShowed=false;this.dialog.hidden()}};Core.Dom.addHTML=function(a,b){a.insertAdjacentHTML("beforeend",b)};if(!$C("div").insertAdjacentHTML){Core.Dom.addHTML=function(b,c){var d=b.ownerDocument.createRange();d.setStartBefore(b);var a=d.createContextualFragment(c);b.appendChild(a)}}App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>','<li class="play" id="#{magicTip}">点击<img align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif">预览动画效果</li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join("");App.smilesDialog2=Core.Class.create();App.smilesDialog2.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(c){this.option=c||{};for(var b in this.defaultConfig){if(this.option[b]==null){this.option[b]=this.defaultConfig[b]}}this.dialog=new Dialog(this.option.htmlTpl);this.dialog.setAreaLocked(true);this.dialogNodes=this.dialog.getNodes();this.getKeyWord();if(scope.smilesData!=null){this.data=scope.smilesData;this.dataSettle();this.eventListen()}else{var a=this;var d=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(f){scope.smilesData=f;a.data=f;a.dataSettle();a.eventListen()},onException:function(){}})}return this},dataSettle:function(g,f){g=g||this.data;f=f||9;this.tabsData=[];this.allData=[];for(var d in g){var c=g[d];c.sortId=d;this.tabsData.push(c);for(var b=0,a=c.data.length;b<a;b++){c.data[b].sid=d;c.data[b].sname=c.name}this.allData=this.allData.concat(c.data)}if(this.allDataBack==null){this.allDataBack=this.allData.slice(0)}this.showTab(1,f);if(this.dialogNodes.smileList.childNodes.length==0){this.showAll()}},children:function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c},showTab:function(d,j){d=d||1;j=j||9;this.dialogNodes.sortList.innerHTML="";this.dialogNodes.smileList.innerHTML="";Core.Dom.setStyle(this.dialogNodes.sortList,"height",j==9?"279px":"217px");this.tabs=new Tabs(this.dialogNodes.sortList);this.tabsObject={};var f=this;for(var c=0;c<j;c++){var o=(d-1)*j;if(this.tabsData[o+c]==null){break}var n=this.tabsData[o+c].sortId;var m=this.tabsData[o+c].name;var a=this.tabsData[o+c].data;var b=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+n+'.gif" height="20" width="20" align="absmiddle"><div><span><a href="#" onclick="return false;" title="'+m+'">'+m+"</a></span><em>("+a.length+")</em></div>",{isFocus:false,className:"cur"});b.addOnAbort(Core.Function.bind3(function(p){},null,[b]));b.addOnFocus(Core.Function.bind3(function(t,s,u,q){f.showSmile(u,1,f.pageSize);f.currentTab=t;f.dialogNodes.allSort.style.fontWeight=400;if(!f.isFromUp){var r=scope.$pageid;if(r){var p=scope.isFromtheCommonhzh;if(p){v7sendLog($_GLOBAL.faceChooseTable[r][p]+"_16_020_"+q,r,"")}}}f.isFromUp=null},null,[b,o+c,a,n]));this.tabsObject[n]=b;this.tabs.add(b)}var g=Math.ceil(this.tabsData.length/j);if(g>0){this.showTabPage(d||1,g,j)}else{this.dialogNodes.sortCtrl.innerHTML=""}},showSmile:function(b,g,o){var p=this;o=o||this.pageSize;var t=this;var c=b;var u=c.length;var r=Math.ceil(u/o);var s=document.createDocumentFragment();var m;this.dialogNodes.smileList.innerHTML="";this.dialogNodes.magicTip.style.cssText="display:none;";for(var f=0;f<o;f++){var a=c[(g-1)*o+f];if(a==null){break}var j=$C("li");var q=$C("a");q.href="#";q.onclick=function(){return false};q.onmousedown=Core.Function.bind3(function(y,z,v){t.hide();t.option.callback(y,z,v)},null,[a.code,a.name,a.swf||null]);q.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+a.code+'T.gif" alt="'+a.name+'" title="'+a.name+'" />';j.appendChild(q);q.setAttribute("key",a.code);var n=$C("span");n.title=a.name;n.innerHTML=Core.String.byteLength(a.name)>8?Core.String.leftB(a.name,6)+"…":a.name;j.appendChild(n);if(a.swf){var d=$C("div");d.innerHTML='<a href="#"   onclick="window.$magicFacePlay(\''+a.swf+'\');return false;"><img height="13" title="播放表情" align="absmiddle" width="14" alt="" src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif"></a>';d.className="arr_r";j.appendChild(d);this.dialogNodes.magicTip.style.cssText="display:block;"}s.appendChild(j);Core.Events.addEvent(q,(function(v){return function(){var z=scope.$pageid;if(z){var y=scope.isFromtheCommonhzh;if(y){v7sendLog($_GLOBAL.faceChooseTable[z][y]+"_16_010_"+v.getAttribute("key"),z,"")}}}})(q),"mousedown")}this.dialogNodes.smileList.appendChild(s);if(u>o){if(g==1){this.dialogNodes.smilePagePrev.innerHTML="上一页"}else{this.dialogNodes.smilePagePrev.innerHTML="";m=$C("a");m.href="#";m.onclick=function(){return false};m.onmousedown=function(){t.showSmile(c,g-1,o)};m.innerHTML="上一页";this.dialogNodes.smilePagePrev.appendChild(m)}this.dialogNodes.smilePageShow.innerHTML=g+"/"+r;if(g>=r){this.dialogNodes.smilePageNext.innerHTML="下一页"}else{this.dialogNodes.smilePageNext.innerHTML="";m=$C("a");m.href="#";m.onclick=function(){return false};m.onmouseup=function(){t.showSmile(c,g+1,o)};m.innerHTML="下一页";this.dialogNodes.smilePageNext.appendChild(m)}}else{this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML=""}},showTabPage:function(a,c,f){this.dialogNodes.sortCtrl.innerHTML="";this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML="";var b=this;var d;if(a==1){if(a!=c){this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>';d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向下";d.className="down";d.onmousedown=function(){b.showTab(a+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d)}else{}}else{if(a<c){d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向上";d.className="up";d.onmousedown=function(){b.showTab(a-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d);d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向下";d.className="down";d.onmousedown=function(){b.showTab(a+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d)}else{d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向上";d.className="up";d.onmousedown=function(){b.showTab(a-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d);Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>')}}},eventListen:function(){var c=this;var d=c.dialogNodes.searchText;var j=c.dialogNodes.searchBtn;var g=c.dialogNodes.keyCtrlBack;var a=c.dialogNodes.allSort;var b=c.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(m){var o=Core.Events.getEvent(),n=($IE)?o.srcElement:o.target;if(c.dialogNodes.entity!=null&&(Core.Dom.contains(c.dialogNodes.entity,n)==false||m==true)){c.hide()}});Core.Events.addEvent(this.dialogNodes.btnClose,function(){c.hide()});Core.Events.addEvent(d,function(){if(Core.String.trim(d.value)=="输入关键字、动漫形象"){d.value="";d.style.color="#000"}d.select()},"focus");Core.Events.addEvent(d,function(){if(Core.String.trim(d.value)==""){d.value="输入关键字、动漫形象";d.style.color="#9b9b9a"}},"blur");Core.Events.addEvent(d,function(o){var m=Core.Events.getEvent();var n=m.which||m.keyCode;var p=Core.String.trim(d.value);if(n==13&&p!=""){c.searchKey(p)}},"keydown");Utils.Form.limitMaxLen(d,20);Core.Events.addEvent(j,function(){if(d.value=="输入关键字、动漫形象"||d.value==""){}else{c.searchKey(d.value);d.focus()}});var f=function(){c.dataSettle(c.data,9);c.dialogNodes.keyCtrl.style.display="none";c.dialogNodes.smileEmpty.style.display="none";c.dialogNodes.smileList.style.display="";c.dialogNodes.searchText.value="输入关键字、动漫形象";c.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(g,f);Core.Events.addEvent(b,f);Core.Events.addEvent(a,function(){c.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize);this.dialogNodes.allSort.style.fontWeight=600;if(this.currentTab!=null){this.currentTab.setAbort()}},setSort:function(a,b){this.isFromUp=a;this.option.sortId=a;this.option.callback=b;if(a==0){this.dialogNodes.allSort.style.fontWeight=600;this.dataSettle()}else{this.dataSettle();this.tabs.swapTags(this.tabsObject[a])}},getKeyWord:function(){if(this.keywordData!=null){return}var a=this;var b=Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig",{onComplete:function(c){a.keywordData=c;var d=c.E___00000000000||"顶|路过|哭|啦啦|美女";var p=document.createDocumentFragment();d=d.split("|");for(var j=0,n=d.length;j<n;j++){var m=$C("a");m.href="#";m.onclick=function(){return false};m.onmousedown=Core.Function.bind3(function(q){a.searchKey(q)},null,[d[j]]);m.innerHTML=d[j];if(d[j]=="魔法表情"){var g=$C("img");g.style.cssText="height:15px; width:15px;";g.setAttribute("align","absmiddle");g.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";g.className="SG_icon SG_icon68 img_m";p.appendChild(g)}p.appendChild(m)}if(a.dialogNodes.hotKeyword.innerHTML==""){a.dialogNodes.hotKeyword.appendChild(p)}var f="";for(var o in c){if(o!="E___00000000000"){f+="∑"+o+"§"+c[o]}}a.keywordStr=f},onException:function(){}})},searchKey:function(b){var c=b.replace(/([\\^$*+?{}.|])/gi,"\\$1");var m=new RegExp("∑([^§]+)§[^∑]*"+c+"[^∑]*","gi");var n=[];this.keywordStr.replace(m,function(r,q){n.push(q)});n=n.join(",");var g={};var a=this.allDataBack;var o=a.length;var p=0;for(var d=0;d<o;d++){if(n.indexOf(a[d].code)!=-1||a[d].sname.indexOf(b)!=-1||a[d].name.indexOf(b)!=-1){if(g[a[d].sid]==null){g[a[d].sid]={name:a[d].sname,data:[]}}g[a[d].sid].data.push(a[d]);p++}}var f=scope.$pageid;if(p==0){this.dialogNodes.smileEmpty.style.display="";this.dialogNodes.smileList.style.display="none";if(f){var j=scope.isFromtheCommonhzh;if(j){v7sendLog($_GLOBAL.faceChooseTable[f][j]+"_16_030_"+encodeURIComponent(b),f,"")}}}else{this.dialogNodes.smileList.style.display="";this.dialogNodes.smileEmpty.style.display="none";if(f){var j=scope.isFromtheCommonhzh;if(j){v7sendLog($_GLOBAL.faceChooseTable[f][j]+"_16_031_"+encodeURIComponent(b),f,"")}}}this.dataSettle(g,7);this.dialogNodes.keyCtrl.style.display="";this.dialogNodes.keyWord.innerHTML=b.split("").join("<wbr/>");Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象";this.dialogNodes.searchText.style.color="#9b9b9a";this.dialog.show()},hide:function(){this.dialog.hidden();this.dialogNodes.keyCtrl.style.display="none"}};scope.smilesDataV2={"302":{name:"小新小浪",contract:"GY00000001",data:[{name:"灌水",code:"E___0173EN00SIG"},{name:"赞",code:"E___0480ZH00SIG"},{name:"美好",code:"E___0305EN00SIG"},{name:"顶",code:"E___0022EN00SIG"},{name:"顶",code:"E___0088EN00SIG"},{name:"顶",code:"E___0472ZH00SIG"},{name:"开心",code:"E___0092EN00SIG"},{name:"路过",code:"E___0177EN00SIG"}]}};App.insertSmilesForm2=Core.Class.create();App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(b){this.option=b||{};if(this.option.sortNode==null){return}for(var a in this.defalutConfig){if(this.option[a]==null){this.option[a]=this.defalutConfig[a]}}if(scope.smilesDataV2==null){this.getSmilesData()}else{this.data=scope.smilesDataV2;this.renderUI()}},getSmilesData:function(){var a=this;var b=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(c){scope.smilesData=c;a.data=c;a.renderUI()},onException:function(){}})},renderUI:function(){var r=this;var n=1;var c=[];var d=[];var b;var f=document.createDocumentFragment();var a=$C("div");var g=$C("span");var p=$C("div");b=this.data&&this.data["302"]&&this.data["302"].data;if($E(this.option.recommNode)!=null){f=document.createDocumentFragment();for(var j=0;j<this.option.recommCount;j++){_title=b[j].name;var q=b[j].code;var m=b[j].swf;node=$C("li");(function(s){node.onclick=Core.Function.bind3(function(v,y,t){r.option.clickCallback(v,y,t);v7sendLog("32_01_20");var u=scope.$pageid;if(u){s+="";s=s.length==1?"0"+s:s;v7sendLog($_GLOBAL.faceCountRecommLinkTable[u]+"_"+s+"_010_"+v,u,"")}Core.Events.stopEvent();return false},null,[q,_title,m])})(j+8);node.hideFocus=true;var o='<a href="#"><img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+q+'T.gif" alt="'+_title+'" title="'+_title+'" height="50" width="50"/></a>';if(m){o=o+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+m+'\');return false;" ><img src="http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'}node.innerHTML=o;f.appendChild(node)}$E(this.option.recommNode).appendChild(f)}n=c=d=b=f=a=g=_morelink=p=q=key=_title=node=null}};Lib.children=function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c};App.insertSmilesDialog2=function(d,g,c,b){App.insertSmilesDialog2.callback=g;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog2()}scope.smileDialog.setSort(d,g);var f=Core.Dom.getXY($E(c));var a=f[0]+b[0];var j=f[1]+b[1];scope.smileDialog.setPosition(a,j);scope.smileDialog.show()};App.formInsertSmile2=function(c,p,a,d,o,q,j,g,m){var n=$E(c);m=m||{};var f=function(){if(n.createTextRange){n.caretPos=document.selection.createRange().duplicate()}};if(!scope.commEditor){scope.commEditor=new commEditor()}scope.commEditor.append(j,c,g);Core.Events.addEvent(n,f,"keyup");Core.Events.addEvent(n,f,"focus");Core.Events.addEvent(n,f,"select");Core.Events.addEvent(n,f,"click");var b={sortNode:p,clickCallback:function(r,t,s){setTimeout(function(){var u='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+r+'T.gif" alt="'+t+'" title="'+t+'"width="50" height="50" />';if(s){u='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+r+'T.gif" alt="'+t+'" title="'+t+'" swfname="'+s+'"  width="50" height="50" />'}scope.commEditor.insertHTML(j,u)},20);if(d){d()}},recommNode:a,positionNode:o||p,arrPosPix:q||[0,0],sortCount:m.sortCount||6,recommCount:m.recommCount||8};new App.insertSmilesForm2(b)};var commEditor=function(b,a){this.fids=[];this.areas={};this.wins={};this.docs={};this.intervals={};this.actions={}};commEditor.prototype={init:function(a){var d=this.docs[a];try{d.body.designMode="on"}catch(c){}d.open();d.writeln(this.getEditorHTML(""));d.body.contentEditable=true;var b=d.parentWindow;Lib.checkAuthor();d.body.onkeydown=function(g){try{if((g||b.event).keyCode==9){$E("login_"+($isLogin?"check":"name")).focus();return false}}catch(f){}};d.close()},lazyInit:function(a){var b=this;return function(){var c=b.docs[a];if(c.body.getAttribute("inited")){return}trace("执行一次:"+a);b.init(a);b.bindListener(a);c.body.setAttribute("inited","yes")}},append:function(d,b,g){g=g||{};if(!g.interval){g.interval={}}if(!g.interval.before){g.interval.before=function(){}}if(!g.interval.after){g.interval.after=function(){}}var f=$E(d);this.wins[d]=f.contentWindow;this.actions[d]=g;var c=this;function a(){try{c.docs[d]=f.contentWindow.document;c.areas[d]=$E(b);if($IE){c.docs[d].body.onclick=c.lazyInit(d)}else{(c.lazyInit(d))()}}catch(j){setTimeout(a,150)}}a()},frameFilter:function(a){var c=false;var b=a.innerHTML;b=b.replace(/<script[\s\S]*<\/script>/ig,"");b=b.replace(/<style[\s\S]*<\/style>/ig,"");b=b.replace(/<!-{2,}[\s\S]*?-{2,}>/g,"");b=b.replace(/<([^>]+).*?>/ig,function(f,g){var d=g.split(" ")[0].toLowerCase();switch(d){case"/p":return"<br>";case"br":return f;case"img":if(f.toLowerCase().indexOf("http://www.sinaimg.cn/uc/myshow/blog")>0||f.toLowerCase().indexOf("http://simg.sinajs.cn/blog7style/images/common")>0){if(f.toLowerCase().indexOf("t.gif")==-1&&f.toLowerCase().indexOf("img_arrow_r.gif")==-1){return""}return f}else{return""}default:return""}});b=b.replace(/\n/g,"");a.innerHTML=b},bindListener:function(d){var g=this.docs[d];var c=this.areas[d];var f=this.wins[d];var j=this.actions[d];var b=this;if($IE){g.onkeydown=function(){var m=f.event;if(m.keyCode==8){var n=b.getFocusElement(d);if(n&&n.tagName.toUpperCase()=="IMG"){n.parentNode.removeChild(n);m.keyCode=0;m.returnValue=false}}}}Core.Events.addEvent(g.body,(function(m){return function(n){b.intervals[d]=setInterval(function(){j.interval.before(d,c);b.clearFrameHTML(m);var p=m.getElementsByTagName("img");for(var o=0;p[o];o++){p[o].removeAttribute("style");p[o].removeAttribute("height");p[o].removeAttribute("width")}j.interval.after(d,c)},400)}})(g.body),"focus");Core.Events.addEvent(g.body,(function(m){return function(n){clearInterval(b.intervals[d])}})(g.body),"blur");if(j.normal){for(var a in j.normal){Core.Events.addEvent(g.body,j.normal[a],a)}}},clearFrameHTML:function(j){var f=this;var b=["a","input"];var g=false;for(var a=0;b[a];a++){if(j.getElementsByTagName(b[a]).length>0){g=true;break}}if(g){f.frameFilter(j)}else{var c=j.getElementsByTagName("img");for(var a=0;c[a];a++){var m=c[a].src.indexOf("http://www.sinaimg.cn/uc/myshow/blog");var n=c[a].src.toLowerCase().indexOf("t.g");var d=c[a].src.indexOf("http://simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((m==-1||n==-1)&&d==-1){f.frameFilter(j);break}}}},getFocusElement:function(c){if(!$IE){var b=this.win.getSelection();var a=b.getRangeAt(0);var d=a.commonAncestorContainer;if(d.tagName){if(d.tagName.toLowerCase()=="body"){return d}}if(!a.collapsed){if(a.startContainer==a.endContainer||(1&&a.startContainer==a.endContainer.parentNode)){if(a.startOffset-a.endOffset<2||1){if(a.startContainer.hasChildNodes()){return a.startContainer.childNodes[a.startOffset]}}}return d.parentNode}else{return d.parentNode}}else{var a=this.docs[c].selection.createRange();return a.item?a.item(0):a.parentElement()}},clearHTML:function(a){var b=this.docs[a];b.body.innerHTML="";b.body.setAttribute("contenteditable",false);b.body.setAttribute("contenteditable",true)},insertHTML:function(b,j){if($IE){(this.lazyInit(b))()}var g=this.wins[b];var f=this.docs[b];if($IE){try{g.focus();var c=f.selection.createRange();if(f.selection.type.toLowerCase()=="control"){var a=f.body.createTextRange();a.moveToElementText(c.item(0));c=a}c.pasteHTML(j);c.collapse(false);c.select()}catch(d){}}else{if(($CHROME||$SAFARI)&&(encodeURIComponent(f.body.innerHTML)=="%0A"||f.body.innerHTML=="")){f.body.focus()}this.execCommand("insertHTML",j,b);if(!$CHROME&&!$SAFARI){f.body.focus()}}},execCommand:function(c,b,a){var f=this.wins[a];var d=this.docs[a];f.focus();d.execCommand(c,"",b);f.focus()},handleChange:function(b){var a=this.docs[b].body;this.areas[b].value=this.getHandledStr(a)},getHandledStr:function(a){var b=[];if(a.hasChildNodes()){a=a.childNodes;for(var c=0;a[c];c++){b.push(this.handleDom(a[c]))}}else{b.push(this.handleDom(a))}return b.join("").replace(/\u00A0/ig," ")},handleDom:function(d){if(d.nodeType==3){var j=d.nodeValue;if(!Core.String.trim(j)){return""}return this.reEscapeHTML(j)}else{if(d.nodeType==1){if(d.hasChildNodes()&&((d.childNodes.length!=1)||(d.childNodes.length==1&&d.childNodes[0].tagName))){var a=[];if(d.tagName){var m=d.tagName.toUpperCase();if(m=="DIV"||m=="P"){a.push("\n")}}d=d.childNodes;for(var c=0;d[c];c++){a.push(this.handleDom(d[c]))}return a.join("")}else{var m=d.tagName.toUpperCase();if(m=="IMG"){if(d.src.indexOf("http://www.sinaimg.cn/uc/myshow/blog")!=-1){if(d.src.indexOf("T.g")==-1){return""}var b=d.src.split("T.g")[0];b=b.substring(b.lastIndexOf("/")+1,b.length);var g=d.getAttribute("title");var f=d.getAttribute("swfname");if(!f&&b[0]=="W"){f=b+"S.swf"}if(g){if(f){return"[magicemoticons="+b+" swfname="+f+"]"+g+"[/magicemoticons]"}else{return"[emoticons="+b+"]"+g+"[/emoticons]"}}}else{return""}}else{if(m=="BR"){return"\n"}else{if(m=="DIV"||m=="P"){var j=d.innerHTML||"";return"\n"+this.reEscapeHTML(j)}else{if(m=="SCRIPT"||m=="STYLE"){return""}else{j=d.innerHTML||d.value||"";return this.reEscapeHTML(j)}}}}}}}return""},reEscapeHTML:function(a){a=a.replace(/\n/g,"");a=a.replace(/&nbsp;/g," ");a=a.replace(/&quot;/g,'"');a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&amp;/g,"&");return a},getEditorHTML:function(b){var a="";a+="<html>";a+="<head>";a+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />';a+="<style>		p {			*margin:0.2em auto;		}		body {			margin: 0;			scrollbar-face-color: #ffffff;			scrollbar-highlight-color: #ffffff;			scrollbar-shadow-color: #c0c1bb;			scrollbar-3dlight-color: #c0c1bb;			scrollbar-arrow-color: #c9cbb6;			scrollbar-track-color: #f4f5f0;			scrollbar-darkshadow-color: #ffffff;			scrollbar-base-color: #ffffff;			padding: 10px;			word-wrap: break-word;			overflow: scroll;			overflow-x: auto;			height: 90%;			font-size: 14px;		}		body, td, textarea, input, br, div, span{			font-family: '', Verdana,Arial, Helvetica, sans-serif;			line-height:1.5;		}		img{			border: 0;		}		html{			height: 100%;			cursor: text;		}		pre{			white-space:normal;		}		form{margin: 0;}		body table{font-size: 14px;}		.border{ border:1px dashed #cfcfcf;}		</style>		<script>document.domain='sina.com.cn';<\/script>		";a+="</head>";a+="<body>";a+=b;a+="</body>";a+="</html>";return a}};App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join("");App.smilesDialog=Core.Class.create();App.smilesDialog.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(c){this.option=c||{};for(var b in this.defaultConfig){if(this.option[b]==null){this.option[b]=this.defaultConfig[b]}}this.dialog=new Dialog(this.option.htmlTpl);this.dialogNodes=this.dialog.getNodes();this.getKeyWord();if(scope.smilesData!=null){this.data=scope.smilesData;this.dataSettle();this.eventListen()}else{var a=this;var d=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(f){scope.smilesData=f;a.data=f;a.dataSettle();a.eventListen()},onException:function(){}})}return this},dataSettle:function(g,f){g=g||this.data;f=f||9;this.tabsData=[];this.allData=[];for(var d in g){var c=g[d];c.sortId=d;this.tabsData.push(c);for(var b=0,a=c.data.length;b<a;b++){c.data[b].sid=d;c.data[b].sname=c.name}this.allData=this.allData.concat(c.data)}if(this.allDataBack==null){this.allDataBack=this.allData.slice(0)}this.showTab(1,f);if(this.dialogNodes.smileList.childNodes.length==0){this.showAll()}},children:function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c},showTab:function(d,j){d=d||1;j=j||9;this.dialogNodes.sortList.innerHTML="";this.dialogNodes.smileList.innerHTML="";Core.Dom.setStyle(this.dialogNodes.sortList,"height",j==9?"279px":"217px");this.tabs=new Tabs(this.dialogNodes.sortList);this.tabsObject={};var f=this;for(var c=0;c<j;c++){var o=(d-1)*j;if(this.tabsData[o+c]==null){break}var n=this.tabsData[o+c].sortId;var m=this.tabsData[o+c].name;var a=this.tabsData[o+c].data;var b=new Tab('<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+n+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+m+"</a></span><em>("+a.length+")</em>",{isFocus:false,className:"cur"});b.addOnAbort(Core.Function.bind3(function(p){},null,[b]));b.addOnFocus(Core.Function.bind3(function(t,s,u,q){f.showSmile(u,1,f.pageSize);f.currentTab=t;f.dialogNodes.allSort.style.fontWeight=400;if(!f.isFromUp){var r=scope.$pageid;if(r){var p=scope.isFromtheCommonhzh;if(p){v7sendLog($_GLOBAL.faceChooseTable[r][p]+"_16_020_"+q,r,"")}}}f.isFromUp=null},null,[b,o+c,a,n]));this.tabsObject[n]=b;this.tabs.add(b)}var g=Math.ceil(this.tabsData.length/j);if(g>0){this.showTabPage(d||1,g,j)}else{this.dialogNodes.sortCtrl.innerHTML=""}},showSmile:function(b,f,n){var o=this;n=n||this.pageSize;var s=this;var c=b;var t=c.length;var q=Math.ceil(t/n);var r=document.createDocumentFragment();var j;this.dialogNodes.smileList.innerHTML="";for(var d=0;d<n;d++){var a=c[(f-1)*n+d];if(a==null){break}var g=$C("li");var p=$C("a");p.href="#";p.onclick=function(){return false};p.onmousedown=Core.Function.bind3(function(u,v){s.option.callback(u,v);s.hide()},null,[a.code,a.name]);p.innerHTML='<img style="width:50px;height:50px;" src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+a.code+'T.gif" alt="'+a.name+'" title="'+a.name+'" />';g.appendChild(p);p.setAttribute("key",a.code);var m=$C("span");m.title=a.name;m.innerHTML=Core.String.byteLength(a.name)>8?Core.String.leftB(a.name,6)+"…":a.name;g.appendChild(m);r.appendChild(g);Core.Events.addEvent(p,(function(u){return function(){var y=scope.$pageid;if(y){var v=scope.isFromtheCommonhzh;if(v){v7sendLog($_GLOBAL.faceChooseTable[y][v]+"_16_010_"+u.getAttribute("key"),y,"")}}}})(p),"mousedown")}this.dialogNodes.smileList.appendChild(r);if(t>n){if(f==1){this.dialogNodes.smilePagePrev.innerHTML="上一页"}else{this.dialogNodes.smilePagePrev.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmousedown=function(){s.showSmile(c,f-1,n)};j.innerHTML="上一页";this.dialogNodes.smilePagePrev.appendChild(j)}this.dialogNodes.smilePageShow.innerHTML=f+"/"+q;if(f>=q){this.dialogNodes.smilePageNext.innerHTML="下一页"}else{this.dialogNodes.smilePageNext.innerHTML="";j=$C("a");j.href="#";j.onclick=function(){return false};j.onmouseup=function(){s.showSmile(c,f+1,n)};j.innerHTML="下一页";this.dialogNodes.smilePageNext.appendChild(j)}}else{this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML=""}},showTabPage:function(a,c,f){this.dialogNodes.sortCtrl.innerHTML="";this.dialogNodes.smilePagePrev.innerHTML="";this.dialogNodes.smilePageShow.innerHTML="";this.dialogNodes.smilePageNext.innerHTML="";var b=this;var d;if(a==1){if(a!=c){this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>';d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向下";d.className="down";d.onmousedown=function(){b.showTab(a+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d)}else{}}else{if(a<c){d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向上";d.className="up";d.onmousedown=function(){b.showTab(a-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d);d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向下";d.className="down";d.onmousedown=function(){b.showTab(a+1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d)}else{d=$C("a");d.href="#";d.onclick=function(){return false};d.title="向上";d.className="up";d.onmousedown=function(){b.showTab(a-1,f);b.showAll()};this.dialogNodes.sortCtrl.appendChild(d);Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>')}}},eventListen:function(){var c=this;var d=c.dialogNodes.searchText;var j=c.dialogNodes.searchBtn;var g=c.dialogNodes.keyCtrlBack;var a=c.dialogNodes.allSort;var b=c.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,function(m){var o=Core.Events.getEvent(),n=($IE)?o.srcElement:o.target;if(c.dialogNodes.entity!=null&&(Core.Dom.contains(c.dialogNodes.entity,n)==false||m==true)){c.hide()}});Core.Events.addEvent(this.dialogNodes.btnClose,function(){c.hide()});Core.Events.addEvent(d,function(){if(Core.String.trim(d.value)=="输入关键字、动漫形象"){d.value="";d.style.color="#000"}d.select()},"focus");Core.Events.addEvent(d,function(){if(Core.String.trim(d.value)==""){d.value="输入关键字、动漫形象";d.style.color="#9b9b9a"}},"blur");Core.Events.addEvent(d,function(o){var m=Core.Events.getEvent();var n=m.which||m.keyCode;var p=Core.String.trim(d.value);if(n==13&&p!=""){c.searchKey(p)}},"keydown");Utils.Form.limitMaxLen(d,20);Core.Events.addEvent(j,function(){if(d.value=="输入关键字、动漫形象"||d.value==""){}else{c.searchKey(d.value);d.focus()}});var f=function(){c.dataSettle(c.data,9);c.dialogNodes.keyCtrl.style.display="none";c.dialogNodes.smileEmpty.style.display="none";c.dialogNodes.smileList.style.display="";c.dialogNodes.searchText.value="输入关键字、动漫形象";c.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(g,f);Core.Events.addEvent(b,f);Core.Events.addEvent(a,function(){c.showAll()})},showAll:function(){this.showSmile(this.allData,1,this.pageSize);this.dialogNodes.allSort.style.fontWeight=600;if(this.currentTab!=null){this.currentTab.setAbort()}},setSort:function(a,b){this.isFromUp=a;this.option.sortId=a;this.option.callback=b;if(a==0){this.dialogNodes.allSort.style.fontWeight=600;this.dataSettle()}else{this.dataSettle();this.tabs.swapTags(this.tabsObject[a])}},getKeyWord:function(){if(this.keywordData!=null){return}var a=this;var b=Utils.Io.JsLoad.request("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig&rnd="+Math.random(),{onComplete:function(o){a.keywordData=o;var m=o.E___00000000000||"顶|路过|哭|啦啦|美女";var n=document.createDocumentFragment();m=m.split("|");for(var j=0,d=m.length;j<d;j++){var g=$C("a");g.href="#";g.onclick=function(){return false};g.onmousedown=Core.Function.bind3(function(p){a.searchKey(p)},null,[m[j]]);g.innerHTML=m[j];n.appendChild(g)}if(a.dialogNodes.hotKeyword.innerHTML==""){a.dialogNodes.hotKeyword.appendChild(n)}var c="";for(var f in o){if(f!="E___00000000000"){c+="∑"+f+"§"+o[f]}}a.keywordStr=c},onException:function(){}})},searchKey:function(b){var c=b.replace(/([\\^$*+?{}.|])/gi,"\\$1");var m=new RegExp("∑([^§]+)§[^∑]*"+c+"[^∑]*","gi");var n=[];this.keywordStr.replace(m,function(r,q){n.push(q)});n=n.join(",");var g={};var a=this.allDataBack;var o=a.length;var p=0;for(var d=0;d<o;d++){if(n.indexOf(a[d].code)!=-1||a[d].sname.indexOf(b)!=-1||a[d].name.indexOf(b)!=-1){if(g[a[d].sid]==null){g[a[d].sid]={name:a[d].sname,data:[]}}g[a[d].sid].data.push(a[d]);p++}}var f=scope.$pageid;if(p==0){this.dialogNodes.smileEmpty.style.display="";this.dialogNodes.smileList.style.display="none";if(f){var j=scope.isFromtheCommonhzh;if(j){v7sendLog($_GLOBAL.faceChooseTable[f][j]+"_16_030_"+encodeURIComponent(b),f,"")}}}else{this.dialogNodes.smileList.style.display="";this.dialogNodes.smileEmpty.style.display="none";if(f){var j=scope.isFromtheCommonhzh;if(j){v7sendLog($_GLOBAL.faceChooseTable[f][j]+"_16_031_"+encodeURIComponent(b),f,"")}}}this.dataSettle(g,7);this.dialogNodes.keyCtrl.style.display="";this.dialogNodes.keyWord.innerHTML=b.split("").join("<wbr/>");Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(a,b){this.x=a;this.y=b;this.dialog.setPosition({x:a,y:b})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象";this.dialogNodes.searchText.style.color="#9b9b9a";this.dialog.show()},hide:function(){this.dialog.hidden();this.dialogNodes.keyCtrl.style.display="none"}};App.insertSmilesForm=Core.Class.create();App.insertSmilesForm.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(b){this.option=b||{};if(this.option.sortNode==null){return}for(var a in this.defalutConfig){if(this.option[a]==null){this.option[a]=this.defalutConfig[a]}}if(scope.smilesData==null){this.getSmilesData()}else{this.data=scope.smilesData;this.renderUI()}},getSmilesData:function(){var a=this;var b=Utils.Io.JsLoad.request([{url:"http://www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(c){scope.smilesData=c;a.data=c;a.renderUI()},onException:function(){}})},renderUI:function(){var v=this;var o=1;var f=[];var g=[];var c;var j=document.createDocumentFragment();var a=$C("div");var m=$C("span");var r=$C("div");a.className="facestyle";for(var t in this.data){if(o==1){c=this.data[t]||{data:{}};c=c.data}if(o<=this.option.sortCount){var q=this.data[t].name;var d=$C("a");d.href="#";d.setAttribute("key",t);d.onclick=function(){Core.Events.stopEvent();return false};d.onmousedown=Core.Function.bind3(function(y){App.insertSmilesDialog(y,v.option.clickCallback,v.option.positionNode,v.option.arrPosPix)},null,[t]);d.hideFocus=true;d.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+t+'-25.gif" alt="'+q+'" title="'+q+'" />';a.appendChild(d);o++}else{break}}var p=new Date().getTime();a.id="recomm_"+p;j.appendChild(a);m.className="SG_more";var b=$C("a");b.href="#";b.onclick=function(){Core.Events.stopEvent();return false};b.onmousedown=(function(y){return function(){App.insertSmilesDialog(0,v.option.clickCallback,v.option.positionNode,v.option.arrPosPix);var z=scope.$pageid;if(z){var A=y.parentNode.parentNode.id.split("_")[0];if(A){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[z][A][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[z][A][0]+"_07_000_000",z,"")}}}})(b);b.innerHTML="更多>>";m.appendChild(b);j.appendChild(m);r.className="clearit";j.appendChild(r);$E(this.option.sortNode).appendChild(j);if($E(this.option.recommNode)!=null){j=document.createDocumentFragment();for(var n=0;n<this.option.recommCount;n++){q=c[n].name;var s=c[n].code;d=$C("a");d.href="#";(function(y){d.onclick=Core.Function.bind3(function(A,B){v.option.clickCallback(A,B);var z=scope.$pageid;if(z){y+="";y=y.length==1?"0"+y:y;v7sendLog($_GLOBAL.faceCountRecommLinkTable[z]+"_"+y+"_010_"+A,z,"")}Core.Events.stopEvent();return false},null,[s,q])})(n+8);d.hideFocus=true;d.innerHTML='<img src="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/'+s+'T.gif" alt="'+q+'" title="'+q+'" />';j.appendChild(d)}$E(this.option.recommNode).appendChild(j)}var u=Lib.children($E("recomm_"+p).childNodes);for(n=0;u[n];n++){Core.Events.addEvent(u[n],(function(y,z){return function(){var A=scope.$pageid;if(A){var B=y.parentNode.parentNode.id.split("_")[0];if(B){scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[A][B][1];v7sendLog($_GLOBAL.faceCountMoreLinkTable[A][B][0]+"_0"+z+"_020_"+y.getAttribute("key"),A,"")}}}})(u[n],(n+1)),"mousedown")}o=f=g=c=j=a=m=b=r=s=t=q=d=null}};Lib.children=function(b){var c=[];for(var a=0;b[a];a++){if(b[a].nodeType==1){c.push(b[a])}}return c};App.insertSmilesDialog=function(d,g,c,b){App.insertSmilesDialog.callback=g;if(scope.smileDialog==null){scope.smileDialog=new App.smilesDialog()}scope.smileDialog.setSort(d,g);var f=Core.Dom.getXY($E(c));var a=f[0]+b[0];var j=f[1]+b[1];scope.smileDialog.setPosition(a,j);scope.smileDialog.show()};App.formInsertSmile=function(b,a,j,g,d,c){var f=$E(b);var m=function(){if(f.createTextRange){f.caretPos=document.selection.createRange().duplicate()}};Core.Events.addEvent(f,m,"keyup");Core.Events.addEvent(f,m,"focus");Core.Events.addEvent(f,m,"select");Core.Events.addEvent(f,m,"click");new App.insertSmilesForm({sortNode:a,clickCallback:function(p,t){var s="[emoticons="+p+"]"+t+"[/emoticons]";if($IE){if(f.createTextRange&&f.caretPos){var q=f.caretPos;q.text=q.text.charAt(q.text.length-1)==" "?s+" ":s;f.focus()}else{f.value+=s;f.focus()}}else{if(f.setSelectionRange){var o=f.selectionStart;var r=f.selectionEnd;var u=f.value.substring(0,o);var n=f.value.substring(r);f.value=u+s+n}else{f.value+=s}}if(g){g()}},recommNode:j,positionNode:d||a,arrPosPix:c||[0,0]})};Core.Dom.removeParentNode=function(a){a=$E(a);var b=a.parentNode;Core.Dom.insertAfter(a,b);b.parentNode.removeChild(b)};TweenStrategyEx=function(b,a,d,c){this.startValue=b||[];this.endValue=a||[];this.duration=d||0;this.motion=c||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(b,a){this.__eventDispatcher.addEventListener(b,a);return this},removeEventListener:function(b,a){this.__eventDispatcher.removeEventListener(b,a);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var g=this,c,a=this.startValue,f=this.endValue,m=this.duration,j=[],b=(new Date()).getTime();this._itvID=window.setInterval(function(){c=((new Date()).getTime()-b)/1000;c>g.duration&&(c=g.duration);for(var d=0;d<a.length;d++){j[d]=g.motion(c,a[d],f[d]-a[d],m)}g.onTween&&g.onTween(j);g.__eventDispatcher.dispatchEvent("tween",j);c==g.duration&&g.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(a){},onEnd:function(){}});Core.Events.getEventTarget=function(a){a=a||Core.Events.getEvent();Core.Events.fixEvent(a);return a.target};Comment2TSina=Core.Class.create();Comment2TSina.prototype={anonyous:false,data:null,initialize:function(a,b){this.anonyous=a||false;this.data=b||{};scope.$temp_commCtt=this.data.weibo_content;scope.$temp_commId=this.data.blog_id},writeCommTips:function(){if(!$E("bb")){return}var d="";var b=$E("writeComm_tips");if(!b){var c=$C("div");c.className="writeComm_tips_box";c.style.display="none";c.innerHTML='<span class="writeComm_tips" id="writeComm_tips"><strong></strong><cite><a href="javascript:;">关闭</a></cite></span>';var a=Core.Dom.byClz(document,"div","writeComm");if(a){a[0].insertBefore(c,a[0].childNodes[0])}else{return}b=c.firstChild;Core.Events.addEvent(b.lastChild,function(){c.style.display="none"},"click");this.bindTipsEvents(b)}var g=b.parentNode,f=b.firstChild;g.style.display="none";if(this.anonyous||($E("anonymity")&&$E("anonymity").checked)||this.data.re_weibo==="no_blog"){f.innerHTML='评论发表成功，<a href="javascript:void(0);">点此还可以同步到微博，分享给我的粉丝。</a>';g.style.display="block"}else{if(this.data.re_weibo==="success"){f.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+this.data.t_sina+'/profile" target="_blank">点此查看</a>';g.style.display="block"}else{if(this.data.re_weibo==="no_bind"){f.innerHTML='评论分享失败，您需要先<a href="javascript:void(0);">绑定微博</a>';g.style.display="block"}}}},bindTipsEvents:function(a){Core.Events.addEvent(a.firstChild,function(c){Core.Events.stopBubble(c);if(Core.Events.getEventTarget(c).tagName.toLowerCase()!="a"){return}var b=a.firstChild.lastChild.innerHTML;if(b==="点此查看"){a.parentNode.style.display="none"}else{if(b==="绑定微博"){$E("writeComm_tips").parentNode.style.display="none";this.bindToTSina()}else{if(checkUserProduct.flag==true){this.openStep()}else{this.shareToT()}}}}.bind2(this),"click")},openStep:function(){var me=this;Utils.Io.Ijax.request("http://control.blog.sina.com.cn/riaapi/tshow/send_cms_weibo.php",{POST:{uid:$UID,blog_id:scope.$temp_commId,content:scope.$temp_commCtt,isphoto:0},onComplete:function(data){data=eval("("+data+")")||{};if(data.code==="A00006"){var tips=$E("writeComm_tips");tips.parentNode.style.display="block";tips.firstChild.innerHTML='评论成功同步到微博，<a href="http://weibo.com/'+data.data+'/profile" target="_blank">点此查看</a>'}else{if(data.code==="B00001"){winDialog.alert("您的博客还未绑定新浪微博，现在绑定？",{icon:"04",funcOk:function(){me.bindToTSina()}})}else{if(data.code==="A00004"||data.code==="A11007"){me.shareToT()}else{winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}}}},onException:function(msg,url){winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}})},bindToTSina:function(){var b=this;var a="http://control.blog.sina.com.cn/t_sina_blog/bind_weibo_form.php?from=js&domain="+document.domain;window.open(a,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);window.tOkBack=function(){trace("微博绑定回调ok函数！");winDialog.alert("绑定微博成功",{icon:"03",funcOk:function(){b.openStep()},funcClose:function(){b.openStep()}})};window.tFailBack=function(){trace("微博绑定 fail");winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},shareToT:function(){var a=scope.$temp_commCtt;if(a){var j=encodeURIComponent(a);var g="http://v.t.sina.com.cn/share/share.php?",d="新浪-博客",b="http://blog.sina.com.cn",c="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+j+"&url="+encodeURIComponent(document.location)+"&source="+d+"&sourceUrl="+encodeURIComponent(b)+"&content=utf-8&appkey=1617465124";window.open(c,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}else{winDialog.alert("分享的内容不能为空",{icon:"01"})}$E("writeComm_tips").parentNode.style.display="none"}};var checkUserProduct={isinit:false,func:null,product:"",flag:true,getReturn:function(a){switch(a){case"blog":var b=("0x"+scope.userProducts)&1;if(b!=0){this.flag=true}else{this.flag=false}break;case"photo":var b=("0x"+scope.userProducts)&8;if(b!=0){this.flag=true}else{this.flag=false}break;default:this.flag=true}this.func()},check:function(b,c){this.product=b;this.func=c||function(){};if(scope.userProducts){this.getReturn(b)}else{var a="http://uic.sso.sina.com.cn/uic/Query.php?UID="+$UID+"&Check=null&UserInfoTypes=[4]&ProductType=2";Utils.Io.JsLoad.request(a,{onComplete:function(d){if(typeof d=="object"){scope.userProducts=d.UserInfo[0][1];this.getReturn(this.product);this.isinit=true}else{this.flag=false;this.isinit=true}}.bind2(this),charset:"UTF-8"})}}};CommentV2.formatTime=function(f){var c=new Date();if(f){c.setTime(c)}var d=(c.getMonth()+1)>=10?(c.getMonth()+1):"0"+(c.getMonth()+1);var a=c.getDate()>=10?c.getDate():"0"+c.getDate();var f=new Date().toTimeString().split(" ")[0];var b=c.getFullYear()+"-"+d+"-"+a+" "+f;return b};CommentV2.Post=Core.Class.create();CommentV2.Post.prototype={articleid:0,totle:0,anonyous:false,onSuccess:new Function(),onError:new Function(),initialize:function(){},post:function(a){try{this.data=a;this.data.article_id=this.articleid;this.data.uid=$isLogin?$UID:"";this.data.fromtype="commentadd";this.data.anonymity=this.data.anonymity||this.anonyous||false;if(this.data.anonymity){this.data.login_name=this.data.comment_anonyous}Lib.checkAuthor();if($isLogin){this.data.login_name=$nick;this.postComment(this.data)}else{if(this.anonyous){this.postComment(this.data)}else{if($E("login_remember")){if(this.data.login_remember){v7sendLog("48_01_37_1")}else{v7sendLog("48_01_37_0")}}new Lib.Login.LoginPost(function(c){Lib.checkAuthor();if($isLogin){this.data.login_name=$nick;this.postComment(this.data);this.renderLogin()}else{if(c&&c.errno&&(c.errno==="4049"||c.errno==="2070")){this.loginNeedSafeCode(c);return}else{winDialog.alert((c&&c.reason)||"登录名或密码错误！",{icon:"02"})}this.refreshCKIMG();$E("commentloginM").style.display="none";$E("commentlogin").style.display="block";$E("commentNick").style.display="";$E("commentNick").innerHTML="";if($E("anonymity_cont")){$E("anonymity").checked=false;$E("anonymity_cont").style.display="none"}}}.bind2(this),false,"referer:"+location.hostname+location.pathname+",func:0001").login(a.login_name,a.login_pass,a.login_remember==true?15:0)}}}catch(b){trace(b)}},renderLogin:function(){$tray.renderLogin();$E("commentlogin").style.display="none";var c=this;var b=$E("commentNick");var a=function(){if(checkUserProduct.flag==true){scope.setNickTime=setInterval(function(){var d=Lib.blogv.getVHTML(scope.loginUserWtype);if(typeof scope.$loginNick=="undefined"){Lib.Uic.getNickName([$UID],function(f){for(var g in f){scope.$loginNick=f[g];b.innerHTML=scope.$loginNick+"&nbsp;"+d+":";b.style.display=""}});clearInterval(scope.setNickTime)}else{b.innerHTML=scope.$loginNick+"&nbsp;"+d+":"}},500)}else{c._showOpenBlogInfo()}};if(b.innerHTML==""){if(checkUserProduct.isinit==false){window.checkuserinterval=setInterval(function(){if(checkUserProduct.isinit==false){checkUserProduct.check("blog",a)}else{clearInterval(window.checkuserinterval)}},500)}else{a()}}if($E("anonymity_cont")){$E("anonymity_cont").style.display=""}},_showOpenBlogInfo:function(){for(var b=$E("commentNick").firstChild;b;b=b.nextSibling){$E("commentNick").removeChild(b)}$E("commentNick").style.display="";$E("commentNick").innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>';scope.addBlogOpenerEvent($E("openblog-li"));if($E("anonymity")){$E("commentloginM").style.display="";$E("anonymity").checked=true;$E("quote_comment_p").style.display="none"}var a=setInterval(function(){if(!scope.nickname){return}$E("openblog-nickname").innerHTML=scope.nickname+"：";clearInterval(a)},500)},postComment:function(d){v7sendLog("32_01_19");var b=new Date().getTime();function c(j){if(!j){var g=new Date().getTime();j=g-b}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/admin/article/ria_debug.php",{GET:{type:"addBlogComment",usetime:j},noreturn:true})}var a={POST:d,onComplete:function(m){if(typeof m=="string"){m=m.replace(/;$/,"")}m=(typeof m=="string"&&(/\s*{/.test(m)))?Core.String.j2o(m):m;if(m!=null&&typeof m.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(m.code=="A00006"){v7sendLog("45_01_12_"+scope.$uid);m=m.data;if(d.is_mobile){if(m.insertid.charAt(0)==="N"){m.insertid=m.insertid.slice(1)}var o=m.t_sina;if(o&&o.charAt(0)==="N"){m.t_sina=o.slice(1)}}c();Lib.checkAuthor();var n=$E("c_"+scope.$articleid).innerHTML;var g=parseInt(/(\d+)/.exec(n)[0],10);g++;$E("c_"+this.articleid).innerHTML="("+g+")";if($isLogin){this.renderLogin()}this.addNewComment(d,m);var j=new Comment2TSina(this.anonyous,m);if($E("bb")&&$E("bb").checked){v7sendLog("32_01_18")}j.writeCommTips();this.onSuccess();if($E("comment_get_vcode")){Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+new Date().getTime())}else{}}else{v7sendLog("32_01_21");c();this.refreshCKIMG();if(m.code=="B36113"){winDialog.alert("博主已关闭匿名评论，请登录后再评论",{funcOk:function(){if($E("anonymity_cont")){$E("anonymity_cont").checked=false;$E("anonymity_cont").style.display="none"}$E("commentlogin").style.display="";$E("commentloginM").style.display="none"}})}else{if(m.code=="B36002"){winDialog.alert($SYSMSG.B36002,{funcOk:function(){$E("login_check").value="";$E("login_check").focus()}})}else{showError(m.code)}}if(m.code!=null){Lib.checkAuthor();if($isLogin){return}if($E("anonymity_cont")){$E("anonymity").checked=false;$E("anonymity_cont").style.display="none"}if($E("anonymity").checked==true){$E("commentloginM").style.display="block";$E("anonymity").checked="checked"}else{$E("commentloginM").style.display="none";$E("commentlogin").style.display="block"}$E("commentNick").innerHTML="";$isLogin=false;this.anonyous=true}}}.bind2(this),onException:function(g){v7sendLog("32_01_21");c(-1);trace("post comment error");winDialog.alert($SYSMSG[g.code]||"发评论失败！请重试。",{icon:"02"})}.bind2(this)};Utils.Io.Ijax.request("http://control.blog.sina.com.cn/admin/comment_new/cms_post.php",a);var f=setTimeout(function(){c(-1);clearTimeout(f);f=null},30000)},refreshCKIMG:function(){if($E("comment_check_img")){$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+new Date().valueOf()}if($E("comment_get_vcode")){Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+new Date().getTime())}},addNewComment:function(c,b){if(isNaN(scope.$comment_page)||("undefined"==typeof(scope.$comment_page))){scope.$comment_page=1}var a=CommentV2.count(scope.$totle_comment);Lib.checkAuthor();this.getPostTemplet(c,b)},commentTween:function(b){var j=this;var g=$E("article_comment_list");var f;if(scope.$pageid.indexOf("articletj")===-1){g.appendChild(b);f=$E("postCommentIframe")}else{var a=$T(g,"li")[0];if(a){a.className="SG_j_linedot1";g.insertBefore(b,a)}else{g.appendChild(b)}f=$E("postcommentid")}var d=Core.Dom.getXY(b);var c=Core.Dom.getXY(f);new rockIt(b,c,d,0,300,"elasticEaseInOut",{end:function(s){s.clear();Core.Dom.opacity(b,0);if(scope.$pageid.indexOf("articletj")===-1){g.appendChild(b);f=$E("postCommentIframe")}else{g.insertBefore(b,g.firstChild);f=$E("postcommentid")}var r=0;var y=function(){Core.Dom.opacity(b,r);if(r==100){clearInterval(u);r=0}r+=20};var u=setInterval(y,10);var A=j.getScollTop();var m=Core.Dom.getXY(b)[1];if(m>A){return}var q=Math.abs(A);var t=0;var p=100;if(q<=100){t=q==A?1:-1;p=q}else{t=A/100}var z=+new Date();var v=500;var n=setInterval(function(){var C=window.$transitions.regularEaseOut;var o=+new Date();if(o-z<v){var B=o-z}else{var B=v;clearInterval(n)}j.setScollTop(C(B,A,m-A,v))},15)}})},getScollTop:function(){var a=0;var b=0;if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){b=document.body.scrollTop;a=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){b=document.documentElement.scrollTop;a=document.documentElement.scrollLeft}}return b},setScollTop:function(a){if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){document.body.scrollTop=a}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){document.documentElement.scrollTop=a}}},getPostTemplet:function(b,m){var o=this;var c=m.isworldcup;var f=m;var m=f.insertid||m;var n={};n.id=m;n.user_image=f.user_img;n.src_uid=scope.$uid;if(b.anonymity){n.uname=b.comment_anonyous;n.comm_uid=0}else{n.ulink="http://blog.sina.com.cn/u/"+(b.uid||$UID);n.ria_index_url=n.ulink;var a=Lib.blogv.getVHTML(scope.loginUserWtype);n.uname=(scope.nickname||b.login_name);if(a){n.vimg=a}n.comm_uid=$UID}if(b.god==1){n.god=1;n.cms_body=this.changeToContent(b.comment,"god")}else{n.cms_body=this.changeToContent(b.comment)}n.cms_pubdate=CommentV2.formatTime();n.fromProduct=f.from_product;n.cms_reply_num="0";n.action_data=encodeURIComponent(Utils.Json.flatten({commentid:n.id,articleid:f.blog_id,fromProduct:f.from_product,comm_uid:n.comm_uid,uname:n.uname,ulink:n.ulink,src_uid:scope.$uid,cms_reply_num:n.cms_reply_num}));var g={};g.item=n;g.fun=function(p){o.commentTween(p)};Lib.Listener.notify("commentlist-commentadd",g);var d=this.isNoCotent();var j=(scope&&scope.$pageid==="articletj");if(d){d.parentNode.removeChild(d)}},isNoCotent:function(){var d=$E("article_comment_list");var a=d.getElementsByTagName("li");for(var c=0;a[c];c++){var f=a[c].getElementsByTagName("div");for(var b=0;f[b];b++){if(f[b].className.toUpperCase().indexOf("NOCOMMDATE")!=-1){return a[c]}}}return null},changeToContent:function(j,c){var g="http://www.sinaimg.cn/uc/myshow/blog/misc/gif/";if(c=="god"){g="http://simg.sinajs.cn/blog7style/images/common/godreply/"}var f=j.replace(/\r\n|\n/gi,"###line-return###");f=Core.String.encodeHTML(f);var m=/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi;var a='<img src="'+g+'$1T.gif" style="margin:1px;" border="0" title="$2" />';f=f.replace(m,a);var d=/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi;var b='<img src="'+g+'$1T.gif" style="margin:1px;" border="0" title="$3" width="50" height="50"/>';f=f.replace(d,b);f=f.replace(/###line-return###/gi,"<br/>");return f},loginNeedSafeCode:function(b){var d=this;var f="http://login.sina.com.cn/cgi/pin.php";var a=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite><a title="关闭" class="CP_w_shut"  id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="" style="width:auto;" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");var c='<div class="CP_layercon1"><div class="verifyPrompt"><p>为了保护你的账号安全，请输入验证码进行登录</p><div class="row1"><strong>验证码：</strong><input type="text" maxlength="5" id="xssSafeCodeDiag_checkword" class="fm1"><img width="100" align="absmiddle" src="http://login.sina.com.cn/cgi/pin.php?r=11681364785467546&amp;s=0" maxlength="5" id="xssSafeCodeDiag_safeimg"><a id="" href="javascript:void(0); return false;" onclick="scope.xssSafeCodeDiag.changeSafeCode();">换一换</a></div><p class="CP_w_btns"><a id="" href="javascript:void(0); return false;" class="CP_a_btn2" onclick="scope.xssSafeCodeDiag.ok();"><cite><span>登录</span></cite></a><span style="display:none" id="xssSafeCodeDiag_ErrTips" class="ErrTips"></span></p></div></div>';if(typeof scope.xssSafeCodeDiag=="undefined"){scope.xssSafeCodeDiag=winDialog.createCustomsDialog({tpl:a,title:"提示",content:c,width:282,height:180,funcDisplayFinished:function(){}},"note");scope.xssSafeCodeDiag.changeSafeCode=function(){$E("xssSafeCodeDiag_checkword").value="";$E("xssSafeCodeDiag_safeimg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0"};scope.xssSafeCodeDiag.ok=function(){var g=$E("xssSafeCodeDiag_checkword").value;if(g===""){$E("xssSafeCodeDiag_ErrTips").innerHTML="请输入验证码";$E("xssSafeCodeDiag_ErrTips").style.display="";return}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){sinaSSOController.loginExtraQuery.door=g||1}}sinaSSOController.loginExtraQuery.door=g||1;d.post(d.data);scope.xssSafeCodeDiag.hidden()};scope.xssSafeCodeDiag.displayError=function(g){if(g.errno!=="4049"){$E("xssSafeCodeDiag_ErrTips").innerHTML=g.reason;$E("xssSafeCodeDiag_ErrTips").style.display=""}else{$E("xssSafeCodeDiag_ErrTips").style.display="none"}}}scope.xssSafeCodeDiag.show();scope.xssSafeCodeDiag.setMiddle();scope.xssSafeCodeDiag.changeSafeCode();scope.xssSafeCodeDiag.displayError(b)}};function rockIt(b,n,o,q,d,g,a){if(!b){return}var j=m(b);if(!j){b.setAttribute("rotationId",j=m())}var f=rockIt.instances||(rockIt.instances={});if(f[j]){t(j)}var s=Ui.Transition;window.$transitions=s;if(typeof a.begin=="function"){a.begin()}b.style.position="absolute";document.body.appendChild(b);f[j]={node:b,startPos:n,endPos:o,round:q,func:a,sTime:+new Date(),duration:d,mode:g||"simple",degree:0,timer:0};f[j].timer=setInterval(function(){var u=+new Date();if(f[j]["sTime"]+f[j]["duration"]<u){p(j,f[j]["duration"]);if(typeof a.end=="function"){a.end({clear:r})}t(j)}else{p(j,u-f[j]["sTime"])}},15);function m(u){if(u){return u.getAttribute("rotationId")}else{return parseInt(Math.random()*10000)+ +new Date()}}function t(v){clearInterval(f[v].timer);for(var u in f[v]){delete f[v][u]}delete f[v]}function p(A,z){var y=s[f[A]["mode"]];var B=f[A];var v=B.node.style;var C=B.duration;var u=B.startPos[0];var D=B.endPos[0]-B.startPos[0];v.left=y(z,u,D,C)+"px";u=B.startPos[1];D=B.endPos[1]-B.startPos[1];v.top=y(z,u,D,C)+"px";u=0;D=(B.round==0||z==C)?0:Math.PI*2*B.round;c(B.node,y(z,u,D,C))}function c(v,u){costheta=Math.cos(u);sintheta=Math.sin(u);if($IE){v.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+costheta+",M12="+(-sintheta)+",M21="+sintheta+",M22="+costheta+',SizingMethod="auto expand")'}else{if($FF){v.style.MozTransform="matrix("+(costheta)+", "+(sintheta)+", "+(-sintheta)+", "+(costheta)+", 0, 0)"}else{if(/WebKit/i.test(navigator.userAgent)){v.style.WebkitTransform="matrix("+(costheta)+", "+(sintheta)+", "+(-sintheta)+", "+(costheta)+", 0, 0)"}}}}function r(){var u=f[j].node.style;u.position="";u.left="";u.top=""}}CommentV2.commentFaceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");CommentV2.count=function(c){var b=50;var a=0;if(c%b==0){a=Math.ceil(c/b)}else{a=Math.floor(c/b)+1}return a};var Comment={};CommentV2.insertSmile=Core.Class.create();CommentV2.insertSmile.prototype={initialize:function(){},show:function(){this.btnShowFaceEditor=$E("article_comment_insertSmile");this.txtComment=$E("commentArea");this.faceEditor=new Lib.Face(this.txtComment);var a=this;a.bindFace()},bindFace:function(){var a=this;Core.Events.addEvent(this.btnShowFaceEditor,function(){if(a.faceEditor.isShowed){a.faceEditor.hidden()}else{if(!a.faceEditor.isLoad){a.faceEditor.load();a.initFace();a.faceEditor.isLoad=true}var b=Core.Dom.getLeft(a.btnShowFaceEditor)-450;var c=Core.Dom.getTop(a.btnShowFaceEditor)+a.btnShowFaceEditor.offsetHeight;a.faceEditor.setPosition(b,c);a.faceEditor.show()}Core.Events.stopEvent()},"mousedown")},initFace:function(){var a=this;Core.Events.addEvent(this.faceEditor.dialogNodes.btnClose,function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(document.body,function(){a.faceEditor.hidden()},"mousedown");Core.Events.addEvent(this.faceEditor.dialog.entity,function(){Core.Events.stopEvent()},"mousedown")}};$SYSMSG.extend({B119001:"不能转载自己的文章!",B119002:"转帖功能为新版博客专属功能，点击确认立即升级你的博客吧！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='http://blog.sina.com.cn/lm/iframe/xhtml/2010/blogspread.html'>了解新版博客详情</a></span>",B119003:"被转载文章不存在!",B119004:"请访问原文进行转载！",B119005:"对不起，博主设置不允许转载该文章",B119006:"对不起，博主设置不允许转载其文章",B119007:"很抱歉，转载失败，请稍后再试",B119008:"已经转载很多啦，看看其他的精彩文章",B119009:"您短时间转载过多，请稍后再试"});App.getArticlesSort=function(b,a){a=a||scope.$uid;var c=$C("script");Lib.checkAuthor();c.src="http://comet.blog.sina.com.cn/api?maintype=acate&varname=x&uid="+a;c.charset="utf-8";c.onload=c.onerror=c.onreadystatechange=Core.Function.bind2(function(){if(c&&c.readyState&&c.readyState!="loaded"&&c.readyState!="complete"){return}App.ArticlesSort=x;if(b!=null){b(App.ArticlesSort)}c.onload=c.onreadystatechange=c.onerror=null;c.src="";c.parentNode.removeChild(c);c=null},this);document.getElementsByTagName("head")[0].appendChild(c)};var cateDialog=Core.Class.create();cateDialog.prototype={uid:"",initialize:function(a){this.action=a||false},show:function(a){this.uid=a||scope.$uid;this.initDialog();this.dialog.show();this.dialog.setFixed(true);this.dialog.setAreaLocked(true);this.dialog.setMiddle()},initDialog:function(){var d=this;var f={width:492,height:0,url:"http://control.blog.sina.com.cn/admin/article/article_class_list.php?"+(this.action?"action=editor":"")};Lib.checkAuthor();this.url="http://control.blog.sina.com.cn/admin/article/article_class_save2.php?uid="+$UID+(this.action?"&action=editor":"");this.id=Core.Math.getUniqueId();this.manage=null;this.manage=new cateMng(this.id,this.itemTpl,this.uid);this.manage.onSuccess=function(m){d.onSuccess(m)};var a=new Ui.Template("<div style='width: #{width}px; height: #{height}px;' id='category_"+this.id+"'></div>");var g={ad:false,drag:true,title:"分类管理",content:a.evaluate(f),shadow:1,width:f.width,height:f.height};var c={};var b=winDialog.createCustomsDialog(g,c);this.dialog=b;$E("category_"+this.id).innerHTML=this.tpl.join("");var j=this;this.dialog.nodes.btnClose.href="javascript:;";this.dialog.nodes.btnClose.onclick=function(){if(j.manage.getEdit()){winDialog.confirm("是否保存此更改？",{funcOk:function(){j.manage.saveHandler(j.url)},funcCancel:function(){j.close()},funcClose:function(){j.dialog.show()},textOk:"是",textCancel:"否"})}else{j.close()}};this.initEvent()},initEvent:function(){this.manage.nameEvent();this.manage.createEvent();this.manage.dataProvider();this.manage.saveEvent(this.url)},hidden:function(){this.dialog.hidden()},close:function(){this.dialog.hidden();this.dialog.destroy()},showOld:function(){this.dialog.show()},reset:function(){window.CateDialog.dialog.setCloseEvent(true);window.CateDialog.dialog.hidden();window.CateDialog.dialog=null;window.CateDialog.init=false},setSize:function(b,a){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(b,a);c.style.width=b+"px";c.style.height=a+"px"},setCloseEvent:function(a){},getDialog:function(){return this.dialog},getId:function(){return this.id},getDataList:function(){return this.manage.list},onSuccess:function(a){},init:false,dialog:null,tpl:['<div id="categoryBody">','<div id="categoryTitle">',"</div>",'<div id="categoryHead">',"<table>","<tr>",'<td><input type="text" maxlength="28" value="最多可输入14个中文字符" id="categoryName"/></td>','<td width="80"><a id="categoryCreate" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>创建分类</cite></a></td>','<td><span class="SG_txtc">请用中文、英文或数字。</span></td>',"</tr>","</table>",'<div id="errTips"></div>',"</div>",'<form method="post" id="categoryForm" name="form">','<div id="categoryList">','<ul class="clearfix" id="datalist">&nbsp;</ul>','<div class="SG_j_linedot"></div>',"</div>",'<div id="categoryBottom" style="text-align:center">','<a id="categorySave" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>保存设置<input type="button" value="保存设置"/></cite></a>',"</div>","</form>","</div>"],itemTpl:['<li class="{class}">','<span class="htit" style="color:#000000" id="cate_{index}">{cate}</span>','<input type="hidden" value="{cate}" name="typename[]" class="catName"/>','<input type="hidden" value="{id}" name="number[]"/>','<span id="ctrl_{index}" class="control">','<div class="manage">','<a class="CP_a_fuc" id="edit_{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.editCate(this);">[<cite>编辑</cite>]</a>','<a class="CP_a_fuc" id="del_{index}" index="{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.delCate(this);">[<cite>删除</cite>]</a>',"</div>",'<div class="arrow">','<a id="up_{index}" class="{up_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.upHandler(this);"/>','<a id="down_{index}" class="{down_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.downHandler(this);"/>',"</div>","</span>",'<div id="editctrl_{index}" class="writeinfo" style="display:none">','<input id="new_{index}" type="text" value="" /><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>',"<div/>","</li>"]};var cateMng=Core.Class.create();cateMng.prototype={list:null,orilen:0,edit:false,uid:null,initialize:function(c,b,a){this.uid=a||scope.$uid;this.id=c;this.itemTpl=b;Array.prototype.remove=function(d){if(isNaN(d)||d>this.length){return false}this.splice(d,1)}},nameEvent:function(){var a=this;$E("categoryName").onfocus=function(){if(this.value=="最多可输入14个中文字符"){this.value=""}};$E("categoryName").onblur=function(){var b=/[ ><\\\'\;\"`\|\t\r\n|\u3000]/ig;this.value=this.value.replace(b,"");if(Core.String.trim($E("categoryName").value)==""){this.value="最多可输入14个中文字符";this.edit=false}else{this.edit=true}a.showTips("")};$E("categoryName").onkeyup=function(){var b=Core.String.trim(this.value);if(Core.String.byteLength(b)>28){this.value=Core.String.leftB(b,28)}else{if(b!=this.value){this.value=b}}};a.showTips("")},createEvent:function(){var c=this;var b="";$E("categoryCreate").onclick=function(){if(a()&&$E("categoryName").edit){var d={id:-1,name:$E("categoryName").value};$E("categoryName").value="最多可输入14个中文字符";$E("categoryName").edit=false;c.list.push(d);c.update()}c.showTips(b)};function a(){var f=Core.String.trim($E("categoryName").value);b="";if(f==""||f=="最多可输入14个中文字符"){b="分类名称不能为空"}else{if(f.indexOf("&")!=-1||f.indexOf("＆")!=-1){b="分类名称不能包含&符号"}else{if(c.list.length>=15){b="抱歉！最多可创建15条分类"}else{if(Core.String.byteLength(f)>28){b="最多可输入14个中文字符"}}}}for(var d=0;d<c.list.length;d++){if(c.list[d].name==f){b="您已经添加过此分类";break}}if(b!=""){return false}else{return true}}},saveEvent:function(a){Core.Events.stopEvent();var b=this;$E("categorySave").onclick=function(){b.saveHandler(a)}},saveHandler:function(url){var _this=this;var length=_this.list.length;if(_this.orilen-length>2){winDialog.confirm("您本次删除的博文分类太多，确定删除？",{funcOk:function(){_this.orilen=length;$E("categorySave").onclick()}});return}var cateName=[];var cateId=[];for(var i=0;i<length;i++){var item=_this.list[i];cateName.push(item.name);cateId.push(item.id)}Utils.Io.Ijax.request(url+"&r="+Math.random(),{POST:{typename:cateName.join("|"),number:cateId.join("|")},onComplete:function(res){eval("var result = "+res);try{try{if($E("module_3")){Lib.Component.refresh(3,{width:scope.catedialogwidth||210})}if($E("module_7")){location.reload()}}catch(error){trace(error)}try{window.ArticleCateFuncs.reloadCate(result.msg)}catch(error){}window.CateDialog.close()}catch(e){}var r;eval("r="+res);_this.onSuccess(r.msg)},onException:function(res){}})},editCate:function(g){var j=this;var d=g.id.split("_")[1];var b=$E("cate_"+d).innerHTML;var a=$E("cate_"+d).parentNode;$E("ctrl_"+d).className="control hide";a.className=d%2==0?"editName":"cline editName";var c='<div id="editctrl_'+d+'" class="writeinfo"><input id="new_'+d+'" type="text" value="'+b+'"><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>';a.innerHTML=c;$E("new_"+d).onkeyup=function(){var m=/[ >&<\\\'\,\;\"`\|\t\r\n|\u3000]/ig;var n=Core.String.trim(this.value.replace(m,""));if(n!=this.value){this.value=n}if(n==""){$E("editctrl_"+d).childNodes[1].disabled=true}else{$E("editctrl_"+d).childNodes[1].disabled=false}};$E("new_"+d).onblur=function(){if(Core.String.byteLength(this.value)>=28){this.value=Core.String.leftB(this.value,28)}};$E("editctrl_"+d).childNodes[1].onclick=function(){if($E("new_"+d).value==b){f(b,2)}else{f($E("new_"+d).value,1)}};$E("editctrl_"+d).childNodes[2].onclick=function(){f(b,2)};function f(r,o){var s=r;var q="";if(Core.String.byteLength(s)>28){s=Core.String.leftB(s,28)}if(o==1){for(var n=0;n<j.list.length;n++){if(j.list[n].name==s){q="您已经添加过此分类";break}}}if(q!=""){if(!$E("err_"+d)){Core.Dom.addHTML($E("editctrl_"+d),'<div id="err_'+d+'" class="errTips">'+q+"</div>");a.style.height="60px"}else{$E("err_"+d).value=q}}else{j.list[d].name=s;var m=j.itemTpl.join("");m=m.replace('<li class="{class}">',"");m=m.replace("</li>");var p=j.list[d];m=m.replace(/\{cate\}/ig,p.name);m=m.replace(/\{id\}/ig,p.id);m=m.replace(/\{index\}/ig,d);m=m.replace(/\{up_class\}/,d==0?"up_disabled":"up");m=m.replace(/\{down_class\}/,d==j.list.length-1?"down_disabled":"down");a.innerHTML=m;a.className=d%2==0?"":"cline";a.style.height="30px";if(o==1){j.edit=true}}q=""}},delCate:function(b){var c=this;var a=b.id.split("_")[1];winDialog.confirm("确实要删除此分类吗？删除后不可恢复。",{funcOk:function(){c.list.remove(a);c.update()}})},upHandler:function(c){var b=c.id.split("_")[1];if(b>0){var a=this.list[b];this.list[b]=this.list[b-1];this.list[b-1]=a;this.update()}},downHandler:function(d){var b=d.id.split("_")[1];if(b<this.list.length-1){var c=b*1+1;var a=this.list[c];this.list[c]=this.list[b];this.list[b]=a;this.update()}},showTips:function(a){$E("errTips").innerHTML=a},dataProvider:function(){var a=this;App.getArticlesSort(function(f){a.list=f.data;a.orilen=a.list.length;$E("datalist").innerHTML="";for(var c=0;c<a.list.length;c++){var b=a.itemTpl.join("");var d=a.list[c];b=b.replace(/\{cate\}/ig,d.name);b=b.replace(/\{class\}/ig,c%2==0?"":"cline");b=b.replace(/\{id\}/ig,d.id);b=b.replace(/\{index\}/ig,c);b=b.replace(/\{up_class\}/,c==0?"up_disabled":"up");b=b.replace(/\{down_class\}/,c==a.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),b)}},this.uid)},update:function(){$E("datalist").innerHTML="";for(var b=0;b<this.list.length;b++){var a=this.itemTpl.join("");var c=this.list[b];a=a.replace(/\{cate\}/ig,c.name);a=a.replace(/\{class\}/ig,b%2==0?"":"cline");a=a.replace(/\{id\}/ig,c.id);a=a.replace(/\{index\}/ig,b);a=a.replace(/\{up_class\}/,b==0?"up_disabled":"up");a=a.replace(/\{down_class\}/,b==this.list.length-1?"down_disabled":"down");Core.Dom.addHTML($E("datalist"),a)}if(!this.edit){this.edit=true}},getEdit:function(){return this.edit},onSuccess:function(a){}};var QuoteSuccess=Core.Class.create();QuoteSuccess.prototype={interfaceSave:null,_isDialogInit:false,_dialog:null,memoNullText:"说点什么...",articleID:"",_cateList:[],initialize:function(){Lib.checkAuthor();this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax");!window.CateDialog&&(window.CateDialog=new cateDialog())},show:function(a){!this._isDialogInit&&this._initDialog();this.articleID=a||"";this._dialog.show();this._dialog.setFixed(true);this._dialog.setMiddle();this._dialog.setAreaLocked(true)},save:function(){var b=this,a=this._dialog.nodes;this.interfaceSave.request({POST:{new_cat:a.selCate.value,blog_id:b.articleID,reship:a.txtMemo.value===b.memoNullText?"":a.txtMemo.value},onSuccess:function(c){b.onSuccess(c);b.close()},onError:function(c){b.onError(c)},onFail:function(){}})},close:function(){this._dialog.hidden();this.clear()},_initDialog:function(){var a=this;this._dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon6">','<div class="turnBox">','<p class="turnTxt">','<img class="SG_icon SG_icon203" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<span class="txt1">转载成功！</span>你还可以写评论...',"</p>","<ul>",'<li><span class="a">评论：</span><span class="b"><textarea id="#{txtMemo}" style="color:#c8c8c8;" cols="" rows="3" class="SG_textarea">'+this.memoNullText+"</textarea></span></li>","<li>",'<span class="a">分类：</span>','<span class="b"><select id="#{selCate}" name=""><option value="00">默认文章分类</option></select>&nbsp;&nbsp;<a id="#{btnShowCate}" href="#" onclick="return false;">创建分类</a></span>',"</li>","</ul>",'<div class="clearit"></div>','<div class="butt">','<a href="#" id="#{btnSave}" onclick="return false;" class="SG_aBtn SG_aBtnB"><cite>保存</cite></a>&nbsp;&nbsp;<a id="#{btnCancel}" onclick="return false;" href="#" class="SG_aBtn SG_aBtnB "><cite>关闭</cite></a>','<a style="visibility:hidden" target="_blank" href="http://blog.sina.com.cn/admin/advice/advice_list.php" class="link">改进建议</a>',"</div>","</div>",'<div class="clearit"></div>',"</div>"].join("")});Core.Events.addEvent(this._dialog.nodes.btnSave,function(){if(a._dialog.nodes.txtMemo.value===a.memoNullText&&a._dialog.nodes.selCate.selectedIndex===0){a.close()}else{a.verified()&&a.save()}},"click");Core.Events.addEvent(this._dialog.nodes.btnCancel,function(){a.close()},"click");Core.Events.addEvent(this._dialog.nodes.btnShowCate,function(){window.CateDialog.onSuccess=function(d){a._dialog.nodes.selCate.length=1;var f=d||[],c,b=f.length;for(c=0;c<b;c++){a.addCate(f[c].value,f[c].label)}a.addCate("0","私密博文")};Lib.checkAuthor();window.CateDialog.show($UID)},"click");this._dialog.addEventListener("hidden",function(){a.clear();a.onClose()});this._dialog.nodes.txtMemo.onblur=function(){if(this.value.replace(/\s/g,"")===""){this.style.color="#c8c8c8";this.value=a.memoNullText}};this._dialog.nodes.txtMemo.onfocus=function(){if(this.value===a.memoNullText){this.style.color="#000000";this.value=""}};this._initCateList();this._isDialogInit=true},verified:function(){var a=this._dialog.nodes;if(Core.String.byteLength(a.txtMemo.value)>2000){winDialog.alert("评论内容必须是1000中文或2000字符以内，请重新输入。");return false}return true},_initCateList:function(){var a=this._dialog.nodes,b=this;a.selCate.length=1;Lib.checkAuthor();App.getArticlesSort(function(){var f=x.data,d,c=f.length;for(d=0;d<c;d++){b.addCate(f[d].id,f[d].name)}b.addCate("0","私密博文")},$UID)},_getFaceURL:function(a){var b=parseInt(a)%8+1;return"http://portrait"+b+".sinaimg.cn/"+a+"/blog/50"},addCate:function(d,a){var b=this._dialog.nodes.selCate;var c=$C("option");c.value=d;c.innerHTML=a;b.appendChild(c)},clear:function(){var a=this._dialog.nodes;a.txtMemo.style.color="#c8c8c8";a.txtMemo.value=this.memoNullText},onSuccess:function(a){},onError:function(a){},onClose:function(){}};var Quote=Core.Class.create();Quote.prototype={quoteSuccess:null,saving:false,articleID:"",initialize:function(a){this.quoteSuccess=new QuoteSuccess();this.initInterface();this.bindEvent(a);this.articleID=scope.$articleid},bindEvent:function(b){var a=this;if(b){Core.Events.addEvent($E(b),function(){a.check()})}},initInterface:function(){this._interface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote.php","ijax")},check:function(b,f,a,c){this.articleID=b||scope.$articleid;c=c||function(){};Lib.checkAuthor();var d=this;if(!$isLogin){v7sendLog("48_01_33");new Lib.Login.Ui().login(function(){scope.blogOpener.showDialog(function(){d.save.bind2(d)();c()})})}else{var d=this;scope.blogOpener.showDialog(function(){d.save(f,a);c()})}},save:function(c,a){var b=this;if(this.saving){return}this.saving=true;var d={version:7,blog_id:b.articleID,comment:a||"",reship:c||""};this._interface.request({POST:d,onSuccess:function(f){this.numAdd();this.saving=false;var g=f.url.split("/").pop().split("_")[1].split(".")[0];if(!c){this.quoteSuccess.onSuccess=function(){winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+f.url+"'>查看转载博文>></a></span>",{icon:"03"})};this.quoteSuccess.show(g)}this.onSuccess(g,f.url||"")}.bind2(this),onError:function(f){this.saving=false;if(f.code=="B119007"||f.code=="B119008"){winDialog.alert($SYSMSG[f.code],{icon:"01",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1");Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click");this.onError();return}if(f.code=="B119002"){winDialog.alert($SYSMSG[f.code],{icon:"01",funcOk:function(){window.location.href="http://control.blog.sina.com.cn/upgrade/upgrade_show.php?version=7"}})}else{winDialog.alert($SYSMSG[f.code],{icon:"02",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1");Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,function(){window.location.href=window.location.href.replace(/#.*$/,"")},"click")}this.onError()}.bind2(this),onFail:function(){this.saving=false}.bind2(this)})},numAdd:function(){var b=$E("quote_sign")||$E("quote_sign_"+this.articleID)||$E("z_"+this.articleID);if(!b){return}var c=b.innerHTML;var a;c.replace(/(\d+)/,function(f,d){a=d});b.innerHTML="("+(parseInt(a)+1)+")"},onSuccess:function(a){},onError:function(){}};var CommentQuote=Core.Class.create();CommentQuote.prototype={_isInitTip:false,_tip:null,quote:null,commentText:"",articleID:"",interfaceSave:null,initialize:function(){this.interfaceSave=new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax");this._initQuote()},_initQuote:function(){var a=this;this.quote=new Quote();this.quote.onSuccess=function(c,b){a.hideTip();winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+b+"'>查看转载博文>></a></span>",{icon:"03"});a.onSuccess()};this.quote.onError=function(){a.hideTip()}},showTip:function(c){var b,a=Core.System.winSize();!this._isInitTip&&this._initTip();b=this._tip;b.getNodes().content.innerHTML=c;b.visibility="hidden";b.show();b.setPosition(a.width/2-(+b.entity.offsetWidth)/2,a.height/2-(+b.entity.offsetHeight)/2);b.visibility="";b.setFixed(true)},check:function(a,b){this.articleID=a;this.commentText=b;this.quote.check(a,b,"1")},hideTip:function(){this._tip&&this._tip.hidden()},_initTip:function(){this._tip=new Lib.Panel();this._tip.setTemplate(['<div id="#{panel}" style="z-index:512;border:1px solid #CC9933; background:#FFFFCC; padding:20px;">','<div id="#{content}"></div>',"</div>"].join(""));this._isInitTip=true},onSuccess:function(){}};scope.bindEmailPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(['<div id="#{panel}" style="z-index:512; width:200px" class="tb_layer_Y tb_layer_w5">','<div class="tb_layer_Y_main tip_layer_main">','<div class="tip_ps" style="width:auto;float:right">','<a id="closeBindEmail" title="关闭提示" class="tb_friend_inputDel" href="#" onclick="return false"></a>',"</div>",'<div style="padding:6px">为了您的账号安全，请<a id="linkBindEmail" href="#" target="_blank">绑定邮箱</a></div>',"</div>",'<div class="tb_layer_arrow tip_arrow"></div>',"</div>"].join(""))},Lib.Panel,{initUserInfo:function(b){var a=this.getNodes()}});$registJob("articleCommentPostV2",function(){if(!$E("comment_check_img")){return}var o=new CommentQuote();o.onSuccess=function(){$E("cbCommentQuote")&&($E("cbCommentQuote").checked=false)};function m(){var C=$E("commentNick");if(!C){return}for(var E=C.firstChild;E;E=E.nextSibling){C.removeChild(E)}C.innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>';scope.addBlogOpenerEvent($E("openblog-li"));var D=setInterval(function(){if(!scope.nickname){return}$E("openblog-nickname").innerHTML=scope.nickname+"：";clearInterval(D)},100)}if(scope.$private.cms!=1&&scope.$isCommentAllow!=1){var t=false;$E("comment_check_img").style.display="none";var A=new CommentV2.Post();var p=function(){$E("commentNick").style.display="";if(checkUserProduct.flag==true){scope.setNickTime=setInterval(function(){var C=Lib.blogv.getVHTML(scope.loginUserWtype);if(typeof scope.$loginNick=="undefined"){Lib.Uic.getNickName([$UID],function(D){for(var E in D){scope.$loginNick=D[E];$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+C+":"}});clearInterval(scope.setNickTime)}else{$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+C+":"}},500)}else{m()}};if($isLogin){if(checkUserProduct.isinit==false){setTimeout(function(){checkUserProduct.check("blog",p)},10)}else{p()}}else{$E("commentlogin").style.display="block";var g=Utils.Cookie.getCookie("remberloginname");if(g!=""&&g!=""){$E("login_name").value=unescape(unescape(g))}var c=Utils.Cookie.getCookie("ALF");if(c!=""&&$E("login_remember")){$E("login_remember").checked=true}var c=Utils.Cookie.getCookie("LiRe");if(c!=""&&$E("login_remember")){$E("login_remember").checked=true}if($E("anonymity_cont")){$E("anonymity")&&($E("anonymity").checked=false);$E("anonymity_cont").style.display="none"}}if($E("bb")){$E("bb").checked=Utils.Cookie.getCookie("acp_bb")=="1"?false:true}var a=function(){Lib.checkAuthor();var E=$E("login_remember");if(!E){return}E.checked=true;if(!$isLogin){E.onclick=C}var D=1;function C(){if(D){var F="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00003&rnd="+Math.random();Utils.Io.JsLoad.request(F,{onComplete:function(){},onException:function(){}});D=null}}};a();if($E("anonymity")&&$E("anonymity").checked){A.anonyous=true;$E("commentlogin").style.display="none";$E("commentloginM").style.display=""}Core.Events.addEvent($E("comment_anonyous"),function(){if($E("anonymity")&&$E("anonymity").checked&&Core.String.trim($E("comment_anonyous").value)=="新浪网友"){$E("comment_anonyous").value=""}},"focus");Core.Events.addEvent($E("comment_anonyous"),function(){if($E("anonymity")&&$E("anonymity").checked&&Core.String.trim($E("comment_anonyous").value)==""){$E("comment_anonyous").value="新浪网友"}},"blur");var u=new scope.bindEmailPanel();Core.Events.addEvent($E("login_name"),function(){u.hidden()},"focus");Core.Events.addEvent($E("login_name"),function(){var C=$E("login_name").value;if(!C){return}f(C)},"blur");function f(C){Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(C)+"&utf82gbk=1&callback=scope.$bindEmailTip",{noreturn:true})}scope.$bindEmailTip=function(D){if(D.ret=="y"||D.errcode=="not_verify"){var C=$E("login_name");u.showWithDom(C,-150,-55);$E("linkBindEmail").href="http://login.sina.com.cn/bindmail/signin.php?entry=blog&utf82gbk=1&username="+encodeURIComponent(C.value)}else{u.hidden()}};Core.Events.addEvent($E("closeBindEmail"),function(){u.hidden()});Core.Events.addEvent("postcommentid",function(){try{u.hidden()}catch(C){}});var b=function(){if($IE8){$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image_ie8.php?"+new Date().valueOf()}else{$E("comment_check_img").src="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+new Date().valueOf()}r("img")};function r(D){var C=D||"check";if(C=="img"){$E("comment_check_img").style.display="inline";$E("check_show").style.display="none"}else{$E("comment_check_img").style.display="none";$E("check_show").style.display=""}}A.articleid=scope.$articleid;A.onSuccess=function(){if(scope.commEditor){scope.commEditor.clearHTML("postCommentIframe")}var C=$E("cbCommentQuote");if(C&&C.checked){o.check($r_quote_bligid,$E("commentArea").value)}$E("commentArea").value="";$E("login_check").value="";if(q&&s){s.value=""}r()};A.onError=function(){b()};if($E("anonymity")){Core.Events.addEvent("anonymity",function(){var E=$E("commentNick");v7sendLog("32_01_17");var D=(checkUserProduct.flag&&checkUserProduct.isinit)||false;D&&$isLogin&&E&&(E.style.display="");if($E("anonymity").checked){A.anonyous=true;$E("commentlogin").style.display="none";$E("commentloginM").style.display="block";$E("cbCommentQuote")&&($E("cbCommentQuote").checked=false);E&&(E.innerHTML="你正以匿名身份发表评论:")}else{var C=Lib.blogv.getVHTML(scope.loginUserWtype);A.anonyous=false;$E("commentlogin").style.display=$isLogin?"none":"block";$E("commentloginM").style.display="none";if(D){E&&(E.innerHTML=(scope.$loginNick||scope.nickname)+"&nbsp;"+C+":")}else{m()}}$E("cbCommentQuote")&&($E("cbCommentQuote").disabled=$E("anonymity").checked);$E("quote_comment_p")&&($E("quote_comment_p").style.display=$E("anonymity").checked?"none":"")})}if($E("bb")){Core.Events.addEvent($E("bb"),function(){v7sendLog("32_01_18")})}if(!$E("postCommentIframe")){Core.Events.addEvent("commentArea",function(){if(t){return}$E("check_show").style.display="none";b();t=true},"focus")}Core.Events.addEvent("login_check",function(){if(t){return}$E("check_show").style.display="none";b();t=true},"focus");Core.Events.addEvent("check_show",function(){if(t){return}$E("check_show").style.display="none";b();t=true},"click");Core.Events.addEvent("comment_check_img",function(){b()},"mousedown");var q=/Mobile/i.test(navigator.userAgent),n=$E("mobileComment"),s=$E("mbCommentTa");if(q&&n){$E("commonComment").style.display="none";$E("faceWrap").style.display="none";n.style.display="";var B=$E("anonymity_cont");B&&(B.style.cssFloat="left")}var v=function(){if(Core.Events.getEvent()){var D=Core.Events.getEvent();if(D.type=="keydown"&&D.keyCode!=13){return}else{if(D.type=="keydown"&&D.keyCode==13){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}}}Core.Events.stopEvent()}if(!$isLogin&&$E("anonymity")&&$E("anonymity").checked==false){if(Core.String.trim($E("login_name").value)==""){showError($SYSMSG.B36107);return}else{if(Core.String.trim($E("login_pass").value)==""){showError($SYSMSG.B36108);return}}}if(q&&s){$E("commentArea").value=s.value}if($E("anonymity")&&$E("anonymity").checked==true&&Core.String.trim($E("comment_anonyous").value)==""){showError($SYSMSG.B36003)}else{if(Core.String.trim($E("commentArea").value)==""){showError($SYSMSG.B36105)}else{if(Core.String.trim($E("login_check").value)==""){winDialog.alert($SYSMSG.B36106,{funcOk:function(){$E("login_check").value="";$E("login_check").focus()}})}else{var C={comment:$E("commentArea").value,login_name:$E("login_name").value,login_pass:$E("login_pass").value,check:$E("login_check").value,comment_anonyous:$E("comment_anonyous").value,anonymity:($E("anonymity")&&$E("anonymity").checked),is_mobile:+q,is_t:0};if($E("login_remember")){C.login_remember=$E("login_remember").checked;if(C.login_remember){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}}if($E("bb")){if((!A.anonyous||!$E("anonymity"))&&$E("bb").checked){C.is_t=1;if(Utils.Cookie.getCookie("acp_bb")=="1"){Utils.Cookie.setCookie("acp_bb","",-1,"/",".blog.sina.com.cn")}}else{C.is_t=0;if(Utils.Cookie.getCookie("acp_bb")!="1"){Utils.Cookie.setCookie("acp_bb","1",2400,"/",".blog.sina.com.cn")}}}A.post(C);t=false}}}};Core.Events.addEvent($E("commentArea"),function(){var C=Core.Events.getEvent();if(C.ctrlKey&&C.keyCode===13){v()}},"keydown");Core.Events.addEvent("postcommentid",function(){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}v()});Core.Events.addEvent($E("postcommentid").parentNode,function(){if(scope.commEditor){scope.commEditor.handleChange("postCommentIframe")}v()},"keydown");Core.Events.addEvent($E("login_check"),v,"keydown");if($E("smilesSortShow")==null){$E("commentArea").style.width="680px";var y=new CommentV2.insertSmile();y.show()}else{var z=[-325,40+($IE?-2:0)],d;if(scope.$pageid.indexOf("articletj")!==-1){d={sortCount:4,recommCount:6}}if($E("postCommentIframe")){var j={normal:{focus:function(){if(t){return}$E("check_show").style.display="none";b();t=true}}};App.formInsertSmile2("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",z,"postCommentIframe",j,d)}else{App.formInsertSmile("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",z,null,null,d)}}}});Core.Dom.getChildrenByClass=function(j,g){var b=[];var f=j.childNodes||j.children;var g=" "+g+" ";var a=f.length;for(var d=0;d<a;++d){var m=f[d];var c=" "+m.className+" ";if(c.indexOf(g)!=-1){b[b.length]=m}}return b};Lib.pkg("util");Lib.util.hoverJq=function(d){var n={elm:document.body,mouseenter:function(o,q,p){},mouseleave:function(o,q,p){},delay:0};d=Lib.apply(n,d);var m=$IE?"mouseenter":"mouseover",f=$IE?"mouseleave":"mouseout";if(!("length" in d.elm)){d.elm=[d.elm]}else{try{d.elm=Array.prototype.slice.call(d.elm,0)}catch(g){var a=[];for(var b=0,c=d.elm.length;b<c;b++){a.push(d.elm[b])}d.elm=a}}Core.Array.foreach(d.elm,function(p,o){Core.Events.removeEvent(p,m);Core.Events.removeEvent(p,f);Core.Events.addEvent(p,(function(r,s,q){return function(t){t=t||window.event;if($IE){s.apply(r,[t,r,q])}else{j(t,"mouseenter",r,q)}}})(p,d[m],o),m);Core.Events.addEvent(p,(function(r,s,q){return function(t){if($IE){s.apply(r,[t,r,q])}else{j(t,"mouseleave",r,q)}}})(p,d[f],o),f)});var j=function(r,q,t,p){var o=r.relatedTarget;try{if(o&&o!==document&&!o.parentNode){return}while(o&&o!==t){o=o.parentNode}if(o!==t){d[q].apply(t,[r,t,p])}}catch(s){}return false}};Lib.register("tray.tpl.loginMemu",function(){var a=['<div class="ntopbar_menu" id="#{panel}">','<div id="#{openBlog}" style="display:none;">','<span class="link" id="#{userMenu}"><a id="#{userNick}" onclick="v7sendLog(\'40_01_21\');return false;" href="###">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span id="#{msnHolder}" class="ico_msn" style="display:none"><a id="#{msnLink}" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c=" target="_blank"><img height="18" width="18" align="absmiddle" class="SG_icon SG_icon136" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_27\')" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<em id="#{newFeed}" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>','<span class="link" id="#{blogMenu}"><a target="_blank" onclick="v7sendLog(\'40_01_24\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a><a id="#{addArticle}" onclick="v7sendLog(\'40_01_25\');return false;" href="###" class="link_arrow"></a></span>','<span class="line_s"></span>','<span class="link" id="#{trayMsg}" msg-panel-show-state="0"><a onclick="v7sendLog(\'40_01_30\');return false;" href="###">消息</a><a href="javascript:return false;" class="link_arrow" title=""></a></span>','<em id="#{newTips}" onclick="v7sendLog(\'40_01_29\')" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>',"</div>",'<div id="#{noOpenBlog}" style="display:none;">','<span class="link"><a id="#{ssoNick}" onclick="v7sendLog(\'40_01_40\');return false;" href="###">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a id="#{ssoLoginOut}" onclick="v7sendLog(\'40_01_41\');return false;" href="###">退出</a></span>','<div class="ntopbar_login" style="float:left;"><a id="#{openBlogBtn}" onclick="v7sendLog(\'40_01_42\')" class="login" href="###"><span>立即拥有一个新博客</span></a></div>',"</div>","</div>"].join("");return a});Lib.register("tray.tpl.loginOutMemu",function(){var b=scope.$uid||"";var c="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+b+"&src=";if(scope.$channel==2){c+="baby"}else{c+="blogicp"}var a=['<div id="#{panel}" class="ntopbar_login">','<a class="login" onclick="v7sendLog(\'40_01_38\');return false;" href="###" action-type="tray-login-btn"><span>登录</span></a>','<a class="register" onclick="v7sendLog(\'40_01_39\')" target="_blank" href="',c,'">注册</a></div>'].join("");return a});Lib.register("tray.tpl.userMenu",function(){var a=['<div id="#{panel}" class="mUserMenu">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle">博客</a></span>','<span class="rlink"><a target="_blank" onclick="v7sendLog(\'40_01_22\')" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a></span>',"</li>",'<li> <span class="tb_ps_nm"><a id="#{linkPhoto}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle">相册</a></span> <span class="rlink"><a target="_blank" id="#{linkPostPhoto}" onclick="v7sendLog(\'40_01_22\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{miniblog}" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon110" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="17" title="微博" align="absmiddle">微博</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle">Qing</a></span> </li>','<li style="display:none;" id="#{mail}"> <span class="tb_ps_nm"><a id="#{bindEmail}" target="_blank" href="http://mail.sina.com.cn/?s=2" onclick="v7sendLog(\'40_01_22\')"><img class="SG_icon SG_icon212" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="邮件" align="absmiddle">邮件</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{mySpace}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle">关于我</a></span> </li>',"</ul>",'<div class="links">','<p><a target="_blank" id="#{linkChangeFace}" onclick="v7sendLog(\'40_01_22\')" href="###">修改头像昵称&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkChangePassword}" onclick="v7sendLog(\'40_01_22\')" href="###">修改登录密码&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" onclick="v7sendLog(\'40_01_22\')" href="###">帐号安全设置&gt;&gt;</a></p>','<p><a id="#{loginOut}" onclick="v7sendLog(\'40_01_23\');return false;" href="#">退出&gt;&gt;</a></p>',"</div>","</div>"].join("");return a});Lib.register("tray.loginOut",function(b){var a=b.Listener;return function(c,d){var f=encodeURIComponent(window.location.href);new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(g){a.notify("global-login-out",g);c&&c(g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}},onError:function(g){a.notify("global-login-out",g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}},onFail:function(g){a.notify("global-login-out",g);if(d){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+f}}})}});Lib.register("tray.UserMenuPanel",function(b){var a=Core.Class.define(function(){b.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(b.tray.tpl.userMenu)},b.Panel,{initUserInfo:function(d){var c=this.getNodes();c.linkBlog.href="http://blog.sina.com.cn/u/"+d;c.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+d;c.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+d;c.qingblog.href="http://qing.weibo.com/fancy.html";c.mySpace.href="http://blog.sina.com.cn/s/profile_"+d+".html";c.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php";c.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php";c.linkAccountSetup.href="http://login.sina.com.cn/member/security.php";this.initLoginOut(c.loginOut)},initLoginOut:function(c){c.onclick=function(){return false};Core.Events.addEvent(c,function(){b.tray.loginOut(null,!0)})}});return a});Lib.register("tray.tpl.blogMenu",function(){var a=['<div id="#{panel}" class="wrtBlog_sub">','<div class="wrtBlog_sub3">','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365">写365</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>',"</div>","</div>"].join("");return a});Lib.register("tray.BlogMenuPanel",function(b){var a=Core.Class.define(function(){b.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(b.tray.tpl.blogMenu)},b.Panel,{});return a});Lib.register("tray.tpl.searchForm",function(){var a=['<div class="ntopbar_input" id="#{panel}">','<form id="#{searchForm}" method="get" target="_blank" action="http://search.sina.com.cn">','<input id="#{queryTxt}" class="ntopbar_txt" type="text" name="q" autocomplete="off"/>','<input id="#{submit}" type="submit" onclick="v7sendLog(\'40_01_44\')" class="ntopbar_searchBtn" value=""/>','<input type="hidden" name="ie" value="utf-8"/>','<input type="hidden" name="e" value="utf-8"/>','<input id="#{range}" type="hidden" name="range" value="article"/>','<input id="#{t}" type="hidden" name="t" value=""/>','<input id="#{s}" type="hidden" name="s" value="sup"/>','<input id="#{by}" type="hidden" name="by" value="all"/>','<input id="#{type}" type="hidden" name="type" value=""/>','<input id="#{stype}" type="hidden" name="stype" value="1"/>','<input id="#{c}" type="hidden" name="c" value="blog"/>',"</form>","</div>"].join("");return a});Core.Dom.addClass=function(f,a){var n=Core.String.trim;a=n(a);if(!a){return f}f=$E(f);var g=n(f.className||"");var m=" "+g+" ";if(!g){f.className=n(a);return f}var c=a.split(" ");var b,j=[];for(var d=0;d<c.length;d++){b=c[d];if(b&&-1===m.indexOf(" "+b+" ")){j.push(b)}}f.className=g+" "+j.join(" ");return f};Core.Dom.removeClass=function(b,a){b=$E(b);b.className=b.className.replace(new RegExp("\\s*\\b"+a+"\\b"),"")};Lib.util.getActionData=function(r,d,a,c){if(!d){throw"[Lib.util.getActionData] param actionType is undefined!"}r=r||window.event;var p=Core.Events.getEventTarget,m,f,b,o,q,j,a=a||"action-type",c=c||"action-data";m=p(r);f=r.currentTarget||(document.documentElement||document.body);while(m&&m!=f){b=m.getAttribute(a)||"";o=b.split(",");for(var g=0,n=o.length;g<n;g++){q=o[g];if(d===q){j=m.getAttribute(c);return{actionType:d,targetEl:m,data:j}}}m=m.parentNode}return null};Lib.register("tray.tpl.cateSearch",function(){var a=['<div id="#{panel}" class="mCatSearch">',"<ul>",'<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="article" class="current">含“<span id="#{article}"></span>”的博文</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="bloger">含“<span id="#{bloger}"></span>”的博主</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="music">含“<span id="#{music}"></span>”的音乐</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="video">含“<span id="#{video}"></span>”的视频</li>',"</ul>","</div>"].join("");return a});Lib.register("tray.CateSearchPanel",function(d){var c=Core.Events.addEvent;var b=Core.String.leftB;var a=Core.String.byteLength;var f=Core.Class.define(function(){d.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(d.tray.tpl.cateSearch);this.initEvt()},d.Panel,{initEvt:function(){var g=this.getNodes();var j=$T(g.panel,"li");d.util.hoverJq({elm:j,mouseenter:function(m,o,n){Core.Dom.addClass(o,"current")},mouseleave:function(m,o,n){Core.Dom.removeClass(o,"current")},delay:50});c(g.panel,function(m){m=m||window.event;var n=d.util.getActionData(m,"tray-search");if(n){d.Listener.notify("tray-categroy-search",n.data)}})},updateSearch:function(j){if(5<a(j)){j=b(j,4)+"..."}var m=j.replace(/(<|>)/g,function(n){if("<"===n){return"&lt;"}else{return"&gt;"}});var g=this.getNodes();g.article.innerHTML=m;g.bloger.innerHTML=m;g.music.innerHTML=m;g.video.innerHTML=m}});return f});Lib.register("tray.SearchFormPanel",function(d){var b=Core.Events.addEvent;var c=Core.String.trim;var a=Core.Class.define(function(f){d.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(d.tray.tpl.searchForm);this.initEvt();this.catePanel=new d.tray.CateSearchPanel();this.catePanel.entity.style.zIndex=512;d.Listener.on({name:"tray-categroy-search",callBack:this.search,scope:this})},d.Panel,{initEvt:function(){var f=this;var g=this.getNode("queryTxt");b(g,function(j){j=j||window.event;var n=j.target||j.srcElement;var m=n.offsetWidth;f.showCateSearch(n,m,n.value)},"input");b(g,function(j){console.log(j);j=j||window.event;if("value"!==j.propertyName){return}var n=j.target||j.srcElement;var m=n.offsetWidth;f.showCateSearch(n,m,n.value)},"propertychange");b(g,function(j){j=j||window.event;var n=j.target||j.srcElement;var m=n.offsetWidth;f.showCateSearch(n,m,n.value)},"focus");b(this.getNode("searchForm"),function(j){j=j||window.event;var m=j.target||j.srcElement;if(!f.checkValidate(m)){Core.Events.stopEvent(j)}else{setTimeout(function(){f.hideCateSearch();f.resetForm()},100)}},"submit");b(window,function(){if(f.catePanel.isShow){var j=g.offsetWidth;f.catePanel.showWithDom(g,-j,4)}},"resize")},checkValidate:function(f){if(("q" in f)&&!c(f.q.value)){return false}else{if(("k" in f)&&!c(f.k.value)){return false}else{return true}}},setForm:function(j,g){var o={queryTxt:"q",ie:"utf-8",range:"",t:"",s:"",by:"",type:"",stype:"",e:"utf-8",c:""};var n=this.getNode("searchForm");n.action=j;d.apply(o,g);var r=this.getNode("queryTxt");r.name=o.queryTxt;delete o.queryTxt;var f,m;for(var q in o){f=o[q];if(typeof f==="string"&&(m=this.getNode(q))){m.value=f}}},resetForm:function(){this.setForm("http://search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})},search:function(m){var j=this.getNode("searchForm");var g="http://search.sina.com.cn";var f="http://video.sina.com.cn/search/index.php";var n="http://music.sina.com.cn/yueku/search/s.php";switch(m){case"video":this.setForm(f,{queryTxt:"k",s:"sup",type:"boke",stype:"1"});break;case"bloger":this.setForm(g,{queryTxt:"q",range:"author",s:"sup",by:"all",stype:"1",c:"blog"});break;case"music":this.setForm(n,{queryTxt:"k",t:"song"});break;default:this.setForm(g,{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})}if($IE){this.getNode("submit").click()}else{Core.Events.fireEvent(this.getNode("submit"),"click")}},showCateSearch:function(f,j,g){var m=this.catePanel;if(g&&m.isHidden){m.showWithDom(f,-j,4)}else{if(!g){this.hideCateSearch()}}m.updateSearch(g)},hideCateSearch:function(){var f=this.catePanel;f.hide();f.updateSearch("")}});return a});Lib.register("tray.loadUserInfo",function(d){var a=d.util.LS;var c=d.util.JSON;var b=function(j,f){var g="http://interface.blog.sina.com.cn/riaapi/profile/getNickName.php";Utils.Io.JsLoad.request(g,{GET:{uid:j},onComplete:function(o){if(o&&"A00006"===o.code){var p=o.data.nickname;var m={time:new Date().getTime()/1000};d.apply(m,o.data);a.setItem("uid"+j,c.stringify(m));f(m)}},onException:function(){},timeout:10000})};return function(m,f,o){var j=a.getItem("uid"+m);if(!o&&j){j=c.parse(j);var n=new Date().getTime()/1000;var g=n-j.time;if(g<4*60&&j.nickname){f(j);return}}b(m,f)}});Lib.register("tray.MsgLoader",function(f){var c=function(j){var g=$C("div");g.style.cssText="position:absolute;top:-1000px;left:-1000px;";document.body.appendChild(g);j.write(g)};var b="",d;if(window.$Maxthon||window.$360||window.$TT){b="?t="+Core.Math.getUniqueId()}var a=function(g){f.apply(this,g);if(!d){try{var j=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"blogMessageReminding.swf"+b,"__msgTipsPlayer","1px","1px","9","#00ff00");j.addParam("quality","high");j.addParam("wmode","transparent");j.addParam("allowScriptAccess","always");j.addParam("freeTime",27*1000);if("complete"===document.readyState){c(j);d=$E("__msgTipsPlayer")}else{_addEvt(window,function(){c(j);d=$E("__msgTipsPlayer")},"load")}}catch(m){}}}.$define({time:30,url:"http://comet.blog.sina.com.cn/api?maintype=notice",getFlaDom:function(){return d},play:function(){if($_GLOBAL.msgPlaySound&&d&&d.PlaySound){try{d.PlaySound()}catch(g){}}},load:function(m,g){var n=this;var j=scope.$articleid||"";if(!m){return}Utils.Io.JsLoad.request(this.url,{GET:{uid:m||"",blogid:j},onComplete:function(s){if(s&&"A00006"==s.code){var t,p;if(m&&(t=s.data[m])){var q={};q.sum=0;for(var o in t){q[o]=t[o];q.sum+=t[o]}q.blogrecomment=q.blogrecomment?q.blogrecomment:0;f.Listener.notify("tray-newmsg-loaded",q)}if(j&&(p=s.data[j])){f.Listener.notify("article-msg-loaded",p)}}},onException:function(){},timeout:10000})}});return a});Lib.register("tray.tpl.notice",function(){var a=['<div id="#{panel}" class="horn">','<div id="#{tj}" class="horn_con" style="display:none;">推荐：<a id="#{noticeAd1}" target="_blank" href="#"></a><a id="#{noticeAd2}" target="_blank" href="#"></a></div>','<div id="#{announce}" class="horn_con" style="display:none;"><p id="#{announceCon}">公告：<em>请您及时更换请请请您正在使用的模版将于2周后被下线，请您及时更换</em></p></div>','<a class="close" title="关闭" id="#{close}" style="float:none;">×</a>',"</div>"].join("");return a});Lib.register("tray.BlogNotice",function(f){var d=Core.Events.addEvent,c=Utils.Cookie.setCookie,b=scope.$pageid;var a=Core.Class.define(function(){f.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(f.tray.tpl.notice);this.initEvt()},f.Panel,{initEvt:function(){var g=this;d(this.getNode("close"),function(j){j=j||window.event;c("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn");f.Listener.notify("tray-announce-close",{});g.destroy()})},update:function(t){var p=this.getNode("tj"),g=this.getNode("announce");var j="";var o=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"];var r="http://comet.blog.sina.com.cn/api?maintype=pageslot";var m={id:o};if(typeof scope!="undefined"){m.blogeruid=scope.$uid}if($UID){m.loginuid=$UID}if($isLogin&&t.announce.result&&(b==="indexM"||b==="articleM"||b==="articlelistM")){g.innerHTML=t.announce.announce_con;g.style.display=""}else{var s=this.getNode("noticeAd1");var q=this.getNode("noticeAd2");var n=function(u){var y=0;var v=u[o[0]].res;var z=u[o[1]].res;if(v||z){if(v){y=0;if(v.length>1){y=Math.floor((v.length+1)*Math.random())}s.innerHTML=v[y].words;s.href=v[y].a_href;s.title=v[y].a_title;s.setAttribute("suda-uatrack",v[y].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(v[y].a_v_suda_key,v[y].a_v_suda_value)}}if(z){y=0;if(z.length>1){y=Math.floor((z.length+1)*Math.random())}q.innerHTML=z[y].words;q.href=z[y].a_href;q.title=z[y].a_title;q.setAttribute("suda-uatrack",z[y].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',""));if(typeof SUDA!=="undefined"){SUDA.uaTrack(z[y].a_v_suda_key,z[y].a_v_suda_value)}}p.style.display=""}};if(scope.__subscribeSlot==="waitting"){scope.__subscribeSlotFunc=n}else{if(typeof scope.__subscribeSlot==="object"){n(scope.__subscribeSlot)}else{scope.__subscribeSlot="waitting";Utils.Io.JsLoad.request(r,{GET:m,onComplete:function(u){n(u);scope.__subscribeSlot=u;if("function"==typeof scope.__subscribeSlotFunc){scope.__subscribeSlotFunc(u)}},onException:function(){}})}}}},setTemplate:function(g){this.template=g;var j=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=j;Core.Dom.insertHTML($E(this.appendTo),j.getHtmlString(),"afterbegin");this.entity=$E("_"+this.uniqueID+"_panel");this.entity.style.display="none";tempEntity=null}});return a});Lib.register("tray.unReadMsgPanel",function(a){var b=Core.Class.define(function(d){a.Panel.prototype.initialize();if(scope.$pageid=="editor"){return}this._lockstate=0;this._scrolling=0;this._srcPot=d;var c=['<div class="cor"></div>','<div class="bd">','<a href="#" id="j-unread-msg-close" class="close" title="关闭">×</a>','<ul id="j-unre-list">',"</ul>","</div>"].join("");this.setTemplate('<div class="messageTips" id="#{panel}" style="left:850px; top:10px;">'+c+"</div>");this.entity.style.zIndex=500;this._bindEvent()},a.Panel,{show:function(){if(this.isShow){return}v7sendLog("40_02_01");this.entity.style.display="";this._srcPot&&this._srcPot.setAttribute("unread-show-state",1);this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}a.Listener.notify("tray-unread-panel-show",{})},hide:function(){a.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("unread-show-state",0);a.Listener.notify("tray-unread-panel-hide",{})},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(j){var g=[];if((j.comment+j.message+j.notice+j.gbook)==0){this.hide();return}if(j.comment>0){g.push("<li>"+j.comment+'条新评论，<a onclick="v7sendLog(\'40_02_02\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">查看评论</a></li>')}if(j.message>0){g.push("<li>"+j.message+'条新纸条，<a onclick="v7sendLog(\'40_02_03\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">查看纸条</a></li>')}if(j.gbook>0){g.push("<li>"+j.gbook+'条新留言，<a onclick="v7sendLog(\'40_02_04\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php">查看留言</a></li>')}if(j.notice>0){var c={notice:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",like:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",notice_favourite:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",notice_quote:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",invite:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",unreadnotices:"http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",point:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_note.php"};var d=c.notice;for(var f in j.notices){if(j.notices[f]>0){d=c[f]||d;break}}g.push("<li>"+j.notice+'条新通知，<a onclick="v7sendLog(\'40_02_05\')" href="'+d+'">查看通知</a></li>')}$E("j-unre-list").innerHTML=g.join("");this.show();this._setThePos()},_setThePos:function(){var g=Core.Dom.getXY(this._srcPot);var d=this._srcPot.className=="link"?-2:0;var j=($IE7||$IE6)?this.entity.offsetWidth:this.entity.clientWidth;if(g[0]){var c=g[0]+this._srcPot.clientWidth-j+d;var f=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){f=g[1]}var m=this._srcPot.clientHeight+f+10;this.setPosition(c,m)}},_bindEvent:function(){var c=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(d){if(c._lockstate){return}c._eventHandle(d);c._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(d){c._scrolling=1;if(c._lockstate){return}c.setFixed(1);c._setThePos()}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(d){c._scrolling=0;if(c._lockstate){return}c.setFixed(0);c._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(d){c._srcPot.setAttribute("adshow",1);if(c.isShow){c._setThePos()}}});Core.Events.addEvent($E("j-unread-msg-close"),function(f){var d=f||window.event;if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}c.hide();c._lockstate=1},"click");Core.Events.addEvent(window,function(){if(c.isShow){c._setThePos()}},"resize")},_eventHandle:function(d){var c={};c.comment=(d.blogcomment-0)+(d.photocomment-0)+d.blogrecomment;c.notice=d.notice+d.like+d.notice_favourite+d.notice_quote+d.invite+d.unreadnotices+d.point;c.notices={notice:d.notice,like:d.like,notice_favourite:d.notice_favourite,notice_quote:d.notice_quote,invite:d.invite,unreadnotices:d.unreadnotices,point:d.point};c.message=d.message;c.gbook=d.gbook;this._updateCont(c)}});return b});Lib.register("tray.msgSummaryPanel",function(d){var c=d.util.JSON;var b=['<li><a onclick="v7sendLog(\'40_02_12\')" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1"><span class="icoms_comment"></span>查看评论</a></li>','<li><a onclick="v7sendLog(\'40_02_13\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span>查看纸条</a></li>','<li><a onclick="v7sendLog(\'40_02_14\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span>查看留言</a></li>','<li><a onclick="v7sendLog(\'40_02_15\')" href="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"><span class="icoms_notice"></span>查看通知</a></li>'];var a=Core.Class.define(function(g){d.Panel.prototype.initialize();this._srcPot=g;this._lock=1;this._scrolling=0;this._requirestate=1;this._nums={};var f=['<div class="bd">','<ul id="j-summary-list">',b.join(""),"</ul>","</div>"].join("");this.setTemplate('<div class="messageBox" id="#{panel}">'+f+"</div>");this.entity.style.zIndex=500;this._bindEvent();this._initNums()},d.Panel,{show:function(){var f=this;if(this._checkNumChange()){this._updateCont()}else{this._showAction()}},_showAction:function(){if(this.isHidden){this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",1);this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}this._setThePos()}else{this._setThePos()}},_checkNumChange:function(){var g=this._srcPot.getAttribute("msg-count");var f=this._srcPot.getAttribute("old-msg-count");if(g==f){return false}else{return true}},hide:function(){d.Panel.prototype.hide.call(this);this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",0);d.Listener.notify("tray-msg-panel-hide",{})},_initNums:function(){var f=c.parse(this._srcPot.getAttribute("msg-count"));this._formatData(f)},_setThePos:function(){if($IE6||$IE7||$IE8){this.entity.style.width="auto"}var m=Core.Dom.getXY(this._srcPot);var g=this._srcPot.className=="link"?-2:0;var n=($IE7||$IE6)?this.entity.offsetWidth:this.entity.clientWidth;var f=m[0]+this._srcPot.clientWidth-n+g;var j=0;if(this._srcPot.getAttribute("adshow")==1&&this._scrolling==0){if($IE6||$IE7||$IE8){j=m[1]-2}else{j=m[1]}}var o=this._srcPot.clientHeight+j+1;if($IE6||$IE7||$IE8){this.entity.style.width=this.entity.clientWidth+1+"px";this.entity.style.width=this.entity.clientWidth-1+"px"}this.setPosition(f,o)},_updatePanelIframe:function(){if(this.backIframe){this._updateBackIframe()}},_updateCont:function(f){var g=[];var j=this;this._lock=0;if(this._requirestate){this._getDate({},function(m){g.push(j._getComment(m));g.push(j._getMessage(m));g.push(j._getGbook(m));g.push(j._getNotice(m));$E("j-summary-list").innerHTML=g.join("");j._srcPot.setAttribute("old-msg-count",j._srcPot.getAttribute("msg-count"));if($IE6){$E("j-summary-list").style.width="270px"}j._showAction()},function(m){});this._requirestate=0}},_getDate:function(j,m,g){m=m||function(){};g=g||function(){};var n=this;Lib.checkAuthor();var f=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notelist.php","jsload");f.request({GET:{uid:$UID},onSuccess:function(o){m(o)}.bind2(this),onError:function(o){g({num:0})}.bind2(this),onFail:function(){g({num:0})}.bind2(this)})},_getUserPicUrl:function(g,f){var f=f||50;var j=parseInt(g)%8+1;return"http://portrait"+j+".sinaimg.cn/"+g+"/blog/"+f},getLen:function(g){if(!g){return 0}var f=g.match(/[^\x00-\xff]/g);return g.length+(f?f.length:0)},strTruncate:function(g,f,j){g=g||"";if(typeof j=="undefined"){j="..."}return(this.getLen(g)>f)?(this.truncete(g,f)+j):g},truncete:function(f,j){var g=f.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");f=f.slice(0,g.slice(0,j).replace(/\*\*/g," ").replace(/\*/g,"").length);this.getLen(f)>j&&j>0&&(f=f.slice(0,f.length-1));return f},getVipIcon:function(g){if(!g){return""}var j={1:{icon:"SG_icon146",info:"新浪个人认证"},2:{icon:"SG_icon147",info:"新浪机构认证"}};var g=g||1;var f='<img class="SG_icon '+j[g].icon+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="'+j[g].info+'" alt="'+j[g].info+'" align="absmiddle" />';return f},_setNameforIE6:function(f){if($IE6){return this.strTruncate(f,4)}else{return f}},_getComment:function(g){var v="";if(this._nums._comment>0){var o=g.msg.cms;if(o.length>0){var r={1:"评论了你的博文",2:"评论了你的图片",6:"回复了你的评论"};var u={1:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1",2:"http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=2",6:"http://i.blog.sina.com.cn/blogprofile/profilereplylist.php"};var s=[];for(var n=0,q=o.length;n<q;n++){var y=o[n];var f=y.nick_name||y.name;f=this._setNameforIE6(f);var m=this._getUserPicUrl(y.uid,30);var t=y.msg_type;s.push(t);var p=y.user_type||0;var j=y.time;v+='<li><a onclick="v7sendLog(\'40_02_06\')" href="'+u[t]+'"><img src="'+m+'"><em class="nl">'+f+"</em>"+this.getVipIcon(p)+'<em class="tm">'+j+"</em>"+r[t]+"</a></li>"}s.sort();if(this._nums._comment>3){v+='<li class="lcount"><a onclick="v7sendLog(\'40_02_07\')" href="'+u[s[0]]+'">总共'+this._nums._comment+"条新评论</a></li>"}else{}}else{v=b[0]}}else{v=b[0]}return v},_getMessage:function(j){var o="";if(this._nums._message>0){var n=j.msg.note[0];var g=n.name||n.nick_name;g=this._setNameforIE6(g);var m=this._nums._message>1?"等"+this._nums._message+"人":"";var f=n.user_type||0;o+='<li class="bgc"><a onclick="v7sendLog(\'40_02_08\')" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span><em class="nl">'+g+"</em>"+this.getVipIcon(f)+m+'发来纸条<em class="nr">查看纸条</em></a></li>'}else{o=b[1]}return o},_getGbook:function(j){var o="";if(this._nums._gbook>0){var n=j.msg.note[1];var g=n.name||n.nick_name;if(g){g=this._setNameforIE6(g);var m=this._nums._gbook>1?"等"+this._nums._gbook+"人":"给你";var f=n.user_type||0;o+='<li class="bgc"><a onclick="v7sendLog(\'40_02_09\')" href="http://i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span><em class="nl">'+g+"</em>"+this.getVipIcon(f)+m+'留言<em class="nr">查看留言</em></a></li>'}}else{o=b[2]}return o},_getNotice:function(j){var p="";var f="http://i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice";var n="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote";var o={3:"http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php",7:f,8:f,9:f,23:f,55:"http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_note.php",13:"http://i.blog.sina.com.cn/profilelist/profilelikelist.php",100:n,101:n,102:n,103:n,104:n,105:n,106:n,107:n,108:n,109:n,110:n,111:n,112:n};if(this._nums._notice>0){var m=j.msg.note[2];var g=m.msg_type||23;p+='<li class="bgc last"><a onclick="v7sendLog(\'40_02_10\')" href="'+o[g]+'"><span class="icoms_notice"></span>'+this._nums._notice+'条新通知<em class="nr">查看通知</em></a></li>'}else{p=b[3]}return p},_bindEvent:function(){var f=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(g){f._requirestate=1;f._eventHandle(g)}});Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(g){f._scrolling=0;if(f._lockstate){return}f.setFixed(0);f._setThePos()}});Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(g){f._scrolling=1;if(f._lockstate){return}f.setFixed(1);f._setThePos()}});Lib.Listener.on({name:"topad680-show-end",callBack:function(g){if(f.isShow){f._setThePos()}}})},_eventHandle:function(f){this._formatData(f);if(this.isShow){this._updateCont()}},_formatData:function(g){var f={};f._comment=(g.blogcomment-0)+(g.photocomment-0)+g.blogrecomment;f._notice=g.notice+g.like+g.notice_favourite+g.notice_quote+g.invite+g.unreadnotices+g.point;f._message=g.message;f._gbook=g.gbook;this._cacheNums(g,f)},_cacheNums:function(m,j){for(var f in m){this._nums[f]=m[f]}for(var g in j){this._nums[g]=j[g]}}});return a});Lib.register("TrayPanel",function(q){var j=Core.Events.addEvent;var c=Core.Events.removeEvent;var b=Utils.Cookie.getCookie;var f=Core.Dom.contains;var s=q.util.JSON;var m=Core.Dom.getChildrenByClass;var r="login_bar_logo_link_350";var o="______noticeTrayHolder";var g=0;var n=null;var a=!1;var p=function(y,t,u){if(typeof u!=="string"){return y.getAttribute(t)}else{y.setAttribute(t,u)}};var d=Core.Class.define(function(){var u=m(document.body,"nsinatopbar")[0];var t=this.$main=m(u,"ntopbar_main")[0];this.newTipsLog=0;q.Panel.prototype.initialize.call(this,{appendTo:t,isPostion:!1,noIframe:!0});q.Listener.on({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this},{name:"tray-newmsg-loaded",callBack:this.showNewMsgTips,scope:this},{name:"global-login-out",callBack:function(){clearInterval(this._msgTimer)},scope:this},{name:"tray-announce-loaed",callBack:function(y){var v=arguments;var z=this;if(this.notice){this.notice.update(y);return}setTimeout(function(){v.callee.call(z,y)},200)},scope:this},{name:"tray-unread-panel-hide",callBack:function(){var y=this.getNode("trayMsg");var v=s.parse(y.getAttribute("msg-count"));this.showNewMsgTips(v,1)},scope:this},{name:"tray-unread-panel-show",callBack:function(){var v=this.getNode("newTips");v.style.display="none"},scope:this},{name:"tray-msg-panel-hide",callBack:function(){var y=this.getNode("trayMsg");var v=s.parse(y.getAttribute("msg-count"));this.showNewMsgTips(v,1)},scope:this},{name:"tray-announce-close",callBack:function(v){this.setTrayPosition()},scope:this},{name:"topad680-show-start",callBack:function(v){this._hideActiveSub()},scope:this});if(g){g++}},q.Panel,{subPanels:[],hoverTimeout:"",hoverTime:400,load:function(v){if(!g){var u=$E(r);if(u&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){u.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else{if($_GLOBAL.platformTrayLogo.imgForIE6){u.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}}this.initSearch()}switch(v){case"login":if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}var t=new Date;var y=this;q.tray.loadUserInfo($UID,function(F){scope.unreadMsg=F;scope.nickname=F.full_nickname;scope.loginUserWtype=F.login_wtype;if(!y._isRenderUser){y.renderRight(q.tray.tpl.loginMemu);y._isRenderUser=!0}var C,E,B;if(F.isbloguser){var D=y.getNode("noOpenBlog");D.style.display="none";y.initUserMenu();y.initBlogMenu(F);y.initNewMsgEvt();y.initMsg();y.initMsgLoder();y.initHideSub();y.initunReadMsgPanel();C=y.getNode("userNick");E=y.getNode("openBlog")}else{C=y.getNode("ssoNick");C.href="http://control.blog.sina.com.cn/myblog/htmlsource/blog_notopen.php?uid="+$UID+"&version=7";y.initOpenBlog();y.initLogout();E=y.getNode("noOpenBlog")}C.innerHTML="";var A=document.createTextNode(F.nickname);C.appendChild(A);E.style.display="block";var z=Utils.Cookie.getCookie("loginFromMsn");if(z&&C){B=y.getNode("msnHolder");B.style.display="block";var G=y.getNode("msnLink");G.href+=$UID}if(B){Core.Dom.insertAfter(B,C.parentNode)}y.initNotice()});break;case"logout":if(!this.trayLogin){this.trayLogin=new q.Login.Ui();this.renderRight(q.tray.tpl.loginOutMemu)}this.initLogin();this.initNotice();break;case"oncelogedon":break}g++},initMsgLoder:function(){if(!this.msgLoader){this.msgLoader=new q.tray.MsgLoader();this.msgLoader.load($UID);var t=this;this._msgTimer=setInterval(function(){t.msgLoader.load($UID)},30*1000)}},initLogin:function(){var u=this;var t=p(this._el,"login");if(!t){p(this._el,"login","1");j(this._el,function(v){var y=q.util.getActionData(v,"tray-login-btn");if(!y){return}if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}u.trayLogin.login(function(){Lib.checkAuthor();var z=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+z+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click")}},initLogout:function(){var t=this.getNode("ssoLoginOut");var u=p(t,"loginout");if(!u){p(this._el,"login","1");j(t,function(){q.tray.loginOut(null,!0)})}t=null},initHideSub:function(){var t=this;j(document.body,function(u){if(!t._activeTab){return}var A=u.target||u.srcElement;var y=t.subPanels;var z;for(var v=y.length-1;v>=0;v--){z=y[v];if(z.tab===A||f(z.tab,A)){return}if(z.panel.entity===A||f(z.panel.entity,A)){return}}t._hideActiveSub()},"click");j(window,function(){var z=t._activeTab;if(!z){return}var C=z.tab;var A=z.panel;var v=z.left;var B=z.top;var u=Core.Dom.getLeft(C)+C.offsetWidth+v;var D=Core.Dom.getTop(C)+C.offsetHeight+B;if($IE6&&this.isFixed){u=u-document.documentElement.scrollLeft;D=D-document.documentElement.scrollTop}A.setPosition(u,D)},"resize")},_hideActiveSub:function(){var u=this;if(u._activeTab){var v=u._activeTab.tab;var t=u._activeTab.panel;u._activeTab=null;t.hidden();v.className=v.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}},initUserMenu:function(){var v=this.getNode("userMenu");var B=p(v,"init");if(!B){p(v,"init","1");var A=this;var t;var z=A.getNode("userMenu");var y=A._findSub("userMenu");var u=0;Lib.util.hoverJq({elm:v,mouseenter:function(H,G,E){clearTimeout(A.hoverTimeout);if(!u){u=1;var D;if(!y){D=new q.tray.UserMenuPanel();A.addSubPanel("userMenu",D,v,z)}else{D=y.panel}var F=D.getNode("panel");D.initUserInfo($UID);Lib.util.hoverJq({elm:F,mouseenter:function(K,J,I){clearTimeout(A.hoverTimeout);A._showPanel("userMenu",-160,0)},mouseleave:function(K,J,I){A.hoverTimeout=setTimeout(function(){A._hideActiveSub()},A.hoverTime)}});C(function(I){if(I){D.getNode("mail").style.display=""}})}A._showPanel("userMenu",-160,0)},mouseleave:function(F,E,D){A.hoverTimeout=setTimeout(function(){A._hideActiveSub()},A.hoverTime)}});var C=function(D){if(typeof t==="boolean"){D(t)}else{Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var E=sinamailinfo.email;if(E!=""){t=!0}else{t=!1}D(t)},onException:function(){}})}}}},initBlogMenu:function(A){var u=this.getNode("addArticle");var z=p(u,"init");if(!z){p(u,"init","1");var y=this;var v=y.getNode("blogMenu");var t=0;Lib.util.hoverJq({elm:v,mouseenter:function(G,F,D){clearTimeout(y.hoverTimeout);if(!t){t=1;var E=y._findSub("blogMenu");var B;if(!E){B=new q.tray.BlogMenuPanel();y.addSubPanel("blogMenu",B,u,v);if(A.tbh_status===1){B.getNode("tbh_status").style.display=""}}var C=B.getNode("panel");Lib.util.hoverJq({elm:C,mouseenter:function(J,I,H){clearTimeout(y.hoverTimeout);y._showPanel("blogMenu",-74,0)},mouseleave:function(J,I,H){y.hoverTimeout=setTimeout(function(){y._hideActiveSub()},y.hoverTime)}})}y._showPanel("blogMenu",-74,0)},mouseleave:function(D,C,B){y.hoverTimeout=setTimeout(function(){y._hideActiveSub()},y.hoverTime)}})}},initNotice:function(){var C=scope.$PRODUCT_NAME;var v=scope.$pageid;if("blog7"!==C){this.noNotice=!0;return}if(-1===v.indexOf("article")&&-1===v.indexOf("index")){this.noNotice=!0;return}var D=b("closeNotice_fzp");var t=$E("sinablogHead");Lib.checkAuthor();if((D&&D===$UID)||!t){this.noNotice=!0;return}if(!this.notice){var B=new q.tray.BlogNotice({appendTo:$E(r).parentNode,isPostion:!1,noIframe:!0});this.notice=B;var y=this;var A=t.offsetHeight+30;var z;var u=function(){var F=document;var E=F.body.scrollTop+F.documentElement.scrollTop;if(E>A){y.hideActive();y.setTrayFixed();if(!z){z=1;v7sendLog("48_01_11_"+scope.$pageid)}}else{setTimeout(function(){y.setTrayPosition();B.hide()})}};j(window,u,"scroll");q.Listener.on({name:"tray-announce-close",callBack:function(){c(window,u,"scroll")}})}},initNewMsgEvt:function(){var t=this.tpl;var y=this.getNode("newTips");var v=p(y,"init");if(!v){p(y,"init","1");var u=this;j(y,function(A){A=A||window.event;var z=A.target||A.srcElement;Core.Events.stopEvent(A);z.style.display="none";z.innerHTML="";var B=u.getNode("trayMsg");Core.Events.fireEvent(B,"click")},"click");y=null}},initMsg:function(){var u=this.getNode("trayMsg");var y=p(u,"init");if(!y){p(u,"init","1");var v=this;var t=0;Lib.util.hoverJq({elm:u,mouseenter:function(G,D,C){clearTimeout(v.hoverTimeout);if(!t){t=1;var F=window.event||G;if(F.preventDefault){F.preventDefault()}else{F.returnValue=false}var A=v.getNode("trayMsg");var B=v._findSub("msgPanel");var z;if(!B){z=new Lib.tray.msgSummaryPanel(A);v.addSubPanel("msgPanel",z,A,A)}var E=z.getNode("panel");Lib.util.hoverJq({elm:E,mouseenter:function(J,I,H){clearTimeout(v.hoverTimeout);v._showPanel("msgPanel",-400,0)},mouseleave:function(J,I,H){v.hoverTimeout=setTimeout(function(){v._hideActiveSub()},v.hoverTime)}})}v._showPanel("msgPanel",-400,0)},mouseleave:function(B,A,z){v.hoverTimeout=setTimeout(function(){v._hideActiveSub()},v.hoverTime)}})}},initunReadMsgPanel:function(){var t=this.getNode("trayMsg");var u=p(t,"init-unre");if(!u){p(t,"init-unre","1");new q.tray.unReadMsgPanel(t)}},initSearch:function(){if(!g){var t=new q.tray.SearchFormPanel({isPostion:!1,appendTo:"traySearchBar",noIframe:!0});t.show();j(document.body,function(u){u=u||window.event;var y=u.target||u.srcElement;var v=t.getNode("queryTxt");if(v!==y&&t.entity!==y&&!f(y,t.entity)){t.catePanel.hide()}},"click")}},initOpenBlog:function(){var u=$E("openblogcss");if(!u){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"});var t=this.getNode("openBlogBtn");scope.addBlogOpenerEvent(t)}},notifyMsgPanel:function(t){var u=t.getAttribute("msg-count");if(u){try{u=s.parse(u)}catch(v){u={}}}else{u=-1}},renderRight:function(u){this.setTemplate(u);this._el=this.entity;var t=m(this.$main,"ntopbar_loading")[0];t.style.display="none";this.show()},addSubPanel:function(u,t,z,y){var v=this;this.subPanels.push({name:u,tab:y,bind:z,panel:t})},_showPanel:function(v,A,B){var C=this._findSub(v);if(!C){return}var t=C.panel;var y=C.tab;t.entity.style.zIndex=512;if("msgPanel"===v){var E=this.getNode("newTips");this.notifyMsgPanel(y);E.style.display="none"}var z,G,D;G=this._activeTab;if(G){D=G.tab;if(D===y){return}G.panel.hide();D.className=D.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}var u=y.className;if(!/\bcurrent\b/.test(u)){y.className+=" current"}this._activeTab={name:v,tab:y,panel:t,left:A,top:B};var F=t.entity;if(this.isFixed&&(!$IE||$IE>6)){F.style.position="fixed"}else{F.style.position="absolute"}t.showWithDom(y,A,B)},_findSub:function(t){var v;for(var u=this.subPanels.length-1;u>=0;u--){v=this.subPanels[u];if(t===v.name){return v}}return null},showNewMsgTips:function(B,t){var y=B.sum-B.feed;var A=this.getNode("newTips");var C=this.getNode("trayMsg");if(y){if(C.getAttribute("unread-show-state")==0&&C.getAttribute("msg-panel-show-state")==0){A.style.display="block"}if(scope.$pageid=="editor"){A.style.display="block"}var v=this.entity.offsetWidth;A.style.left=(v-A.offsetWidth-10)+"px";if(y<10){A.innerHTML=y}else{A.innerHTML="•••"}if(!this.newTipsLog){v7sendLog("40_01_49_"+$UID);this.newTipsLog=1}C.setAttribute("msg-count",s.stringify(B));this.startTitleTips(y)}else{C.setAttribute("msg-count",s.stringify(B));this.stopTitleTips()}var z=B.feed;if(z){var u=this.getNode("newFeed");u.style.display="block";var v=this.entity.offsetWidth;u.style.left=(v-u.offsetWidth-197)+"px";z=(z<10)?z:"•••";u.innerHTML=z;if(!u.addEvt){u.addEvt=1;j(u,function(){location.href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1";u.style.display="none";u.innerHTML=""})}}},stopTitleTips:function(){if(scope.$pageid=="editor"){return}var t=document.title.replace(/\(\d+\+*\)/,"");document.title=t},startTitleTips:function(t){if(scope.$pageid=="editor"){return}var u;if(t){t=(t>=100000)?"99999+":t;if(/\(\d+\+*\)/.test(document.title)){u=document.title.replace(/\(\d+\+*\)/,"("+t+")")}else{u="("+t+")"+document.title}}document.title=u},hideActive:function(){var t,u;if(t=this._activeTab){t.panel.hide();u=t.tab;u.className=u.className.replace(/(?:[ ]*)\bcurrent\b/g,"");this._activeTab=null}},setTrayFixed:function(){var t=$E(r);this.notice.show();var u=this;setTimeout(function(){$E("traySearchBar").parentNode.style.display="none";t.style.display="none";var v=t.parentNode.parentNode;if(!$IE||$IE>6){q.Listener.notify("tray-scrolling-fix",{});v.style.position="fixed";v.style.top="0px"}else{if($IE===6){if(!u.__isFixie6){j(window,function(A){if(!u.isFixed){return}var B=document.documentElement.scrollTop;setTimeout(function(){var C=document.documentElement.scrollTop;if(B===C){v.style.display="block";u._ie6fix(A)}else{if(u.isFixed){v.style.display="none"}}},50)},"scroll");u.__isFixie6=!0}}}v.style.width="100%";if(!$E(o)){var z=v.offsetHeight;var y=$C("div");y.style.height=z+"px";y.id=o;Core.Dom.insertAfter(y,v)}u.isFixed=!0})},_ie6fix:function(u){if(this.isFixed){var v=$E(r);var t=v.parentNode.parentNode;t.style.position="absolute";t.style.top=document.documentElement.scrollTop+"px";var y=this.getNode("trayMsg");if(y){y.style.display="none";y.style.display=""}q.Listener.notify("tray-scrolling-fix",{})}},setTrayPosition:function(){if($IE6){var y=this.getNode("trayMsg");if(y){y.style.display="none";y.style.display=""}}q.Listener.notify("tray-scrolling-nofix",{});var u=$E(r);var t=u.parentNode.parentNode;if($E(o)){t.parentNode.removeChild($E(o))}t.style.position="";var v=$E("traySearchBar");v.style.position="";v.style.top="";this.notice.hide();t.style.display="block";u.style.display="block";$E("traySearchBar").parentNode.style.display="block";this.isFixed=!1}});Lib.tray.TrayPanel=d;return function(){if(!n){n=new d()}return n}});Core.System.htmlFilter=function(b){var c={"&":"&#038;","<":"&#060;",">":"&#062;"};var a;for(a in c){b=b.replace(new RegExp(a,"g"),c[a])}return b};Utils.Io.loadExternalCSS=function(a,f){if(typeof a!=="string"){return}var c,d,b=document.getElementsByTagName("head")[0];if($FF){d=$C("style");d.type="text/css";d.innerHTML="@import url("+a+")";b.appendChild(d);(function(){try{d.sheet.cssRules;typeof f==="function"&&f()}catch(g){setTimeout(arguments.callee,50)}})()}else{c=$C("link");c.href=a;c.type="text/css";c.rel="stylesheet";c.media="all";b.appendChild(c);if($SAFARI||$CHROME){(function(){try{c.sheet.cssRules;typeof f==="function"&&f()}catch(g){setTimeout(arguments.callee,50)}})()}else{c.onload=function(){c.onload=null;typeof f==="function"&&f()}}}};Core.Events.click=(function(){var a=/mobile/i.test(navigator.userAgent);if($IE&&$IE<9){return function(b){b.click()}}else{return function(c){var b;if(a){b=document.createEvent("HTMLEvents")}else{b=document.createEvent("MouseEvents")}b.initEvent("click",true,true);c.dispatchEvent(b)}}})();Core.Dom.removeClassName=Core.Dom.removeClass;scope.trayPlusTemplayLogout=['<div class="topbar_menu">','<span class="link"><a target="_blank" href="http://blog.sina.com.cn">博客首页</a></span>','<span class="line_s"></span>',"</div>",'<div class="topbar_login"><a id="linkTrayLogin" class="login" href="javascript:;">登录</a><a id="linkReg" target="_blank" class="register" href="">注册</a></div>','<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayLogin=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span class="line_s"></span>','<span style="display:none;" id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" style="display:none;" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><a href="#" onclick="return false;" class="link_arrow" title=""></a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s"></span>','<span class="link" id="logOut"><a href="#">退出</a></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.trayPlusTemplayOnceLoged=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a></span>','<span class="line_s"></span>','<span id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="http://mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="http://control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="http://simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join("");scope.newStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="http://control.blog.sina.com.cn/blogprofile/profileremind.php?com=2"><span id="nstFavorite" style="padding:3px 2px;display:none;">你有博文被<span style="color:red">转载/收藏</span></span></a>','<img id="gbimg" class="SG_icon SG_icon83" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="17" height="15" align="absmiddle" style="display:none"/><a style="display:none" href="http://i.blog.sina.com.cn/blogprofile/index.php?com=g" id="gbmsg">官博<em>新动态</em></a>',"</div>"].join("");scope.onceLogedStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="javascript:void(0);return false;"><span id="nstUnread" style="padding:3px 2px;display:none;">你有<span style="color:red">未读消息</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstUpdate" style="padding:3px 2px;display:none;">你最近浏览的博主<span style="color:red">有更新</span></span></a>','<a href="javascript:void(0);return false;"><span id="nstUnpub" style="padding:2px 2px;display:none;">你有<span style="color:red">尚未发表</span>的博文</span></a>',"</div>"].join("");scope.nicknamePanelTemplate=['<div id="#{panel}" class="tb_layer_Y tb_layer_w2" style="z-index:512;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_ps">','<div class="tb_ps_list">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" href="javascript:;"><img class="SG_icon SG_icon15" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle" /><strong>博客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostBlog}" href="http://control.blog.sina.com.cn/admin/article/article_add.php">发博文</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{linkPhoto}" href="javascript:;"><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle" /><strong>相册</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostPhoto}" href="http://photo.blog.sina.com.cn/upload/upload.php">发图片</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" href="javascript:;"><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle" /><strong>播客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkUpload}" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>][<a id="#{linkRecord}" href="http://vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{miniblog}" href="javascript:;" target="_blank"><img class="SG_icon SG_icon51" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微博" align="absmiddle" /><strong>微博</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{qingblog}" onclick="v7sendLog && v7sendLog(\'79_01_02\',scope.$pageid,\'qingLink\');" href="javascript:;" target="_blank"><img class="SG_icon SG_icon205" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="Qing" align="absmiddle" /><strong>Qing</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{mySpace}" href="javascript:;"><img class="SG_icon SG_icon41" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle" /><strong>关于我</strong></a></span>',"</li>","</ul>",'<div class="clearit"></div>',"</div>",'<div class="tb_ps_manage">','<p><a target="_blank" id="#{linkChangeFace}" href="javascript:;">修改头像昵称</a></p>','<p><a target="_blank" id="#{linkChangePassword}" href="javascript:;">修改登录密码</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" href="javascript:;">账号安全设置</a></p>','<p><a target="_blank" id="#{bindEmail}" href="javascript:;">绑定邮箱</a></p>',"</div>","</div>","</div>","</div>"].join("");scope.NicknamePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.nicknamePanelTemplate)},Lib.Panel,{initUserInfo:function(c){var a=this.getNodes();scope.$bindEmail=function(m){var j=a.bindEmail;if(m.ret!="y"&&m.errcode!="not_verify"){j.parentNode.removeChild(j)}else{j.href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog"}};try{var g=/user=([^&]+)&/g.exec(decodeURIComponent(Utils.Cookie.getCookie("SUP")))[1];Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(g)+"&utf82bgk=1&callback=scope.$bindEmail",{noreturn:true})}catch(f){}a.linkBlog.href="http://blog.sina.com.cn/u/"+c;a.linkPhoto.href="http://photo.blog.sina.com.cn/u/"+c;a.linkVBlog.href="http://you.video.sina.com.cn/m/"+c;a.miniblog.href="http://control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+c;a.qingblog.href="http://qing.blog.sina.com.cn/fancy.html";a.mySpace.href="http://blog.sina.com.cn/s/profile_"+c+".html";a.linkChangeFace.href="http://control.blog.sina.com.cn/blogprofile/nick.php";a.linkChangePassword.href="http://login.sina.com.cn/member/security/password.php";a.linkAccountSetup.href="http://login.sina.com.cn/member/security.php";var d=["linkBlog","linkPhoto","linkVBlog","miniblog","qingblog","mySpace","linkChangeFace","linkChangePassword","linkAccountSetup"];for(var b=0;b<d.length;b++){a[d[b]].onclick=function(){v7sendLog("40_01_02_"+$UID)}}}});var st=['<div id="#{panel}" style="z-index:512;" class="tb_layerBox">',"<ul>",'<li id="#{blog}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博文</a></li>','<li id="#{bauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博主</a></li>','<li id="#{song}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">音乐</a></li>','<li id="#{video}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">视频</a></li>','<li id="#{vauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">播主 </a></li>',"</ul>","</div>"];scope.searchPanelTemplate=st.join("");scope.SearchPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.searchPanelTemplate)},Lib.Panel,{config:{blog:{text:"博文",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"article",by:"all"},bauthor:{text:"博主",url:"http://search.sina.com.cn/?c=blog",keyName:"q",range:"author",by:"all"},song:{text:"音乐",url:"http://music.sina.com.cn/yueku/search/s.php",keyName:"k",t:"song",s:"",ts:"",type:"",stype:""},video:{text:"视频",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"1"},vauthor:{text:"播主",url:"http://search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"3"}}});Utils.Flash.swfView={swfList:[],Add:function(j,g,a,c,m,d,n,b,f){if(j&&a){this.swfList[this.swfList.length]={sURL:j,sID:g,sPID:a,nWidth:c,nHeight:m,nVersion:d,sBGColor:n,oVar:b,oParam:f};this.Init();return}},Init:function(){var j;var g=this.swfList;for(var d=0,b=g.length;d<b;d++){var f=g[d];j=new Utils.Flash.swfObject(f.sURL,f.sPID,f.nWidth,f.nHeight,f.nVersion,f.sBGColor);if(f.oVar){for(var c in f.oVar){j.addVariable(c,f.oVar[c])}}if(f.oParam){for(var a in f.oParam){j.addParam(a,f.oParam[a])}}j.write(f.sID)}g=[];f=null;j=null}};Utils.Io.loadCss=function(d,c){if(d==null){return false}c=c||window;var a=c.document;d.id=d.id||"";var b;if(d.url){b=a.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",d.url)}else{if(d.text){b=a.createElement("style");b.setAttribute("type","text/css");if($IE){b.styleSheet.cssText=d.text}else{b.innerHTML=d.text}}}b.setAttribute("id",d.id);a.getElementsByTagName("head")[0].appendChild(b)};var st=['<div id="#{panel}" style="z-index:512;" class="tb_layer_Y tb_layer_w6" style="left:400px; top:700px;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_mas" id="#{newInboxList}" style="">','<div class="tb_mas_list">','<ul id="#{changebgli1}"  style="display:none" >','<li  style="display:none" >','<span id="#{ccsysgonggao}" class="tb_friend_nm">[<strong>公告</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪邀你一起共度中秋活动</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>",'<li style="display:none">','<span id="#{ccsystongzhi}" class="tb_friend_nm">[<strong>通知</strong>] <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪2010邀你一起共度中秋活动...</a></span>','<span class="tb_friend_set"><a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>","</ul>",'<ul class="bd" id="#{changebgli2}">','<li  id="#{newInboxLoding}" style="cursor:default" ><div style="margin: 0pt; padding: 10px;text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif"><div></li>','<li  id="#{nomsgli}" style="cursor:default;" >还没有消息</li>','<li style="float:none;"><span class="mas_more"><a id="#{mas_moremsg}" href="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php">全部消息</a></span></li>',"</ul>",'<div class="clearit"></div>',"</div>",'<ul class="commentslist" id="commentdata">','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">评论</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1" id="#{commentRelapseCount}" ></a></li>','<li><a class="conn" href="http://i.blog.sina.com.cn/blogprofile/wall.php">留言</a><a class="num" href="http://i.blog.sina.com.cn/blogprofile/wall.php" id="#{guestBookCount}">1</a></li>','<li class="lst"><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php">好友邀请</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profileinvitelist.php" id="#{inviteCount}" ></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">纸条</a><a class="num" href="http://control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1" id="#{messageCount}" ></a></li>','<li><a class="conn" target="_blank" href="http://mail.sina.com.cn" reject="1">邮箱</a><a class="num" href="http://mail.sina.com.cn" id="#{mailCount}" target="_blank" reject="1"></a></li>','<li><a class="conn" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">系统消息</a><a class="num" href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote" id="#{sysnoticeCount}" ></a></li>',"</ul>","</div>","</div>","</div>"];scope.newInboxPanelTemplate=st.join("");Lib.LocalDB={_this:null,isFlashReady:false,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var d=Lib.LocalDB;d.isFlashReady=true;if(d.loadedFun){d.loadedFun(d._this)}var g=d.regiFun;var b=d.regiFunArgs;for(var c=0;c<g.length;c++){g[c].apply(null,b[c])}},registerFun:function(c,d){this.regiFun.push(c);var b=d||[];this.regiFunArgs.push(b)},set:function(a,b){if(this.isFlashReady){try{this.FlaDom.setLazyInterface(a,b);return true}catch(c){trace("set函数出错")}}return false},get:function(a,b,d){if(this.isFlashReady){try{return this.FlaDom.getLazyInterface(a,b,d)}catch(c){trace("get函数出错")}}return false},clearCache:function(b,a){if(this.isFlashReady){try{$E("scache").clearCache(b,a)}catch(c){trace("gclearCache函数出错")}}return false},loadFlash:function(c){var a="";if(window.$Maxthon||window.$360||window.$TT){a="?t="+Core.Math.getUniqueId()}if(!this.FlaDom){var b=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+a,"scache","1","1","9","#00ff00");b.addParam("quality","high");b.addParam("wmode","transparent");b.addParam("allowScriptAccess","always");b.write(c);this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(a){trace("判断是否是通信主机发生错误");return false}},login:function(a){try{this.FlaDom.login(a)}catch(b){trace("login函数出错");trace(a)}},sendToClient:function(a){try{if(this.getServer()){this.FlaDom.sendToClient(a)}else{}}catch(b){trace("sendToClient函数出错")}},setClientJsFun:function(a){try{if(this.getServer()){this.FlaDom.setClientJsFun(a)}else{trace("非主机不可以设置接收函数")}}catch(b){trace("setClientJsFun函数出错")}},receive:function(a){this.updataFun(a)}};scope.msnTipsTemplate=['<div id="#{panel}" style="position: absolute; width: 369px; padding-top: 7px; font-size: 12px; z-index:511">',"<div  style=\"top: 0pt; left: 65px; position: absolute; width: 16px; height: 8px; background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_boxtop_01.png') no-repeat scroll 0pt 0pt transparent; z-index: 100;\"></div>","<div style=\"padding: 5px 6px 9px 14px; border: 1px solid rgb(181, 202, 214); background: url('http://simg.sinajs.cn/blog7style/images/special/move/bg_asiangames.jpg') no-repeat scroll left bottom rgb(255, 255, 255); z-index: 1;\">",'<p id="#{close}" class="close" style="float: right; margin: 0pt; cursor: pointer; width: 8px; height: 8px; font-size: 0pt;background:url(\'http://simg.sinajs.cn/blog7style/images/special/move/btn_close.gif\') no-repeat 0 0;"></p>','<div style="width: 342px; margin: 10px 0pt 0pt; padding: 0pt 0pt 3px;">','<a style="float: left; margin: 0pt 10px 0pt 0pt;" href="#"><img height="91" width="122" style="border: 0pt none;" alt="MSN" src="http://simg.sinajs.cn/blog7style/images/special/move/img_msnphoto.png"></a>','<h3 style="padding: 2px 0pt 5px; color: rgb(0, 0, 0); margin: 0pt; font-size: 12px;">各位拥有MSN帐号的同学注意啦!</h3>','<p style="width: 268px; display: inline; text-indent: 0pt; padding: 0pt; color: rgb(51, 51, 51); line-height: 19px;">新浪博客帐号与MSN帐号已经实现关联。您可以使用MSN帐号来登录博客，绑定后发博文、发图片可同步到Live，第一时间让您的MSN好友知晓。</p>',"</div>",'<p style="clear: both; height: 30px; margin: 12px 10px 4px 0pt; padding: 12px 0pt 0pt; border-top: 1px solid rgb(220, 213, 211); text-align: right;"><a style="float: right; color: rgb(176, 173, 172); margin-top: 10px; text-decoration: none;" href="javascript:void(0);" id="#{noMoreShow}">不再显示</a><a style="float: right; text-decoration: none; margin: 10px 14px 0pt 16px;color:#2d3186;" href="http://blog.sina.com.cn/s/blog_4b0f52990100lt3i.html">帮助</a><a id="#{setNow}"style="float: right;" href="http://control.blog.sina.com.cn/blogprofile/msnbind.php"><img height="32" width="105" style="border: medium none;" alt="立即设置" src="http://simg.sinajs.cn/blog7style/images/special/move/btn_receive01.jpg"></a></p>',"</div>","</div>"].join("");scope.msnTips=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.msnTipsTemplate)},Lib.Panel,{initUserInfo:function(a,c){var b=this.getNodes();this.setFixed($E("loginBarActivity"),-230,-2);var d=this;b.close.onclick=function(){d.hidden()};b.noMoreShow.onclick=function(){d.hidden();Utils.Cookie.setCookie("noMoreMsnTips"+$UID,1,24*100,"/",".blog.sina.com.cn")};b.setNow.onclick=function(){v7sendLog("95_02_01",scope.$pageid,"")}},setFixed:function(c,a,b){var d=this;setTimeout(function(){d.showWithDom(c,a,b);d.fadeIn()},2000);Core.Events.addEvent(window,function(){var f=Core.Dom.getLeft(c)+c.offsetWidth+a;var g=Core.Dom.getTop(c)+c.offsetHeight+b;if($IE6&&d.isFixed){f=f-document.documentElement.scrollLeft;g=g-document.documentElement.scrollTop}d.setPosition(f,g)},"resize")},fadeIn:function(){var c=this.entity;Core.Dom.opacity(c,0);var a=0;(function b(){Core.Dom.opacity(c,a+=5);if(Core.Dom.getStyle(c,"opacity")<1){setTimeout(b,20)}})()}});scope.NewInboxPanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.newInboxPanelTemplate);this.nodes=this.getNodes();var b=this;var a=Lib.LocalDB;if(/Mobile/i.test(navigator.userAgent)){setTimeout(function(){b.requestDataInterface()},100)}else{if(!a.FlaDom){a._this=b;a.loadedFun=b.FlashLoaded;a.loadFlash("trayFlashConnetion")}else{b.FlashLoaded(b)}}Core.Events.addEvent($E("loginBarInbox"),function(c){v7sendLog("40_01_09_"+$UID);var d=(c&&c.target)||(window.event&&window.event.srcElement);if(d&&d.tagName&&d.tagName.toLowerCase()=="a"){v7sendLog("45_01_10_"+$UID)}b._hasOverview=true;$E("ccnotepiaohong").style.display="none";b.requestMsgDate()},"click");this.interfaceMessages=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unread.php","jsload")},Lib.Panel,{nodes:null,_connectSWF:null,_SWFChannelName:"inboxConnection",interfaceMessges:null,isMessageLoaded:false,isUICServiceLoaded:true,isHaveNewMessage:false,_listData:null,_productIDs:{blog:1,vblog:2,group:4,photo:8,cube:16},_msgIsLoad:false,_newnote:0,_hasOverview:false,interfaceUICServiceURL:"http://uic.sinajs.cn/uic?type=service&uids=#{uids}&varname=service",FlashLoaded:function(b){var a=Lib.LocalDB;var c=b;window.$updateData=function(d){c.updateData(d)};Lib.checkAuthor();a.login($UID);a.setClientJsFun("$updateData");setTimeout(function(){c.requestDataInterface()},100)},requestMsgDate:function(){this.updateView("loading");var c=this;var b=0;if(this._hasOverview){b=this._newnote;this._newnote=0;this._hasOverview=false}var a=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notetips.php?clearnum="+b,"jsload");a.request({GET:{uid:$UID},onSuccess:function(p){if(typeof p.announcement!="undefined"&&p.announcement){c.nodes.ccsysgonggao.innerHTML='[<strong>公告</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+p.announcement+"</a>";c.nodes.ccsysgonggao.parentNode.style.display=""}else{c.nodes.ccsysgonggao.parentNode.style.display="none"}if(typeof p.sysNote!="undefined"&&p.sysNote){c.nodes.ccsystongzhi.innerHTML='[<strong>通知</strong>]&nbsp;<a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+p.sysNote+"</a>";c.nodes.ccsystongzhi.parentNode.style.display=""}else{c.nodes.ccsystongzhi.parentNode.style.display="none"}if(typeof p.sysNote=="undefined"&&typeof p.announcement=="undefined"){c.nodes.ccsystongzhi.parentNode.parentNode.style.display="none"}else{c.nodes.ccsystongzhi.parentNode.parentNode.style.display=""}c.nodes.nomsgli.style.display="";if(typeof p.notice!="undefined"&&p.notice){var g=p.notice;while(c.nodes.changebgli2.childNodes.length>2){c.nodes.changebgli2.removeChild(c.nodes.changebgli2.childNodes[c.nodes.changebgli2.childNodes.length-3])}for(var o=g.length-1;o>=0;o--){var f=$C("li");f.innerHTML=g[o].data;f._href=g[o].url;c.nodes.changebgli2.insertBefore(f,c.nodes.changebgli2.firstChild);f.onclick=function(){v7sendLog("45_01_11_"+$UID);window.location.href=this._href};c.nodes.nomsgli.style.display="none"}}if(parseInt($E("ccnotepiaohong").innerHTML,10)>0){var n=parseInt($E("ccnotepiaohong").innerHTML,10);var q=c.nodes.changebgli2.childNodes;for(var m=0;(m<q.length-2&&m<n);m++){Core.Dom.removeClassName(q[m],"cur");q[m].className+=" cur"}}c.updateView("loaded");c._msgIsLoad=true;c.bindliEvent()},onError:function(f){},onFail:function(){}});var d=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/unreadmail.php","jsload");d.request({onSuccess:function(g){var f=parseInt(g)||0;if(f>99){f="99+"}c.nodes.mailCount.innerHTML=f||""},onError:function(){c.nodes.mailCount.innerHTML=""}})},requestDataInterface:function(){var f=this;Lib.checkAuthor();var a=Lib.LocalDB;var c=null;if(a.isFlashReady&&!this.checkCache){this.clearCache();c=a.get("uid_"+$UID+"unread",60*1000*4);this.checkCache=true}var b=function(g,d){if(!c&&!d){a.set("uid_"+$UID+"unread",g)}if(g.isBindToMsn==0&&Utils.Cookie.getCookie("noMoreMsnTips"+$UID)!=1){}f.isMessageLoaded=true;f.onMessageLoad(g.nickname);f._listData=g;scope.unreadMsg=g;scope.nickname=g.full_nickname;scope.loginUserWtype=g.login_wtype;if(g.svr_time){scope.$svr_time=g.svr_time}if(g.nfn>=1){v7sendLog("40_01_03_"+$UID);f.initNewStatusTip(g)}else{}f.updateListData(g);if(f.isMessageLoaded){f.updateData({data:f._listData});f.onLoaded()}scope.hasOpenBlog=g.isbloguser==1?"open":"no";scope.bindTrayOpenTime=1;Lib.Listener.notify("tray-data-loaded",g);if(scope.hasOpenBlog=="no"&&scope.bindTrayOpenTime==1){if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}$E("openedBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="";$E("outOfOpenBlogTray").style.display="";scope.addBlogOpenerEvent($E("openBlogBtnTray"));$E("noOpenBlogName").href="http://blog.sina.com.cn/u/"+$UID;scope.bindTrayOpenTime=2}scope.unreadOkExecuted=true};if(c){b(c,true);trace("-------unread 使用缓存的数据!!!----")}else{trace("-----直接调用unread接口！！！");this.interfaceMessages.request({GET:{uid:$UID,product:"blog"},onSuccess:b,onError:function(d){},onFail:function(){}})}},clearCache:function(){var b={profile_notice:"notice",profile_paperlist:"message",profile_invitelist:"invite",profile_commlist:"blogcomment",profile_replylist:"blogrecomment",profile_guestBookM:"gbook",profile_commtrash:"trashcomment",profile_commphotolist:"photocomment",profile_index:"profile_index",profile_remind:"profile_remind"};var a=Lib.LocalDB;var c=a.get("uid_"+$UID+"unread",60*1000*4);if(c&&b[scope.$pageid]&&typeof(c[b[scope.$pageid]])!=undefined){trace("-----清除缓存");a.clearCache(10,"uid_"+$UID+"unread")}var g=$UID+"_clear_flash";var f=Utils.Cookie.getCookie(g);if(f==1){trace("【活动】根据cookie标记,清除Flash缓存");a.clearCache(10,"uid_"+$UID+"unread");Utils.Cookie.setCookie(g,"",0,"/",".sina.com.cn")}},initMsnTips:function(){Lib.checkAuthor();new scope.msnTips().initUserInfo($nick,$UID)},initNewStatusTip:function(f){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var d=$E("newStatusTip");if(d||!f){return}v7sendLog("45_01_07_"+$UID);d=$C("div");d.id="newStatusTip";d.className="tb_layer_Y tb_layer_w3";d.style.width="138px";d.innerHTML=scope.newStatusTipTemplay;var b=$T($E("loginBarCenter"),"a")[0];var g=Core.Dom.getXY(b);d.style.left=(g[0]-(138/2-b.offsetWidth/2))+"px";d.style.top=(g[1]+b.offsetHeight)+"px";d.style.zIndex="510";if(b.href.indexOf("?")==-1){b.href+="?type=2&from="+scope.$pageid}Core.Dom.opacity(d,0);document.body.appendChild(d);if(f.nfn>=1){$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("45_01_09_"+$UID);v7sendLog("40_01_04_"+$UID)}}if(f.official_blog==1){$E("gbimg").style.display="";$E("gbmsg").style.display=""}for(var c=1;c<=500;c++){(function(a){setTimeout(function(){Core.Dom.opacity(d,a*2/10)},a*2)})(c)}if(scope.$pageid=="editor"){b.target="_blank";$E("nstFeed").parentNode.target="_blank";$E("gbmsg").style.target="_blank";Core.Events.addEvent(b,this.closeTip(b),"click")}Core.Events.addEvent(window,function(){var j=$T($E("loginBarCenter"),"a")[0];var m=Core.Dom.getXY(j);d.style.left=(m[0]-(138/2-j.offsetWidth/2))+"px";d.style.top=(m[1]+j.offsetHeight)+"px"},"resize")},closeTip:function(a){return function(){$E("newStatusTip").style.display="none";a.href=a.href.split("?")[0]}},updateData:function(a){var c=Lib.LocalDB;var d=this;Lib.checkAuthor();try{if(($UID&&$UID==a.uid)||c.getServer()==true){d.isHaveNewMessage=false;d.isMessageLoaded=false;d.updateListData(a.data);if(d._newnote>0){v7sendLog("45_01_08_"+$UID);v7sendLog("40_01_08_"+$UID)}if(a.data.nfn>=1){d.initNewStatusTip()}}}catch(b){}if(c.getServer()==true){Lib.checkAuthor();c.sendToClient({data:a.data,uid:$UID});setTimeout(function(){d.requestUICService();d.requestDataInterface()},60000*4)}else{setTimeout(function(){if(c.getServer()){c.setClientJsFun("$updateData");d.requestUICService();d.requestDataInterface()}},60000*4)}},initializeList:function(){this.requestUICService();this.checkCache=false},updateListData:function(g){try{var d=0;d+=parseInt(this._getFormatCountString(g.invite)||0);if(d>500){d="500+"}this.nodes.inviteCount.innerHTML=d?d:""}catch(j){}try{var d=0;d+=parseInt(this._getFormatCountString(g.message)||0);if(d>500){d="500+"}this.nodes.messageCount.innerHTML=d?d:""}catch(j){}try{var d=0;d+=parseInt(g.unreadnotices||0);d+=parseInt(g.notice||0);if(d>500){d="500+"}this.nodes.sysnoticeCount.innerHTML=d?d:""}catch(j){}Lib.checkAuthor();try{var d=0;d+=parseInt(this._getFormatCountString(g.gbook)||0);d+=parseInt(this._getFormatCountString(g.trashwall)||0);if(d>500){d="500+"}this.nodes.guestBookCount.innerHTML=d?d:""}catch(j){}try{var d=0;d+=parseInt(g.blogcomment||0);d+=parseInt(g.blogrecomment||0);d+=parseInt(g.photocomment||0);d+=parseInt(g.trashcomment||0);if(d>500){d="500+"}this.nodes.commentRelapseCount.innerHTML=d?d:""}catch(j){}this._newnote=parseInt(g.newnotes,10);if(this._newnote>0){$E("ccnotepiaohong").innerHTML=this._newnote>500?"500+":this._newnote;$E("ccnotepiaohong").style.display=""}else{$E("ccnotepiaohong").style.display="none"}var f,b=["notice","invite","message","blogcomment","blogrecomment","photocomment","trashcomment","vblogcomment","gbook"],a=b.length;for(f=0;f<a;f++){if(parseInt(g[b[f]])>0){this.isHaveNewMessage=true}var c;for(c in g){if(c!="version"&&window.parseInt(g[c])>0){if($E("left_"+c)){$E("left_"+c).innerHTML="("+g[c]+")"}}}}},requestUICService:function(){Lib.checkAuthor();if(this.isMessageLoaded){this.updateData({data:this._listData});this.onLoaded()}},_getFormatCountString:function(a){var b="";if(!isNaN(parseInt(a))&&parseInt(a)!=0){if(parseInt(a)>500){b="(<strong>500+</strong>)"}else{b=a}}return b},updateView:function(a){this.nodes.newInboxLoding.style.display=a=="loaded"?"none":"";if(a=="loading"){this.nodes.nomsgli.style.display="none"}},onLoaded:function(){},onMessageLoad:function(a){$E("loginBarAppMenuLabel").innerHTML=Core.System.htmlFilter(a);$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(a)},bindliEvent:function(){var a=this.nodes.changebgli1.getElementsByTagName("li");var f=this.nodes.changebgli2.getElementsByTagName("li");for(var c=0;c<a.length;c++){a[c].style.cursor="pointer";a[c].onmouseover=function(){this._className=this.className;this.className="on"};a[c].onmouseout=function(){this.className=this._className}}for(var c=0;c<f.length-1;c++){if(f[c]==this.nodes.nomsgli){continue}f[c].style.cursor="pointer";f[c].onmouseover=function(){this._className=this.className;this.className="on"};f[c].onmouseout=function(){this.className=this._className}}var d=$E("commentdata");if(d){Core.Events.addEvent(d,function(g){b(g)})}Core.Events.addEvent(this.nodes.changebgli1,function(g){b(g)});Core.Events.addEvent(this.nodes.changebgli2,function(g){b(g)});function b(g){var j=(g&&g.target)||(window.event&&window.event.srcElement);if(j&&j.tagName&&(j.tagName.toLowerCase()=="a"||j.tagName.toLowerCase()=="li")&&!j.getAttribute("reject")){v7sendLog("40_01_10_"+$UID);v7sendLog("45_01_11_"+$UID)}}}});scope.addArticleTemplate=['<div id="#{panel}" class="wrtBlog_sub" style="z-index:512;">','<div class="wrtBlog_sub2">','<p><img width="15" height="16" align="absmiddle" title="写365" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon138"><a onclick="v7sendLog(\'48_01_18\');v7sendLog(\'40_01_14\');" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank">写365</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon88" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="长微博" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/changWeiBo.php">长微博</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon87" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微语录" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/weiyulu/weiyulu.php">微语录</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon85" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="九宫格" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/daily.php">九宫格</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon18" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发照片" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://photo.blog.sina.com.cn/upload/upload.php">发照片</a></p>','<div class="SG_j_linedot"></div>','<p><img class="SG_icon SG_icon16" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发视频" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://vupload.you.video.sina.com.cn/u.php?m=1">发视频</a></p>','<div id="tray_tbh_ware_linedot" style="display:none;" class="SG_j_linedot"></div>','<p id="tray_tbh_ware_link" style="display:none;"><img class="SG_icon SG_icon150" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="发商品" align="absmiddle" /><a target="_blank" onclick="v7sendLog(\'40_01_14\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tbh=1">发商品</a></p>',"</div>","</div>"].join("");scope.addArticlePanel=Core.Class.define(function(){Lib.Panel.prototype.initialize.apply(this,arguments);this.setTemplate(scope.addArticleTemplate);this.hidden()},Lib.Panel,{});Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.cancelBubble=true}};if(!$IE||$IE>8){Core.Events.stopBubble=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){b.stopPropagation()}}}Lib.PlatformTrayPlus=Core.Class.create();Lib.PlatformTrayPlus.prototype={tray:null,subPanels:[],trayLogin:null,initialize:function(){},load:function(d){var c=$E("login_bar_logo_link_350");if(c&&$_GLOBAL&&$_GLOBAL.platformTrayLogo){if(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs){c.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs}else{if($_GLOBAL.platformTrayLogo.imgForIE6){c.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6}}}switch(d){case"login":if($E("loginBarOptApp")==null||!$isAdmin){this.render(scope.trayPlusTemplayLogin);trace("++++js渲染 登陆后++++++")}this.initStatic();if(/ipad/i.test(navigator.userAgent)){v7sendLog("48_01_02")}this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);this.initNicknamePanel();this.initNewInboxPanel();this.initActivityPanel();var b=this;Utils.Io.JsLoad.request("http://service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var j=sinamailinfo.email;if(j!=""){b.initMailRemind()}},onException:function(){}});this.initMsnLogout();if(scope&&scope.$private&&scope.$private.msnfeed){var g=this;setTimeout(function(){g.displayUserGuideTips()},1000)}break;case"logout":this.trayLogin=new Lib.Login.Ui();if($E("phprender")===null){this.render(scope.trayPlusTemplayLogout);trace("-----------js渲染---------")}else{trace("-----------php渲染---------")}this.initLogin();this.initPopularize();break;case"oncelogedon":this.trayLogin=new Lib.Login.Ui();this.render(scope.trayPlusTemplayOnceLoged);this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);var f=Lib.Login.info();var a=f&&f.uid;$E("loginBarAppMenuLabel").innerHTML=f&&f.nick;this.initPopularize();this.initOnceLogedEvent(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"],a);this.initOnceLogedTips(a);this.initStatic();break}this.initAddArticlePanel();this.initSearchPanel();this.initFilmSearch()},displayUserGuideTips:function(){if(!window.scope||scope.$pageid==="profile_index"){Utils.Cookie.setCookie($UID+"alreadyVisitProfileIndex","true","86400","/",".sina.com.cn");return}var b=this;function a(){var c=$E("loginBarCenter");if(c){var g=Core.Dom.getXY(c),f=g[0]+c.offsetWidth/2-b.tipsUserGuide.offsetWidth/2+"px",d=g[1]+c.offsetHeight+10+"px"}b.tipsUserGuide.style.left=f;b.tipsUserGuide.style.top=d}},initStatic:function(){if(!this._commetTimer){var a=function(){var d=scope.$uid;var c=scope.$articleid||"";var b="http://comet.blog.sina.com.cn/api?maintype=notice";Utils.Io.JsLoad.request(b,{GET:{uid:d||"",blogid:c},onComplete:function(f){}})};this._commetTimer=setInterval(a,30*1000);setTimeout(function(){a()},15)}},initFilmSearch:function(){var b=$E("loginBarSearchInput");b&&(b.value="");var a=$E("loginBarSearchSType");a&&(a.value="title")},render:function(a){$E("trayContainer").innerHTML=a},initLogin:function(){var b=this;var a=Core.Dom.getElementsByClass($E("trayContainer"),"span","link")[0];a.onclick=function(){v7sendLog("40_01_15")};Core.Events.addEvent($E("linkTrayLogin"),function(){v7sendLog("40_01_16");if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}b.trayLogin.login(function(){Lib.checkAuthor();var c=$UID==scope.$uid?"02":"01";v7sendLog("87_01_"+c+"_"+$UID,scope.$pageid);setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false,"referer:"+location.hostname+location.pathname+",func:0007")},"click");$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=blogicp";$E("linkReg").onclick=function(){v7sendLog("40_01_17")};if(scope.$channel){if(scope.$channel==2){$E("linkReg").href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=baby"}}},initPopularize:function(){var a=$E("divPopularize");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}},_loadPopularizeData:function(a){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/iframe/283/2012/0705/1.js",{charset:"utf-8",onComplete:function(g){var d=$_GLOBAL.popularizeConfig;if(!d||a.innerHTML){return}var c=d.length;var j=Utils.Cookie;var f=parseInt(j.getCookie("blogPopularizeIndex")||0);if(c<=f){f=0}j.setCookie("blogPopularizeIndex",1+f,24,"/",".blog.sina.com.cn");a.innerHTML=d[f];if($E("err_i8t9c")){var b=a.innerText||a.textContent||"";if(b.length>10){a.children[0].innerHTML=b.substr(0,9)+"..."}}}})},setNodesMouseHoverStyle:function(c){var b,a=c.length;for(b=0;b<a;b++){Core.Events.addEvent($E(c[b]),(function(d){return function(){Core.Dom.removeClassName($E(c[d]),"current");$E(c[d]).className+=" current"}})(b),"mouseover");Core.Events.addEvent($E(c[b]),(function(d){return function(){Core.Dom.removeClassName($E(c[d]),"current")}})(b),"mouseout")}$E("loginBarCenter").onclick=function(){v7sendLog("40_01_05_"+$UID)};$E("loginBarFriend").onclick=function(){v7sendLog("40_01_06_"+$UID)};$E("logOut").onclick=function(){v7sendLog("40_01_11_"+$UID)}},initNicknamePanel:function(){var d=new scope.NicknamePanel();Lib.checkAuthor();d.initUserInfo($UID);this.addSubPanel(d,$E("loginBarOptApp"),-98,-9);var b=this;if(Utils.Cookie.getCookie("loginFromMsn")&&!$E("msnLoginIcon")){var a=$C("img");a.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";a.style.cssFloat=a.style.styleFloat="left";a.width="18";a.height="0";a.style.padding="9px 0";a.align="absmiddle";Core.Dom.insertAfter(a,$E("loginBarAppMenuLabel"));trace("创建msn icon");c(a)}else{trace("不渲染msn icon")}function c(j){var f=$C("a");var m=j.parentNode;var o=m.parentNode;var n=$C("img");o.style.position="relative";m.style.position="relative";n.id="msnLoginIcon";n.className="SG_icon SG_icon136";n.src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";n.style.width="18px";n.style.height="18px";n.align="absmiddle";f.appendChild(n);f.href="http://control.blog.sina.com.cn/blogprofile/msnbind.php?c="+ +new Date();f.target="_blank";f.style.cssText="display:block; width:18px; height:18px; position:absolute; z-index:1024;";f.style.paddingTop="4px";f.title="MSN账号登录";o.insertBefore(f,o.childNodes[0]);Core.Events.addEvent(window,g,"resize");trace("创建msn icon mask");g();function g(){var p=setInterval(function(){var q=$E("loginBarAppMenuLabel").innerHTML;if(q!=="读取中..."){var r=j.offsetLeft+"px";f.style.left=r;trace("刷新msn icon mask");clearInterval(p)}},300)}scope.$msnRelocation=g}},initAddArticlePanel:function(){var a=new scope.addArticlePanel();this.addSubPanel(a,$E("arrowAddArticle"),-81,0);$E("arrowAddArticle").onclick=function(){v7sendLog("40_01_13_"+($UID?$UID:""))};$E("arrowAddArticle").parentNode.children[0].onclick=function(){v7sendLog("40_01_12_"+($UID?$UID:""))}},showPublishWare:function(c){if(c.tbh_status&&parseInt(c.tbh_status,10)){$E("tray_tbh_ware_linedot").style.display="";var a=$E("tray_tbh_ware_link");a.style.display="";try{var b=$T(a,"a")[0];if(scope&&"editor"==scope.$pageid){b.href="javascript:;";b.target="";b.onclick=function(){var f=$E("shortcut_content");var j=$T(f,"img");for(var g=0;g<j.length;g++){if(-1!=j[g].src.indexOf("element_shop")){Core.Events.click(j[g])}}}}b=null;a=null}catch(d){}}Lib.Listener.off({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this})},initSearchPanel:function(){var d=new scope.SearchPanel();this.addSubPanel(d,$E("searchSelect"),-54,-4);Utils.Form.limitMaxLen($E("loginBarSearchInput"),50);var c=d.getNodes();var a;for(a in d.config){(function(g){Core.Events.addEvent(c[g],function(){f(g)},"click")})(a)}f("blog");$E("searchSelect").onclick=function(){v7sendLog("40_01_18")};var b=Core.Dom.getElementsByClass($E("loginBarSearchForm"),"input","topbar_searchBtn")[0];b.onclick=function(){v7sendLog("40_01_20")};Core.Events.addEvent($E("loginBarSearchInput"),function(g){var j=g.keyCode||g.charCode;if(j==15){v7sendLog("40_01_20")}},"keyup");function f(p){var o=$E("loginBarSearchForm");o.action=d.config[p]["url"];$E("loginBarSearchMenuLabel").innerHTML=c[p].getElementsByTagName("a")[0].innerHTML;var m=$E("loginBarSearchC"),r=$E("loginBarSearchT"),j=$E("loginBarSearchType"),n=$E("loginBarSearchS"),g=$E("loginBarSearchTS"),q=$E("loginBarSearchInput");switch(p){case"all":case"blog":case"bauthor":if(!m){m=$C("input");m.type="hidden";m.name="c";m.id="loginBarSearchC";o.appendChild(m)}m.value="blog";r.value=d.config[p]["range"];r.name="range";j.value=d.config[p]["by"];j.name="by";q.name=d.config[p]["keyName"];break;case"song":case"video":case"vauthor":m&&(m.value="");r.value=d.config[p]["t"];r.name="t";n.value=d.config[p]["s"];g.value=d.config[p]["ts"];j.value=d.config[p]["type"];j.name="type";$E("loginBarSearchSType").value=d.config[p]["stype"];q.name=d.config[p]["keyName"];break}}},hideActiLink:function(b){var a=scope.$pageid;if("pageSetM"!==a&&"editor"!==a){b.style.display="none";b.setAttribute("shouldShow","1")}setTimeout(function(){if((typeof BLOG_AD_TIPS=="undefined")||!BLOG_AD_TIPS){b.style.display="";return}},3000)},initActivityPanel:function(){if($_GLOBAL){var a=$E("loginBarActivity");if(a){this.hideActiLink(a);this._loadPopularizeData(a)}}if($_GLOBAL.activityBlackList&&$_GLOBAL.activityBlackList[scope.$pageid]){trace("【活动】当前页面在黑名单");return}},initMsnLogout:function(){var f=$E("openedBlogTray");var c=f.getElementsByTagName("a");var g=c[c.length-1];g.href="#";g.onclick=function(){return false};var a=$E("noOpenedBlogTray");var b=a.getElementsByTagName("a");var j=b[b.length-1];j.href="#";j.onclick=function(){return false};var m=encodeURIComponent(window.location.href);if(f){Core.Events.addEvent(g,d)}if(a){Core.Events.addEvent(j,d)}function d(){new Interface("http://control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(n){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+m},onError:function(n){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+m},onFail:function(n){window.location.href="http://login.sina.com.cn/cgi/login/logout.php?r="+m}})}},addSubPanel:function(b,d,a,c){var g=this;this.subPanels.push(b);function f(){Core.Events.stopEvent();var m,j=g.subPanels.length;for(m=0;m<j;m++){g.subPanels[m].hidden()}b.showWithDom(d,a,c)}Core.Events.addEvent(d,function(){if(d===$E("loginBarOptApp")){v7sendLog("40_01_01_"+$UID)}f()},"click");Core.Events.addEvent(document.body,function(){b.hidden()},"click");Core.Events.addEvent(b.entity,function(){Core.Events.stopEvent()},"mousedown");Core.Events.addEvent(window,function(){var j=Core.Dom.getLeft(d)+d.offsetWidth+a;var m=Core.Dom.getTop(d)+d.offsetHeight+c;if($IE6&&this.isFixed){j=j-document.documentElement.scrollLeft;m=m-document.documentElement.scrollTop}b.setPosition(j,m)},"resize")},initNewInboxPanel:function(){var c=new scope.NewInboxPanel();this.addSubPanel(c,$E("loginBarInbox"),-137,-9);try{if(!$E("ccnotepiaohong")){var a=$C("div");a.className="imforbox";a.style.display="none";a.id="ccnotepiaohong";$E("loginBarInbox").appendChild(a)}$E("loginBarInbox").className="link imfor"}catch(b){}c.onMessageLoad=function(d){$E("loginBarAppMenuLabel").innerHTML=d;$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(d)}},initMailRemind:function(){if($E("loginBarMail")&&$E("line")){$E("loginBarMail").style.display="";$E("line").style.display=""}function b(){var c=new Interface("http://interface.blog.sina.com.cn/riaapi/profile/unreadmail.php","jsload");c.request({onSuccess:function(g){var d=parseInt(g,10);if(d>99){d="99+"}if(d!==0&&$E("mailpiaohong")){var f=$E("mailpiaohong");f.style.display="";f.innerHTML=d}else{$E("mailpiaohong").style.display="none"}},onError:function(){$E("mailpiaohong").style.display="none"}})}b();var a=setInterval(b,5*60*1000);Core.Events.addEvent($E("loginBarMail"),function(){v7sendLog("40_01_07_"+$UID);var d=$E("mailpiaohong");var c=!(d.style.display);if(c){d.style.display="none"}},"click");Core.Events.addEvent($E("mailpiaohong"),function(){var c=$E("mailpiaohong");c.style.display="none";window.open("http://mail.sina.com.cn/?s=2")},"click")},initOnceLogedEvent:function(d,c){var b,a=d.length;var f=this;for(b=0;b<a;b++){$E(d[b]).onclick=function(){switch(this.id){case"loginBarOptApp":v7sendLog("44_01_07_"+c);break;case"loginBarMail":v7sendLog("44_01_08_"+c);break;case"loginBarCenter":v7sendLog("44_01_09_"+c);break;case"loginBarFriend":v7sendLog("44_01_10_"+c);break;case"loginBarInbox":v7sendLog("44_01_11_"+c);break}if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}f.trayLogin.login(function(){setTimeout(function(){window.location=window.location.toString().replace(/#.*/,"")},100)},false);return false}}},initOnceLogedTips:function(b){var c=this;var a="http://interface.blog.sina.com.cn/riaapi/profile/unread.php";Utils.Io.JsLoad.request(a,{GET:{uid:b,product:"blog"},onComplete:function(f){if(scope.$pageid=="profile_index"||scope.$pageid=="pageSetM"||scope.$pageid=="editor"){return}var g=$E("newStatusTip");if(!g){g=$C("div");g.id="newStatusTip";g.className="tb_layer_Y tb_layer_w3";g.style.width="138px";g.innerHTML=scope.onceLogedStatusTipTemplay;var d=$T($E("loginBarCenter"),"a")[0];var j=Core.Dom.getXY(d);g.style.left=(j[0]-(138/2-d.offsetWidth/2))+"px";g.style.top=(j[1]+d.offsetHeight)+"px";g.style.zIndex="510";g.style.display="none";document.body.appendChild(g)}if(f.data.unreadnotes>=1){v7sendLog("44_01_12_"+b);g.style.display="block";$E("nstUnread").style.display="block";$E("nstUnread").onclick=function(){v7sendLog("44_01_13_"+b);if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}c.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/profilelatestnote.php"},100)},false);return false}}else{if(f.data.nfn>=1){v7sendLog("44_01_14_"+b);g.style.display="block";$E("nstFeed").style.display="block";$E("nstFeed").onclick=function(){v7sendLog("44_01_15_"+b);if(typeof sinaSSOController!="undefined"){sinaSSOController.loginExtraQuery={}}c.trayLogin.login(function(){setTimeout(function(){window.location="http://i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"},100)},false);return false}}}Core.Events.addEvent(window,function(){var m=$T($E("loginBarCenter"),"a")[0];var n=Core.Dom.getXY(m);g.style.left=(n[0]-(138/2-m.offsetWidth/2))+"px";g.style.top=(n[1]+m.offsetHeight)+"px"},"resize")},onException:function(d){}})}};$registJob("tray",function(){Lib.Listener.add("tray-data-loaded");Lib.checkAuthor();var f;var d=$E("login_bar_logo_link_350");var j="ntopbar_main"===d.parentNode.className;if(j){f=Lib.TrayPanel()}else{f=new Lib.PlatformTrayPlus()}var g=Lib.Login.info();var c=g.uid;window.$onceLog=false;var a=unescape(Utils.Cookie.getCookie("onceloggedonblog"));if(a&&c){time=a;var b=new Date().getTime();if(time&&(b>time)){$onceLog=true}}if($isLogin){f.load("login")}else{if(!j&&$onceLog){f.load("oncelogedon")}else{f.load("logout")}}window.$tray={};window.$tray.renderLogin=function(){Lib.checkAuthor();if($isLogin){f.load("login")}};window.$tray.renderLogout=function(){f.load("logout")}});$registJob("login",function(){var a=new Lib.Login.Ui();Core.Events.addEvent("loginbtn",function(){a.login(function(){alert("做一些，登陆之后，做的事情，呵呵！")})})});Lib.insertMoban=function(){if(scope.tpl&&scope.tpl!=""&&(scope.tpl.split("_")[0]=="13"||$_GLOBAL.flashtemplate[scope.tpl])){Lib.insertMobanFunc(scope.tpl)}};Lib.insertMobanFunc=function(g){var b=$E("headflash");if(b){b.innerHTML="";b.style.display="";var f="http://simg.sinajs.cn/blog7newtpl/css/"+g.split("_")[0]+"/"+g+"/top.swf";var c=950,d=266;if($_GLOBAL.flashtemplate[g].width){c=$_GLOBAL.flashtemplate[g].width}if($_GLOBAL.flashtemplate[g].height){d=$_GLOBAL.flashtemplate[g].height}trace("flash height="+d);var a=Utils.Flash.swfView.Add(f,"headflash","headflash_f",c,d,"9.0.0.0","#000",{},{allowScriptAccess:"false",wmode:"transparent",allowFullScreen:"false"})}};Lib.tplFuncArr={};Lib.tplFuncCount=0;Lib.getTplNum=function(m){Lib.tplFuncArr[Lib.tplFuncCount++]=m||function(){};if($isAdmin&&scope.tpl&&scope.tpl!=""){for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}return}else{if($IE){var f=document.styleSheets;var j=/\S*(blog7tpl([^t]*))\S*/gi;var b=/\S*(blog7newtpl\/css([^t]*))\S*/gim;for(var d=0;d<f.length;d++){if(f[d].id=="uid_link_css"){var c=j.exec(f[d].cssText);var g=b.exec(f[d].cssText);if(c!=null||g!=null){if(c!=null){scope.tpl=c[2].split("/")[2]}else{if(g!=null){scope.tpl=g[2].split("/")[2]}}}break}}for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}}else{if(!$IE&&scope.$PRODUCT_NAME=="blog7"){for(var a in Lib.tplFuncArr){Lib.tplFuncArr[a]();Lib.tplFuncArr[a]=null;delete Lib.tplFuncArr[a]}return;Utils.Io.Ajax.request("http://blog.sina.com.cn/s/"+scope.$uid+".css?",{onComplete:function(s){s=s.replace("\n","");var r=/\S*(blog7tpl([^t]*))\S*/gim;var o=/\S*(blog7newtpl\/css([^t]*))\S*/gim;var p=r.exec(s);var q=o.exec(s);if(p!=null||q!=null){if(p!=null){scope.tpl=p[2].split("/")[2]}else{if(q!=null){scope.tpl=q[2].split("/")[2]}}}for(var n in Lib.tplFuncArr){Lib.tplFuncArr[n]();Lib.tplFuncArr[n]=null;delete Lib.tplFuncArr[n]}}.bind2(this),returnType:"txt"})}else{if(!$IE&&scope.$PRODUCT_NANM!="blog7"){Utils.Io.JsLoad.request("http://blog.sina.com.cn/s/"+scope.$uid+".js",{GET:{tm:new Date().getTime()},onComplete:function(){for(var n in Lib.tplFuncArr){Lib.tplFuncArr[n]();Lib.tplFuncArr[n]=null;delete Lib.tplFuncArr[n]}}.bind2(this)})}}}}};$registJob("getTplNum",function(){});(function(){var getImgStaticPath=function(pid,type){if(!pid){return""}var type=type||"orignal";try{var num=(eval("0X"+pid.substring(pid.length-2))%16)+1;return"http://s"+num+".sinaimg.cn/"+type+"/"+pid}catch(e){trace("图片URL计算出错！PID:"+pid);return""}};window.getImgStaticPath=getImgStaticPath})();Utils.insertTemplate=function(d,j,f){var a=[],b={},n=/#{(\w+)}/g,m="_"+(new Date().getTime().toString()).slice(-5)+Math.floor(Math.random()*100000);j=j.replace(n,function(o,p){a.push(p);return p+m});Core.Dom.insertHTML(d,j,f);for(var g=a.length,c;g--;){c=a[g];b[c]=$E(c+m)}return b};$registJob("articleShare",function(){if(!$E("t_"+scope.$articleid)){trace("应该是私密博文");return}var t="javascript:void((function(s,d,e,r,l,p,t,z,c,w){var%20f='http://v.t.sina.com.cn/share/share.php?',u=z||d.location,p=['url=',e(u),'&title=',e(t||d.title),'&source=',e(r),'&sourceUrl=',e(l),'&content=',c||'gb2312','&pic=',e(p||''),'&ralateUid=',w].join('');function%20a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=440,height=430,left=',(s.width-440)/2,',top=',(s.height-430)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,'新浪-博客','http://blog.sina.com.cn','"+(scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"")+"','分享"+scope.owenerNickName+"的博文："+$E("t_"+scope.$articleid).innerHTML.replace(/'/g,"\\'")+" 推荐给@头条博客','http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html','utf-8','1231759973'));";t=Core.String.decodeHTML(t);if($E("shareminiblogfromblogatarticlepage")){Lib.Uic.getNickName([scope.$uid],function(y){var v=y[scope.$uid]||"";v=Core.String.encodeHTML(v);scope.owenerNickName=v;$E("shareminiblogfromblogatarticlepage").href=t})}if($_GLOBAL.diggerOpenFlag){var j=$E("sharewb"),f=$E("shareqing"),m=$E("sharemail");if(j){j.href=t;Core.Events.addEvent(j,function(){v7sendLog("80_01_04")})}if(!f&&j){f=$C("a");f.href="javascript:;";f.innerHTML='<img width="18" height="18" align="absmiddle" title="分享到新浪Qing" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205" />';j.parentNode.appendChild(f)}if(f){f.onclick=function(){var C=$E("t_"+scope.$articleid).innerHTML,B=[],A=$T($E("sina_keyword_ad_area2"),"img");if(C.length>120){C=C.substr(0,120)+"…"}for(var z=0,v=Math.min(20,A.length);z<v;z++){B.push(A[z].src||A[z].real_src)}var y=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+scope.owenerNickName+"的博文《"+C+"》，查看原文：")+"&url="+encodeURIComponent(location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+encodeURIComponent(B.join(","));window.open(y,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2);v7sendLog("80_01_01");return false}}if(!m&&f){var c='<a href="javascript:;" id="sharemail"><img width="16" height="16" align="absmiddle" title="分享到新浪邮箱" alt="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon211"></a>';Utils.insertTemplate(f,c,"AfterEnd");m=$E("sharemail")}if(m){if(!scope.$rank||!scope.totalPv){var d=setInterval(r,300);function r(){var v=scope.$rank;var y=scope.totalPv;if(v&&y){clearInterval(d)}}}m.onclick=function(){if($isLogin){var v="http://mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);window.open(v,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2);return false}else{var y=new Lib.Login.Ui();y.login(function(){var z="http://mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);window.open(z,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2);return false})}}}if($E("sharexn")){$E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)";Core.Events.addEvent($E("sharexn"),function(){v7sendLog("80_01_07")})}if($E("sharedb")){$E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)";Core.Events.addEvent($E("sharedb"),function(){v7sendLog("80_01_08")})}if($E("sharekx")){$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();";Core.Events.addEvent($E("sharekx"),function(){v7sendLog("80_01_06")})}var g=$E("sharemsn");if(g){var b=[];b.push("url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+scope.$articleid+".html"));var s=$E("t_"+scope.$articleid);if($IE){s=s.innerText}else{s=s.textContent}b.push("title="+encodeURIComponent(s));var o=scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"http://portrait"+(parseInt(scope.$uid)%8+1)+".sinaimg.cn/"+scope.$uid+"/blog/180";b.push("screenshot="+encodeURIComponent(o));var u=$E("sina_keyword_ad_area2");if(u){if($IE){u=u.innerText}else{u=u.textContent}u=u.replace(/\n/ig,"");u=u.replace(/^\s\s*/,"");var p=/\s/;var n=u.length;while(p.test(u.charAt(--n))){}b.push("description="+encodeURIComponent(u.substring(0,101)))}g.href="http://profile.live.com/badge/?"+b.join("&");g.target="_blank";Core.Events.addEvent(g,function(){v7sendLog("80_01_05")})}}if($E("moreshares")){Core.Events.addEvent($E("moreshares"),function(){if($E("sharelayer")){if($E("sharelayer").style.display=="none"){var z=Core.Events.fixEvent(Core.Events.getEvent());var y=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=(y[0]-45)+"px";$E("sharelayer").style.top=(y[1]+15)+"px";$E("sharelayer").style.display=""}else{}}else{var v='<div id="sharelayer" style="z-index:100;width:120px;" class="tb_layer_Y tb_layer_w2"><div class="tb_layer_arrow"></div><div class="tb_layer_Y_main" ><div class="tb_ps_share" style="width:96px;"><span class="share"><a id="sharewb" href="#" title="分享到新浪微博"><img height="16" align="absmiddle" width="16" title="微博" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon51"></a></span><span class="share"><a id="sharexn" href="#" title="分享到人人"><img height="16" align="absmiddle" width="16" title="人人" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon113"></a></span><span class="share"><a id="sharedb" target="_blank" href="#" title="分享到豆瓣"><img height="16" align="absmiddle" width="16" title="豆瓣" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon116"></a></span><span class="share"><a id="sharekx" href="#" title="分享到开心001"><img height="16" align="absmiddle" width="16" title="开心001" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon117"></a></span><div class="clearit"></div></div></div></div>';Core.Dom.insertHTML(document.body,v,"beforeend");var z=Core.Events.fixEvent(Core.Events.getEvent());var y=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=(y[0]-45)+"px";$E("sharelayer").style.top=(y[1]+15)+"px";$E("sharewb").href=t;$E("sharexn").href="javascript:u='http://share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)";$E("sharedb").href="http://www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)";$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('http://www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();";Core.Events.addEvent($E("sharelayer"),function(){var F=Core.Events.fixEvent(Core.Events.getEvent());var E=Core.Dom.getXY($E("sharelayer"));var G=Core.System.getScrollPos(document);var D=E[0];var C=E[1];var B=G[1]+F.clientX;var A=G[0]+F.clientY;if(B>=(D+116)||B<=D||A>=(C+42)||A<=C){$E("sharelayer").style.display="none"}},"mouseout")}},"mouseover")}var a=function(){var z=['<div class="layer_weimi">','<a href="javascript:;" class="close" id="weimiShareClose"></a>','<div class="title">微米分享</div>','<ol class="list">','<li class="step code"><img id="weimiQRCode" alt="二维码" /></li>','<li class="step step1">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/1.jpg" alt="步骤一" /></div>','<div class="desc"><span class="num">1</span><span class="txt">微米扫描左侧二维码</span></div>',"</li>",'<li class="step step2">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/2.jpg" alt="步骤二" /></div>','<div class="desc"><span class="num">2</span><span class="txt">点击右上角的分享按钮</span></div>',"</li>",'<li class="step step3">','<div class="pic"><img src="http://simg.sinajs.cn/blog7style/images/common/weimilayer/3.jpg" alt="步骤三" /></div>','<div class="desc"><span class="num">3</span><span class="txt">选择分享给朋友</span></div>',"</li>","</ol>","</div>"].join("");var D={},A={};var v,B,C,y="http://comet.blog.sina.com.cn/qr?"+location.href.replace(/[#?](.*)/,"");A.init=function(){C=$E("shareweimi");if(!C){D.createShareNode()}Core.Events.addEvent(C,D.showLayer,"click");Core.Events.addEvent(window,D.resizeLayer,"resize")};D.createShareNode=function(G){var F=$E("shareqing").parentNode,H=$E("shareqing"),E;E=$C("a");E.id="shareweimi";E.innerHTML='<img width="51" height="16" align="absmiddle" title="分享到微米" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon213">';F.insertBefore(E,H);C=$E("shareweimi")};D.createShareLayer=function(){var E=$C("div");E.id="weimiShareLayer";E.innerHTML=z;document.body.appendChild(E);$E("weimiQRCode").src=y;v=$E("weimiShareLayer");B=$E("weimiShareClose");Core.Events.addEvent(B,D.hideLayer,"click")};D.showLayer=function(){v=$E("weimiShareLayer");if(!v){D.createShareLayer()}D.setPos();v.style.display="";return false};D.hideLayer=function(){v&&(v.style.display="none");return false};D.resizeLayer=function(){if(!v){return}if(v.style.display=="none"){return}D.setPos()};D.setPos=function(){var F=document.documentElement.clientHeight||document.body.clientHeight;var G=document.documentElement.clientWidth||document.body.clientWidth;var E=586;v.style.position=$IE6?"absolute":"fixed";v.style.left=Math.abs(G-E)/2+"px";v.style.zIndex="1025";if($IE6){v.style.top=document.documentElement.scrollTop+50+"px"}else{v.style.top=50+"px"}};return A};var q=a();q.init()});$registJob("recordVisitor",function(){Lib.checkAuthor();if($isLogin&&!$isAdmin){(function(){if(scope.unreadMsg){if(!scope.unreadMsg.foot){scope.unreadMsg.foot=0}if(!(scope.unreadMsg.foot*1)){var a={pid:1,uid:scope.$uid};if(typeof scope.$articleid!="undefined"){a.subid=scope.$articleid}Utils.Io.JsLoad.request("http://footprint.cws.api.sina.com.cn/add.php",{GET:a})}}else{setTimeout(arguments.callee,200)}})()}});Utils.text2Copy=function(c){var a=function(){var r=(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"])?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(r){var v=navigator.plugins["Shockwave Flash"].description.split(" ");for(var t=0;t<v.length;++t){if(isNaN(parseInt(v[t],10))){continue}var s=v[t]}return s>=10}else{if($IE){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10");return true}catch(u){return false}}}};if(window.clipboardData&&$IE6){window.clipboardData.clearData();return window.clipboardData.setData("Text",c)}else{if(a()){if($IE){try{window.clipboardData.clearData();return window.clipboardData.setData("Text",c)}catch(n){return false}}try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var b=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!b){return}var q=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!q){return}q.addDataFlavor("text/unicode");var p={};var j={};p=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var m=c;p.data=m;q.setTransferData("text/unicode",p,m.length*2);var o=Components.interfaces.nsIClipboard;if(!b){return false}b.setData(q,null,o.kGlobalClipboard);return true}catch(n){return false}}else{var g="flashcopier";if(!$E(g)){var f=$C("div");f.id=g;document.body.appendChild(f)}c=c.replace(/%/g,escape("%")).replace(/&/g,escape("&"));var d='<embed src="http://simg.sinajs.cn/blog7common/clipboard.swf" FlashVars="clipboard='+c+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';$E(g).innerHTML=d;return true}}};Lib.subscribe=Core.Class.create();Lib.subscribe.prototype={initialize:function(){this.createDlg()},createDlg:function(){var a="http://blog.sina.com.cn/rss/"+scope.$uid+".xml";var c=['<div id="rssDy"></div>'];c.push('<div class="clearit"></div></div><table><tr><th scope="row">订阅地址：</th><td><input type="text" id="subscribeText" class="SG_input" value="" /><a class="SG_aBtn SG_aBtnB" href="javascript:;" onclick="return false;"><cite id="subscribeCopy">复制</cite></a></td></tr><tr><th scope="row"></th><td>如果还没有RSS阅读器，请<strong><a href="http://down.tech.sina.com.cn/content/3034.html" target="_blank">立即下载</a></strong>。 </td></tr></table>');c=c.join("");var b=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite style="width:100px;"><a href="http://www.sina.com.cn/ddt/rsshelp.html" target="_blank">什么是RSS?</a><a title="关闭" class="CP_w_shut" id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 rssLayer" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");this._dialog=winDialog.createCustomsDialog({tpl:b,title:"RSS订阅",content:c,width:415,height:104},"tips");$E("subscribeText").value=a;this.bindEvent()},bindEvent:function(){var a=this;Core.Events.addEvent($E("subscribeCopy"),function(){var b=Utils.text2Copy($E("subscribeText").value);if(b==true){winDialog.alert("复制成功",{funcOk:function(){a._dialog.hidden()},icon:"03"})}})},show:function(){var a=function(){if($_GLOBAL.rssIcons){var d=scope.$uid;if($_GLOBAL.rssMethod){d=scope[$_GLOBAL.rssMethod]}var b="http://blog.sina.com.cn/rss/"+d+".xml";var g=['<div class="rss_title"><strong>在线阅读器直接订阅：</strong></div><div class="rss_list" style="display:inline-block;">'];for(var f=0;$_GLOBAL.rssIcons[f];f++){var c=$_GLOBAL.rssIcons[f];if(c.cls==="rss_shiye"){b=d+"&sub=1"}g.push('<span><a target="_blank" href="');g.push(c.href);if(c.encode){g.push(encodeURIComponent(b))}else{g.push(b)}g.push('" class="');g.push(c.cls);g.push('" title="');g.push(c.title);g.push('"></a></span>')}g.push('<span class="news"><img width="15" height="15" align="top" class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="新"></span>');$E("rssDy").innerHTML=g.join("")}};this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle();if($_GLOBAL.rssIcons){a()}else{Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/rss_conf.js",{onComplete:function(){a()},noreturn:true,isRemove:false})}},hidden:function(){this._dialog.hidden()}};$registJob("subscribe",function(){Core.Events.addEvent($E("SubscribeNewRss"),function(){if(!window.mySubscribe){window.mySubscribe=new Lib.subscribe()}window.mySubscribe.show()})});$registJob("updownurl",function(){var c=$E("new_nextprev_"+scope.$articleid);if(!c){Lib.checkAuthor();if(scope.$pn_x_rank=="1"&&!$isAdmin){return false}var b=$E("nextprev_"+scope.$articleid);var a=new Interface("http://blogtj.sinajs.cn/api/get_prevnext_article.php","jsload");var d=$E("t_"+scope.$articleid).parentNode;var f=Core.Dom.getChildrenByClass(d,"time")[0].innerHTML;f=f.replace("(","").replace(")","");a.request({GET:{uid:scope.$uid,blog_id:scope.$articleid,varname:"prevnext",blog_pubdate:f,pn_x_rank:scope.$pn_x_rank},onSuccess:function(j){var g="";if(j.prev!=null){g+='<div><span class="SG_txtb">前一篇：</span><a href="'+j.prev.blog_url+'">'+j.prev.blog_title+"</a></div>"}if(j.next!=null){g+='<div><span class="SG_txtb">后一篇：</span><a href="'+j.next.blog_url+'">'+j.next.blog_title+"</a></div>"}b.innerHTML=g},onError:function(){}})}});Lib.AudioCheck={};var random="";if(window.$Maxthon||window.$360||window.$TT){random="?t="+new Date().getTime()}Lib.AudioCheck.swfUrl=$_GLOBAL.flashBasicURL+"mp3.swf"+random;Lib.AudioCheck.soundUrl="http://interface.blog.sina.com.cn/riaapi/cksound/cksound.php";Lib.AudioCheck.render=function(b,a){$E(b).innerHTML='		<a style="margin-left:3px;" id="comment_get_vcode" href="javascript:;" onclick="Lib.AudioCheck.callAudioCheck();return false;">收听验证码</a>		<img id="play_img" name="play_img" src="http://image2.sina.com.cn/blog/tmpl/v3/images/blank.gif" align="absmiddle" style="margin-right:2px;" height="15">		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="0" height="0" id="mp3_player" align="middle">		<param name="allowScriptAccess" value="always" />		<param name="movie" value="'+this.swfUrl+'" />		<param name="quality" value="high" />		<param name="bgcolor" value="#ffffff" />		<param name="FlashVars" value="mp3URL='+a+'" />		<embed src="'+this.swfUrl+'" FlashVars="mp3URL='+a+'" quality="high" bgcolor="#ffffff" width="0" height="0" name="mp3_player" swLiveConnect="true" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"/>		</object>	'};Lib.AudioCheck.callAudioCheck=function(){setTimeout(function(){$E("play_img").src="http://blogimg.sinajs.cn/v5images/play_img.gif";window.document.mp3_player.SetVariable("isPlay","1");$E("login_check").value="";$E("login_check").focus()},500);var a="http://comet.blog.sina.com.cn/api?maintype=hits&act=3&uid=00000203";Utils.Io.JsLoad.request(a,{onComplete:function(){}})};$registJob("audioCheck",function(){if(!$E("article_comment_list")){return}if(scope.$private.cms!=1&&scope.$isCommentAllow!=1){var b=$E("comment_get_vcode");var a=Core.Dom.wrap(b,"span");if(a){Lib.AudioCheck.render(a,Lib.AudioCheck.soundUrl+"?"+new Date().getTime())}}});Lib.RandomStroll=Core.Class.create();Lib.RandomStroll.prototype={link_url:null,swf_url:$_GLOBAL.flashBasicURL+"lookViewSpring.swf?2",initialize:function(a){this.link_url=a&&a[Math.floor(Math.random()*a.length)];var b=SinaEx.createNode('<div id="ramdomVisitDiv" style="position:absolute;width:140px;z-index:101;"></div>');b.style.top=scope._AD_HEIGHT?(scope._AD_HEIGHT+30)+"px":"30px";document.body.appendChild(b);this.div=b;this.lock();Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"resize");Core.Events.addEvent(window,function(){this.lock()}.bind2(this),"scroll")},load:function(a){Utils.Flash.swfView.Add(this.swf_url,"ramdomVisitDiv","map","140","87","8.0.0.0","#000",{url:this.link_url},{scale:"noscale",allowScriptAccess:"always",wmode:"transparent"})},lock:function(){this.div.style.right="0px"},show:function(){$E("ramdomVisitDiv").style.display=""},hide:function(){$E("ramdomVisitDiv").style.display="none"}};function clickSendRandomLog(){v7sendLog("79_01_14",scope.$pageid,"")}function mouseoverSendRandomLog(){v7sendLog("79_01_13",scope.$pageid,"")}$registJob("randomScroll",function(){Utils.Io.JsLoad.request("http://blog.sina.com.cn/lm/rndurllist.js",{onComplete:function(){if(typeof RND_URL_LIST==="undefined"||!RND_URL_LIST||!RND_URL_LIST.length){return}var a=new Lib.RandomStroll(RND_URL_LIST);a.load({target:"_self",URL:""})}})});if(typeof(sina)!="object"){var sina={}}sina.$=function(a){if(!a){return null}return document.getElementById(a)};var sinaFlash=function(g,r,f,b,u,p,m,q,t,j,d){var s=this;if(!document.createElement||!document.getElementById){return}s.id=r?r:"";var n=function(o,v){for(var c=0;c<o.length;c++){if(o[c]==v){return c}}return -1},a="8.0.42.0";if(n(["eladies.sina.com.cn","ent.sina.com.cn"],document.domain)>-1){s.ver=a}else{s.ver=u?u:a}s.ver=s.ver.replace(/\./g,",");s.__classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";s.__codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+s.ver;s.width=f;s.height=b;s.movie=g;s.src=s.movie;s.bgcolor=p?p:"";s.quality=q?q:"high";s.__pluginspage="http://www.macromedia.com/go/getflashplayer";s.__type="application/x-shockwave-flash";s.useExpressInstall=(typeof(m)=="boolean")?m:false;s.xir=t?t:window.location;s.redirectUrl=j?j:window.location;s.detectKey=(typeof(d)=="boolean")?d:true;s.escapeIs=false;s.__objAttrs={};s.__params={};s.__embedAttrs={};s.__flashVars=[];s.__flashVarsStr="";s.__forSetAttribute("id",s.id);s.__objAttrs.classid=s.__classid;s.__forSetAttribute("codebase",s.__codebase);s.__forSetAttribute("width",s.width);s.__forSetAttribute("height",s.height);s.__forSetAttribute("movie",s.movie);s.__forSetAttribute("quality",s.quality);s.__forSetAttribute("pluginspage",s.__pluginspage);s.__forSetAttribute("type",s.__type);s.__forSetAttribute("bgcolor",s.bgcolor)};sinaFlash.prototype={getFlashHtml:function(){var b=this,c="<object ";for(var a in b.__objAttrs){c+=a+'="'+b.__objAttrs[a]+'" '}c+=">\n";for(var a in b.__params){c+='	<param name="'+a+'" value="'+b.__params[a]+'" />\n'}if(b.__flashVarsStr!=""){c+='	<param name="flashvars" value="'+b.__flashVarsStr+'" />\n'}c+="	<embed ";for(var a in b.__embedAttrs){c+=a+'="'+b.__embedAttrs[a]+'" '}c+="></embed>\n</object>";return c},__forSetAttribute:function(b,c){var a=this;if(typeof(b)=="undefined"||b==""||typeof(c)=="undefined"||c==""){return}b=b.toLowerCase();switch(b){case"classid":break;case"pluginspage":a.__embedAttrs[b]=c;break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"codebase":a.__objAttrs[b]=c;break;case"src":case"movie":a.__embedAttrs.src=c;a.__params.movie=c;break;case"width":case"height":case"align":case"vspace":case"hspace":case"title":case"class":case"name":case"id":case"accesskey":case"tabindex":case"type":a.__objAttrs[b]=a.__embedAttrs[b]=c;break;default:a.__params[b]=a.__embedAttrs[b]=c}},__forGetAttribute:function(b){var a=this;b=b.toLowerCase();if(typeof a.__objAttrs[b]!="undefined"){return a.__objAttrs[b]}else{if(typeof a.__params[b]!="undefined"){return a.__params[b]}else{if(typeof a.__embedAttrs[b]!="undefined"){return a.__embedAttrs[b]}else{return null}}}},setAttribute:function(a,b){this.__forSetAttribute(a,b)},getAttribute:function(a){return this.__forGetAttribute(a)},addVariable:function(b,c){var a=this;if(a.escapeIs){b=escape(b);c=escape(c)}if(a.__flashVarsStr==""){a.__flashVarsStr=b+"="+c}else{a.__flashVarsStr+="&"+b+"="+c}a.__embedAttrs.FlashVars=a.__flashVarsStr},getVariable:function(b){var d=this,c=d.__flashVarsStr;if(d.escapeIs){b=escape(b)}var a=new RegExp(b+"=([^\\&]*)(\\&?)","i").exec(c);if(d.escapeIs){return unescape(RegExp.$1)}return RegExp.$1},addParam:function(a,b){this.__forSetAttribute(a,b)},getParam:function(a){return this.__forGetAttribute(a)},write:function(b){var a=this;if(typeof b=="string"){document.getElementById(b).innerHTML=a.getFlashHtml()}else{if(typeof b=="object"){b.innerHTML=a.getFlashHtml()}}}};addAdvertise=function(){var a=$E("blogads");if(scope.$pageid.indexOf("article")>-1){if(a!=null){var b=$C("div");b.id="blogads2";b.className="blogads2 borderc";b.innerHTML='<p><a href="javascript:;" id="adversite_bottom"></a></p><p class="SG_txtc">新浪广告共享计划</p>'+($isAdmin?'<div class="manage SinaAd_mg2"><a href="http://share.sass.sina.com.cn/widget_ad/index_out.php?done" class="SinaAd_linkcolor SinaAd_link" target="_blank">[管理]</a></div>':"");b.style.display="none";if(scope.$pn_x_rank&&window.parseInt(scope.$pn_x_rank)==0){if($E("nextprev_"+scope.$articleid)){Core.Dom.insertAfter(b,$E("nextprev_"+scope.$articleid))}else{if($E("new_nextprev_"+scope.$articleid)){Core.Dom.insertAfter(b,$E("new_nextprev_"+scope.$articleid))}}}}}Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7/adwidget.js?v1",{onComplete:function(){if(typeof adShare!="undefined"){adShare.init(scope.$uid,"sinablog","SINABLOG")}},noreturn:true,isRemove:false})};$registJob("renderAd",function(){scope.$private.ad=scope.$private.ad||0;if(scope.$private.ad>0){addAdvertise()}});$TEMPLATECLONE_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00003:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00004:"未登录",A00005:"抱歉，你暂时不能复制该模板",A00006:"操作成功",A11007:'你还未开通新浪博客，请先 <a href="http://login.sina.com.cn/hd/reg_sec.php?entry=blog"  id="cloneTemplateButNoReg">开通博客</a>'};Lib.TemplateClone=Core.Class.create();Lib.TemplateClone.prototype={type:"1",version:"7",interfaceClone:null,btnClone:null,initialize:function(b,a){var c=this;this.interfaceClone=new Interface("http://control.blog.sina.com.cn/riaapi/conf/template_clone.php","jsload");this.btnClone=b;if(this.btnClone){Core.Events.addEvent(this.btnClone,function(){c.clone(a)},"click")}},clone:function(b,d){var g=this;var a="<a style='color:red' href='http://finance.sina.com.cn/333/2010-02-05/guest920.shtml' target='_blank'>315十大行业满意度调查</a>";var f=d?a:"";Lib.checkAuthor();if($isLogin){winDialog.confirm("确定使用此模板吗?",{subText:f,funcOk:function(){scope.blogOpener.showDialog(function(){g.request(b)})}})}else{var c=new Lib.Login.Ui();c.login(function(){winDialog.confirm("确定使用此模板吗?",{subText:f,funcOk:function(){scope.blogOpener.showDialog(function(){g.request(b)})},funcCancel:function(){location.reload()}})})}},request:function(a){var b=this;this.interfaceClone.request({GET:{uid_cloned:scope.$uid,type:b.type,version:b.version},onSuccess:function(c){if(a){a()}},onError:function(c){if(c.code=="A11007"){Lib.checkAuthor();var d=winDialog.alert($TEMPLATECLONE_MSG[c.code].replace(/#\{linkNewBlog\}/g,"http://control.blog.sina.com.cn/reg/reg_blog.php?version=7"),{icon:"01"});$E("cloneTemplateButNoReg").onclick=function(){d.hidden().destroy()}}else{winDialog.alert($TEMPLATECLONE_MSG[c.code],{icon:"02"})}},onFail:function(){}})}};$registJob("templateClone",function(){Lib.checkAuthor();if($isAdmin){trace("博主。不执行代码");return}Lib.getTplNum(function(){var a=function(){function f(m){var n=new Ui.Template($_GLOBAL.cloneTemplateConfig[scope.tpl].count_text);var o={};o.template_pv=m;$E("template_clone_link").innerHTML=n.evaluate(o)}if(scope.tpl){var b;var g=$_GLOBAL.cloneTemplateConfig[scope.tpl];if(g&&g.template_clone_pic.replace(/\s/g,"")!=""){if(scope.tpl=="8_52"){$E("template_clone_pic").parentNode.parentNode.style.top="0px";if(window.screen.width<1280){$E("template_clone_pic").parentNode.parentNode.style.right="88px"}$E("template_clone_pic").parentNode.parentNode.style.zIndex=201}$E("template_clone_pic").innerHTML=g.template_clone_pic;$E("template_clone_link").innerHTML=g.template_clone_link;$E("template_clone_other").innerHTML=g.template_clone_other;if(g.count_id){var d="http://comet.blog.sina.com.cn/api?maintype=hits&act=3&uid="+g.count_id+"&varname=templatecc";Utils.Io.JsLoad.request(d,{onComplete:function(){if(typeof templatecc!="undefined"){f(templatecc.pv)}else{$E("template_clone_link").style.display="none"}}})}b=new Lib.TemplateClone($E("template_clone_pic"),function(){winDialog.alert("克隆模板成功!",{icon:"03",funcOk:function(){Lib.checkAuthor();window.location.href="http://blog.sina.com.cn/u/"+$UID}})})}var c=$_GLOBAL.GUANWANG[scope.tpl];if(c&&c.template_clone_pic.replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=c.template_clone_pic;$E("template_clone_other").innerHTML=c.template_clone_other;if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href=c.template_clone_link;$E("template_clone_pic").parentNode.target="_blank"}}}var j=$_GLOBAL.famous_conf[scope.tpl];if(j&&j.template_clone_pic.replace(/\s/g,"")!=""){$E("template_clone_pic").innerHTML=j.template_clone_pic;$E("template_clone_link").innerHTML=j.template_clone_link;$E("template_clone_other").innerHTML=j.template_clone_other;if($E("template_clone_pic")){if($E("template_clone_pic").parentNode.tagName.toLowerCase()=="a"){$E("template_clone_pic").parentNode.href="http://ba.sass.sina.com.cn/front/tp/deliver?blogId="+scope.$uid+"&tp="+scope.tpl}}}}};if($_GLOBAL.cloneTemplateConfig){a()}else{Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7common/conf/tmp_clone.js",{onComplete:function(){a()},noreturn:true,isRemove:false})}})});if(typeof Lib.flashComponent=="undefined"){Lib.flashComponent={}}Lib.FlashDetector=function(a){this.version=a}.$define({version:"",detect:function(){var g=window.navigator,d,a,f,b="0.0.0";if(g.plugins&&g.plugins.length){for(d=0,a=g.plugins.length;d<a;d++){if(g.plugins[d].name.toLowerCase().indexOf("shockwave flash")!=-1){b=g.plugins[d].description.toLowerCase().replace(/shockwave flash\s?/,"").split(" ")[0];f=true;break}}}else{if(window.ActiveXObject){for(d=11;d>=1;d--){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d)){b=d+".0";f=true;break}}catch(c){}}}}if(f){this._detectVersion(b)}else{this.onUninstalled&&this.onUninstalled.call(this)}},_detectVersion:function(b){var f=this._getFormatVersion(b).split("."),d=this._getFormatVersion(this.version).split("."),c,a=d.length;for(c=0;c<a;c++){if(+f[c]>+d[c]){this.onSuccess&&this.onSuccess.call(this);return}else{if(+f[c]<+d[c]){this.onVersionLower&&this.onVersionLower.call(this,b);return}}}this.onSuccess&&this.onSuccess.call(this)},_getFormatVersion:function(a){var b=a+"";b.indexOf(".")==-1&&(b+=".0.0");b.split(".").length<3&&(b+=".0");return b},onVersionLower:function(a){},onUninstalled:function(){},onSuccess:function(){}});Lib.flashComponent.FlashContianer=function(a){this._initCfg(a);this._flashDetector=new Lib.FlashDetector(this.flashCfg.version);this._detect()}.$define({flashCfg:{url:"",width:0,height:0,containerID:"divContainer",flashID:"flashID",flashVar:"",version:"9",wmode:"transparent",allowScriptAccess:"always"},rerender:function(){this._initFlash()},_renderText:["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join(""),_flash:null,_falshEntity:null,_flashDetector:null,_initFlash:function(){this._addFlash();this._initFlashEntity()},_detect:function(){var a=this._flashDetector,b=this;a.onSuccess=function(){b._initFlash()};a.onUninstalled=function(){b._renderUninstalled()};a.onVersionLower=function(c){b._renderVersionLower()};a.detect()},_renderVersionLower:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的Flash播放器版本过低")},_renderUninstalled:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器")},_initCfg:function(a){var b;for(b in this.flashCfg){typeof(a[b])!="undefined"&&(this.flashCfg[b]=a[b])}},_addFlash:function(){var a=this.flashCfg,b=this;this._flash=new Utils.Flash.swfObject(a.url,a.flashID,a.width,a.height,a.version,"#ffffff");this._flash.addParam("allowScriptAccess",a.allowScriptAccess);this._flash.addParam("wmode",a.wmode);this._flash.addParam("flashVars",a.flashVar);this._flash.write(a.containerID)},_initFlashEntity:function(){this._flashEntity=$IE?window[this.flashCfg.flashID]:document[this.flashCfg.flashID]}});Lib.flashComponent.HeadPhoto=function(a){}.$extends(Lib.flashComponent.FlashContianer).$define({setMaskPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setMaskPosition&&this._flashEntity.setMaskPosition(a,b)},setPhotoURL:function(a){this._flashEntity.setPhotoURL&&this._flashEntity.setPhotoURL(a)},getPhotoURL:function(a){if(this._flashEntity.getPhotoURL){return this._flashEntity.getPhotoURL()}},setPhotoPosition:function(a,b){a=isNaN(a)?0:a;b=isNaN(b)?0:b;this._flashEntity.setPhotoPosition&&this._flashEntity.setPhotoPosition(a,b)},setPhotoZoom:function(a){a=isNaN(a)?1:a;this._flashEntity.setPhotoZoom&&this._flashEntity.setPhotoZoom(a)},setPhotoAngle:function(a){a=isNaN(a)?0:a;this._flashEntity.setPhotoAngle&&this._flashEntity.setPhotoAngle(a)}});Lib.flashComponent.HeadPhotoEditorConfig={t3_34:{middlePointX:350,middlePointY:100,maskX:108,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_34.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_34.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_35:{middlePointX:200,middlePointY:100,maskX:6,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_35.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_35.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_36:{middlePointX:300,middlePointY:120,maskX:131,maskY:23,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_36.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_36.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_37:{middlePointX:230,middlePointY:100,maskX:71,maskY:0,maskURL:"http://simg.sinajs.cn/blog7swf/baby/mask3_37.swf",frameURL:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_37.png",defaultPhoto:"http://simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"}};$registJob("baby_headPhoto",function(){var f=scope.UserBabyPic||{},d=$E("headflash"),b=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"];scope.renderHeadPhoto=function(j){if(!d){return}d.style.display="";var g=Lib.flashComponent.HeadPhotoEditorConfig["t"+j]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34;scope.headPhoto=new Lib.flashComponent.HeadPhoto({url:$_GLOBAL.flashBasicURL+"baby/headPhoto.swf",width:540,height:285,containerID:"headflash",flashID:"flashHeadPhoto",flashVar:["maskURL=",g.maskURL,"&maskX=",g.maskX,"&maskY=",g.maskY,"&middlePointX=",g.middlePointX,"&middlePointY=",g.middlePointY,"&photoURL=",f.photoURL||g.defaultPhoto,"&photoX=",f.photoX||0,"&photoY=",f.photoY||0,"&photoZoom=",f.zoom||1,"&photoAngle=",f.angle||0].join("")})};for(var c=0,a=b.length;c<a;c++){if(b[c]==scope.tpl){scope.renderHeadPhoto(scope.tpl);break}}});$registJob("baby_babyBarFlashDetect",function(){var b=$E("divBabyBarFlash"),a=new Lib.FlashDetector("9.0.0"),c=["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="http://get.adobe.com/cn/flashplayer/">','<img src="http://simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join("");a.onUninstalled=function(){b&&(b.innerHTML=c.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器"))};a.onVersionLower=function(d){b&&(b.innerHTML=c.replace(/\#\{reason\}/g,"您的Flash播放器版本过低"))};a.detect()});$SYSMSG.extend({B24001:"未同意服务条款",B24002:"你输入的手机号有误，请重新输入。",B24003:"你输入的验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24004:"此博客已绑定手机号",B24005:"此手机号已绑定博客",B24006:"你输入的手机号或验证码有误，请重新输入。<br/>若忘记验证码，可重新获取。",B24007:"此博客未开通手机订阅",B24008:"被访问者uid错误",B24009:"自己不能订阅自己",B24010:"你已手机订阅此用户。",B24011:"抱歉！你的手机订阅用户数已达上限，手机订阅失败。",B24012:"自己不能取消自己",B24013:"此用户未被订阅",B24014:"手机关注订阅失败！",B24015:"确定要取消对他的手机订阅吗？",B24017:"抱歉！您所在的地区暂不支持此服务。",B24018:"抱歉！系统繁忙，请稍后再试。",B24019:"抱歉！您输入的手机号码错误，请重新输入。",B24020:"抱歉！系统繁忙，请稍后再试。",B24021:"抱歉！为防止用户恶意骚扰，您今天尝试开通的次数已达上限。",B24022:"手机绑定但是没有开通，点击确定后将返回个人中心。"});scope.PhoneAttentionAdd=Core.Class.create();scope.PhoneAttentionAdd.prototype={initialize:function(){},add:function(a){try{Core.Events.stopEvent()}catch(b){}a=a||scope.$uid;if(!this.addInterface){this.addInterface=new Interface("http://control.blog.sina.com.cn/admin/iphoneattention/attention.php","jsload")}Lib.checkAuthor();if(!$isLogin){v7sendLog("48_01_31");new Lib.Login.Ui().login(Core.Function.bind3(this.request,this,[a]),false,"referer:"+location.hostname+location.pathname+",func:0005")}else{this.request(a)}},request:function(a){this.addInterface.request({GET:{fuid:a},onSuccess:function(b){var c='手机订阅成功！若此人有新博文发布，我们会短信提醒你。" <br/><span style="font-weight: 100; font-size: 12px;"><a target="_blank" href="http://i.blog.sina.com.cn/blogprofile/profilephone.php">管理我的手机订阅</a>>></span>';winDialog.alert(c,{icon:"03",funcOk:function(){if(scope.$pageid=="profile_phone"||scope.$pageid=="profile_attention"){window.location.reload()}}})},onError:function(b){if(b.code=="B24007"){window.location.href="http://i.blog.sina.com.cn/blogprofile/profilephone.php"}else{if(b.code=="B24016"){var c="你还没有开通博客，现在立即开通？";winDialog.confirm(c,{icon:"04",textOk:"是",textCancel:"否",funcOk:function(){window.open("http://control.blog.sina.com.cn/reg/reg_blog.php?version=7")}})}else{showError(b.code)}}},onFail:function(){}})}};$registJob("phone_attention_add",function(){scope.pa_add=new scope.PhoneAttentionAdd()});$registJob("quote",function(){$E("quote_set_sign")&&(scope.article_quote=new Quote("quote_set_sign"));$E("quote_set_sign2")&&(scope.article_quote=new Quote("quote_set_sign2"));if(!$E("quote_set_sign")&&!$E("quote_set_sign2")){!scope.article_quote&&(scope.article_quote=new Quote());scope.articel_quote_alert=function(a){scope.article_quote.check(a)}}});var QuoteList=Core.Class.create();QuoteList.prototype={saving:false,articleID:"",pageCount:0,initialize:function(a,b){this.container_id=b;this.articleID=scope.$articleid||"";this.initInterface();this.bindEvent(a);$E(this.container_id)&&this.initHtml()},bindEvent:function(b){var a=this;if($E(b)){Core.Events.addEvent($E(b),function(){a.show()})}},initInterface:function(){this.addInterface=new Interface("http://control.blog.sina.com.cn/myblog/htmlsource/quotelist.php","jsload");this.delInterface=new Interface("http://control.blog.sina.com.cn/admin/article/article_quote_del.php","jsload")},show:function(b,c,a){this.pageCount=a||scope.$x_quote_c||0;c&&(this.container_id=c);if(!this.container_id){return}this.articleID=b||scope.$articleid;c&&(this.container_id=c);if($E(this.container_id)&&$E(this.container_id).innerHTML.replace(/\s/g,"")===""){this.initHtml()}if(this.isShow){this.hidden();return}$E(this.container_id).style.display="block";this.loadData();this.isShow=true},hidden:function(){$E(this.container_id).style.display="none";this.isShow=false},initHtml:function(){var b=$E(this.container_id);if(b){var c=this.articleID||"";var a='<h3><a href="#" onclick="return false" title="关闭" id="ql_close'+c+'" class="blogzz_closepic SG_floatR"></a>转载列表：</h3>                <ul class="ul_zzlist" id="ql_content'+c+'">                </ul>				<ul style="display:none"><li id="ql_tip'+c+'"></li></ul>                <div class="SG_clearB"></div>                <div class="blogzz_btn">					<a id="btnArticleQuote'+c+'" href="#" onclick="scope.article_quote && scope.article_quote.check(\''+c+'\');return false;" class="SG_aBtn SG_aBtn_ico SG_turn"><cite><img class="SG_icon SG_icon111" id="quoteList_quote'+c+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />转载</cite></a>					<p id="quoteDescription'+c+'" class="SG_turntxt">转载是分享博文的一种常用方式...</p>				</div>				<div id="ql_page'+c+'" class="blogzz_paged"></div>				<div class="clearit"></div>';b.innerHTML=a;Lib.checkAuthor();$E("btnArticleQuote"+c)&&($E("btnArticleQuote"+c).style.display=$isAdmin?"none":"");$E("quoteDescription"+c)&&($E("quoteDescription"+c).style.display=$isAdmin?"":"none");Core.Events.addEvent($E("ql_close"+c),this.hidden.bind2(this))}},setTip:function(b){var d=this.articleID||"";var c=$E("ql_tip"+d);var a=$E("ql_content"+d);if(b!="ok"){c.innerHTML="暂无转载。";a.style.display="none";c.parentNode.style.display="block"}else{c.parentNode.style.display="none";a.style.display="block"}},loadData:function(b){var a=this;var b=b||1;var c={blogid:a.articleID,version:7,page:b};this.addInterface.request({GET:c,onSuccess:function(d){if(d.length>0){this.setTip("ok");this.parseData(d);this.page(b)}else{this.setTip()}}.bind2(this),onError:function(d){showError(d.code)},onFail:function(){}})},parseData:function(d){var f=this.articleID||"";var c="";var a=d.length;for(var b=0;b<a;b++){c+=this.buildListHtml(d[b])}$E("ql_content"+f).innerHTML=c;scope.quoteList_quote=new Quote("quoteList_quote"+f)},page:function(a){var d=this.articleID||"";var c=this.pageCount;var b=Math.ceil(c/10,10);if(b>1){Ui.Pagination.init({pageNode:"ql_page"+d,nodeClassNamePrefix:"SG",curPage:a,maxPage:b,pageTpl:this.loadData.bind2(this),type:3}).show()}else{$E("ql_page"+d).innerHTML=""}},buildListHtml:function(b){if($isAdmin){b.isShow=""}else{b.isShow="none"}var a=['<li id="pl_#{rp_blogid}">','<p class="blogzz_pinfo SG_txtb SG_floatL">','<a target="_blank" href="http://blog.sina.com.cn/u/#{rp_bloguid}">#{rp_bloguname}</a>','<span class="zzlist_mleft zzlist_mright">等级<em class="SG_txtc">(#{rp_ugrade})</em></span>','<span class="zzlist_mleft">转载了此文：</span><a target="_blank" href="http://blog.sina.com.cn/s/blog_#{rp_blogid}.html">#{rp_blogtitle}</a>',"</p>",'<p class="SG_floatR">','<em class="SG_txtc">#{rp_blogpubdate}</em>','<a href="#" style="display:#{isShow}" class="CP_a_fuc" onclick="scope.article_quoteList.del(\'#{rp_blogid}\',\''+this.articleID+'\');return false;">[<cite id="pl_del_#{rp_bloguid}">删除</cite>]</a>',"</p>","</li>"].join("");b.rp_ugrade=b.rp_ugrade.toString();return new Ui.Template(a).evaluate(b)},del:function(a,b){var c=this;var f={sblog_id:scope.$articleid||b,version:7,blog_id:a},c=this;$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=+$E("quote_sign_count").innerHTML-1);Core.Dom.removeNode($E("pl_"+a));var d=c.articleID||"";if($E("ql_content"+d)&&$E("ql_content"+d).getElementsByTagName("li").length==0){c.setTip()}this.delInterface.request({GET:f,onSuccess:function(g){c.onDeleted()}.bind2(this),onError:function(g){showError(g.code)},onFail:function(){}})},onDeleted:function(){}};$registJob("quote_list",function(){var a=$E("z_"+scope.$articleid);if($E("quote_sign")){scope.article_quoteList=new QuoteList("quote_sign","blog_quote")}else{if(a){scope.article_quoteList=new QuoteList("z_"+scope.$articleid,"blog_quote");a.innerHTML=="(0)"&&(a.style.display="none")}}});Core.String.StringBuffer=function(){this.buffer=[]};Core.String.StringBuffer.prototype.append=function(a){this.buffer.push(a);return this};Core.String.StringBuffer.prototype.toString=function(){return this.buffer.join("")};$SYSMSG.extend({B00901:"投票不存在。",B00902:"投票已截止。",B00903:"超出允许投票个数。",B00904:"你已投过票了!<br/>重复投票是没有意义的。",B00905:"投票主题过短<br/>至少要5个汉字或10个字符！",B00906:"投票选项至少要填写2项",B00907:"投票的截止时间不能小于当前时间，请重新选择 ",B00908:"投票选项最多可填写7项",B00909:"投票主题不能为空"});if(typeof infosoftglobal=="undefined"){var infosoftglobal=new Object()}if(typeof infosoftglobal.FusionChartsUtil=="undefined"){infosoftglobal.FusionChartsUtil=new Object()}infosoftglobal.FusionCharts=function(d,a,p,g,n,j,m,q,b,f,o){if(!document.getElementById){return}this.initialDataSet=false;this.params=new Object();this.variables=new Object();this.attributes=new Array();if(d){this.setAttribute("swf",d)}if(a){this.setAttribute("id",a)}n=n?n:0;this.addVariable("debugMode",n);p=p.toString().replace(/\%$/,"%25");if(p){this.setAttribute("width",p)}g=g.toString().replace(/\%$/,"%25");if(g){this.setAttribute("height",g)}if(m){this.addParam("bgcolor",m)}this.addParam("quality","high");this.addParam("allowScriptAccess","always");this.addVariable("chartWidth",p);this.addVariable("chartHeight",g);this.addVariable("DOMId",a);j=j?j:0;this.addVariable("registerWithJS",j);q=q?q:"noScale";this.addVariable("scaleMode",q);b=b?b:"EN";this.addVariable("lang",b);this.detectFlashVersion=f?f:1;this.autoInstallRedirect=o?o:1;this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){infosoftglobal.FusionCharts.doPrepUnload=true}};infosoftglobal.FusionCharts.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array();var b;var c=this.getVariables();for(b in c){a.push(b+"="+c[b])}return a},getSWFHTML:function(){var c="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){c='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ';c+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var d=this.getParams();for(var a in d){c+=[a]+'="'+d[a]+'" '}var b=this.getVariablePairs().join("&");if(b.length>0){c+='flashvars="'+b+'"'}c+="/>"}else{c='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';c+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var d=this.getParams();for(var a in d){c+='<param name="'+a+'" value="'+d[a]+'" />'}var b=this.getVariablePairs().join("&");if(b.length>0){c+='<param name="flashvars" value="'+b+'" />'}c+="</object>"}return c},setDataURL:function(b){if(this.initialDataSet==false){this.addVariable("dataURL",b);this.initialDataSet=true}else{var a=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));if(!a.setDataURL){__flash__addCallback(a,"setDataURL")}a.setDataURL(b)}},encodeDataXML:function(j){var d=["\\$","\\+"];var m=j.match(/=\s*\".*?\"/g);if(m){for(var f=0;f<m.length;f++){var b=m[f].replace(/^=\s*\"|\"$/g,"");b=b.replace(/\'/g,"%26apos;");var g=j.indexOf(m[f]);var a="='"+b+"'";var c=j.substring(0,g);var n=j.substring(g+m[f].length);var j=c+a+n}}j=j.replace(/\"/g,"%26quot;");j=j.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");j=j.replace(/\&/g,"%26");return j},setDataXML:function(b){if(this.initialDataSet==false){this.addVariable("dataXML",this.encodeDataXML(b));this.initialDataSet=true}else{var a=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));a.setDataXML(b)}},setTransparent:function(a){if(typeof a=="undefined"){a=true}if(a){this.addParam("WMode","transparent")}else{this.addParam("WMode","Opaque")}},render:function(b){if((this.detectFlashVersion==1)&&(this.installedVer.major<8)){if(this.autoInstallRedirect==1){var a=window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");if(a){window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"}else{return false}}else{return false}}else{var d=(typeof b=="string")?document.getElementById(b):b;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var c=this;if(window.addEventListener){window.addEventListener("load",function(){d.innerHTML=c.getSWFHTML()},false)}else{if(window.attachEvent){window.attachEvent("onload",function(){d.innerHTML=c.getSWFHTML()})}else{d.innerHTML=this.getSWFHTML()}}}else{d.innerHTML=this.getSWFHTML()}if(!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")]){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))}return true}}};infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var d=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){d=new infosoftglobal.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var c=1;var b=3;while(c){try{b++;c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);d=new infosoftglobal.PlayerVersion([b,0,0])}catch(f){c=null}}}else{try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");d=new infosoftglobal.PlayerVersion([6,0,21]);c.AllowScriptAccess="always"}catch(f){if(d.major==6){return d}}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(c!=null){d=new infosoftglobal.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(","))}}}return d};infosoftglobal.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){var b=document.getElementsByTagName("OBJECT");for(var c=b.length-1;c>=0;c--){b[c].style.display="none";for(var a in b[c]){if(typeof b[c][a]=="function"){b[c][a]=function(){}}}}};if(infosoftglobal.FusionCharts.doPrepUnload){if(!infosoftglobal.unloadSet){infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload);infosoftglobal.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}infosoftglobal.FusionChartsUtil.getChartObject=function(b){var a=null;if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[b]){a=document.embeds[b]}else{a=window.document[b]}}else{a=window[b]}if(!a){a=document.getElementById(b)}return a};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject;var FusionCharts=infosoftglobal.FusionCharts;var voteValues=[];RenderFlash=Core.Class.create();RenderFlash.prototype={flashId:null,data:null,current:null,eventDom:null,_labels:null,selected:[],initialize:function(){this.eventDom={tab:$E("tabDiv")?$E("tabDiv"):null,line:$E("lineView")?$E("lineView"):null,pie:$E("pieView")?$E("pieView"):null,column:$E("columnView")?$E("columnView"):null,content:$E("voteViewContent")?$E("voteViewContent"):null};this._refreshFlashId();this._addClickEvent(this.eventDom.line);this._addClickEvent(this.eventDom.pie);this._addClickEvent(this.eventDom.column);this.combineData()},showTab:function(a,t,m){if(this.current==a){return}var f=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(f){f.style.display=""}window.clearAllInterval();if(a=="line"){this.current="line";$E("voteViewContent").innerHTML=window.vote_cache_content_html;window.renderVoteNum();var o=document.getElementsByName("chb1");for(var b=0;b<o.length;b++){o[b].disabled="true";try{o[b].parentNode.childNodes[3].style.cursor="default"}catch(p){}}}else{if(a=="Pie3D.swf"){this.current="Pie3D.swf";var g=this._tabTemplate.chooses.join("");var s="";for(var c=0;c<this._labels.length;c++){var r=this._tabTemplate.item.join("");r=r.replace("#{type}",window.vote_rc_type+"");r=r.replace(/([#][{]index[}])/ig,c+1);r=r.replace("#{text}",this._labels[c]);s+=r}g=g.replace("#{uls}",s);g+=this._tabTemplate.flash.join("");this.eventDom.content.innerHTML=g;var q=this._labels.length*30;if(q<150){q=150}var d="<chart baseFontSize='12' baseFontColor='888888' numberSuffix='%25' showAboutMenuItem='0' decimals='2' chartTopMargin='0' chartBottomMargin='0' caption='' showValues='0' formatNumberScale='0' bgColor='99CCFF,FFFFFF' bgAlpha='0,0' startingAngle='60'>";for(var c=0;c<this.data.length;c++){var u=this.data[c];if(this.selected[c]!=null){d+="<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' displayValue='"+(Core.String.shorten(this._labels[c],7,"…"))+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' isSliced='1' />"}else{d+="<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' displayValue='"+(Core.String.shorten(this._labels[c],7,"…"))+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' />"}}d+="</chart>";var n=new FusionCharts($_GLOBAL.flashBasicURL+"Pie3D.swf",t,"360",q,"0","0");n.setDataXML(d);n.setTransparent(true);n.render(m)}else{if(a=="Column3D.swf"){this.current="Column3D.swf";var g=this._tabTemplate.chooses.join("");var s="";for(var c=0;c<this._labels.length;c++){var r=this._tabTemplate.item.join("");r=r.replace("#{type}",window.vote_rc_type+"");r=r.replace(/([#][{]index[}])/ig,c+1);r=r.replace("#{text}",this._labels[c]);s+=r}g=g.replace("#{uls}",s);g+=this._tabTemplate.flash.join("");this.eventDom.content.innerHTML=g;var q=this._labels.length*30;if(q<150){q=150}var d="<chart baseFontSize='12' baseFontColor='888888' showValues='1' outCnvBaseFontColor='999999' outCnvBaseFontSize='12' numberSuffix='%25' showAboutMenuItem='0' decimals='2' yAxisMaxValue='100' palette='2' enableRotation='1' canvasBgColor='ffffff' canvasBgAlpha='0' canvasBgDepth='3' canvasBaseColor='ffffff' divLineColor='d8d8d8' numDivLines='4' bgAlpha='0' divLineColor='d8d8d8' canvasPadding='8' chartLeftMargin='0' chartRightMargin='5' chartTopMargin='5' chartBottomMargin='0' maxColWidth='70' showValues='0'><styles><definition><style name='myToolTip' type='font' size='12' color='666666' /></definition><application><apply toObject='ToolTip' styles='myToolTip' /></application></styles>";for(var c=0;c<this.data.length;c++){var u=this.data[c];d+="<set label='"+(c+1)+"' value='"+voteValues[c].replace("%","")+"' toolText='"+this._labels[c]+"("+voteValues[c]+")' />"}d+="</chart>";var n=new FusionCharts($_GLOBAL.flashBasicURL+"Column3D.swf",t,"360",q,"0","0");n.setDataXML(d);n.setTransparent(true);n.render(m)}}}if($E("flashContent")){$E("flashContent").style.padding="13px 0 0 "}},_refreshFlashId:function(){this.flashId=Core.Math.getUniqueId()},_addClickEvent:function(a){var b=this;if(a){a.onclick=function(){b._onClickHandler(this)}}},_onClickHandler:function(b){var d=this;function a(f){d.eventDom.line.parentNode.className="";d.eventDom.pie.parentNode.className="";d.eventDom.column.parentNode.className="";d.eventDom[f].parentNode.className="cur SG_txtb"}if(b!=null){var c=b.id;if(c=="lineView"){this.showTab("line","lineId","voteViewContent");a("line")}else{if(c=="pieView"){this.showTab("Pie3D.swf","Pie3D_"+this.flashId,"flashContent");a("pie")}else{if(c=="columnView"){this.showTab("Column3D.swf","Column3D_"+this.flashId,"flashContent");a("column")}}}}},combineData:function(b){this.data=[];var c=this._getLabel();for(var a=0;a<c.length;a++){this.data[this.data.length]={label:c[a],num:window.vote_count.detail[a]}}},_getLabel:function(){var d=[];var c=Core.Dom.getElementsByClass($E("voteViewContent"),"span","");var a=c.length;for(var b=0;b<a;b++){d[d.length]=c[b].innerHTML}this._labels=d;return d},_tabTemplate:{chooses:['<div class="vContentRe">',"<ul>","#{uls}","</ul>","</div>"],item:['<li class="clearfix">','<div class="choosed">','<input type="#{type}" disabled="disabled" id="chb#{index}"/><label for="chb#{index}" style="cursor:default"><em>#{index}.</em><span>#{text}</span></label>',"</div>","</li>"],flash:['<div id="flashContent" class="vContentPic">',"</div>"]}};(function(a){a.rf=null;a.changeType=function(b){$E("mutiple").style.display=b?"":"none";$E("voteType").value=b?$E("mutiple").value:1};a.checkNum=function(f,d){var c=document.getElementsByName("chb1");var j=0;for(var g=0;g<c.length;g++){var b=c[g];if(b.checked){j++}}if(j>d){winDialog.alert("最多只能选"+d+"项！",{icon:"01"});f.checked=false}};a.isExpired=function(b){return(b.replace(/(-)|\s/g,"")<getTimestamp("yyyy-MM-dd hh").replace(/(-)|\s/g,""))};a.getTimestamp=function(n){var j=new Date();var c=j.getFullYear();var g=j.getMonth()+1;g=g>9?g:("0"+g);var b=j.getDate()>9?j.getDate():("0"+j.getDate());var f=j.getHours();var m=j.getMinutes()>9?j.getMinutes():("0"+j.getMinutes());var d=j.getSeconds()>9?j.getSeconds():("0"+j.getSeconds());return(n.replace(/(y{2,4})/,c).replace("MM",g).replace("dd",b).replace("hh",f).replace("mm",m).replace("ss",d))};a.readyFun=function(){var n;var f=false;Lib.checkAuthor();if($isLogin){n=$UID}else{n="0"}var o=swfAPI.getC(n);if(o){var r=o.split("|");for(var g=0;g<r.length;g++){var b=r[g];if(b==scope.$articleid){f=true;break}}}if(!f){Core.Events.addEvent("voteBtn",function(){var s=$T($E("voteViewContent"),"input");var y=[];for(var t=0;t<s.length;t++){var u=s[t];if(u.checked&&u.name&&u.name=="chb1"){y.push(t+1)}}if(y.length<1){winDialog.alert("请选择要投票的项！",{icon:"01"});return false}Lib.checkAuthor();if($isLogin){n=$UID}else{n="0"}function j(){try{var z=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(z){z.style.display=""}if(o){if(r.length>99){swfAPI.clearK(n)}else{o=scope.$articleid+"|"+o}}else{o=scope.$articleid}swfAPI.setC(n,o.toString())}catch(A){Debug.error("投票种flash cookie失败！错误原因："+A)}}this.flag=true;var v=y.length;new Interface("http://control.blog.sina.com.cn/admin/vote/shot_vote.php?version=7","ijax").request({POST:{blog_id:scope.$articleid,vote_checklist:y.join(",")},onSuccess:function(F){j();try{var z=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));z.innerHTML='<span class="voteState">已投票</span>';clearAllInterval()}catch(G){}window.vote_count.total+=1;var E=Core.Dom.getElementsByClass($E("voteViewContent"),"span","");var J=[];for(var B=0;B<v;B++){var K=y[B];window.vote_count.detail[K-1]+=1;J.push(E[K-1].innerHTML)}var D={};D.uid=$UID;var A=new Date().getTime();A/=1000;A=Math.ceil(A);D.time=A;D.vote=J;var H=window.vote_interface_result;var I=[];for(var C=0;C<H.length;C++){I[C+1]=H[C]}I[0]=D;window.vote_interface_result=I;renderVoteNum();initLoginBar()},onError:function(D){try{winDialog.alert($SYSMSG[D.code]);if(D.code=="B00902"){var C=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));C.innerHTML='<span class="voteState">投票已截止</span>';var E=$N("chb1");for(var B=0;B<E.length;B++){E[B].disabled=true;try{E[B].parentNode.childNodes[3].style.cursor="default"}catch(A){}}var z=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(z){z.style.display=""}}else{if(D.code=="B00904"){if(!f){j()}var C=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));C.innerHTML='<span class="voteState">已投票</span>';var E=$N("chb1");for(var B=0;B<E.length;B++){E[B].disabled=true;try{E[B].parentNode.childNodes[3].style.cursor="default"}catch(A){}}}}}catch(A){}}})},"click",false)}else{var c=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn"));c.innerHTML='<span class="voteState">已投票</span>';var p=document.getElementsByName("chb1");for(var d=0;d<p.length;d++){p[d].disabled="true";try{if($IE){p[d].parentNode.childNodes[2].style.cursor="default"}else{p[d].parentNode.childNodes[3].style.cursor="default"}}catch(q){}}var m=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(m){m.style.display=""}}};a.swfAPI={setC:function(b,c){$E("swfId").setC(b,c)},getC:function(b){return $E("swfId").getC(b)},clearK:function(b){$E("swfId").clearK(b)},clearC:function(){$E("swfId").clearC()}};a.insertList=function(c){function g(r){var j=new Date(r*1000);return j.getFullYear()+"-"+((j.getMonth()+1)<10?("0"+(j.getMonth()+1)):(j.getMonth()+1))+"-"+j.getDate()+" "+j.getHours()+":"+(j.getMinutes()<10?"0"+j.getMinutes():j.getMinutes())}var n='<li><span class="SG_dot"></span><span class="txt"><a target="_blank" href="#{url}">#{nick}</a>#{userV}&nbsp;<span class="SG_txtb">投票给 #{vote}</span><em class="SG_txtc">#{time}</em></span></li>';var o="";var p=Lib.blogv.getVHTML;if(this.vote_interface_result){for(var f=0;f<vote_interface_result.length;f++){var q=vote_interface_result[f];var m=n;m=m.replace("#{url}","http://blog.sina.com.cn/u/"+q.uid);m=m.replace("#{nick}",c[q.uid]);m=m.replace("#{userV}",p(q.wtype));m=m.replace("#{time}",g(q.time));var b="";for(var d=0;d<q.vote.length;d++){b+='"'+q.vote[d]+'" '}m=m.replace("#{vote}",b);o+=m;if(f==10){break}}if($E("voterlist")){$E("voterlist").innerHTML=o}}};a.initLoginBar=function(){Lib.checkAuthor();if($E("vote_login_txt")){if($isLogin){$E("vote_login_txt").style.display="none"}else{$E("vote_login_txt").style.display="";$E("vote_login").onclick=function(){var b=new Lib.Login.Ui();b.login()}}}};a.initNewVote=function(){Lib.checkAuthor();if($E("voteAD")){$E("voteAD").innerHTML='<a class="SG_linka"><img height="15" align="top" width="15" class="SG_icon SG_icon33" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="投票"></a>&nbsp;<a target="_blank" href="http://control.blog.sina.com.cn/admin/article/article_add.php#voteadd">发起新投票</a>&nbsp;&nbsp;&nbsp;<a class="SG_linka"><img height="18" align="top" width="18" title="" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon110"></a>&nbsp;<a href="#" id="shareVote">分享此投票</a>';$E("shareVote").onclick=function(){var g=encodeURIComponent("分享投票："+$T($E("voter"),"span")[0].innerHTML+"——来自"+scope.owenerNickName+"的博文："+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML||""),f="新浪-博客",c="http://blog.sina.com.cn",d="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+g+"&url="+encodeURIComponent(document.location)+"&source="+f+"&sourceUrl="+encodeURIComponent(c)+"&content=utf-8&appkey=1617465124";window.open(d,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);return false}}var b=$E("cc_morevote");if(!b){b=$C("div");b.id="cc_morevote";b.className="voteapp_btnMore";b.innerHTML='<a href="http://control.blog.sina.com.cn/blogprofile/profilevote.php?type=1" target="blank" title="查看更多投票">查看更多投票&gt;&gt;</a><img class="SG_icon SG_icon11" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="新" align="absmiddle" />';$E("voterlist").parentNode.parentNode.appendChild(b)}};a.renderVoteNum=function(){var p=[];var o=window.vote_interface_result;for(var g=0;g<o.length;g++){var s=o[g];p[p.length]=s.uid}Lib.Uic.getNickName(p,insertList);this.initNewVote();var q=$E("chb1");if(q!=null&&q.type=="radio"){window.vote_rc_type="radio"}else{window.vote_rc_type="checkbox"}this.valueContents=Core.Dom.getElementsByClass($E("voter"),"div","num");var n=0;voteValues=[];var d;var r=window.vote_count.detail;var n=window.vote_count.total;$E("total").innerHTML=n+"人";var b=0;for(var f=0;f<r.length;f++){b+=r[f]}for(d=0;d<valueContents.length;d++){var m=r[d];if(b==0){var c="0%"}else{if(Math.round(m/b*100)>100){var c="100%"}else{var c=Math.round(m/b*100)+"%"}}voteValues.push(c);valueContents[d].innerHTML=m+'<span class="SG_txtc">('+c+")</span>"}renderProgress(voteValues)};a.renderProgress=function(g){window.itvIds=[];var d;var b=Core.Dom.getElementsByAttr($E("voter"),"name","voteResult");var c=Core.Dom.getElementsByClass($E("voter"),"div","num");var f=[];for(d=0;d<c.length;d++){(/\((.*)\)/).test(c[d].innerHTML);f[d]=RegExp.$1}for(d=0;d<b.length;d++){b[d].className="color c"+(d+1);b[d].style.fontSize="8px";b[d].style.width="0px";window.itvIds[d]=window.setInterval((function(j){return function(){if(parseInt(b[j].style.width)<parseInt(f[j])){b[j].style.width=parseInt(b[j].style.width,10)+1+"%"}else{window.clearInterval(itvIds[j])}}})(d),10)}if(!this.rf){a.rf=new RenderFlash()}};a.clearAllInterval=function(){if(window.itvIds){for(var b=0;b<window.itvIds.length;b++){window.clearInterval(itvIds[b])}}}})(window);$registJob("dynamicVoteView",function(){var c=$E("voter");window.vote_progress_css=["1px solid #8d458e","1px solid #578425","1px solid #89ba00","1px solid #008d8e","1px solid #7da4cf","1px solid #d54545","1px solid #ff8d46","1px solid #f6bd0e","1px solid #008dd5","1px solid #b2aa01"];if($E("voterlist")){Lib.checkAuthor();var b="";try{b=Core.Dom.getElementsByClass($E("voter"),"span","voteState")[0].innerHTML}catch(a){}Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/get_user_vote.php",{GET:{blog_id:scope.$articleid},onComplete:function(g){try{if(g.code=="A00006"){window.vote_cache_content_html=$E("voteViewContent")?$E("voteViewContent").innerHTML:"";window.vote_interface_result=g.data&&g.data.newten;window.vote_count=g.data&&g.data.count;renderVoteNum()}else{winDialog.alert(g.code,{icon:"02"});if($E("voterlist")&&$isLogin&&b!="投票已截止"){$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。"}else{if(b=="投票已截止"){try{var d=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(d){d.style.display="none"}Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(f){}}else{if(!$isLogin){$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。"}else{$E("voterlist").innerHTML="加载中…"}}}}}catch(j){trace("vote error")}},noencode:true,onError:function(f){if($E("voterlist")){$E("voterlist").innerHTML="加载中…"}if(b=="投票已截止"){try{Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(d){}}}})}});(function(){var c="readyFun";function b(m,g,d,f){var j=function(){var n=new Utils.Flash.swfObject(g,f,"1","1","9","#00ff00");n.addParam("quality","high");n.addParam("allowScriptAccess","always");n.addVariable("readyFun",d);n.write(m)};j()}var a="";if(window.$Maxthon||window.$360||window.$TT){a="?uid="+Core.Math.getUniqueId(1,10)}b("swfbox",$_GLOBAL.flashBasicURL+"voteCookie.swf"+a,c,"swfId")})();$SYSMSG.extend({B03020:"博文已收藏成功！",B03002:"已达收藏数2000条上限，不能继续收藏。",B03004:"已收藏过此博文，不能重复收藏。",B03005:"确实要取消此收藏吗？",B03006:"确实要删除此博文吗？删除后可在“回收站”恢复。",B03007:"确实要删除此草稿吗？删除后不可恢复。",B03008:"确实要彻底删除此博文吗？删除后不可恢复。",B03010:"确实要替换已置顶的博文吗？",B03011:"确实要取消置顶吗？取消后可在“博文”页恢复。",B03014:"博文已成功置顶到首页！",B03015:"抱歉，您的博客尚未升级，请<a href='http://blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“收藏” 。",S01107:"已收藏过此博文，不能重复收藏。",B03016:"是否要彻底删除此博文？博文删除后不可恢复，博文内图片如被其他博文引用也将无法显示。",B03017:"私密博文不能被收藏。",B119000:"对不起，您短时间点击收藏过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});$SYSMSG.extend({B00007:"跳转到自动开通页",B00008:"自动开通用户(跳转到假页)",B00009:"跳转到自动开通页",B00010:"无权限。 ",B00011:"抱歉，Blog ID 错误，操作无法完成。",B00012:"抱歉，可能因为重复操作而无法执行，请刷新本页再试。",B00013:"用户ID被封杀",B00014:"很抱歉，您输入的验证码不正确。",B04101:"请输入您的昵称！",B04102:"请正确输入您的邮件地址！",B04103:"请选择您举报信息的位置！",B04104:"请选择您举报的不良信息的类型！",B04105:"简单描述最多只能输入500个字符！",B04106:"再次感谢您帮助我们进行不良信息的验证工作，我们将认真仔细地处理您提交的内容。",B07006:"您已发的博文正在审查中，请稍后再发文"});App.ArticleMange=Core.Class.create();Core.Class.extend(App.ArticleMange.prototype,{initialize:function(c,b){for(var a in b){this[a]=b[a]}this.articleId=c;Lib.checkAuthor();this.pretreat()},pretreat:function(){if(this.articleId==null){Debug.error("ArticleManage need the article id.");return}else{this.checkLogin();return this}},checkLogin:function(){this.needLogin=this.needLogin();Debug.log("checkLogin : "+this.needLogin);var b=function(c){new Lib.Login.Ui().login(c)};var a=Core.Function.bind2(this.confirm,this);Lib.checkAuthor();if(this.needLogin||!$isLogin){b(a)}else{a()}},confirm:function(){if(!$isLogin){Lib.checkAuthor();$tray.renderLogin()}this.needLogin=false;var a=this.textOk||"确定";var b=this.textCancel||"取消";if(this.confirmMSG){winDialog.confirm(this.confirmMSG,{funcOk:Core.Function.bind2(this.doAction,this),textOk:a,textCancel:b})}else{this.doAction()}},doAction:function(){if($IE&&Core.Events.getEvent()){Core.Events.stopEvent()}var b={};for(var a in this.param){if(typeof this.param[a]=="function"){b[a]=Core.Function.bind2(this.param[a],this)()}else{b[a]=this.param[a]}}if(b.getType=="POST"){if(b.getType){delete b.getType}this.Interface.request({POST:b,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(c){showError(c.code)},onFail:function(){showError("A00001")}})}else{if(b.getType){delete b.getType}this.Interface.request({GET:b,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(c){showError(c.code)},onFail:function(){showError("A00001")}})}}});Lib.IframeDialog=Core.Class.create();Lib.IframeDialog.prototype={dialog:null,initialize:function(a){this.id=Core.Math.getUniqueId();this.option=a},initDialog:function(){var d=this,b=this.option;var c={ad:false,drag:true,tpl:b.tpl||d.tpl,title:b.title,content:'<iframe frameborder="0" id="ifrDialog_'+d.id+'" scrolling="no"></iframe>',renderer:Ui.SimpleRenderer,width:b.width,height:b.height};this.dialog=winDialog.createCustomsDialog(c);this.dialog.setAreaLocked(true);var a=$E("ifrDialog_"+this.id);a.src=b.url;a.style.width=b.width+"px";a.style.height=b.height+"px";b.funcClose&&this.bindColseFunc()},tpl:'<table id="#{entity}" class="CP_w"><thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th><th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th><th class="tRight"><span></span></th></tr></thead><tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td><td class="tRight"><span></span></td></tr></tfoot><tbody><tr><td class="tLeft"><span></span></td><td class="tMid" id="#{content}"></td><td class="tRight"><span></span></td></tr></tbody></table>',reset:function(){if(this.dialog){this.hidden();var a=this.dialog.nodes.panel||this.dialog.nodes.entity;a.parentNode.removeChild(a);this.dialog=null}},bindColseFunc:function(){Core.Events.addEvent(this.dialog.nodes.btnClose,this.option.funcClose)},setSize:function(b,a){var c=this.dialog.nodes.content.firstChild;this.dialog.setSize(b,a);c.style.width=b+"px";c.style.height=a+"px"},show:function(){this.reset();this.initDialog();this.dialog.show();this.dialog.setMiddle()},close:function(){this.dialog.hidden()}};Lib.AccountChecker=Core.Class.create();Lib.AccountChecker.prototype={initialize:function(a){if(a.indexOf("vt=1")>0||a.indexOf("vt=2")>0){this.showDialog(a)}else{window.location.href=a}},showDialog:function(c){document.domain="sina.com.cn";if(!window.accDialog){window.accDialog=new Lib.IframeDialog({url:c,title:"账号安全",width:300,height:165});scope.accCallback=function(){window.accDialog.close()}}window.accDialog.show();var a=window.accDialog.dialog.nodes;var b=a.content;b.firstChild.style.marginLeft="25px";a.btnClose.style.display="none";var d=document.createElement("p");d.style.lineHeight="70px";d.innerHTML="　　为了您的账号安全，请输入验证码后再进行操作";b.insertBefore(d,b.firstChild)},hideDialog:function(){window.accDialog&&window.accDialog.hidden()}};App.deleteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_del_recycle.php","ijax"),needLogin:function(){trace("检查用户");Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03006,param:{getType:"POST","blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(a){if(a&&a.code==="B30001"){new Lib.AccountChecker(a.data.ssoUseUrl)}else{showError(a.code)}}});App.deleteDraftArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_draft_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.clearRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.restoreRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_recycle_resume.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.addFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_save.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isLogin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){if($E("f_"+scope.$articleid)){$E("f_"+scope.$articleid).innerHTML=$E("f_"+scope.$articleid).innerHTML.replace(/\((\d*)\)/gi,function(d,c){return"("+(window.parseInt(c)+1)+")"})}winDialog.alert($SYSMSG.B03020,{icon:"03"})}});App.deleteFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/favourites_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03005,param:{resourceids:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.setTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.replaceTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03010,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.unsetTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_top_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:$SYSMSG.B03011,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}});App.moreLayer=function(g,d){var c="";var f="";var a="";if(!scope.moreLayerId){scope.moreLayerId=[0,0]}scope.moreLayerId.push(g);scope.moreLayerId.shift();c=$E("a_layer_"+scope.moreLayerId[0]);a=$E("a_more_"+scope.moreLayerId[1]);f=$E("a_layer_"+scope.moreLayerId[1]);f.style.left=Core.Dom.getLeft(a)-30+"px";f.style.top=Core.Dom.getTop(a)+a.offsetHeight+"px";if(c){c.style.display="none"}f.style.height="80px";f.style.display="";f.onmouseout=(function(j){return function(m){m=m||window.event;var n=m.relatedTarget||m.toElement;if($FF){if(!b(j,n)){j.style.display="none"}}else{if(!j.contains(n)){j.style.display="none"}}}})(f);function b(n,o){if(n.hasChildNodes()){var m=n.childNodes;for(var j=0;m[j];j++){if(b(m[j],o)){return true}}}return n==o}};App.modifyCategory=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php","jsload"),param:{},requestOk:function(){window.location.reload()},requestError:function(a){},needLogin:function(){trace("检查用户");Lib.checkAuthor();return !$isAdmin},confirmMSG:['<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt" style="padding:0;">','<table class="CP_w_ttl"><tr><td id="#{text}">','<p style="font-size:13px; font-weight:normal; padding-left:30px;">文章分类：','<select id="#{cateSel}" style="width:130px;">{0}</select>',"</p>","</td></tr></table>",'<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns" style="padding-left:60px;">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"><span id="#{ok}">确认</span></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"><span id="#{cancel}">取消</span></cite></a>',"</p>","</div>","</div>"].join(""),confirm:function(){if(!$isLogin){Lib.checkAuthor();$tray.renderLogin()}this.needLogin=false;if(this.confirmMSG){var a=this;if(!App.cacheSort){App.getArticlesSort(function(b){App.cacheSort=b.data;a.showLayer()})}else{this.showLayer()}}else{this.doAction()}},showLayer:function(){var g=this;var n,d,m,j=+this.cateId,b=0;var c="<option value='{1}'>{0}</option>";var a="<option value='00'>选择分类</option>";for(var f=0;f<App.cacheSort.length;f++){m=App.cacheSort[f];a+=c.format(m.name,m.id);if(m.id===j){b=f+1}}a+="<option value='0'>私密博文</option>";this.confirmMSG=this.confirmMSG.format(a);n=winDialog.createCustomsDialog({title:"修改博文分类",content:this.confirmMSG});n.setFixed(true);n.setMiddle();n.show();d=n.nodes.cateSel;d.selectedIndex=b;n.nodes.linkCancel.onclick=function(){n.close();return false};n.nodes.btnClose.onclick=function(){n.close();return false};n.nodes.linkOk.onclick=function(){g.param={old_cat:g.cateId,new_cat:d.options[d.selectedIndex].value,blog_id:g.articleId};if(g.param.new_cat==="0"){g.privacyArticleCheck(Core.Function.bind2(g.doAction,g));n.close();return}Core.Function.bind2(g.doAction,g)();n.close();return false}},privacyArticleCheck:function(a){var b=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/points/check_vip.php","ijax");var c=function(d){var g=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/points/points_redeem.php","ijax");var f=winDialog.alert("你尚未开通私密博文功能!",{funcOk:function(){g.request({POST:{user:scope.$uid||$UID,type:4,auto:1},onSuccess:function(j){d()},onError:function(j){if(j&&j.code=="A00003"){winDialog.alert(j.data,{subText:'<a href="http://blog.sina.com.cn/huodong/lottery.html?f=1">马上获得1888积分! </a>'})}else{winDialog.alert(j&&j.data)}},onFail:function(){}})},textOk:"兑换并修改",subText:"私密博文一个月(30天)功能仅需30积分"},"privacyArticleDialog")};b.request({POST:{type:4},onSuccess:function(d){a()},onError:function(d){if(d&&d.code=="A00001"){c(a)}},onFail:function(){}})},requestOk:function(){winDialog.alert("修改分类成功",{icon:"03",funcOk:function(){window.location.reload()}})}});App.deleteClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/admin/article/article_clockpub_del.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},confirmMSG:"博文删除后将无法恢复，确定要删除吗？",textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(a){if(a.code==="B00011"){winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"})}else{showError(a.code)}}});App.sendClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/clockPubImmediate.php","jsload"),needLogin:function(){Lib.checkAuthor();return !$isAdmin},param:{blog_id:function(){return this.articleId}},requestOk:function(a){winDialog.alert("博文已发布成功",{funcOk:function(){setTimeout(function(){window.location.href="http://blog.sina.com.cn/s/blog_"+a+".html"},1)},icon:"03"})},requestError:function(a){if(a.code==="B40003"||a.code==="B36101"){winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"})}else{showError(a.code)}}});App.articleHide=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=0","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否要隐藏此博文",needLogin:function(){trace("检查用户");Lib.checkAuthor();return !$isAdmin},requestOk:function(){winDialog.alert("隐藏成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(a){winDialog.alert("失败，请重试")}});App.articleRestore=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("http://control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=00","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否恢复此博文",needLogin:function(){Lib.checkAuthor();return !$isAdmin},requestOk:function(){winDialog.alert("恢复成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(a){winDialog.alert("恢复失败，请重试")}});$articleManage=function(f,d,c){if($IE){try{Core.Events.stopEvent();$E("a_layer_"+scope.moreLayerId[1]).style.display="none";$E("a_layer_"+scope.moreLayerId[0]).style.display="none"}catch(b){}}c=c||{};switch(d){case 1:new App.deleteArticle(f,c);break;case 2:new App.deleteDraftArticle(f,c);break;case 3:new App.clearRecycleBinArticle(f,c);break;case 4:new App.restoreRecycleBinArticle(f,c);break;case 5:var a=function(){scope.blogOpener.showDialog(function(){new App.addFavoriteArticle(f,c)})};Lib.checkAuthor();if(!$isLogin){v7sendLog("48_01_35");new Lib.Login.Ui().login(a)}else{a()}break;case 6:new App.deleteFavoriteArticle(f,c);break;case 7:new App.setTopArticle(f,c);break;case 8:new App.replaceTopArticle(f,c);break;case 9:new App.unsetTopArticle(f,c);break;case 10:App.moreLayer(f,Core.Events.getEvent());break;case 11:new App.modifyCategory(f,c);break;case 12:new App.articleHide(f,c);break;case 13:new App.articleRestore(f,c);break;case 14:new App.deleteClockpub(f,c);break;case 15:new App.sendClockpub(f,c);break}};function changeFontSize(f){var d,g="字体大小：";var a="<strong>#</strong>&nbsp;",b=3,c=["小","中","大"];g+=new Array(4).join(a);switch(f){case 2:d="fontSize_L";break;case 0:d="fontSize_S";break;case 1:default:d="fontSize_M";break}g=g.replace(/(<strong>)(#)(<\/strong>)/g,function(m,j,o,n){b--;if(b!=f){return'<a href="#" onclick="changeFontSize('+b+');return false;">'+c[b]+"</a>"}else{return j+c[f]+n}});$E("articleFontManage").innerHTML=g.substring(0,g.length-6);if(typeof attentionWorldCup!="undefined"){$E("articlebody").className="worldcup_article "+d}else{$E("articlebody").className="artical "+d}if(typeof SUDA!="undefined"){SUDA.uaTrack("blog_article","h_article16")}}$registJob("report_bodyArticle",function(){var a=new Lib.BlogReport(),b="";window.report=function(c){var g=scope.$uid,j,m="",f='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+c+'.html">'+$E("t_"+c).innerHTML+"</a>",d=$E("t_"+c).innerHTML;if(b===""){Lib.Uic.getNickName([g],function(o){if(o&&o[g]){var n=o[g];a.start("blog",n,c,g,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+n+"</a>",m,f,d)}else{a.start("blog","新浪网友",c,g,"新浪网友",m,f,d)}})}else{j='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+b+"</a>";a.start("blog",b,c,g,j,m,f,d)}};window.article_report=function(c){var g=scope.$uid,j,m="",f='<a target="_blank" href="http://blog.sina.com.cn/s/blog_'+c+'.html">'+$E("t_"+c).innerHTML+"</a>",d=$E("t_"+c).innerHTML;if(b===""){Lib.Uic.getNickName([g],function(o){if(o&&o[g]){var n=o[g];a.start("blog",n,c,g,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+n+"</a>",m,f,d)}else{a.start("blog","新浪网友",c,g,"新浪网友",m,f,d)}})}else{j='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+b+"</a>";a.start("blog",b,c,g,j,m,f,d)}}});$registJob("flashtemplate",function(){Lib.getTplNum(function(){if(scope.tpl){Lib.insertMoban()}})});$registJob("imageLazyLoad",function(){var d=document.getElementsByTagName("IMG");var c=[];for(var b=0,a=d.length;b<a;b++){if(d[b].getAttribute("real_src")!=null){c.push(d[b])}}if(c.length>0){Lib.LazyLoad(c,{callback:function(g){scope.sharePhoto&&scope.sharePhoto.bindFn&&scope.sharePhoto.bindFn(g,"real_src");var f=g.getAttribute("real_src");if(scope.showPicSlide){scope.showPicSlide(g,f)}g.src=f;if(scope.$pageid==="articletjTech"){if(g.complete&&g.width>550){g.width=550}else{g.onload=function(){if(g.width>550){g.width=550}}}}}})}});scope.$worldCupInfos={teams:{"1":{name:"南非",group:"A",URL:"http://2010.sina.com.cn/teams/southafrica.shtml"},"2":{name:"墨西哥",group:"A",URL:"http://2010.sina.com.cn/teams/mexico.shtml"},"3":{name:"乌拉圭",group:"A",URL:"http://2010.sina.com.cn/teams/uruguay.shtml"},"4":{name:"法国",group:"A",URL:"http://2010.sina.com.cn/teams/france.shtml"},"5":{name:"阿根廷",group:"B",URL:"http://2010.sina.com.cn/teams/argentina.shtml"},"6":{name:"尼日利亚",group:"B",URL:"http://2010.sina.com.cn/teams/nigeria.shtml"},"7":{name:"韩国",group:"B",URL:"http://2010.sina.com.cn/teams/korearepublic.shtml"},"8":{name:"希腊",group:"B",URL:"http://2010.sina.com.cn/teams/greece.shtml"},"9":{name:"英格兰",group:"C",URL:"http://2010.sina.com.cn/teams/england.shtml"},"10":{name:"美国",group:"C",URL:"http://2010.sina.com.cn/teams/usa.shtml"},"11":{name:"阿尔及利亚",group:"C",URL:"http://2010.sina.com.cn/teams/algeria.shtml"},"12":{name:"斯洛文尼亚",group:"C",URL:"http://2010.sina.com.cn/teams/slovenia.shtml"},"13":{name:"德国",group:"D",URL:"http://2010.sina.com.cn/teams/germany.shtml"},"14":{name:"澳大利亚",group:"D",URL:"http://2010.sina.com.cn/teams/australia.shtml"},"15":{name:"塞尔维亚",group:"D",URL:"http://2010.sina.com.cn/teams/serbia.shtml"},"16":{name:"加纳",group:"D",URL:"http://2010.sina.com.cn/teams/ghana.shtml"},"17":{name:"荷兰",group:"E",URL:"http://2010.sina.com.cn/teams/netherlands.shtml"},"18":{name:"丹麦",group:"E",URL:"http://2010.sina.com.cn/teams/denmark.shtml"},"19":{name:"日本",group:"E",URL:"http://2010.sina.com.cn/teams/japan.shtml"},"20":{name:"喀麦隆",group:"E",URL:"http://2010.sina.com.cn/teams/cameroon.shtml"},"21":{name:"意大利",group:"F",URL:"http://2010.sina.com.cn/teams/italy.shtml"},"22":{name:"巴拉圭",group:"F",URL:"http://2010.sina.com.cn/teams/paraguay.shtml"},"23":{name:"新西兰",group:"F",URL:"http://2010.sina.com.cn/teams/newzealand.shtml"},"24":{name:"斯洛伐克",group:"F",URL:"http://2010.sina.com.cn/teams/slovakia.shtml"},"25":{name:"巴西",group:"G",URL:"http://2010.sina.com.cn/teams/brazil.shtml"},"26":{name:"朝鲜",group:"G",URL:"http://2010.sina.com.cn/teams/koreadpr.shtml"},"27":{name:"科特迪瓦",group:"G",URL:"http://2010.sina.com.cn/teams/cotedivoire.shtml"},"28":{name:"葡萄牙",group:"G",URL:"http://2010.sina.com.cn/teams/portugal.shtml"},"29":{name:"西班牙",group:"H",URL:"http://2010.sina.com.cn/teams/spain.shtml"},"30":{name:"瑞士",group:"H",URL:"http://2010.sina.com.cn/teams/switzerland.shtml"},"31":{name:"洪都拉斯",group:"H",URL:"http://2010.sina.com.cn/teams/honduras.shtml"},"32":{name:"智利",group:"H",URL:"http://2010.sina.com.cn/teams/chile.shtml"}},games:{"1":{teams:["1","2"],time:"2010-06-11 22:00:00",score:"",group:"A"},"2":{teams:["3","4"],time:"2010-06-12 02:30:00",score:"",group:"A"},"3":{teams:["5","6"],time:"2010-06-12 22:00:00",score:"",group:"B"},"4":{teams:["7","8"],time:"2010-06-12 19:30:00",score:"",group:"B"},"5":{teams:["9","10"],time:"2010-06-13 02:00:00",score:"",group:"C"},"6":{teams:["11","12"],time:"2010-06-13 19:30:00",score:"",group:"C"},"7":{teams:["13","14"],time:"2010-06-14 02:30:00",score:"",group:"D"},"8":{teams:["15","16"],time:"2010-06-13 22:00:00",score:"",group:"D"},"9":{teams:["17","18"],time:"2010-06-14 19:30:00",score:"",group:"E"},"10":{teams:["19","20"],time:"2010-06-14 22:00:00",score:"",group:"E"},"11":{teams:["21","22"],time:"2010-06-15 02:30:00",score:"",group:"F"},"12":{teams:["23","24"],time:"2010-06-15 19:30:00",score:"",group:"F"},"13":{teams:["27","28"],time:"2010-06-15 22:00:00",score:"",group:"G"},"14":{teams:["25","26"],time:"2010-06-16 02:30:00",score:"",group:"G"},"15":{teams:["31","32"],time:"2010-06-16 19:30:00",score:"",group:"H"},"16":{teams:["29","30"],time:"2010-06-16 22:00:00",score:"",group:"H"},"17":{teams:["1","3"],time:"2010-06-17 02:30:00",score:"",group:"A"},"18":{teams:["2","4"],time:"2010-06-18 02:30:00",score:"",group:"A"},"19":{teams:["6","8"],time:"2010-06-17 22:00:00",score:"",group:"B"},"20":{teams:["5","7"],time:"2010-06-17 19:30:00",score:"",group:"B"},"21":{teams:["13","15"],time:"2010-06-18 22:00:00",score:"",group:"D"},"22":{teams:["12","10"],time:"2010-06-18 22:00:00",score:"",group:"C"},"23":{teams:["9","11"],time:"2010-06-19 02:30:00",score:"",group:"C"},"24":{teams:["16","14"],time:"2010-06-19 02:30:00",score:"",group:"D"},"25":{teams:["17","19"],time:"2010-06-19 19:30:00",score:"",group:"E"},"26":{teams:["18","20"],time:"2010-06-20 02:30:00",score:"",group:"E"},"27":{teams:["22","24"],time:"2010-06-20 19:30:00",score:"",group:"F"},"28":{teams:["21","23"],time:"2010-06-20 22:00:00",score:"",group:"F"},"29":{teams:["25","27"],time:"2010-06-21 02:00:00",score:"",group:"G"},"30":{teams:["26","28"],time:"2010-06-21 19:30:00",score:"",group:"G"},"31":{teams:["30","32"],time:"2010-06-21 22:00:00",score:"",group:"H"},"32":{teams:["29","31"],time:"2010-06-22 02:00:00",score:"",group:"H"},"33":{teams:["2","3"],time:"2010-06-22 22:00:00",score:"",group:"A"},"34":{teams:["1","4"],time:"2010-06-22 22:00:00",score:"",group:"A"},"35":{teams:["6","7"],time:"2010-06-23 02:30:00",score:"",group:"B"},"36":{teams:["5","8"],time:"2010-06-23 02:30:00",score:"",group:"B"},"37":{teams:["9","12"],time:"2010-06-23 22:00:00",score:"",group:"C"},"38":{teams:["10","11"],time:"2010-06-23 22:00:00",score:"",group:"C"},"39":{teams:["13","16"],time:"2010-06-24 02:30:00",score:"",group:"D"},"40":{teams:["15","14"],time:"2010-06-24 02:30:00",score:"",group:"D"},"41":{teams:["21","24"],time:"2010-06-24 22:00:00",score:"",group:"F"},"42":{teams:["22","23"],time:"2010-06-24 22:00:00",score:"",group:"F"},"43":{teams:["18","19"],time:"2010-06-25 02:30:00",score:"",group:"E"},"44":{teams:["17","20"],time:"2010-06-25 02:30:00",score:"",group:"E"},"45":{teams:["25","28"],time:"2010-06-25 22:00:00",score:"",group:"G"},"46":{teams:["26","27"],time:"2010-06-25 22:00:00",score:"",group:"G"},"47":{teams:["29","32"],time:"2010-06-26 02:30:00",score:"",group:"H"},"48":{teams:["30","31"],time:"2010-06-26 02:30:00",score:"",group:"H"},"49":{},"50":{},"51":{},"52":{},"53":{},"54":{},"55":{},"56":{},"57":{},"58":{},"59":{},"60":{},"61":{},"62":{},"63":{},"64":{}},teammatches:{"1":["1","17","34"],"2":["1","18","33"],"3":["2","17","33"],"4":["2","18","34"],"5":["3","20","36"],"6":["3","19","35"],"7":["4","20","35"],"8":["4","19","36"],"9":["5","23","37"],"10":["5","22","38"],"11":["6","23","38"],"12":["6","22","37"],"13":["7","21","39"],"14":["7","24","40"],"15":["8","21","40"],"16":["8","24","39"],"17":["9","25","44"],"18":["9","26","43"],"19":["10","25","43"],"20":["10","26","44"],"21":["11","28","41"],"22":["11","27","42"],"23":["12","28","42"],"24":["12","27","41"],"25":["14","29","45"],"26":["14","30","46"],"27":["13","29","46"],"28":["13","30","45"],"29":["16","32","47"],"30":["16","31","48"],"31":["15","32","48"],"32":["15","31","47"]}};$registJob("favGames",function(){if(typeof(attentionWorldCup)=="undefined"){return}if(!attentionWorldCup.show_attentiongame.length){return}if(scope.wc_match_info){b()}else{Utils.Io.JsLoad.request("http://blog.sina.com.cn/2010worldcup/worldcup.js",{onComplete:function(){scope.wc_match_info=wc_match_info;scope.wc_teams_info=wc_team_info;b()}})}function b(){var G=scope.wc_match_info;var z=scope.wc_teams_info;var o=attentionWorldCup.show_attentiongame;var H=attentionWorldCup.show_attentionteam;var B=6;var j=['<table border="0" cellpadding="0" cellspacing="1">',"<tr>",'<th scope="col" class="w1">日期</th>','<th scope="col" class="w2">时间</th>','<th scope="col">对阵</th>',"</tr>#{itemLines}","</table>"].join("");var n=["<tr>","<td>#{date}</td>",'<td class="wdc_ta">#{time}</td>','<td class="wdc_te"><span class="matchL">#{army1}</span><span class="vs wdc_ta"> VS </span><span class="matchR">#{army2}</span></td>',"</tr>"].join("");var m=$E("favGames");var E="";var u=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];var A,y;var v=[];var p=[];var t=[];var r=[];for(A=0;A<o.length;A++){trace("userGameHash "+G[o[A]].score+"////"+A);r.push(G[o[A]])}var f=a(r,"score",B,true);trace("length: "+f.length);for(A=0;A<f.length;A++){trace(A);var q=(f[A].time.split(" ")[0]).split("-");var F=(f[A].time.split(" ")[1]).split(":")[0];var D=new Date();D.setMonth(q[1]-1);D.setDate(q[2]);D.setHours(F);v[A]=D.getTime()}p=p.concat(v);var c;var g;var C=[];for(y=0;y<v.length;y++){c=v[0];g=0;for(A=1;A<v.length;A++){if(v[A]<c){c=v[A];g=A}}C.push(g);v[g]=Infinity}for(A=0;A<v.length;A++){var q=(f[C[A]].time.split(" ")[0]).split("-");var D=new Date();D.setMonth(q[1]-1);D.setDate(q[2]);var s=D.getDay();D=(D.getMonth()+1)+"月"+D.getDate()+"日";E+=new Ui.Template(n).evaluate({army1:z[f[C[A]].teams[0]].name,army2:z[f[C[A]].teams[1]].name,date:D+" "+u[s],time:f[C[A]].time.split(" ")[1].slice(0,-3)})}m.innerHTML=new Ui.Template(j).evaluate({itemLines:E})}function a(c,f,j,g){var m;var d=[];var n=[];for(m=0;m<c.length;m++){if(g?!c[m][f]:c[m][f]){d.push(c[m])}}for(m=0;m<j;m++){if(!d[m]){trace("src not enough");break}n.push(d[m])}return n}});$registJob("teams_wc",function(){if(typeof(attentionWorldCup)=="undefined"){return}new FavTeamsInfo();var a="http://comet.blog.sina.com.cn/api?maintype=hits&act=3&uid=00000300&tm"+new Date().getTime();Utils.Io.JsLoad.request(a,{onComplete:function(){}})});var FavTeamsInfo=function(){this.entity=$E("favTeams");if(!this.entity){return}this.allTeams=$T(this.entity,"li");this.isTweenIn=[];this.isTweenOut=[];this.initialize()};FavTeamsInfo.prototype={initialize:function(){if(!this.entity){return}var b=this;var a=64;Core.Array.foreach(this.allTeams,function(d,f){var c=$T(d,"p")[1];c.style.zIndex=512;d.style.zIndex=a--;Core.Events.addEvent(d,function(){if(!$IE){if(!b.justIn(Core.Events.getEvent(),d)){return}}b.tweenIn(d,c,f)},$IE?"mouseenter":"mouseover");Core.Events.addEvent(d,function(){if(!$IE){if(!b.justIn(Core.Events.getEvent(),d)){return}}b.tweenOut(d,c,f)},$IE?"mouseleave":"mouseout")})},justIn:function(a,c){var b=a.relatedTarget;while(b&&(b!=c)){b=b.parentNode}return(b!=c)},tweenIn:function(b,a,c){try{Ui.tween.stop(a)}catch(d){}var f=this;b.className="hover";Core.Dom.setStyle(a,"opacity",1);a.style.display=""},tweenOut:function(b,a,c){var d=this;new Ui.tween(a,["opacity"],[0],0.3,"simple",{end:function(){a.style.display="none";b.className=""}})}};var CalendarWc=function(){this.entity=$E("wdc_calender");this.closeBtn=$E("wcc_close");this.fakeImg=$C("div");this.switchOn=false;this.isTween=false;this.posRelDom=null;this.lockPosX;this.lockPosY;this.initialize()};CalendarWc.prototype={initialize:function(){if(!this.entity){return}var a=this;this.fakeImg.style.cssText="z-index:612; position:absolute; border:2px solid #d2d9e6; background-color:white;";document.body.insertBefore(this.fakeImg,document.body.firstChild);this.renderNew();this.renderToday();Core.Events.addEvent(this.closeBtn,function(){a.resetCalendar()});Core.Events.addEvent(window,function(){a.justiPos()},"resize")},resetCalendar:function(){try{Ui.tween.stop(this.fakeImg)}catch(a){}Core.Dom.setStyle(this.entity,"display","none");Core.Dom.setStyle(this.entity,"visibility","hidden");Core.Dom.setStyle(this.fakeImg,"display","none");this.switchOn=false;this.isTween=false},justiPos:function(){if(!this.switchOn){return}Core.Dom.setStyle(this.entity,"left",(Core.Dom.getLeft(this.posRelDom)-this.lockPosX)+"px");Core.Dom.setStyle(this.entity,"top",(Core.Dom.getTop(this.posRelDom)-this.lockPosY)+"px")},renderNew:function(){var f=this;var d=attentionWorldCup.show_attentiondate;if(!d&&!d.length){return}for(var b=0;b<d.length;b++){var c;var a=d[b].split("_");c=$E("wcc_"+a[0]+"_"+a[1]);if(!c){break}$T(c,"a")[0].title="有关注的赛事";this.addClass(c,"new");Core.Events.addEvent(c,(function(g){return function(){f.resetCalendar();window.location.href="#"+d[g]}})(b))}},renderToday:function(){var b=new Date().getMonth()+1;var a=new Date().getDate();this.addClass($E("wcc_"+b+"_"+a),"cur")},setPos:function(c,a,b){this.posRelDom=c;var f=Core.Dom.getLeft(c)+(a?a:0);var d=Core.Dom.getTop(c)+(b?b:0);if($IE6&&$IE7){f+=document.documentElement.scrollLeft;d+=document.documentElement.scrollTop}this.fakeImg.style.left=f+"px";this.fakeImg.style.top=d+"px"},arcFunc:function(f,d,g){return function(a){return f*a*a+d*a+g}},tweenPlay:function(){this.resetCalendar();var a=this;Core.Dom.setStyle(this.entity,"display","");Core.Dom.setStyle(this.fakeImg,"display","");Core.Dom.setStyle(this.fakeImg,"opacity",0.6);Core.Dom.setStyle(this.fakeImg,"width","48px");Core.Dom.setStyle(this.fakeImg,"height","15px");this.isTween=true;new Ui.tween(this.fakeImg,["opacity","height","width","left"],[1,this.entity.offsetHeight-4,this.entity.offsetWidth-4,Core.Dom.getLeft(this.posRelDom)-217],0.3,"strongEaseIn",{end:function(){new Ui.tween(a.fakeImg,["opacity"],[1],0.1,"simple",{end:function(){a.entity.style.left=Core.Dom.getLeft(a.fakeImg)+"px";a.entity.style.top=Core.Dom.getTop(a.fakeImg)+"px";a.fakeImg.style.display="none";a.entity.style.visibility="visible";a.switchOn=true;a.lockPosX=Core.Dom.getLeft(a.posRelDom)-Core.Dom.getLeft(a.entity);a.lockPosY=Core.Dom.getTop(a.posRelDom)-Core.Dom.getTop(a.entity)}})}})},addClass:function(b,a){if(!b){return false}if(!this.hasClass(b,a)){b.className=Core.String.trim(b.className.concat(" "+a))}},delClass:function(c,b){if(!c){return false}var a=new RegExp("(?: +|^)"+b+"(?=( |$))","ig");c.className=Core.String.trim(c.className.replace(a,""))},hasClass:function(c,b){if(!c){return false}var a=new RegExp("(?: +|^)"+b+"(?=( |$))","ig");return a.test(c.className)}};$registJob("calendar_wc",function(){if(typeof(attentionWorldCup)=="undefined"){return}var a=new CalendarWc();$E("calendar_wc").onmouseover=function(){if(a.isTween){return}a.setPos(this,0,0);a.tweenPlay();return false}});$SYSMSG.extend({B00802:"抱歉，此篇图片已经被删除",B00803:"抱歉，此篇专辑已经被删除",B00804:"抱歉，此篇文章已经被删除"});$registJob("digger",function(){var v=$E("d1_digg_"+scope.$articleid);if(!scope.digger){scope.digger={}}scope.digger.flashReady=function(){};scope.digger.diggerPer=function(){};scope.digger.diggerNums=function(){};scope.digger.setData=function(){};scope.digger.diggerPost=function(){};scope.digger.bindEvent=function(){};scope.digger.showLast10=function(){};scope.digger.hiddenLast10=function(){};if(!$E("diggerFla")){trace("no diggerFla");return}if(!$_GLOBAL.diggerOpenFlag){trace("close...");return}Lib.checkAuthor();var g="";if($isLogin){g=$UID;trace("当前用户:"+$UID)}var z=false;var r=false;scope.digger.flashReady=function(){trace("--------顶踩加载完毕....");z=true};trace("--------顶踩开始加载完毕....");var j="";if(window.$Maxthon||window.$360||window.$TT){j="?t="+Core.Math.getUniqueId()}var o=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"digger.swf"+j,"digger","1","1","9","#00ff00");o.addParam("quality","high");o.addParam("wmode","transparent");o.addParam("allowScriptAccess","always");o.write("diggerFla");var f=$E("digger");scope.digger.diggerPer=function(A){if(!A.params){A.params={res_id:A.res_id,res_uid:A.res_uid||scope.$uid}}A.url="http://control.blog.sina.com.cn/riaapi/digg/get_digg.php";t(A)};scope.digger.diggerNums=function(A){if(!A.params){A.params={res_id:A.res_id,res_uid:A.res_uid||scope.$uid}}A.url="http://blogtj.sinajs.cn/api/get_digg_num.php";t(A)};function y(C){var B=0;var A=setInterval(function(){B+=500;if(B>=$_GLOBAL.diggerFlashTimeout){trace("已超时，不再尝试放进flash cookie:"+C.res_id+"_"+(C.res_uid||scope.$uid)+"_"+g+"_"+C.res_type);clearInterval(A);r=true}if(z){clearInterval(A);c(C)}},500)}function c(A){if(r){trace("不等待,flash已经是不可靠的，顶没有放入flash cookie");return}if(!z){y(A)}else{f.setData(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type);trace(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type+"放入成功!")}}scope.digger.setData=function(A,B,C){c({res_id:A,res_uid:B,res_type:C})};scope.digger.diggerPost=function(B){if(!B.params){B.params={res_id:B.res_id,res_uid:B.res_uid||scope.$uid,action:B.action||"0",res_type:B.res_type}}B.url="http://control.blog.sina.com.cn/admin/digg/post_digg.php";if(!B.onSuccess){B.onSuccess=function(C){c(B)}}else{var A=B.onSuccess;B.onSuccess=function(C){A(C);c(B)}}t(B)};function d(C){var B=0;var A=setInterval(function(){B+=500;trace("waitOrExecute:等待flash加载..."+B);if(z){clearInterval(A);scope.digger.bindEvent(C)}if(B>=$_GLOBAL.diggerFlashTimeout){trace("响应超时，直接执行代码");clearInterval(A);a(C);r=true;return}},500)}function a(A){for(var B in A.events){A.targetEle["on"+B]=A.events[B](A)}}scope.digger.bindEvent=function(A){if(r){trace("不等待,flash已经是不可靠的，直接执行代码");a(A);return}if(!z){trace("falsh还没有加载完毕");d(A)}else{trace("读取"+A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type+":"+f.getData(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type));if(f.getData(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type)){trace(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type+": 找到，不绑定事件");A.whenFind&&A.whenFind(A)}else{trace(A.res_id+"_"+(A.res_uid||scope.$uid)+"_"+g+"_"+A.res_type+": 未找到，绑定事件");a(A)}}};var p=false;function t(A){if(p){return}p=true;new Interface(A.url,"jsload").request({GET:A.params,onSuccess:function(B){A.onSuccess&&A.onSuccess(B);p=false},onError:function(B){A.onError&&A.onError(B);p=false},onFail:function(){A.onFail&&A.onFail();p=false}})}var m=document.createElement("div");m.className="tb_layer_Y tb_layer_w3";m.style.cssText="z-index: 511;position:absolute;display:none;width:160px";var n=document.createElement("div");n.className="tb_layer_arrow";var u=document.createElement("div");u.className="tb_layer_Y_main tip_ps";u.style.cssText="width:auto;";if(v&&v.innerHTML==="顶"){u.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近顶了的博主：</div>						<div></div>'}else{u.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>						<div style="text-align:left;color:#999999">最近喜欢了的博主：</div>						<div></div>'}m.appendChild(n);m.appendChild(u);document.body.appendChild(m);var q=u.getElementsByTagName("a")[0];var b=u.getElementsByTagName("div")[1];b.style.whiteSpace="nowrap";function s(){b.innerHTML='<div style="text-align:center;"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>'}s();q.onclick=function(){scope.digger.hiddenLast10()};scope.digger.showLast10=function(D){s();scope.digger.diggerPer(D);var F=Core.Dom.getXY(D.ele);D.onError=function(G){b.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">数据请求失败，请稍后重试</div>'};D.onFail=D.onError;D.onSuccess=function(I){if(m.style.display){trace("已经被关闭，不再往里面写入信息");return}var L=[];var K=Lib.blogv.getVHTML;for(var H=0;I[H];H++){var G=I[H];var J=G.action_uname;L.push("<div>",'<a target="_blank" title="到',G.action_uname,'的博客去看看" href="http://blog.sina.com.cn/u/',G.action_uid,'">',J,"</a>",K(parseInt(G.wtype||-1)),"</div>")}if(!L.length){if(v&&v.innerHTML==="顶"){b.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户顶过</div>'}else{b.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户喜欢过</div>'}}else{b.innerHTML=L.join("")}};var B=0;var E=50;var C=(D.dx||-76)+F[0];var A=(D.dy||10)+F[1];if($IE){C-=1;A-=2}if($SAFARI){C+=1}if($CHROME){C+=1;A+=2}m.style.display="";m.style.left=C+"px";m.style.top=A+"px";Core.Dom.opacity(m,B);new Ui.tween(m,["opacity"],[1],0.3,"strongEaseIn");window.onresize=function(){var G=Core.Dom.getXY(D.ele);m.style.left=G[0]-76+"px";m.style.top=G[1]+10+"px"}};scope.digger.hiddenLast10=function(){var A=1;new Ui.tween(m,["opacity"],[0],0.3,"strongEaseOut")}});$registJob("stylefix",function(){if($IE6&&scope.UserPic&&scope.UserPic[1]&&scope.UserPic[1].apply=="1"){$E("blognavBg").style.filter="none"}var c=$E("sina_keyword_ad_area2");if(c){var b=c.getElementsByTagName("embed");var a=c.getElementsByTagName("object");if(b||a){if(deconcept.SWFObjectUtil.getPlayerVersion().major===0){var d='我们的产品需要安装flashplayer 10或更高版本，请 <a href="http://get.adobe.com/flashplayer">点击此处</a> 免费下载';var m="我们的产品需要安装flashplayer 10或更高版本，请前往 http://get.adobe.com/flashplayer 免费下载";if(winDialog){winDialog.alert(d)}else{alert(m)}}}}var j=document.createElement("style");j.type="text/css";j.id="stylefix";var g="#bsPanelHolder,#sinaads_pdps54771{display:none;}";try{j.appendChild(document.createTextNode(g))}catch(f){j.styleSheet.cssText=g}document.getElementsByTagName("head")[0].appendChild(j)});$registJob("articleDigger",function(){if(!$E("diggerFla")){return}if(!$_GLOBAL.diggerOpenFlag){return}var g=scope.$articleid;function f(){var n=0;var m=setInterval(function(){if(scope.useNewInterfaceToGetNum){trace("通过别的借口进行装载");scope.useNewInterfaceToGetNum.onSuccess=function(o){scope.useNewInterfaceToGetNum=null;j(o)};scope.useNewInterfaceToGetNum.onError=function(o){scope.useNewInterfaceToGetNum=null;j(null)};scope.useNewInterfaceToGetNum.onFail=function(o){scope.useNewInterfaceToGetNum=null;j(null)};trace("装载完毕");clearInterval(m)}},50)}f();function c(m){m.ele.parentNode.className="SG_aBtn SG_aBtn_ico SG_turn SG_click";m.ele.children[1].innerHTML="已喜欢"}function a(q){var u;if("articletj"!==scope.$pageid){q.ele.className="upBox upBox_dis";q.ele.style.cursor="default";u=q.ele.getElementsByTagName("p")[1];var m=u.innerHTML;var n=SinaEx.createNode("<div>"+m+"</div>");var p=SinaEx.findNode(n,"nextSibling","firstChild");n.removeChild(p);var o=n.innerHTML;if(o==="顶"){u.innerHTML='<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶'}else{u.innerHTML="已喜欢"}}else{var t=q.ele.getElementsByTagName("span");u=t[0];var s=u.parentNode;var r=s.parentNode.parentNode;r.className="upBox upBox_dis";u.style.cursor="default";s.style.cursor="default";t[1].style.cursor="default";t[2].style.cursor="default";u.innerHTML="已喜欢"}}function d(o){if("articletj"!==scope.$pageid){o.ele.className="upBox upBox_click";o.ele.getElementsByTagName("p")[0].innerHTML="+1"}else{var m=o.ele.getElementsByTagName("span");states=m[0];var n=states.parentNode;var p=n.parentNode.parentNode;p.className="upBox upBox_click";states.innerHTML='<span class="up1">+1</span>喜欢'}}function b(o){if("articletj"!==scope.$pageid){o.ele.className="upBox";var p=o.ele.getElementsByTagName("p")[0];p.innerHTML=p.getAttribute("mnum")}else{var m=o.ele.getElementsByTagName("span");states=m[0];var n=states.parentNode;var q=n.parentNode.parentNode;q.className="upBox";states.innerHTML='<img class="SG_icon SG_icon34" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="推荐" align="absmiddle">喜欢'}}function j(q){var s=scope.$pageid==="articletjTech";var n=q?q["digg_m_"+g]:0;var o=$E("dbox2_"+g);if(!o){trace("没有找到计数模块，认为这是不需要顶踩功能的");return}if(n){o.innerHTML=n}else{o.innerHTML="0"}var r=g;o.setAttribute("mnum",n);var m=o.parentNode;m.style.cursor="pointer";scope.digger.bindEvent({ele:m,targetEle:m,ti_title:encodeURIComponent(o.getAttribute("ti_title")||""),disClass:"upBox upBox_dis",res_id:r,uid:scope.$uid,res_type:"1",whenFind:function(t){if(s){c(t)}else{a(t)}},events:{mouseover:function(t){return function(){if(!s){d(t)}}},mouseout:function(t){return function(){if(!s){b(t)}}},click:function(t){return function(){scope.digger.diggerPost({params:{res_id:t.res_id,res_uid:t.res_uid||scope.$uid,action:"0",res_type:"1",ti_title:t.ti_title},res_id:t.res_id,res_uid:t.res_uid||scope.$uid,action:"0",res_type:"1",onSuccess:function(v){t.targetEle.onmouseover=function(){};t.targetEle.onmouseout=function(){};t.targetEle.onclick=function(){};if(s){c(t)}else{a(t)}var u=$E("dbox2_"+t.res_id);var y=parseInt(u.getAttribute("mnum"))+1;u.innerHTML=y;Lib.Listener.notify("article_like_success")},onError:function(v){if(v.code=="B00801"){winDialog.alert("这篇博文您已经喜欢过啦!",{icon:"01"});t.targetEle.onmouseover=function(){};t.targetEle.onmouseout=function(){};t.targetEle.onclick=function(){};if(s){c(t)}else{a(t)}scope.digger.setData(t.res_id,scope.$uid,1);var u=$E("dbox2_"+t.res_id);var y=u.getAttribute("mnum");u.innerHTML=y}else{showError(v.code)}}});return false}}}});var p=$E("d1_digg_"+g);if(!p){return}$E("d1_digg_"+g).onclick=(function(t){return function(u){scope.digger.showLast10(t);return false}})({ele:$E("d1_digg_down_"+g),res_id:g,res_uid:scope.$uid});$E("d1_digg_down_"+g).onclick=(function(t){return function(u){scope.digger.showLast10(t);return false}})({ele:$E("d1_digg_down_"+g),res_id:g,res_uid:scope.$uid})}});$registJob("miniBlogAttention",function(){var a=new Interface("http://weibo.com/attention/aj_addfollow.php","jsload");scope.attMiniBlog=function(){Lib.checkAuthor();if($UID){Utils.Io.JsLoad.request("http://weibo.com/attention/aj_addfollow.php?jsdomain=1&uid=1231759973&fromuid="+$UID,{onComplete:function(){}})}}});Lib.register("util.loadScript",function(){var c=!0,d=!1,b={};var a=function(f,g){Utils.Io.JsLoad.request(f,{isRemove:d,noreturn:c,onComplete:function(o){b[f].isLoading=d;var m=b[f].cb;for(var n=0,j=m.length;n<j;n++){m[n](o)}b[f].cb=null}})};return function(j,g){var m=b[j];var f=m&&m.cb;if(!m){f=[g];m={isLoading:c,cb:f};b[j]=m;a(j,m)}else{if(m.isLoading){f.push(g)}else{g()}}}});Lib.register("sendSuda",function(b){var a="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js";return function(c){b.util.loadScript(a,c)}});$registJob("suda",function(){var g=scope&&scope.$pageid;var m=window.location.href;var b=m.indexOf("tj=1")>-1;var j=g&&(g==="articletj"||g==="index"||g==="indexM"||g==="editor"||b);function a(r,q,p,o,n){if(b){v7sendLog(n)}switch(r){case"index":case"indexM":v7sendLog(q);break;case"editor":v7sendLog(p);break;case"articletj":v7sendLog(o);break}}if(j){var c=encodeURIComponent(m);var f=encodeURIComponent(document.referrer)}if(typeof _S_pSt=="function"){if(j){v7sendLog("42_01_03_"+new Date().getTime()+"_"+c+"_"+f)}return}if(j){if(!$isLogin){var d="42_01_01_"+new Date().getTime()+"_"+c+"_"+f}else{var d="42_01_01_"+$UID+"_"+new Date().getTime()+"_"+c+"_"+f}a(g,"42_01_08","42_01_14",d,"42_01_05")}Lib.sendSuda(function(){try{_S_pSt("")}catch(o){}if(j){if(!$isLogin){var n="42_01_02_"+new Date().getTime()+"_"+c+"_"+f}else{var n="42_01_02_"+$UID+"_"+new Date().getTime()+"_"+c+"_"+f}a(g,"42_01_09","42_01_15",n,"42_01_06")}})});Lib.register("execZhitou",function(b){var a="http://d5.sina.com.cn/litong/zhitou/sinaads/release/sinaads.js";document.createElement("inc");return function(c){b.util.loadScript(a,c)}});var blogAd={};blogAd.getInitPermission=function(b){var a;if(b&&b.ads&&b.ads[0]){a=b&&b.ads&&b.ads[0];return a.type=="mixed"||a.ref}else{return false}};blogAd.insertIns=function(f,a,d,c){d=d||"beforeend",c=c||"display:block;";var b='<ins class="sinaads" data-ad-pdps="'+f+'" style="'+(c||"")+'"></ins>';a=a||document.body;return Core.Dom.insertHTML(a,b,d)};Core.System.getParam=function(b){var a=window.location.search.match(new RegExp("(\\?|&)"+b+"=([^&]*)(&|$)"));if(a!=null){return unescape(a[2])}return null};$registJob("scrollAd",function(){if(scope.$pageid=="articleM"||scope.$pageid=="article"||scope.$pageid=="articleM_new"||scope.$pageid=="article_new"){blogAd.insertIns("PDPS000000054727");Lib.execZhitou(function(a){(window.sinaads||[]).push({params:{sinaads_follow_top:30,sinaads_follow_mini_top:200}})})}});$registJob("SinglesDay",function(){scope.addFriendForSinglesDay=function(){Lib.checkAuthor();if($UID){new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax").request({POST:{uid:$UID,aid:1259295385}})}}});Core.Events.stopDefaultEvent=function(a){var b=a?a:Core.Events.getEvent();if(b!=null){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}}};Utils.excBeforeCloseWin=function(c,a,d,b){closeVar={};closeVar.func=d;closeVar.tips1=c;closeVar.tips2=a;closeVar.args=b;closeVar.length=arguments.length;window.beforeunloadfunc=function(){if(closeVar.length==1){return closeVar.tips1;Core.Events.stopEvent()}else{if($IE){var g=Core.Events.fixEvent(Core.Events.getEvent());if(g.clientY<0||g.altKey){if(confirm(closeVar.tips2)){if(closeVar.args){Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])()}else{closeVar.func()}}else{}}}else{function f(j){if(j==true){if(closeVar.args){Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])()}else{closeVar.func()}}else{}}return f.call(this,confirm(closeVar.tips2))}}};Core.Events.addEvent(window,beforeunloadfunc,"beforeunload")};var StaticUser=Core.Class.create();StaticUser.prototype={container_id:null,is_init:false,localDB:null,initialize:function(a){this.container_id=a;if(!Lib.LocalDB.FlaDom){trace("first 加载");var b=this;Lib.LocalDB.registerFun(function(){setTimeout(function(){b.loaded()},10)});Lib.LocalDB.loadFlash("trayFlashConnetion")}else{this.loaded()}},loaded:function(){var c=this;if(Lib.LocalDB.get("SUKeya",31536000000)){window.staticunload=function(){if($IE){var d=Core.Events.fixEvent(Core.Events.getEvent());this.record()}else{this.record()}};Core.Events.addEvent(window,Core.Function.bind2(window.staticunload,c),"beforeunload")}else{Lib.LocalDB.set("SUKeya",window.staticTime+parseInt(Math.random()*100000).toString());this.record();this.send()}var b=Lib.LocalDB.get("SUInfo",31536000000);if(Lib.LocalDB.get("SULastTime",31536000000)){var a=Lib.LocalDB.get("SULastTime",31536000000);if((new Date().getTime()-a)>3600000){this.send()}}else{Lib.LocalDB.set("SULastTime",new Date().getTime())}},record:function(){var c=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536000000));var a="";var d=document.referrer;if((ts=Utils.Cookie.getCookie("SUP"))!=""){ts=decodeURIComponent(ts);if(ts!=""){a+="|lu:"+ts.split("&uid=")[1].split("&")[0]}if(scope.unreadMsg&&scope.unreadMsg.isbloguser){a+="|ib:"+scope.unreadMsg.isbloguser}if(!Lib.LocalDB.get("SULoginFlag")){a+="|al:1|at:"+new Date().getTime()}else{if(d==""){a+="|al:4"}else{if(d.indexOf("blog.sina.com.cn")>-1){a+="|al:2"}else{a+="|al:3"}}}if(Utils.Cookie.getCookie("ALF")!=""){a+="|pu:1"}Lib.LocalDB.set("SULoginFlag",true)}else{Lib.LocalDB.set("SULoginFlag",false)}var b="et:"+window.staticTime+"|r:"+d+"|u:"+window.location.href+"|lt:"+new Date().getTime().toString()+"|vu:"+scope.$uid+a+";";Lib.LocalDB.set("SUInfo",encodeURIComponent(c+b))},send:function(){var b=Lib.LocalDB.get("SUKeya",31536000000);var d=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536000000));var f=d.split(";");if(f.length>5){var a="";for(var c=0;c<f.length;c++){if((c+1)%5==0){v7sendLog("StaticUser","",encodeURIComponent("k:"+b+";"+a));a=""}else{a+=f[c]+";"}}if(a!=""){v7sendLog("StaticUser","",encodeURIComponent("k:"+b+";"+a))}}else{v7sendLog("StaticUser","",encodeURIComponent("k:"+b+";"+d))}Lib.LocalDB.set("SUInfo","");Lib.LocalDB.set("SULastTime",new Date().getTime())}};$registJob("static",function(){window.staticClass=new StaticUser();var a=function(){var d=document.createElement("div");d.className="dowAndroidTip";d.id="dow_AndroidTip";d.innerHTML='<div class="dowAndroidTipInner"><p style="cursor:pointer;" id="save2mobile">将此博客<span>保存到手机</span></p><p style="cursor:pointer;" id="save2mobile2">阅读随时随地</p><span class="arrowMod"><span class="arrowModInner"></span></span><a id="close_discover" class="close" href="javascript:;" title="关闭">关闭</a></div>';$E("headarea").appendChild(d);var f=Core.Dom.getXY(document.body);var c=Core.Dom.getXY($E("blogtopoption"));d.style.position="absolute";d.style.left=f[0]+728+"px";d.style.top=c[1]-45+"px";$E("close_discover").onclick=function(){v7sendLog("70_01_05_"+($UID||0));$E("dow_AndroidTip").style.visibility="hidden";return false};$E("save2mobile").onclick=$E("save2mobile2").onclick=function(g){Core.Events.stopEvent(g);v7sendLog("70_01_06_"+($UID||0));window.open("http://appmaster.hudee.com/sina/download.jsp?uid="+scope.$uid);$E("dow_AndroidTip").style.visibility="hidden"}};var b=Core.Dom.byClz($E("blogtopoption"),"a","dwnAndroid");if(b.length){b=b[0];if((Core.String.trim(b.innerText||b.textContent||""))==="下载应用"){a()}Core.Events.addEvent(b,function(){var c=Core.String.trim(b.innerText||b.textContent||""),d;switch(c){case"下载应用":d="70_01_01_"+($UID||0);break;case"制作应用":d="70_01_02_"+$UID;break;case"管理应用":d="70_01_04_"+$UID;break;case"制作中":d="70_01_03_"+$UID}d&&v7sendLog(d)})}});$registJob("sharePhoto",function(){var D=Core.Array.foreach,f=scope.$pageid,g=f=="article"||f=="articleM"||f=="article_new"||f=="articleM_new",m=scope.$uid,E,p,t,q=$E("sina_keyword_ad_area2")||document.body,A,v,j=62,o=1;var n=SinaEx.createNode('<div id="sharePhoto" style="display:none;width:120px;position:absolute;"><div class="picShareQing"><div class="share SG_txtb"><span>分享到新浪Qing</span></div></div><div class="picShareFlt"><div class="share SG_txtb" style="margin-top:5px;"><span>分享到新浪微博</span></div></div></div>');var d=n.children[0];var a=d.nextSibling;document.body.appendChild(n);setTimeout(function(){Lib.Uic.getNickName([m],function(F){E=F[m]})},500);function r(){if(this.width<165||this.height<j){return false}var F=Core.Dom.getXY(this)[0]+this.width-124;F=Math.min(F,A-134);s.left=F+"px";s.top=Core.Dom.getXY(this)[1]+this.height-j+4+"px";if(o){s.display=""}p=encodeURIComponent(this.getAttribute("real_src")||this.src);t=this}function b(){var G=Core.Events.getEvent(),F=G.relatedTarget||G.toElement;if(!F||!Core.Dom.contains(n,F)){s.display="none"}}var u=n,s=u.style;Core.Events.addEvent(d,function(){var F=g?"的《"+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML+"》":"",G=$_GLOBAL.qingURL+"blog/controllers/share.php?searchPics=0&content="+encodeURIComponent("分享"+E+F+"的博文图片，查看原文：")+"&url="+encodeURIComponent(y(t)||location.href)+"&ralateNick="+encodeURIComponent("新浪博客")+"&pics="+p;window.open(G,"shareQing","toolbar=0,status=0,resizable=1,width=600,height=520,left="+(screen.width-600)/2+",top="+(screen.height-520)/2);v7sendLog("80_01_02");if(typeof SUDA!="undefined"){SUDA.uaTrack("blog_article","h_article20")}return false});Core.Events.addEvent(a,function(){var I="http://v.t.sina.com.cn/share/share.php?",J=encodeURIComponent("分享"+E+"的博文图片："+(g?Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML:"")),H="新浪-博客",F="http://blog.sina.com.cn",G="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+J+"&url="+encodeURIComponent(y(t)||document.location)+"&source="+H+"&sourceUrl="+encodeURIComponent(F)+"&content=utf-8&appkey=1617465124&pic="+p;window.open(G,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);v7sendLog("80_01_09");if(typeof SUDA!="undefined"){SUDA.uaTrack("blog_article","h_article21")}Core.Events.stopEvent()});function z(G,F){if(!(G.getAttribute(F)||"").indexOf("http://www.sinaimg.cn/uc/myshow/blog/misc/gif/E___")||!Core.Dom.contains(q,G)){return}c();v=new Image;Core.Events.addEvent(v,function(){if(this.width>165&&this.height>35){Core.Events.addEvent(G,r.bind2(G),"mouseover");Core.Events.addEvent(G,b.bind2(G),"mouseout")}}.bind2(v),"load");v.src=G.getAttribute(F)}function c(){A=Core.Dom.getXY(q)[0]+q.clientWidth}Core.Events.addEvent(window,c,"resize");if(f=="index"||f=="indexM"||f=="article"||f=="articleM"||f=="article_new"||f=="articleM_new"){D([$E("module_10001"),$E("module_10002"),$E("module_10003"),$E("module_920")],function(F){if(F&&F.clientWidth>500){q=F;C()}})}function y(G){if(g){return}var F;while(G=G.parentNode){if(G.className=="content"&&G.nodeName=="DIV"&&(F=G.nextElementSibling||G.nextSibling).className=="tagMore"){return($T(F,"a")[0]||{}).href||""}}}function C(){o=1;D($T(q,"img"),function(F){z(F,"src")})}if(Lib&&Lib.Component.Comp_10001){var B=Lib.Component.Comp_10001.prototype.afterLoadList;Lib.Component.Comp_10001.prototype.afterLoadList=function(){o=0;s.display="none";B.apply(this,arguments);setTimeout(C,100)}}scope.sharePhoto={bindFn:z}});$registJob("selectionShare",function(){if(!$E("sina_keyword_ad_area2")){return}var n=$C("div");n.innerHTML='<img src="http://simg.sinajs.cn/blog7style/images/common/share.gif" title="将选中内容分享到新浪微博"/>';n.id="selectionShare";n.style.display="none";n.style.position="absolute";n.style.cursor="pointer";document.body.appendChild(n);Core.Events.addEvent(document.body,function(){j()});Core.Events.addEvent(n,function(){m();Core.Events.stopEvent()});var r=null;Lib.Uic.getNickName([scope.$uid],function(t){r=t[scope.$uid]});var s=0,q=0;var p=0,o=0;var d,a;Core.Events.addEvent($E("sina_keyword_ad_area2"),function(t){var t=Core.Events.getEvent();t=Core.Events.fixEvent(t);setTimeout(function(){var u=g();if(u){setTimeout(function(){f()},100);b(t)}else{j()}})},"mouseup");Core.Events.addEvent($E("sina_keyword_ad_area2"),function(t){var t=Core.Events.getEvent();t=Core.Events.fixEvent(t);p=t.pageX;o=t.pageY},"mousedown");function g(){d=null;a=null;var B=Core.String.trim;if(document.selection){var z=document.selection.createRange();var t=z.text;if(t.length>=10){d=t}var v=z.htmlText;var y=/<img[\s\S]+src="(\S+)"[\s\S]+>/img;if(y.test(v)){a=RegExp.$1}}else{try{var z=window.getSelection().getRangeAt(0);if(!Core.Dom.contains($E("sina_keyword_ad_area2"),z.commonAncestorContainer)){return}var t=z.toString();if(t.length>=10){d=t}var C=$C("div");C.appendChild(z.cloneContents());var u=$T(C,"img");if(u.length>0){a=u[0].src||u[0].real_src}}catch(A){}}if(d){d=B(d).replace(/\r|\n/g,"")}return d}function m(){if(d&&d.length>80){d=d.substr(0,80)+"……"}var v=Core.Dom.byClz(document.body,"h2","titName")[0];var C=v.textContent||v.innerHTML;if(d){var B=encodeURIComponent(d+"——博文片段来自"+r+"："+C)}else{var B=encodeURIComponent("分享"+r+"的博文图片："+C)}var A="http://v.t.sina.com.cn/share/share.php?",z="新浪-博客",t="http://blog.sina.com.cn",y="http://v.t.sina.com.cn/share/share.php?searchPic=false&title="+B+"&url="+document.location+"&source="+z+"&sourceUrl="+encodeURIComponent(t)+"&content=utf-8&appkey=1617465124";if(a){y=y+"&pic="+a}window.open(y,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2);j()}function f(){n.style.left=s+"px";n.style.top=q+"px";n.style.display=""}function j(){n.style.display="none"}function b(A){if(!$IE){c();return}var y=document.selection.createRange();var z=y.duplicate();z.collapse(false);z.moveStart("word",-1);while(z.text.length==0){z.moveStart("word",-1)}var u=false;if(A.pageY-o<=-z.boundingHeight){u=true;trace(11111)}if(Math.abs(A.pageY-o)<z.boundingHeight){if(A.pageX-p<0){u=true;trace(11111)}else{u=false;trace(22222)}}y.collapse(u);if(!u){y.moveStart("word",-1);while(y.text.length==0){y.moveStart("word",-1);y.moveEnd("word",-1)}}var B=y.htmlText;var v="temp_"+parseInt(Math.random()*1000);var t=y.boundingWidth,C=y.boundingHeight;y.pasteHTML('<a id="'+v+'" >$</a>'+B);var D=$E(v);if(u){s=Core.Dom.getLeft(D)+10;q=Core.Dom.getTop(D)-26-7}else{s=Core.Dom.getLeft(D)+t-36;q=Core.Dom.getTop(D)+C}D.parentNode.removeChild(D)}function c(){var t=window.getSelection();var z=t.rangeCount-1;var v=t.getRangeAt(z);var u=$C("span");var A=v.cloneRange();var C=false;var y;var D;var B;y=v.startContainer;if(v.startContainer!=v.endContainer){if(t.focusNode!=v.startContainer){C=true;y=v.endContainer}}else{if(t.focusOffset>t.anchorOffset){C=true}}A.collapse(!C);A.insertNode(u);B=Core.Dom.getXY(u);if(y.nodeType==3){y=y.parentNode}if(y.tagName.toUpperCase()=="IMG"){D=y.offsetWidth}else{D=Core.Dom.getStyle(y,"fontSize");D=parseInt(D.substring(0,D.length-2))}if(C){s=B[0]-33;q=B[1]+10;if(!$FF){q+=D}}else{s=B[0]+7;q=B[1]-36;if($FF){q-=D}}u.parentNode.removeChild(u);t.removeAllRanges();t.addRange(v)}});$registJob("toZoneStatic",function(){if(scope.$uid=="1513474044"||scope.$uid=="1632440911"||scope.$uid=="1311747503"||scope.$uid=="1374847633"||scope.$uid=="1265252974"||scope.$uid=="1218670734"||scope.$uid=="1156966391"){Utils.Io.JsLoad.request("http://sjs.sinajs.cn/blog7activity/zoneStatic.js",{isRemove:false,onComplete:function(){if(typeof zoneStatic=="function"){zoneStatic()}if(typeof traceFunction=="function"){traceFunction()}},noreturn:true})}});$registJob("userResidenceTime",function(){function b(j,g){var f=["1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],m=[],o=f.length;if(g){f=f.concat(g)}for(var n=0;n<j;n++){m.push(f[Math.floor(Math.random()*o)])}return m.join("")}function d(){var f=new Date().valueOf();return b(15,f.toString().slice(-5).split(""))}var c=d();function a(){v7sendLog("24_01_01_"+scope.$pageid+"_"+c,null,null);setInterval(function(){v7sendLog("24_01_01_"+scope.$pageid+"_"+c,null,null)},3000)}Math.floor(Math.random()*100)<1&&a()});Lib.templateUtils=function(){};Lib.templateUtils.prototype.getTemplateNodes=function(m){var c=document.createElement("div");var a={};var f=[];var n=(new Date().getTime().toString()).slice(-5)+Math.floor(Math.random()*100000);var g=/#{([a-z0-9_]+)}/gi;m=m.replace(g,function(p,o){f.push(o);return o+"_"+n});c.innerHTML=m;var b;var d=f.length;var j;for(b=0;b<d;b++){j=f[b];a[j]=this.findById(j+"_"+n,c)}return a};Lib.templateUtils.prototype.getIdNodes=function(q){var f,d,m,c,o,n;var b={};var a=[];var p=[];var r=[];var g=document.createElement("div");g.innerHTML=q;r=g.getElementsByTagName("*");q.replace(/id *= *"([^{ ]+?)"/ig,function(s,j){a[a.length]=j});m=r.length;for(f=0;f<m;f++){if(r[f].id){p[p.length]=r[f]}}m=a.length;for(f=0;f<m;f++){o=a[f];d=0;c=p.length;while(d<c){n=p[d];if(o==n.id){b[o]=n;p.splice(d,1)}d++}}return b};Lib.templateUtils.prototype.findById=function(g,f,b){var d;var f=f||document;var c=f.getElementsByTagName(b||"*");var a=c.length;for(d=0;d<a;d++){if(c[d].getAttribute("id")==g){return c[d]}}};Lib.templateUtils.prototype.formatTemplate=function(b,a){var b;var c=new RegExp("#{([a-z0-9]+)}","ig");b=b.replace(c,function(j,d,g,f){return a[d]});return b};(function(){Function.prototype.$defineProto=function(c){var b;for(b in c){this.prototype[b]=c[b]}if(this.__interface__){for(b in this.prototype){if(this.prototype[b]==="NI"){throw new Error("类定义错误，接口方法["+b+"]未实现")}}}this.prototype.constructor=this;this.$extendClass=this.$defineProto=this.$implements=function(){throw new Error("$defineProto 语句定义后面不能再作其它定义")};return this};Function.prototype.$extendClass=function(){var f=this;var c=arguments.length;var b;var d;if(c===0){throw new Error("$extendClass 语句错误：未指定父类")}b=arguments[0];d=function(){var j=this;this.$super={};for(var g in b.prototype){if(!b.prototype[g]){continue}this.$super[g]=(function(m){return function(){b.prototype[m].apply(j,arguments)}})(g)}b.apply(this,arguments);f.apply(this,arguments)};d.prototype=a(b.prototype);d.prototype.constructor=d;return d};Function.prototype.$implements=function(){var b=Array.prototype.slice.call(arguments,0);var f;var d=b.length;var c;while(d--){if(typeof b[d]!=="object"){throw new Error("$implements 语句错误：参数必须为 object 类型")}for(c in b[d]){typeof this.prototype[c]==="undefined"&&(this.prototype[c]="NI")}}this.__interface__=true;this.$extendClass=function(){throw new Error("$extendClass 语句错误：$extendClass 语句不能出现在 $implements 定义之后")};return this};Function.prototype.$mixProto=function(){this.$extendClass=this.$defineProto=function(){throw new Error("$mixProto 必须放在最后使用")};var b=arguments[0];var c=b.prototype;for(var d in c){if(this[d]){throw new Error("目标类有同名方法")}if(!c[d]){continue}this.prototype[d]=c[d]}return this};function a(c){function b(){}b.prototype=c;return new b()}})();function commonLog(a){var b=window.clog_img=new Image();b.onload=b.onerror=function(){window.clog_img=null};b.src=a+(a.indexOf("?")>0?"&__rnd=":"?")+Math.random();b=null}blogAd.CommAd=function(m){Lib.checkAuthor();var p,g,f;var o=$E("commAd_1");var j=$E("commAd_2");if(!o){trace("no id");p=$E("articlebody");g=articlebody.getElementsByTagName("strong");for(f=0;f<g.length;f++){if(g[f].innerHTML=="评论"){o=g[f].parentNode.getElementsByTagName("span")[0]}else{if(g[f].innerHTML=="发评论"){j=g[f].parentNode.getElementsByTagName("span")[0]}}}}this.MARK_ID=2;this.LIMITED=24;var q=['<span style="margin-left:15px; width:220px; display:inline-block;">','<a target="_blank" href="http://blog.sina.com.cn/lm/8/2009/0325/105340.html">重要提示：警惕虚假中奖信息</a>',"</span>"].join("");var d='<span style="display:inline-block;width:220px;white-space:nowrap;">#{link}</span>';var r='<span style="margin:0 60px 0 20px; display:inline-block;">|</span>';var c="";var b="";var a="",n=false;if(!$isAdmin&&m&&(!(+m.code))&&m.ads){if(m.ads[0]&&m.ads[0].link){n=true;c=this.formatTemplate(d,{link:m.ads[0].link});if(m.ads[0].status&&m.ads[0].status.adstart){new Image().src=m.ads[0].status.adstart}}if(m.ads[1]&&m.ads[1].link){n=true;b=this.formatTemplate(d,{link:m.ads[1].link});if(m.ads[1].status&&m.ads[1].status.adstart){new Image().src=m.ads[1].status.adstart}}if(m.ads[2]&&m.ads[2].link){n=true;a=this.formatTemplate(d,{link:m.ads[2].link});if(m.ads[2].status&&m.ads[2].status.adstart){new Image().src=m.ads[2].status.adstart}}}if(o){o.style.display="inline-block"}if(j){j.style.display="inline-block"}n&&commonLog("http://1092.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tjbw_plq_wzl&db=sina&border=0&local=yes&js=ie")}.$defineProto({}).$mixProto(Lib.templateUtils);blogAd.insertIns=function(f,a,d,c){d=d||"beforeend",c=c||"display:block;";var b='<ins class="sinaads" data-ad-pdps="'+f+'" style="'+(c||"")+'"></ins>';a=a||document.body;return Core.Dom.insertHTML(a,b,d)};var Article={};Article.getSearchReferrer=function(){var j={};var a=document.URL;if(a.indexOf("blog.sina.com.cn")!=-1&&a.indexOf("k=")!=-1){var d=new Utils.Url(a);j.key=d.getParam("k");j.type=d.getParam("t");return j}var f=document.referrer;if(!f||f===""){return false}var g={"www.google.co.jp":{param:"q",type:"utf-8"},"www.google.com.hk":{param:"q",type:"utf-8"},"www.baidu.com":{param:"wd",type:"GBK",needTrans:true},"www.soso.com":{param:"query",type:"GBK",needTrans:true},"search.yahoo.com":{param:"p",type:"utf-8"},"cn.bing.com":{param:"q",type:"utf-8"},"www.youdao.com":{param:"q",type:"utf-8"},"www.sogou.com":{param:"query",type:"GBK",needTrans:true},"www.so.com":{param:"q",type:"utf-8"}};for(var b in g){var c=new Utils.Url(f);if(f.indexOf(b)!=-1){j.key=c.getParam(g[b]["param"]);j.type=g[b]["type"];j.needTrans=g[b]["needTrans"];break}}if(!j.key||j.key===""){return false}else{return j}};window.sendLogToQing=function(c,a){if(typeof scope==="undefined"){window.scope={};scope.$uid=scope.$pageid=""}var f=c||"",b=a||scope.$uid,d=scope.$pageid,j=new Date().getTime(),g=f+"|"+j+"|"+d+"|"+b;var m=window.actlog_img=new Image();m.onLoad=m.onError=function(){window.actlog_img=null};m.src=$_GLOBAL.qingURL+"blog/api/actlog.php?msg="+encodeURIComponent(g);m=null};$registJob("searchToQing",function(){var b=scope.isFromSearchEngine||Article.getSearchReferrer();if(!b){return}var f=document.documentElement,d=document.body;c();function a(n){var o=decodeURIComponent,g="",j=$C("div"),m;j.className="blog_skeywords";j.style.overflow="hidden";j.style.position=$IE6?"absolute":"fixed";j.style.right="0px";j.style.zIndex=10;g='<dl class="clearfix"><dt><a href="'+o(n.ad_pic_url)+'" target="_blank" title="'+o(n.ad_title)+'"><img width="208" height="48" src="'+o(n.ad_pic_address)+'" alt="'+o(n.ad_title)+'" /></a></dt><dd>'+(n.ad_word1?'<p><a href="'+o(n.ad_word1_url)+'" target="_blank">'+o(n.ad_word1)+"</a></p>":"")+(n.ad_word2?'<p><a href="'+o(n.ad_word2_url)+'" target="_blank">'+o(n.ad_word2)+"</a></p>":"")+'</dd></dl><a onclick="this.parentNode.style.display=\'none\';return false;" href="javascript:;" class="close"></a>';j.innerHTML=g;d.appendChild(j);m=j.offsetHeight;j.style.top=((f.clientHeight||d.clientHeight)-m)+"px";$IE6&&Core.Events.addEvent(window,function(r){var q=f.scrollTop||d.scrollTop,p=f.clientHeight||d.clientHeight;j.style.top=Math.abs(p+q-m)+"px"},"scroll");Core.Events.addEvent(window,function(){setTimeout(function(){var r=f.scrollTop||d.scrollTop,p=f.clientHeight||d.clientHeight;var q=Math.abs(p-m);if($IE6){q=Math.abs(p+r-m)}j.style.top=q+"px"},30)},"resize")}function c(){var j,o;var m=130,n=f.clientHeight||d.clientHeight;var g="http://blog.sina.com.cn/lm/iframe/article/searchqing.html?t="+(+new Date());j=$C("iframe");j.src=g;j.width="100%";j.scrolling="no";j.style.border="0px";j.frameBorder="no";closeBtn=$C("a");closeBtn.className="nblog_searchBtmBtn";closeBtn.href="javascript:void(0);";closeBtn.title="关闭";closeBtn.innerHTML="关闭";closeBtn.id="serachToQingCloseBtn";closeBtn.onClick="return false";o=$C("div");o.id="searchToQing";o.style.width="100%";o.style.height="100px";o.style.left="0px";o.style.top=(n-m)+"px";o.style.position="fixed";o.style.zIndex=201;o.appendChild(closeBtn);o.appendChild(j);Core.Events.addEvent(closeBtn,function(){trace("add events to closeBtn");$E("searchToQing").parentNode.removeChild($E("searchToQing"))},"click");if($IE6){o.style.position="absolute";o.style.overflow="hidden";Core.Events.addEvent(window,function(){var r=f.scrollTop||d.scrollTop,p=f.clientHeight||d.clientHeight;var q=Math.abs(p-m);if($IE6){q=Math.abs(p+r-m)}$E("searchToQing").style.top=q+"px"},"scroll");j.style.left=o.style.left;j.style.top=o.style.top}d.appendChild(o);Core.Events.addEvent(window,function(p){setTimeout(function(){var s=f.scrollTop||d.scrollTop,q=f.clientHeight||d.clientHeight;var r=Math.abs(q-m);if($IE6){r=Math.abs(q+s-m)}$E("searchToQing").style.top=r+"px"},20)},"resize");Core.Events.addEvent($E("serachToQingCloseBtn"),function(p){sendLogToQing("79_01_12|blog7",$UID||"")},"click");o=null;j=null;if($E("searchToQing")&&SUDA){SUDA.uaTrack("blog_sflow","v_sflow")}}});Lib.BlogRecommendDialog=Core.Class.create();Lib.BlogRecommendDialog.prototype={template:['<div class="blogreco" id="#{panel}">','<div id="#{frame}">','<div class="TB" id="#{titleBar}">','<a id="blogNorAd_Cls" class="btnClose" style="position:absolute;left:240px;" href="javascript:">&nbsp;</a>','<a class="btnMin" style="position:absolute;left:220px;" id="#{btnMin}" href="javascript:">&nbsp;</a>',"</div>",'<div id="#{content}"></div>',"</div>","</div>"].join(""),contentUrl:'<iframe frameborder="0" scrolling="no" class="IF" src="http://blog.sina.com.cn/lm/mini/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"dlg680",_mode:null,_timePoints:null,_toolbarHeight:0,width:260,height:190,isMin:false,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(f,d,b){var c=this;var a;this._mode=f;this._timePoints=d;this.oParam=b;this.isShowClosedAD=!(+b.code);if(!this._dialog){this._dialog=new Ui.Panel();this._dialog.setTemplate(this.template);a=this._dialog.nodes;a.btnClose=$E("blogNorAd_Cls");this._dialog.entity.style.zIndex="100";this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100");this._dialog.setContent(this.contentUrl);this._dialog.setFixed(true);this.setPos();if(scope.isFromSearchEngine){this._searchToQing()}}this._evt=new Core.Events.EventDispatcher(this);Core.Events.addEvent(a.btnClose,this.close.bind2(this));Core.Events.addEvent(a.btnMin,this.toggle.bind2(this));Core.Events.addEvent(window,function(){if(c._dialog&&c._dialog.entity){var n=document.documentElement.clientWidth||document.body.clientWidth;var m=document.documentElement.clientHeight||document.body.clientHeight;var j=Math.max(n)-c.width,g=Math.max(m)-c.height-c._toolbarHeight;if(scope.isFromSearchEngine){g-=100}c._dialog.setPosition({x:j,y:g})}},"resize")},setPos:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;var d=document.documentElement.clientHeight||document.body.clientHeight;var c=a-this.width;var b=d-this.height-this._toolbarHeight;if(scope.isFromSearchEngine){b-=100}this._dialog.setPosition({x:c,y:b})},show:function(){var c=this;this._dialog.show();this._evt.dispatchEvent("show");this.uiStatus="2";this._slide=new Ui.Slide($E(this._dialog.entity.id));var b=this._slide.container.style;if($IE6){b.overflow="visible";b.height=0}else{b.position="absolute"}this._slide.onSlideMax=function(){c._evt.dispatchEvent("max")};this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px";new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide);this._slide.onSlideMin=function(){c._evt.dispatchEvent("min")};this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-28,this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide);this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide);this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity);this._dialog.entity=null;c._evt.dispatchEvent("close");setTimeout(function(){var f=$E("rightADWrap");if(f){Core.Dom.setStyle(f,"right","0")}},1000)}.bind2(this);this._slide.slideMax();if(!blogAd.getInitPermission(this.oParam)){return}this.oParam=this.oParam.ads[0];var a=$E("rightADWrap");var d=this.width;if(a){Core.Dom.setStyle(a,"right",d+"px")}},toggle:function(){if(this._dialog.nodes.btnMin){var a=this._dialog.nodes.btnMin.className;if(a=="btnMin"){a="btnMax";this.uiStatus="1";this._slide.slideMin()}else{a="btnMin";this.uiStatus="2";this._slide.slideMax()}this._dialog.nodes.btnMin.className=a;a=null;this.onToggle()}},close:function(){Utils.Cookie.setCookie(this._cookie,new Date().getHours(),24,"/");var a=this;a.uiStatus="0";Lib.execZhitou(function(b){var c=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});c.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>';setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){c.show();setTimeout(function(){c.hide()},5000)}}})},1000)});this._slide.slideIn()},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},_initClosedAD:function(){this.closedFlashTemplate=['<div id="#{panel}">','<div id="#{content}">','<div id="blogVideoAd" width="'+this.oParam.width+'" height="'+this.oParam.height+'"></div>',"</div>","</div>"].join("");this.closedADLayer=new Ui.Panel();this.closedADLayer.setTemplate(this.closedFlashTemplate);this.closedADLayer.entity.style.zIndex="100";this.closedADLayer.__iframe&&(this.closedADLayer.__iframe.style.zIndex="100");var b=Core.System.pageSize();var f=Math.min(b[2],document.documentElement.clientWidth)-this.oParam.width;var d=Math.min(b[3],document.documentElement.clientHeight)-this.oParam.height;if(scope.isFromSearchEngine){d-=100}this.closedADLayer.setFixed(true).setPosition({x:f,y:d});var g=this.oParam;var c=this.closedADLayer.nodes;var a=$E("blogVideoAd");if(!a){return}switch(g.type){case"mixed":a.innerHTML=g.content;trace(g.content);break;case"pic":a.innerHTML='<img src="'+g.ref+'" style="width:'+g.width+"px; height:"+g.height+'px;" />';if(g.click){a.style.position="relative";c.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>');c.cantSeeMe.href=g.click;c.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+g.height+"px; width:"+g.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;";a.appendChild(c.cantSeeMe)}break;case"swf":this.appendSwf(g.ref,"",g.width,g.height,a.id);if(g.click){a.style.position="relative";c.cantSeeMe=this.createNode('<a href="#" target="_blank"></a>');c.cantSeeMe.href=g.click;c.cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+g.height+"px; width:"+g.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;";a.appendChild(c.cantSeeMe)}break}},appendSwf:function(a,g,d,f,b){if(typeof sinaFlash=="undefined"){return}var c=new sinaFlash(a,g,d+"",f+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);c.addParam("allowScriptAccess","always");c.addParam("wmode","transparent");c.write(b)},onToggle:function(){},addEventListener:function(b,a){this._evt.addEventListener(b,a)},getHeight:function(){var b=this.closedADLayer;var a=0;if(this._dialog.entity){trace("dialog height");a=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop);a>0?a:0;trace("dialog height"+a)}if(b){trace("flash height====");a=b.clientHeight;trace("flash height===="+a)}return a},_searchToQing:function(){var a=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){scope.isFromSearchEngine=!1;if(a._dialog&&a._dialog.entity){var f=Math.max(document.documentElement.clientHeight)-a.height-a._toolbarHeight,b=Math.max(document.documentElement.clientWidth)-a.width;a._dialog.setPosition({x:b,y:f})}if(a.closedADLayer&&a.closedADLayer.entity){var d=a.closedADLayer.entity;var c=d.style.top;d.style.top=parseInt(c)+100+"px"}}},"click")}};Lib.ADBlogRecommendDialog=Core.Class.create();Lib.ADBlogRecommendDialog.prototype={template:['<div id="#{panel}" class="popBox">','<div id="#{frame}" class="popBox_bg">','<div id="#{popFlashContent}" class="popFlash" style="z-index:10;">','<a target="_blank" id="#{clickURL}" style="display:none;position:absolute;"></a>',"</div>",'<div id="#{popMain_bg}" class="popMain_bg" style="z-index:11;"></div>','<div class="popMain" style="z-index:12">','<div id="#{content}">',"</div>","</div>",'<div id="#{titleBar}" class="popBox_btn" style="z-index:12;">','<a id="#{btnMin}" href="#" onclick="return false;" title="" class="mini"></a>','<a id="blogNorAd_Cls" href="#" onclick="return false;" title="" class="close"></a>',"</div>","</div>","</div>"].join(""),contentUrl:'<iframe style="width:100%;height:185px;" allowtransparency="yes" frameborder="0" scrolling="no" src="http://blog.sina.com.cn/lm/mini/noborder/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"ad680",_mode:null,_timePoints:null,flashURL:"",picURL:"",flashWidth:0,flashHeight:0,tjURL:"",btnURL:"",clickURL:"",_toolbarHeight:0,width:262,height:255,isMin:false,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(j,d,o,g,c,f,q,p,b,m){var n=this;var a;this._mode=j;this.flashURL=g;this.picURL=o;this.flashWidth=c;this.flashHeight=f;this.tjURL=q;this.btnURL=p;this.clickURL=b;this._timePoints=d;this.oParam=m;if(!(+m.code)){this.isShowClosedAD=true}if(!this._dialog){this._dialog=new Ui.Panel();this._dialog.setTemplate(this.template);a=this._dialog.nodes;a.btnClose=$E("blogNorAd_Cls");this._dialog.entity.style.zIndex="1000";this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100");this._dialog.setContent(this.contentUrl);this._dialog.setFixed(true);this.setPos();if(scope.isFromSearchEngine){this._searchToQing()}}this._evt=new Core.Events.EventDispatcher(this);Core.Events.addEvent(a.btnClose,this.close.bind2(this));Core.Events.addEvent(a.btnMin,this.toggle.bind2(this));Core.Events.addEvent(window,function(){if(n._dialog&&n._dialog.entity){var s=Math.max(document.documentElement.clientHeight)-n.height-n._toolbarHeight,r=Math.max(document.documentElement.clientWidth)-n.width;if(scope.isFromSearchEngine){s-=100}n._dialog.setPosition({x:r,y:s})}},"resize");!this.clickURL&&this.initFlashAD(a.popFlashContent.id)},setPos:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;var d=document.documentElement.clientHeight||document.body.clientHeight;var c=a-this.width;var b=d-this.height-this._toolbarHeight;if(scope.isFromSearchEngine){b-=100}this._dialog.setPosition({x:c,y:b})},initFlashAD:function(b){var a=new sinaFlash(this.flashURL,"popSmallFlash",this.flashWidth,this.flashHeight,"8","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);a.addParam("allowScriptAccess","always");a.addParam("wmode","transparent");a.write(b)},show:function(){var b=this._dialog.nodes;b.frame.style.backgroundImage="url("+this.picURL+")";b.btnClose.style.backgroundImage="url("+this.btnURL+")";b.btnMin.style.backgroundImage="url("+this.btnURL+")";b.popMain_bg.style.backgroundImage="url("+this.tjURL+")";if(this.clickURL){b.clickURL.style.display="";b.clickURL.style.width=(this.flashWidth||260)+"px";b.clickURL.style.height=(this.flashHeight||50)+"px";b.clickURL.href=this.clickURL}var d=this;this._dialog.show();this._evt.dispatchEvent("show");this.uiStatus="2";this._slide=new Ui.Slide($E(this._dialog.entity.id));var c=this._slide.container.style;c.top="0px";if($IE6){c.overflow="visible";c.height=0}else{c.position="absolute"}this._slide.onSlideMax=function(){d._evt.dispatchEvent("max")};this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px";new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide);this._slide.onSlideMin=function(){d._evt.dispatchEvent("min")};this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-55,this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide);this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(f){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide);this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity);this._dialog.entity=null;d._evt.dispatchEvent("close")}.bind2(this);this._slide.slideMax();if(!blogAd.getInitPermission(this.oParam)){return}this.oParam=this.oParam.ads[0];commonLog("http://1088.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_fdtc_bk&db=sina&border=0&local=yes&js=ie");var a=$E("rightADWrap");if(a){Core.Dom.setStyle(a,"right","260px")}},toggle:function(){if(this._dialog.nodes.btnMin){if(this.displayState=="max"){this.uiStatus="1";this._slide.slideMin();this.displayState="min"}else{this.uiStatus="2";this._slide.slideMax();this.displayState="max"}this.onToggle()}},close:function(){Utils.Cookie.setCookie(this._cookie,new Date().getHours(),24,"/");var a=this;a.uiStatus="0";Lib.execZhitou(function(b){var c=new sinaadToolkit.Box({position:"right bottom",width:260,height:190,follow:1});c.getMain().innerHTML='<ins class="sinaads" id="PDPS000000025956" data-ad-status="async" data-ad-pdps="PDPS000000025956"></ins>';setTimeout(function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000025956"),params:{sinaads_success_handler:function(){c.show();setTimeout(function(){c.hide()},5000)}}})},1000)});this._slide.slideIn()},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},appendSwf:function(a,g,d,f,b){if(typeof sinaFlash=="undefined"){return}var c=new sinaFlash(a,g,d+"",f+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);c.addParam("allowScriptAccess","always");c.addParam("wmode","transparent");c.write(b)},onToggle:function(){},addEventListener:function(b,a){this._evt.addEventListener(b,a)},getHeight:function(){var b=this.closedADLayer;var a=0;if(this._dialog.entity){trace("dialog height");a=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop);a>0?a:0;trace("dialog height"+a)}if(b&&b.entity.style.display!="none"){trace("flash height====");a=this.oParam.height;trace("flash height===="+a)}return a},_searchToQing:function(){var a=this;Core.Events.addEvent($E("serachToQingCloseBtn"),function(){if(scope.isFromSearchEngine){scope.isFromSearchEngine=!1;if(a._dialog&&a._dialog.entity){var f=Math.max(document.documentElement.clientHeight)-a.height-a._toolbarHeight,b=Math.max(document.documentElement.clientWidth)-a.width;a._dialog.setPosition({x:b,y:f})}if(a.closedADLayer&&a.closedADLayer.entity){var d=a.closedADLayer.entity;var c=d.style.top;d.style.top=parseInt(c)+100+"px"}}},"click")}};scope.searchEngineList={"www.google.com":{param:"q",encode:"utf-8"},"www.google.com.hk":{param:"q",encode:"utf-8"},"www.baidu.com":{param:"wd",encode:"gbk"},"www.soso.com":{param:"w",encode:"gbk"},"cn.yahoo.com":{param:"p",encode:"utf-8"},"search.yahoo.com":{param:"p",encode:"utf-8"},"web.gougou.com":{param:"search",encode:"utf-8"},"cn.bing.com":{param:"q",encode:"utf-8"},"www.youdao.com":{param:"q",encode:"utf-8"},"www.sogou.com":{param:"query",encode:"gbk"},"uni.sina.com.cn":{param:"k",encode:"gbk"},"search.sina.com.cn":{param:"q",encode:"utf-8"}};scope.searchFloatingLayerTemplate=['<div id="statBottomforniangs" class="blog_sfout">','<div class="blog_srhflt">','<div id="searchFloatingLayer_LeftContentArea" class="blog_sfL">','<div class="blog_sfTit"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_01\');return false;" id="searchFloatingLayer_RelatedArticle" target="_blank">相关博文</a></div>','<div class="blog_sflist">','<ul id="searchFloatingLayer_RelatedArticleList"></ul>','<span class="SG_more"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_04\');return false;" id="searchFloatingLayer_More" target="_blank">更多&gt;&gt;</a></span>',"</div>","</div>",'<div class="blog_sM" id="searchFloatingLayer_ad"></div>','<div class="blog_sfR">','<div class="mren">',"<strong>看看名嘴们都在说什么</strong>",'<ul class="mren_list" id="searchFloatingLayer_CelebrityList"></ul>','<div class="clear"></div>',"</div>","</div>",'<div class="clear"></div>',"</div>",'<div class="blog_sfClo"><a id="searchFloatingLayer_CloseBtn" href="#" onclick="return false;"></a></div>',"</div>"].join("");scope.searchFloatingLayer={dataURL:"http://control.blog.sina.com.cn/riaapi/article/search_recommend.php",isDisplay:function(){var g=new Utils.Url(window.location.href).anchor||{};var f=g.sFLKeyword;var d=document.referrer;if(window.location.host==="blog.sina.com.cn"&&f){this.keyword=f;this.encode=g.sFLEncode||"utf-8";return true}if(!d){return}var b=scope.searchEngineList;var a=new Utils.Url(d);for(var c in b){if(a.url.indexOf(c)>-1){this.keyword=a.getParam(b[c]["param"]);if((c==="search.sina.com.cn"||c==="www.baidu.com")&&a.getParam("ie")){this.encode=a.getParam("ie")}else{this.encode=b[c]["encode"]}return true}}},displayFloatingLayer:function(a){var b=this;if(!blogAd.getInitPermission(a)){return}a=a.ads[0];Utils.Io.JsLoad.request(this.dataURL,{charset:"utf-8",noencode:true,GET:{encode:this.encode,keyword:this.keyword},onComplete:function(c){if(c&&c.code==="A00006"){b.createFloatingLayerWithData(c.data,a)}else{}}})},createFloatingLayerWithData:function(d,a){if(d.relatedArticle&&d.relatedArticle.length===0){return}var c=new Ui.Panel();c.setTemplate('<div id="#{panel}">'+scope.searchFloatingLayerTemplate+"</div>").setFixed(true);c.show();c.entity.style.zIndex="9999";b($IE6?"":"first");Core.Events.addEvent($E("searchFloatingLayer_CloseBtn"),function(){c.destroy()});Core.Events.addEvent(window,function(){b()},"resize",false);this.updateContent(d,a);!$IE6&&this.playDisplayEffect(c);function b(j){var g=document.documentElement.clientWidth;var f=document.documentElement.clientHeight;c.setPosition({x:0,y:f-(j?0:c.entity.offsetHeight)});$E("statBottomforniangs").style.width=g+"px"}},updateContent:function(f,j){var c=f.relatedArticle;var m=f.celebrity;var d;var o=[];var n=[];var a="http://search.sina.com.cn/?c=blog&by=title&range=all&q="+this.keyword+"&ie="+this.encode;var g=$E("searchFloatingLayer_ad");var b;for(d=0;d<c.length&&d<2;d++){o[o.length]="<li>";if(c[d].isRecommend){o[o.length]='<img class="SG_icon SG_icon107" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="推荐" align="absmiddle" />'}o[o.length]="<a onclick=\"v7sendLog && v7sendLog('85_01_0"+(2+d)+'\');" href="'+c[d].url.replace(/\?.*/,"")+"#sFLKeyword="+this.keyword+"&sFLEncode="+this.encode+'" target="_blank">'+c[d].title.replace(f.keyword,'<span class="blog_sfNm">'+f.keyword+"</span>")+"</a>";o[o.length]="</li>"}if(c.length===1){$E("searchFloatingLayer_LeftContentArea").className="blog_sfL blog_onlyone"}if(f.type===1){$E("searchFloatingLayer_RelatedArticle").parentNode.className="blog_sfTit blog_nofTit"}$E("searchFloatingLayer_RelatedArticleList").innerHTML=o.join("");for(d=0;d<m.length&&d<5;d++){n[n.length]="<li>";n[n.length]="<a onclick='v7sendLog && v7sendLog(\"85_01_0"+(5+d)+"\");' href='http://blog.sina.com.cn/u/"+m[d].uid+"#sFLKeyword="+encodeURIComponent(m[d].uname)+"&sFLEncode=utf-8' target='_blank'>"+m[d].uname+"</a>";n[n.length]="</li>"}$E("searchFloatingLayer_CelebrityList").innerHTML=n.join("");$E("searchFloatingLayer_RelatedArticle").href=a;$E("searchFloatingLayer_More").href=a+"&s=2";if(!j||!g){return}if(j.type=="swf"){this.appendSwf(j.ref,"",j.width,j.height,g)}else{g.style.cssText="height:"+j.height+"px; width:"+j.width+"px;";g.innerHTML="<img src='"+j.ref+"' alt=''/>"}if(j.click){g.style.position="relative";b=this.createNode('<a href="#" target="_blank"></a>');b.href=j.click;b.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+j.height+"px; width:"+j.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;";g.appendChild(b)}g.style.marginTop=parseInt((70-j.height)/2)+"px"},createNode:function(a){var b=$C("div");b.innerHTML=a;return b.childNodes[0]},playDisplayEffect:function(b){var d=b.entity;var c=parseInt(d.style.top);var a=new Ui.TweenStrategy(c,c-d.offsetHeight,0.5);a.onTween=function(f){d.style.top=f+"px"};a.onEnd=function(){b.setPosition({x:0,y:document.documentElement.clientHeight-d.offsetHeight})};a.start()},appendSwf:function(a,g,c,d,b){if(typeof sinaFlash=="undefined"){return}var f=new sinaFlash(a,g,c+"",d+"","9","#FFFFFF",false,"High","http://www.sina.com.cn/","http://www.sina.com.cn/",false);f.addParam("allowScriptAccess","always");f.addParam("wmode","transparent");f.write(b)}};$registJob("outSearch",function(){(typeof BlogAd=="undefined"?a:b)();function a(){Utils.Io.JsLoad.request("http://pfp.sina.com.cn/blog/js/blogad.js",{charset:"gb2312",onComplete:function(){if(typeof BlogAd=="undefined"){return}b()},isRemove:false})}function b(){new BlogAd({pos:"jumpin"}).getAd(function(c){if(!(+c.code)){Utils.Io.loadExternalCSS($_GLOBAL.cssBasicURL+"module/layer/re_seach.css",function(){var d=scope.searchFloatingLayer;if(d.isDisplay()){d.displayFloatingLayer(c)}})}})}});blogAd.popAd=function(){var c=1;var j;var g=false;var f={code:"2101",ads:{0:{type:"mixed"}}};var d={};setTimeout(function(){Lib.Listener.notify("blogRecommendAfter")},4000);if(scope.handler_680!=null){return}scope.handler_680=null;d.renderPopAd=function(s){if(b()==false){$callJob("outSearch");return}var p=s&&s.isAD;if(p){var r="?"+(new Date()).getTime();s.flashURL&&(s.flashURL+=r);s.picURL&&(s.picURL+=r);s.borderImg&&(s.borderImg+=r);s.btnImg&&(s.btnImg+=r);j=new Lib.ADBlogRecommendDialog("once",c,s.picURL,s.flashURL,s.flashWidth,s.flashHeight,s.borderImg,s.btnImg,s.clickUrl,f);j.onToggle=function(){g=true};var q=new Image();q.onload=function(){scope.handler_680=j;scope.Bind680EventHandler&&scope.Bind680EventHandler();j.show();a();setTimeout(function(){if(!g&&j._slide&&j.displayState=="max"){j.toggle()}},60000);q=null};q.src=s.picURL;var o=false;if(s.logurls){j.addEventListener("show",function(){if(!o){o=true;Core.Events.addEvent(j._dialog.nodes.popFlashContent,Core.Function.bind3(n,this,[s.logurls]),"click")}})}}else{j=new Lib.BlogRecommendDialog("once",c,f);j.onToggle=function(){g=true};scope.handler_680=j;scope.Bind680EventHandler&&scope.Bind680EventHandler();j.show();a();setTimeout(function(){if(!g&&j._slide&&j._dialog.nodes.btnMin.className=="btnMin"){j.toggle()}},60000)}};function b(){var o=document.cookie.match(/(?:ad|dlg)680=(\d+)/);return o?m(o[1])!==m(new Date().getHours()):true}function m(o){if(o>21){return 1}else{if(o>14){return 3}else{if(o>7){return 2}else{return 1}}}}function a(){if(!j._dialog.entity){$callJob("outSearch")}else{if(j._dialog.entity.style.display=="none"){$callJob("outSearch")}}}function n(p){for(var o=0;o<p.length;o++){commonLog&&commonLog(p[o])}}return d};$registJob("tjAd",function(){scope.isFromSearchEngine=Article.getSearchReferrer();var b=window.location.href.indexOf("tj=1")>-1;var d=scope.$pageid.indexOf("articletj")>-1;new blogAd.CommAd();var a=~~(Math.random()*100)%10;var c="http://d"+a+".sina.com.cn";Lib.util.loadScript(c+"/litong/zhitou/sinaads/release/spec/getSinaadsExParamsForBlog.js",function(){});(function(){if(!d&&b){Lib.execZhitou(function(j){var n=Lib.Listener;var m=blogAd.insertIns("PDPS000000049439",$E("trayFlashConnetion").parentNode,"beforebegin");n.notify("topad680-show-start",{});function g(){var o=$E("sinabloga");if(o){var p=$E("ramdomVisitDiv");p&&(p.style.top=o.offsetTop+"px")}}(window.sinaads||[]).push({element:m,params:{sinaads_success_handler:function(){g();n.notify("topad680-show-end",{show:!0})},sinaads_fail_handler:function(){g();n.notify("topad680-show-end",{show:!1})}}})})}Lib.execZhitou(function(g){var j=blogAd.insertIns("PDPS000000051781");j.style.display="none";var m=blogAd.popAd();(window.sinaads||[]).push({element:j,params:{sinaads_success_handler:function(n,p){n.style.display="none";var o;function q(s){var r={};if(p.content[0].src[0].replace(/(^\s*)|(\s*$)/g,"").length===0){r.isAD=false}else{r={isAD:true,flashURL:c+"/litong/kuaijieweibo/yafeng/boke/sc/bk.swf",flashWidth:293,flashHeight:60,picURL:s.content[0].src[0],clickUrl:s.content[0].link[0],borderImg:c+"/litong/kuaijieweibo/yafeng/boke/images/imgbgnn.gif",btnImg:c+"/201007/09/237719_btn.gif",logurls:s.content[0].monitor}}return r}o=q(p);m.renderPopAd(o)},sinaads_fail_handler:function(n,o){n.style.display="none";m.renderPopAd({isAD:false})}}})});if(!d){Lib.checkAuthor();var f=!$isAdmin;if(!f){return}Lib.execZhitou(function(j){var g,q=$E("module_910")||$E("module_911");q&&(g=SinaEx.prev(q));if(!g){var p=$E("module_904")||$E("module_903");var o=p.parentNode.children;if(3>o.length){g=p.parentNode.lastChild}else{g=o[2]}}var m=blogAd.insertIns("PDPS000000055124",g,"afterend");(window.sinaads||[]).push({element:m,params:{sinaads_success_handler:function(){m.style.marginBottom="10px"}}})})}})();(function(){Lib.Listener.on({name:"blogRecommendAfter",callBack:function(f){Lib.execZhitou(function(j){var g=c+"/litong/zhitou/zhangfei/blog/blog_bottom_float.js";Lib.util.loadScript(g,function(){(sinaads=window.sinaads||[]).push({element:m,params:{}})});var m=blogAd.insertIns("PDPS000000052950",document.body)})}})})();(function(){function f(t){if(!t.shareAdBloger||!t.shareAdBloger.result){return}var o=$E("sina_keyword_ad_area2");var u=Core.Dom.byClz(o,"div","blogzz_acon")[0];if(u){o=u}var g,q,p=0,z=0,j,s,v=280;function y(A){return("textContent" in A)?A.textContent:A.innerText}function n(A){var B=A.getAttribute("real_src")||"";if(B.indexOf("http://www.sinaimg.cn/uc/")===0){return false}else{if(0==B.indexOf("http://simg.sinajs.cn/blog7style/")){return false}}return true}function m(C){var D=C.getElementsByTagName("img");for(var B=0,A=D.length;B<A;B++){if(n(D[B])){return true}}return false}for(var r=o.children.length-1;r>=0;r--){g=o.children[r];if(!m(g)){s=y(g);z+=s.length;p+=g.offsetHeight}else{p=0;z=0}if(r>1&&(p>v)){j=g;break}}q=$C("div");q.style.cssText="display: none; width: 200px; height: 300px; margin: 10px 20px 10px 0px; float: left; overflow: hidden; clear: both; padding: 4px; border: 1px solid rgb(205, 205, 205);";if(!j){o.appendChild(q)}else{o.insertBefore(q,j)}Lib.execZhitou(function(A){var B=blogAd.insertIns("PDPS000000053083",q);(sinaads=window.sinaads||[]).push({element:B,params:{sinaads_success_handler:function(){q.style.display="block"},sinaads_fail_handler:function(){}}})})}if(!scope.$channel){Lib.Listener.on({name:"ad_show_hide_conditions",callBack:function(g){f(g)}})}else{f(scope.$channel)}})()});Utils.Io.TimeoutJsLoad=function(a,b){this._opts={url:"",charset:"utf-8",noreturn:false,noencode:false,timeout:-1,GET:{},onComplete:null,onException:null,type:"blogScript",jsonpParamName:"callback"};if(!a||typeof a!=="string"){throw new Error("url参数不能为空!")}this._opts.url=a;this.isAborted=false;this.scriptIdentifier="";this.varname="";this.loadComplete=false;this.timeObj;Core.System.parseParam(this._opts,b);this.loadScript()};Utils.Io.TimeoutJsLoad.prototype={constructor:Utils.Io.TimeoutJsLoad,__jsonpCounter:(new Date()).getTime(),loadScript:function(){var d=this._opts,b=$C("script"),c=$T(document,"head")[0],g=this,f=this._processUrl();b.async=true;b.src=d.url;b.charset=d.charset;b.id="script"+this.scriptIdentifier;if(d.type==="jsonp"){window[f]=a}else{if(d.type==="blogScript"){b.onload=b.onerror=b.onreadystatechange=a}}function a(n){var m=d.type;if(m==="blogScript"&&b&&b.readyState&&b.readyState!="loaded"&&b.readyState!="complete"){return}g.loadComplete=true;if(m==="jsonp"){window[f]=undefined;try{delete window[f]}catch(j){}}else{if(m==="blogScript"){b.onload=b.onreadystatechange=b.onerror=null}}c.removeChild(b);if(!g.isAborted&&typeof d.onComplete==="function"){g.timeObj&&clearTimeout(g.timeObj);d.onComplete(m==="blogScript"?window[g.varname]:n)}}c.insertBefore(b,c.firstChild);if(d.timeout>0){this.timeObj=setTimeout(function(){g.abortRequest()},d.timeout)}},abortRequest:function(){if(this.loadComplete){return}this.isAborted=true;if(/opera/i.test(navigator.userAgent)&&$E("script"+this.scriptIdentifier)){$E("script"+this.scriptIdentifier).src=""}typeof this._opts.onException==="function"&&this._opts.onException()},_processUrl:function(){var d=this._opts,a=d.url,g=d.GET,c,b=window.parseInt(Math.random()*100000000),f=new Utils.Url(a);for(c in g){f.setParam(c,d.noencode===true?g[c]:Core.String.encodeDoubleByte(g[c]))}this.scriptIdentifier=b;if(d.type==="blogScript"){this.varname=f.getParam("varname")||"requestId_"+b;d.noreturn!==true&&f.setParam("varname",this.varname)}else{if(d.type==="jsonp"){var j="jsonp"+this.constructor.prototype.__jsonpCounter++;f.setParam(d.jsonpParamName,j)}}d.url=f.toString();return j}};$registJob("tranVideo",function(){function m(){var n=navigator.userAgent.toLowerCase();return{isIpad:n.match(/ipad/i)!=null,isIphone:n.match(/iphone/i)!=null,isIpod:n.match(/ipod/i)!=null}}var g=m();if(!(g.isIpad||g.isIphone||g.isIpod)){return}var d=Utils.Io.JsLoad.request;var j=Utils.Io.TimeoutJsLoad;var b=Core.Dom.insertHTML;var c=Core.String.j2o;var a={getVid:function(p){var o=new RegExp("vid=([^&]*)?&","i");var n=p.match(o);if(n){return n[1]||""}else{return""}},createVideoTag:function(n){var o="http://video.sina.com.cn/api/getIpadUrl.php?url="+encodeURIComponent(n.src.replace(".swf",""));new j(o,{type:"blogScript",GET:{rmd:Math.random()},onComplete:function(q){if(q.ipad_url==""){return}n.style.display="none";var p=$C("video");p.className="video";p.setAttribute("width","482px");p.setAttribute("height","388px");p.setAttribute("controls","controls");p.setAttribute("src",q.ipad_url);n.parentNode.insertBefore(p,n)},onException:Function()})}};allEmbed=document.getElementsByTagName("embed");for(var f=0;f<allEmbed.length;f++){if((allEmbed[f].src.indexOf("http://p.you.video.sina.com.cn")!=-1)||(allEmbed[f].src.indexOf("http://you.video.sina.com.cn")!=-1)){a.createVideoTag(allEmbed[f])}}});$registJob("errorTips",function(){Lib.checkAuthor();function a(b){var c=$C("div");c.innerHTML=b;return c.firstChild}if($isLogin){Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/warning.php",{GET:{uid:$UID},onComplete:function(n){var c,b;if(n&&n.iswarning==1){var d=Utils.Cookie.getCookie("i8t9c"+$UID)!==n.date?"block":"none";var g='<div id="err_i8t9c" class="tb_layer_Y tb_layer_w6" style="display:'+d+';z-index:500;position:absolute;top:-300px;"><div class="tb_layer_arrow" style="margin:0 0;left:219px"></div><div class="tb_layer_Y_main"><div class="tb_mas"><span style="float:right;"><a class="conn" href="javascript:;" onclick="scope.i8t9c()">×</a></span></div><div class="tb_mas">'+n.msg+'<p style="text-align:center;padding:6px;"><input type="button" value="知道了" onclick="scope.i8t9c()" /></p></div></div></div></div>';scope.i8t9c=function(){$E("err_i8t9c").style.display="none";Utils.Cookie.setCookie("i8t9c"+$UID,n.date,8760,"/");Utils.Cookie.setCookie("i8t9c"+$UID,n.date,8760,"/","blog.sina.com.cn")};scope.i8t9c.show=function(){$E("err_i8t9c").style.display="";o()};c=a(g);document.body.appendChild(c);var m=$E("loginBarActivity"),f;b=a('<div class="topbar_activity"><a href="javascript:;" onclick="scope.i8t9c&&scope.i8t9c.show();">[公告]</a></div>');m.parentNode.insertBefore(b,m);setTimeout(o,10);Core.Events.addEvent(window,function(){o()},"resize");var j=document.documentElement.scrollTop+document.body.scrollTop}function o(){var q=Core.Dom.getXY(b);var p=c.offsetWidth;c.style.visibility="inherit";c.style.top=q[1]+23+"px";c.style.left=q[0]-p+41+"px"}}})}});var ReblogToQing=Core.Class.create();ReblogToQing.prototype={saving:false,blogId:"",initialize:function(){},reblog:function(a){this.blogId=a;if(!this.blogId){throw new Error("转载博文ID未定义")}this.checkUser(this.blogId)},checkUser:function(a){this.blogId=a||scope.$blogId;Lib.checkAuthor();var b=this;if(!$isLogin){v7sendLog("48_01_32");new Lib.Login.Ui().login(function(){scope.blogOpener.showDialog(function(){b.save.bind2(b)()})})}else{var b=this;scope.blogOpener.showDialog(function(){b.save()})}},save:function(){var c=this;if(this.saving){return}this.saving=true;var d={version:7,blogId:c.blogId,rnd:(+new Date)};var b=function(){winDialog.alert("对不起，系统繁忙请稍后！",{icon:"01",funcOk:function(){}})};var a="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/share2qing.php?rnd="+(+new Date);Utils.Io.Ijax.request(a,{POST:d,returnType:"json",onComplete:function(f){this.saving=false;if(!f){b();return}try{f=(new Function("return "+f))()}catch(g){b()}if("A00006"==f.code){winDialog.alert(["已成功转载到Qing博客！<br/><span style='font-weight: 100; font-size: 12px;'>",f.data.qingId?"<a target='_blank' href='"+$_GLOBAL.qingURL+f.data.userId+"/"+f.data.qingId+".html'>去查看已转载的文章>></a>":"","</span>"].join(""),{icon:"03"});c.onSuccess(f,d)}else{if("A00420"==f.code){c.showOpenQingWnd()}else{if("A00421"==f.code){c.showShareToQingFailure()}else{b()}}}}.bind2(this),onException:function(f){this.saving=false;if(!f){b();return}}.bind2(this)})},showOpenQingWnd:function(){var a=winDialog.createCustomsDialog({content:['<div class="CP_layercon2 unilayer">','<div class="CP_prompt toQing">','<table class="CP_w_ttl"><tbody><tr><td>您的新浪博客账号未开通Qing。开通后可转载到Qing中。</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a id="#{openQing}" class="SG_aBtn SG_aBtnB" href="'+$_GLOBAL.qingURL+'home" target="_blank"><cite>开通Qing</cite></a>','&nbsp;&nbsp;<a id="#{cancel}" class="SG_aBtn SG_aBtnB" href="javascript:void(0);"><cite>取消</cite></a></p>',"</div>","</div>"].join(""),shadow:1},"openQing");a.setMiddle();a.show();a.nodes.openQing.onclick=function(){setTimeout(function(){a.close();a.onclick=null;a=null},200)};a.nodes.cancel.onclick=function(){setTimeout(function(){a.close();a.onclick=null;a=null},200)}},showShareToQingFailure:function(){var a="对不起，转载至Qing博客失败。";winDialog.alert(a,{icon:"01",funcOk:function(){}})},onSuccess:function(a){},onError:function(){}};$registJob("renderReblogDiv",function(){var _addEvent=Core.Events.addEvent,_getEventTarget=Core.Events.getEventTarget,_getXY=Core.Dom.getXY,delegateEl,delegateElId,cls="",isNew=(scope.$pageid=="article_new"||scope.$pageid=="articleM_new"),reblogDivId="reblog_"+(+new Date);if(isNew){cls="oper_list"}var reblogDivInnerHTML='<ul class="'+cls+'"><li><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'toQing\'}" href="javascript:void(0);" title="转载到Qing博客">'+(isNew?"":'<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon205"/>')+'Qing</a></li><li><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载到博客">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>')+'博客</a></li><li style="display:none;"><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载原文">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>')+'转载原文</a></li><li style="display:none"><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'editor\'}" href="javascript:void(0);" title="采编">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>')+'采编</a></li><li><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'cwb\'}" href="javascript:;" title="发布长微博">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon143"/>')+"长微博</a></li></ul>";var reblogDiv=SinaEx.createNode('<div id="'+reblogDivId+'" class="turnList" style="display:none;position:absolute;z-index:20;">'+reblogDivInnerHTML+"</div>");document.body.appendChild(reblogDiv);var getActionData=Lib.util.getActionData;var sinablogbody=$E("sinablogbody");var idCard,reblogBtn;var isIdCard=false;var isValidateIdentity=0;var onMouseOverReblogBtn=function(e){var srcEl=$E(this.id),tEl=_getEventTarget(e);var eventData=getActionData(e,"reblog");if(!eventData){return}$E("sinablogbody").setAttribute("ismouseover","1");var data=eval("("+eventData.data+")");reblogBtn=eventData.targetEl.parentNode.parentNode;setTimeout(function(){var isMouseHover=$E("sinablogbody").getAttribute("ismouseover")||0;isMouseHover=parseInt(isMouseHover)||parseInt($E(reblogDivId).getAttribute("ismouseover")||0);if(!isMouseHover){return}if(isNew){eventData.targetEl.className="lk_a lka_last lka_hover"}var reblogDiv=$E(reblogDivId),pos=_getXY(eventData.targetEl);reblogDiv.style.display="";reblogDiv.style.top=(pos[1]+23)+"px";if($IE6||$IE7){reblogDiv.style.left=(pos[0]-2)+"px"}else{reblogDiv.style.left=pos[0]+"px"}reblogDiv.setAttribute("blogId",data.blogId);Lib.checkAuthor();var editorState=reblogDiv.children[0].children[3].children[0];if(!reblogBtn.getAttribute("isreblog")){editorState.innerHTML=isNew?"采编":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>采编'}else{editorState.innerHTML=isNew?"已采编":'<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编'}var sameVariable=reblogDiv.children[0];setTimeout(function(){if(data.srcBlog){reblogDiv.children[0].children[2].style.display="none";if($isAdmin){sameVariable.children[1].style.display="none"}else{sameVariable.children[1].style.display=""}}else{sameVariable.children[1].style.display="none";if($isAdmin){sameVariable.children[2].style.display="none"}else{sameVariable.children[2].style.display=""}}if(data.srcBlog=="0"){reblogDiv.children[0].children[3].style.display="none"}if(isIdCard&&reblogBtn.getAttribute("isshow")){return}if(data.srcBlog=="1"&&$isLogin){if(isValidateIdentity){return}Utils.Io.Ijax.request("http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/qingEditing.php",{onComplete:function(data){var result=Core.String.j2o(data);if(result.code==="A00006"){idCard=result.data.message;if(idCard){sameVariable.children[3].style.display=""}}isIdCard=true;reblogBtn.setAttribute("isshow","1")}})}else{sameVariable.children[3].style.display="none"}},2)},400)};var onMouseOutReblogBtn=function(e){var srcEl=$E(this.id),tEl=_getEventTarget(e);var eventData=getActionData(e,"reblog");if(!eventData){return}$E("sinablogbody").setAttribute("ismouseover","0");var timer=$E("sinablogbody").getAttribute("timer");if(timer){return}var timer=setInterval(function(){var isMouseHover=$E("sinablogbody").getAttribute("ismouseover")||0;var isReblogDivMouseHover=$E(reblogDivId).getAttribute("ismouseover")||0;isMouseHover=parseInt(isMouseHover)||parseInt(isReblogDivMouseHover);if(!isMouseHover){$E(reblogDivId).style.display="none";$E("sinablogbody").removeAttribute("timer");if(isNew){eventData.targetEl.className="lk_a lka_last"}clearInterval(timer)}},1000)};var MOUSEOVER="mouseover";var MOUSEOUT="mouseout";var addModuleMouseEvent=function(moduleId){if(!$E(moduleId)){trace("没有组件："+moduleId);return}try{if(scope.$pageid==="articletjTech"||scope.$pageid=="article_new"||scope.$pageid=="articleM_new"){moduleBody=$E(moduleId);_addEvent(moduleBody,Core.Function.bind2(onMouseOverReblogBtn,moduleBody),MOUSEOVER);_addEvent(moduleBody,Core.Function.bind2(onMouseOutReblogBtn,moduleBody),MOUSEOUT)}var moduleBody=$E(moduleId).children[1];if(moduleBody&&"SG_connBody"==moduleBody.className){moduleBody.id=moduleId+"_SG_connBody";_addEvent(moduleBody,Core.Function.bind2(onMouseOverReblogBtn,moduleBody),MOUSEOVER);_addEvent(moduleBody,Core.Function.bind2(onMouseOutReblogBtn,moduleBody),MOUSEOUT)}}catch(e){trace("注册转载博问按钮事件代理出错，组件ID："+moduleId)}};addModuleMouseEvent("module_10001");addModuleMouseEvent("module_10002");addModuleMouseEvent("module_10003");addModuleMouseEvent("module_920");addModuleMouseEvent("module_921");addModuleMouseEvent("module_3001_SG_connBody");addModuleMouseEvent("module_920_SG_connBody");var onMouseOverReblogDiv=function(e){$E(reblogDivId).setAttribute("ismouseover",1)};var onMouseOutReblogDiv=function(e){$E(reblogDivId).setAttribute("ismouseover",0)};_addEvent(reblogDiv,onMouseOverReblogDiv,MOUSEOVER);_addEvent(reblogDiv,onMouseOutReblogDiv,MOUSEOUT);!scope.article_quote&&(scope.article_quote=new Quote());scope.articel_quote_alert=function(articleID){scope.article_quote.check(articleID)};function showError(icon,ico){if(icon.message){var msg=icon.message}winDialog.alert(msg,{icon:ico||"01"})}var reblogToQing=new ReblogToQing();var reblog=function(e){var srcEl=$E(reblogDivId),tEl=_getEventTarget(e);var eventData=getActionData(e,"click_reblog");if(!eventData){return}if(reblogBtn.getAttribute("isreblog")==="1"){return}var blogId=$E(reblogDivId).getAttribute("blogId"),data=eval("("+eventData.data+")");if("toQing"===data.action){reblogToQing.reblog(blogId)}else{if("cwb"===data.action){window.open("http://control.blog.sina.com.cn/admin/article/changWeiBo.php?url="+encodeURIComponent("http://blog.sina.com.cn/s/blog_"+blogId+".html"))}else{if("editor"===data.action){winDialog.confirm("确定采编至 #"+idCard+" 标签下",{icon:"04",funcOk:function(){var url="http://control.blog.sina.com.cn/blog_rebuild/riaapi/blog/editing2qing.php?rnd="+(+new Date);Utils.Io.Ijax.request(url,{POST:{blogId:blogId},returnType:"json",onComplete:function(data){var result=Core.String.j2o(data);if(result&&result.code==="B00015"){winDialog.alert("采编 #"+idCard+" 成功",{icon:"03"});tEl.innerHTML='<img width="18" height="18" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon142"/>已采编';reblogBtn.setAttribute("isReblog","1")}else{if(result&&result.code){showError(result.data,"01")}else{winDialog.alert("系统繁忙，请稍后在试！",{icon:"01"})}}}})},funcClose:function(){},textOk:"确定",isAdamant:$IE})}else{scope.articel_quote_alert(blogId)}}}v7sendLog&&v7sendLog("79_01_22",scope.$pageid,"qingLink")};_addEvent(reblogDiv,reblog,"click");reblogDiv=null;delegateEl=null});Core.Dom.findNode=function(a,d,c){for(var b=a[c];b;b=b[d]){if(b.nodeType==1){return b}}return null};Core.Dom.nextNode=function(a){return Core.Dom.findNode(a,"nextSibling","nextSibling")};blogAd.shareToWeibo=function(b){var c=new Utils.Url("http://v.t.sina.com.cn/share/share.php"),a=encodeURIComponent;if(b.clickCode){new Image().src=b.clickCode}for(var d in b){if(b.hasOwnProperty(d)){c.setParam(d,a(b[d]))}}if(!b.title){c.setParam("title",a(b.title||document.title))}c.setParam("content","utf-8");var f=function(){c=c.toString();if(!window.open(c,"mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join(""))){location.href=c}};if(/Firefox/.test(navigator.userAgent)){setTimeout(f,0)}else{f()}};blogAd.nickTrayAd=function(g,m){m.innerHTML=g.adLink;var o=this,n=['<div id="#{entity}" class="tips_layer1 tips_bg_a" style="z-index:150;position:absolute;top:23px;left:0px;display:none;">','<div id="#{body}" class="tips_bd">','<a id="#{imageLink}" href="" class="link" title="" target="_blank"></a>','<div class="tips_detail"> <span id="#{closeBtn}" class="close" title="关闭">×</span>','<p id="#{userNick}" class="tips_nickname"></p>','<p id="#{tipsTitle}" class="tips_txt"></p>','<p id="#{tipsTxtLink}" class="tips_ad"></p>','<p id="#{tipsBtn}" class="tips_btn"></p>',"</div>","</div>","</div>"].join("");this.relativeNodeId=m.id;this.MARK_ID=1;this.LIMITED=24;var b=this.nodes=this.getTemplateNodes(n);Core.Dom.insertAfter(b.entity,document.body.lastChild);if($IE6&&g.ie6BackgroundPic){b.entity.style.backgroundImage="url("+g.ie6BackgroundPic+")"}else{if(g.backgroundPic){try{b.entity.style.backgroundImage="url("+g.backgroundPic+")"}catch(f){}}}b.imageLink.href=g.imageLinkHref;var a=typeof $nick;if("undefined"==a){a="亲爱的网友"}else{a=$nick}b.userNick.innerHTML="HI，"+a.replace(/</g,"&lt;");b.tipsTitle.innerHTML=g.tipsTitle;if(g.tipsTxtLink){b.tipsTxtLink.innerHTML=g.tipsTxtLink}var j=b.tipsTxtLink.children[0],c=j.style;if(!$IE6&&g.tipsTxtLinkBgPic){c.backgroundImage="url("+g.tipsTxtLinkBgPic+")";c.backgroundRepeat="no-repeat"}else{if($IE6&&g.ie6TipsTxtLinkBgPic){c.backgroundImage="url("+g.ie6TipsTxtLinkBgPic+")";c.backgroundRepeat="no-repeat"}}b.tipsBtn.innerHTML=g.tipsBtn;Core.Events.addEvent(b.closeBtn,function(){o.hide();scope.$channel=null;var p=g.status.adclose;if(p){new Image().src=p}},"click");setTimeout(function(){o.setPos();o.show();o.initResizeEvent()},15);var d=g.status&&g.status.adclose;Core.Events.addEvent(b.entity,function(r){var s=r.target||r.srcElement,p=b.entity;do{if("A"===s.nodeName.toUpperCase()&&(-1!=s.href.indexOf("http"))){o.hide();scope.$channel=null;var q=g.status.adclose;if(q){new Image().src=q}break}}while(s&&(s==p))},"click");if(g.status.adstart){new Image().src=g.status.adstart}if(!g.blogTip){commonLog("http://1090.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tip&db=sina&border=0&local=yes&js=ie")}else{v7sendLog(g.logCode)}}.$defineProto({setMark:function(){var a=new Date().getHours();var b=24-a;Utils.Cookie.setCookie("blogTipsAd",1,b,"/",".blog.sina.com.cn")},setPos:function(){var c=$E(this.relativeNodeId);var d=Core.Dom.getXY(c);var b=c.offsetWidth,a=this.nodes.entity.style;a.left=parseInt(d[0])+(b-100)+"px";a.top=parseInt(d[1])+23+"px"},show:function(){this.isHidden=false;var b=this.nodes.entity,c=Core.Dom.setStyle;var a=new Ui.TweenStrategy(0,1,0.5,function(g,f,m,j){return -m*(g/=j)*(g-2)+f});a.onTween=function(d){c(b,"opacity",d)};a.onEnd=function(){if(!$IE){c(b,"opacity","none")}else{b.style.filter="none"}};c(b,"opacity",0);b.style.display="block";a.start()},hide:function(){this.setMark();this.isHidden=true;var b=this.nodes.entity,c=Core.Dom.setStyle;var a=new Ui.TweenStrategy(1,0,0.5,function(g,f,m,j){return -m*(g/=j)*(g-2)+f});a.onTween=function(d){c(b,"opacity",d)};a.onEnd=function(){if(!$IE){c(b,"opacity","none")}else{b.style.filter="none"}b.style.display="none"};a.start()},initResizeEvent:function(){var a=this;Core.Events.addEvent(window,function(){if(!a.isHidden){a.setPos()}},"resize")}}).$mixProto(Lib.templateUtils);blogAd.loadNickTrayAd=function(g){var f=Lib.Listener;var m=$E("loginBarActivity")||$E("divPopularize");var c=m.getAttribute("shouldShow"),b=new Date().getDay(),j=Utils.Cookie.getCookie("blogTipsAd");m.style.display="";var d=(b==1||b==3||b==5);if(!d){return}if(j){return}var a="http://simg.sinajs.cn/blog7style/css/module/layer/layer20.css";Utils.Io.loadExternalCSS(a,function(){if(g){if(!g||!g.isShow){return}if(g.logCode){g.logCode=g.logCode+"|"+$UID}blogAd.trayAdHandle=new blogAd.nickTrayAd(g,m);m=null}})};$registJob("trayTipsAd",function(){var f=Lib.Listener;var c,b,d;var a=function(g){g=g&&g.weicaopan&&g.weicaopan.weicaopan_con;Lib.execZhitou(function(){function q(v){var y=s.firstChild,u=v?"":"none";while(y){if("a"===y.nodeName.toLowerCase()){y.style.display=u}y=y.nextSibling}}var s=$E("loginBarActivity")||$E("divPopularize");s.style.display="";var m=s.parentNode;var t=m.parentNode.offsetHeight,n,o;q(false);if("none"===m.style.display){m.style.position="absolute";m.style.top="-40px";m.style.display="";o=Core.Dom.getXY(s);var j=$E("login_bar_logo_link_350");j.style.display="";var p=j.children[0].offsetWidth;n=p+o[0];if(c){t+=90}m.style.position="";m.style.top="";m.style.display="none";j.style.display="none"}else{o=Core.Dom.getXY(s);t+=o[1];n=o[0]}var r=blogAd.insertIns("PDPS000000033238",s);(window.sinaads||[]).push({element:r,params:{sinaads_tip_top:t,sinaads_tip_left:n,sinaads_success_handler:function(){q(false);window.BLOG_AD_TIPS=1},sinaads_fail_handler:function(){q(true);blogAd.loadNickTrayAd(g)},sinaads_ad_zindex:590}})});f.off({name:"ad_show_hide_conditions",callBack:a});a=null};f.on({name:"ad_show_hide_conditions",callBack:function(g){if("undefined"!==typeof c){a(g)}else{d=g}b=!0}});f.on({name:"topad680-show-end",callBack:function(g){c=g.show;if(b){a(d)}}})});SinaEx.enterLeave=function(b,c,g,f){var j=Core.Events.addEvent,d=null,m=0,a=0;c=c||function(){};g=g||function(){};f=f||0;j(b,function(n){clearTimeout(a);var p=n||window.event,o=p.target||p.srcElement;m=setTimeout(function(){if(d&&SinaEx.contains(d,o)){return}var q=SinaEx.parent(o,"li");if(q){if(d){g(d)}c(q);d=q}else{if(d){g(d);d=null}}},f)},"mouseover");j(b,function(){clearTimeout(m);a=setTimeout(function(){if(d){g(d);d=null}},f)},"mouseout")};$registJob("qingRecommend",function(){var q=$E("qingRecWindow");if(!q){return}var g=0,f=0,d=$T($E("qingRecPic"),"img"),j=d.length,m=0,n=$IE?5:2,p=0;var c=Core.Dom.opacity;b();SinaEx.enterLeave($E("qingRecPic"),function(s){var t=s.getAttribute("noo");r(t)},function(s){},100);function r(t){t=parseInt(t);if(m===t){return}clearTimeout(g);clearTimeout(f);SinaEx.removeClass(SinaEx.parent(d[m],"li"),"current");SinaEx.addClass(SinaEx.parent(d[t],"li"),"current");c(q,0);var s=d[t];if($E("module_911")){if(t==0){q.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_49" href="'+s.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(s.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+s.getAttribute("bigsrc")+'" /><span>'+(s.getAttribute("alt")||"")+"</span></a>"}else{if(t==1){q.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_50" href="'+s.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(s.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+s.getAttribute("bigsrc")+'" /><span>'+(s.getAttribute("alt")||"")+"</span></a>"}else{if(t==2){q.innerHTML='<a suda-uatrack="key=blog_qing_g&value=h_SLOT_51" href="'+s.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(s.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+s.getAttribute("bigsrc")+'" /><span>'+(s.getAttribute("alt")||"")+"</span></a>"}}}}else{q.innerHTML='<a href="'+s.parentNode.href+'" target="_blank" onclick="v7sendLog(\''+(s.parentNode.getAttribute("bigcode")||"00_00_qzj")+'\');return true;"><img src="'+s.getAttribute("bigsrc")+'" /><span>'+(s.getAttribute("alt")||"")+"</span></a>"}p=30;o();m=t;f=setTimeout(a,5000)}function o(){c(q,p);p+=n;if(p<100){g=setTimeout(o,15)}else{c(q,100)}}function a(){var s=m+1;s>=j&&(s=0);r(s)}function b(){for(var t=0,s;t<j;t++){s=SinaEx.parent(d[t],"li");s&&s.setAttribute("noo",t)}setTimeout(function(){q.style.background="";a()},5000)}});$registJob("qingRecomNew",function(){var r=$E("qingRecNew");if(!r){return}var j=0,g=0,f=$E("qingRecPic").children,m=f.length,n=0,o=$IE?5:2,q=0;var c=Core.Events.addEvent,d=Core.Dom.opacity;for(var b=0;b<m;b++){(function(u){var v=0;c(f[u],function(){v=setTimeout(function(){s(u)},100)},"mouseover");c(f[u],function(){clearTimeout(v)},"mouseout")})(b)}function s(u){if(n===u){return}clearTimeout(j);clearTimeout(g);var t=f[u];SinaEx.removeClass(f[n],"current");SinaEx.addClass(t,"current");d(r,0);r.innerHTML='<a href="'+t.getAttribute("imghref")+'" target="_blank" onclick="v7sendLog(\''+(t.getAttribute("imgcode")||"00_00_qzj")+'\');return true;"><img src="'+t.getAttribute("imgsrc")+'" /><span>'+t.getAttribute("imgtitle")+"</span></a>";q=30;p();n=u;g=setTimeout(a,3000)}function p(){d(r,q);q+=o;if(q<100){j=setTimeout(p,15)}else{d(r,100)}}function a(){var t=n+1;t>=m&&(t=0);s(t)}r.children[0].innerHTML='<img src="'+f[0].getAttribute("imgsrc")+'" /><span>'+f[0].getAttribute("imgtitle")+"</span>";r.style.background="";setTimeout(a,3000)});$registJob("adNoticeChannel",function(){var g=Core.Events.addEvent;var f=Lib.Listener,c=scope.$pageid;var j=window.location.href.indexOf("tj=1")>-1;var b=document.referrer;if(b){var d=b.match(/(\:\/\/)(.*?)(\/)/g);b=d&&d[0].replace(/(\:\/\/){0,}(\/){0,}/g,"")}else{b=""}Lib.checkAuthor();var a="http://comet.blog.sina.com.cn/api?maintype=load_channel";Utils.Io.JsLoad.request(a,{GET:{uid:$UID,bloguid:scope.$uid,refer:b},onComplete:function(m){if(m&&m.code==="A00006"){scope.$channel=m.data;if((c=="article_new"||c=="articleM_new"||c==="article"||c==="articleM"||c==="index"||c==="indexM"||c==="articlelist"||c==="articlelistM"||c==="wanwan_index"||c==="articlepreview_new")){f.notify("notice_ad_layer",scope.$channel||{})}f.notify("ad_show_hide_conditions",scope.$channel||{})}}})});(function(){var a=function(d){var b=d.split("-");var f=b[0];for(var c=1;c<b.length;c++){f+=b[c].charAt(0).toUpperCase()+b[c].substring(1)}return f};Core.Dom.setStyle2=function(d,c){if(typeof d=="string"){d=$E(d)}for(var b in c){styleAttr=a(b);Core.Dom.setStyle(d,styleAttr,c[b])}}})();$registJob("blogNotice",function(){var r=$E("login_bar_logo_link_350");var o=Core.Events.addEvent,F=Core.Events.removeEvent,C=Utils.Cookie.setCookie,t=Utils.Cookie.getCookie,s=Core.Dom.setStyle,j=Lib.Listener,B,n;var d=t("closeNotice_fzp");Lib.checkAuthor();if(d&&d===$UID){return}var g=scope.$pageid,p=scope.$uid,y=window.location.href.indexOf("tj=1")>-1;if(r&&"ntopbar_main"===r.parentNode.className){j.on({name:"notice_ad_layer",callBack:function(H){j.notify("tray-announce-loaed",H)}});return}else{var b;var E=document.documentElement;var z={guideLayer:'<div class="l_hornbg" id="#{guideLayer}" style="display:none;"><div class="l_horn"><span class="close" title="关闭" id="#{close}">&times;</span><div class="horn1" id="#{noticeLayer}" style="display:none;"><div class="horn_left"><span class="horn_icon" id="#{noticeIcon}"></span></div><div class="horn_right" id="#{noticeAdLayer}">推荐：<a href="" target="blank" id="#{noticeAdCon1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{noticeAdCon2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div><div class="horn2" id="#{adLayer}">推荐：<a href="" target="blank" id="#{adContent1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{adContent2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div></div>'};var a={mid:{"z-index":"500",position:$IE6?"absolute":"fixed"}};var q=$_GLOBAL.cssBasicURL+"module/layer/layer24.css";Utils.Io.loadExternalCSS(q);var c=function(H){b=Utils.insertTemplate($E("sinabloga"),z.guideLayer,"BeforeBegin");A(b.guideLayer);if($IE6){b.guideLayer.style.position="absolute";E.style.backgroundImage="url(ablout:blank)";E.style.backgroundAttachment="fixed";o(window,m,"scroll")}o(window,u,"scroll");G(H)};j.on({name:"notice_ad_layer",callBack:c});function G(L){if($isLogin&&L.announce.result&&(g==="indexM"||g==="articleM"||g==="articlelistM")){b.noticeLayer.style.display="";b.adLayer.style.display="none";var M=L.announce;Core.Dom.insertHTML(b.noticeIcon,M.announce_con,"AfterEnd")}else{b.adLayer.style.display=""}if(L.advertise){var K=L.advertise;var N=decodeURIComponent(K.advertise_con1.content),H=decodeURIComponent(K.advertise_con2.content),I=decodeURIComponent(K.advertise_con1.link),J=decodeURIComponent(K.advertise_con2.link);b.noticeAdCon1.innerHTML=N;b.noticeAdCon1.href=I;b.noticeAdCon2.innerHTML=H;b.noticeAdCon2.href=J;b.adContent1.innerHTML=N;b.adContent1.href=I;b.adContent2.innerHTML=H;b.adContent2.href=J;if(b.close){o(b.close,function(){C("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn");D()})}}}function u(){var H=document.body.scrollTop+document.documentElement.scrollTop;if(H>height){f(b.guideLayer);if(!$IE6){b.guideLayer.style.top="0"}if(!B){B=1;v7sendLog("48_01_11_"+scope.$pageid)}}else{v(b.guideLayer)}}function D(){Core.Dom.removeNode(b.guideLayer);F(window,u,"scroll");F(window,m,"scroll");scope.$channel=null}function A(H){Core.Dom.setStyle2(H,a.mid)}function m(){b.guideLayer.style.top=document.documentElement.scrollTop+"px";b.guideLayer.style.left=0+"px"}function f(I){if(!n){n=1;var H=new Ui.TweenStrategy(0,1,0.6,function(K,J,M,L){return -M*(K/=L)*(K-2)+J});H.onTween=function(J){s(I,"opacity",J)};H.onEnd=function(){if(!$IE){s(I,"opacity","none")}else{I.style.filter="none"}};s(I,"opacity",0);I.style.display="block";H.start()}}function v(I){if(n){n=0;var H=new Ui.TweenStrategy(1,0,0.6,function(K,J,M,L){return -M*(K/=L)*(K-2)+J});H.onTween=function(J){s(I,"opacity",J)};H.onEnd=function(){if(!$IE){s(I,"opacity","none")}else{I.style.filter="none"}I.style.display="none"};H.start()}}}});$registJob("trashPv",function(){});Ui.LayerCount=(function(){var b=500;var a=1024;return function(c){if("mode"===c){return a}else{b+=24}return b>a?a-50:b}})();Lib.OnlyShadow=function(d,c,g,b){this.entity=null;this.parent=c||document.body;b=Lib.apply({zIndex:1024,backgroundColor:"black"},b);this._ie6Fixed=function(){if(f.entity){f.entity.style.top=document.documentElement.scrollTop+"px";var n=(document.documentElement.scrollLeft-f._ie6EntityXY[0]);var m=n+f.entity.offsetWidth;var j=(document.documentElement.scrollWidth||document.body.scrollWidth);if(m<=j){f.entity.style.left=n+"px"}if(f.ifm){f.ifm.style.top=f.entity.style.top;if(m<=j){f.ifm.style.left=f.entity.style.left}}}};var f=this;this.resetShadowDiv=Core.Function.bind3(function(){if(f.entity){setTimeout(function(){f.updateSize();if($IE6&&f.isShow()){f.entity.style.left="0px";var j=Core.Dom.getXY(f.entity);f._ie6EntityXY=j;f._ie6Fixed()}},1)}},this);this._create=function(){f.entity=$C("div");if(g){f.entity.id=g}f.entity.style.position="absolute";f.entity.style.width=f.getAreaWidth()+"px";f.entity.style.height=f.getAreaHeight()+"px";f.entity.style.left="0px";f.entity.style.top="0px";f.entity.style.zIndex=b.zIndex;f.entity.style.backgroundColor=b.backgroundColor;f.parent.appendChild(f.entity);f._setOpacity(f.entity,isNaN(d)?0.5:d);if($IE6){var m=Core.Dom.getXY(f.entity);f._ie6EntityXY=m;var j=(document.documentElement.scrollLeft-f._ie6EntityXY[0]);f.entity.style.left=j+"px"}f.addIframe();Core.Events.addEvent(window,f.resetShadowDiv,"resize");f.setFixed(true);f.hidden()};(function a(){if(g&&$E(g)){f.entity=$E(g)}else{f._create()}})()};Lib.OnlyShadow.prototype={isShow:function(){return this.entity.offsetHeight>0?true:false},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display=""}if($IE6){this.updateSize();this.entity.style.left="0px";var a=Core.Dom.getXY(this.entity);this._ie6EntityXY=a;this._ie6Fixed()}this.onShow()},hidden:function(){this.entity.style.display="none";if(this.ifm){this.ifm.style.display="none"}this.onHidden()},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");Core.Events.removeEvent(window,this.resetShadowDiv,"resize");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},addIframe:function(){this.ifm=$C("iframe");this._setOpacity(this.ifm,0);this.ifm.style.position="absolute";this.ifm.style.zIndex=this.entity.style.zIndex;this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;this.ifm.style.width=this.entity.style.width;this.ifm.style.height=this.entity.style.height;this.entity.parentNode.insertBefore(this.ifm,this.entity)},insertBefore:function(a){a.parentNode.insertBefore(this.entity,a);if(this.ifm){this.entity.parentNode.insertBefore(this.ifm,this.entity)}},updateSize:function(){var a=this.getAreaWidth();var b=this.getAreaHeight();this.entity.style.width=a+"px";this.entity.style.height=b+"px";if(this.ifm){this.ifm.style.width=a+"px";this.ifm.style.height=b+"px"}},getAreaHeight:function(){var a=Math.max(document.documentElement.clientHeight,document.body.clientHeight);return a},getAreaWidth:function(){var a=document.documentElement.clientWidth||document.body.clientWidth;return a},setFixed:function(a){if($IE6){var b=this;if(a){b._ie6Fixed();Core.Events.addEvent(window,b._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,b._ie6Fixed,"scroll")}}else{this.entity.style.position=a?"fixed":"absolute"}},_setOpacity:function(b,a){if($IE){b.style.filter="alpha(opacity="+a*100+")"}else{b.style.opacity=a}},onShow:function(){},onHidden:function(){}};Article.SlideTJCover=function(f){var b=arguments;var p=b.callee._instance;this.cfg=f=Lib.apply(this.cfg||{},f);if(p){return p}var d=this;b.callee._instance=this;var B=function(I,H,o){var F=new Image();F.src=H;$E(I).setAttribute("blogId",o);var G=function(L,J){var K=$E(L).getAttribute("blogId");if(K===o){$E(L).src=J}};if(F.complete){$E(I).src=H}else{$E(I).src=c;F.onload=function(){G(I,H)};F.onerror=function(){$E(I).src="http://s4.sinaimg.cn/image/default_cover.gif#4"}}};var j=function(G,H,o){G=$E(G);H=H||"查看原文";if(G.textContent){G.textContent=H}else{G.innerText=H}var F;if(o){F="http://blog.sina.com.cn/s/blog_"+o+".html"}else{F="javascript:;"}G.href=F};var y=function(F,o){var H=(F.offsetHeight-o.offsetHeight)/2;var G=(F.offsetWidth-o.offsetWidth)/2;if(H<0){H=0}o.style.top=H+"px";if(G<0){G=0}o.style.left=G+"px"};var a=function(I){var o=Lib.util.getActionData(I,"show-next-slide");if(!o){return}var H=decodeURIComponent(o.data).split("###");var F=H[0];var G=new Article.MultipleImgLayer();G.showNextSlide(F)};var r=function(K){var F=Lib.util.getActionData(K,"show-next-tj");if(!F){return}var I=decodeURIComponent(F.data).split("###");var G=I[0];var J=I[1]||"";var o=I[2]||"next";var H=new Article.MultipleImgLayer();H.setDirection("next");H.getNextSlideData(G,J,function(L){if(L.pre.blogId||L.next.blogId){s();d.show(L)}else{n(o)}},o);return false};var m=function(H,F,G,o){if(F){$E(H).setAttribute("action-data",encodeURIComponent(F+"###"+G+"###"+o))}};var n=function(o){$E(u[o+"Btn"]).style.visibility="hidden"};var s=function(){$E(u.nextBtn).style.visibility="";$E(u.preBtn).style.visibility=""};var g=function(o){j(u[o+"Title"],"");B(u[o+"Img"],"http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif");m(u[o+"Btn"],"");$E(u[o+"Img"]).style.visibility="hidden";$E(u[o+"Title"]).style.visibility="hidden";n(o)};var t=function(F){var o=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/;var G=F.match(o);if(G){switch(G[1]){case"bmiddle":return F.replace(/\/bmiddle\//,"/cover/");case"mw690":return F.replace(/\/mw690\//,"/cover/");case"middle":return F.replace(/\/middle\//,"/cover/");case"mw600":return F.replace(/\/mw600\//,"/cover/");default:return F}}else{return F}};var c="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif";var A='<div id="#{entity}" class="showEnd" style="position:absolute;visibility:hidden;"><div class="tit"><strong>该篇博文浏览结束</strong><a id="#{review}" href="javascript:;" class="replay" title="重新浏览" hidefocus="true"></a></div><div class="pages"><a id="#{preBtn}" href="javascript:void(0);" class="preview" action-type="show-next-tj" hidefocus="true">&lt;&lt;上一篇</a><a id="#{nextBtn}" href="javascript:void(0);" class="next" action-type="show-next-tj" hidefocus="true">下一篇&gt;&gt;</a></div><div class="content"><ul><li><a id="#{preImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{preImg}" src="'+c+'" /></a><a id="#{preTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li><li class="nomgr"><a id="#{nextImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{nextImg}" src="'+c+'" /></a><a id="#{nextTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li></ul></div></div>';var E=document,v=null,D=new Lib.HtmlTemplate(A);Core.Dom.addHTML(f.renderTo,D.getHtmlString());var u=D.getNodeIds();var q=Core.Events.addEvent;q($E(u.review),(function(){v7sendLog("49_01_06");this.cfg.review(this)}).bind2(this));q($E(u.preBtn),function(){v7sendLog("49_01_07")});q($E(u.nextBtn),function(){v7sendLog("49_01_08")});q($E(u.preImgBtn),function(){v7sendLog("49_01_09")});q($E(u.nextImgBtn),function(){v7sendLog("49_01_10")});q($E(u.entity),a);q($E(u.entity),r);var C={isHidden:true,getEntity:function(){return $E(u.entity)},fixPos:function(){if(!this.isHidden){y(this.cfg.renderTo,this.getEntity())}},show:function(I){var M=$E(u.preImgBtn).parentNode.parentNode.parentNode;var H=$E(u.preBtn).parentNode;if(!I){M.style.display="none";H.style.display="none";I={}}else{M.style.display="";H.style.display=""}var J=this.cfg,K=J.renderTo,G=this.getEntity();if(G.offsetHeight==0||G.offsetWidth==0){return false}y(K,G);this.isHidden=false;G.style.visibility="inherit";var P=$E(u.preTitle),N=$E(u.nextTitle);var Q=false;if(I.pre&&I.pre.images&&(I.pre.images.length>0)){var F=I.pre.blogId;var L=I.pre.publishTime;$E(u.preTitle).style.visibility="inherit";j(P,I.pre.title,F);B(u.preImg,t(I.pre.images[0]),F);$E(u.preImg).style.visibility="inherit";m(u.preBtn,F,L,"pre");$E(u.preBtn).style.visibility="inherit";m(u.preImgBtn,F)}else{Q=true;g("pre")}if(I.next&&I.next.images&&(I.next.images.length>0)){var O=I.next.blogId;var o=I.next.publishTime;$E(u.nextTitle).style.visibility="inherit";j(N,I.next.title,O);B(u.nextImg,t(I.next.images[0]),O);$E(u.nextImg).style.visibility="inherit";m(u.nextBtn,O,o,"next");$E(u.nextBtn).style.visibility="inherit";m(u.nextImgBtn,O)}else{Q=true;g("next")}if(Q){M.style.backgroundImage="none"}else{if(!$IE6){M.style.background="url("+z+") 235px 100px no-repeat"}else{M.style.backgroundImage="url("+z+")"}}this.cfg.data=I;return true},hide:function(){var o=this.getEntity();o.style.visibility="hidden";this.isHidden=true;return true}};var z="http://simg.sinajs.cn/blog7style/images/common/multishow_or."+($IE==6?"gif":"png");Lib.apply(this,C)};Lib.register("diYuanXinLog",function(){var b=!1;var f;var a=[];var d=(typeof $_GLOBAL!="undefined"&&$_GLOBAL.ver!=null)?$_GLOBAL.ver.di_yuan_xin||"-1":"-1";var c="http://sjs.sinajs.cn/xblogtheme/js/di_yuan_xin.js?ver="+d+".js";var b=function(){Utils.Io.JsLoad.request(c,{isRemove:!1,noreturn:true,onComplete:function(){f=!1;b=!0;for(var j=0,g=a.length;j<g;j++){a[j]()}a=[]}})};return function(g){if(!0===b){g()}else{if(!0===f){a.push(g)}else{a.push(g);b()}}}});Article.MultipleImgLayer=function(m){var ad=arguments;var ah=ad.callee._instance;if(ah){return ah}ad.callee._instance=this;var B=this;var K=function(){if($FF){B.scrollTop=document.documentElement.scrollTop}if($IE6){document.body.setAttribute("scroll","no")}else{document.documentElement.style.overflow="hidden";!$IE8&&(document.body.style.overflow="hidden")}};var aq=function(){if($IE6){document.body.removeAttribute("scroll")}else{document.documentElement.style.overflow="auto";!$IE8&&(document.body.style.overflow="auto")}if($FF){document.documentElement.scrollTop=B.scrollTop}};var f=function(){var o=function(av){var ax=document,aw=ax.documentElement["client"+av],au=ax.body;return ax.compatMode==="CSS1Compat"&&aw||au&&au["client"+av]||aw};return{height:o("Height"),width:o("Width")}};var t=function(o){var aw=$E(ap.multiPicLoading),av=Math.max(o.height,500),au=Math.max(o.width,500);aw.style.top=(av-181)/2+"px";aw.style.left=(au-141)/2+"px";S()};var N=function(){$E(ap.multiPicLoading).style.top="-1000px"};var z=function(ax){var av=f(),ay=Math.max(av.height,500),aw=Math.max(av.width,500),az=document,au=az.documentElement.scrollTop+az.body.scrollTop;ax.style.height=ay+"px";ax.style.width=aw+"px";ax.style.top=au+"px";var o=$E(ap.multiPicContent);o.style.height=(ay-88)+"px"};var T=function(){var aw=$E(ap.multiPicContent);var ay=aw.getElementsByTagName("IMG"),av,o;for(var ax=0,au=ay.length;ax<au;ax++){av=ay[ax];o=av.getAttribute("origin-size");if(o){return av}}return null};var S=function(){var o=T();if(o){o.parentNode.removeChild(o)}};var at=function(av,au){var aA=Math.max(av.height-88,412);var aB=Math.max(av.width,500);var aD=au.height;var aC=au.width;au.setAttribute("origin-size",aC+"*"+aD);var aw=((av.height-88)/aD);var ay=(av.width/aC);if(!isFinite(aw)||!isFinite(ay)){return}var ax=1,o,az;if((1>aw)&&(aw<ay)){az=Math.min(aD,aA);ax=az/aD;o=ax*aC;au.height=az;au.width=o}else{if(1>ay){o=Math.min(aC,aB);ax=o/aC;az=ax*aD;au.width=o;au.height=az}}if($IE&&$IE<8){au.style.zoom=1}};var s=function(au,o){if(o.offsetHeight==0||o.offsetWidth==0){return}var aw=(au.offsetHeight-o.offsetHeight)/2;var av=(au.offsetWidth-o.offsetWidth)/2;if(aw<0){aw=0}o.style.top=aw+"px";if(av<0){av=0}o.style.left=av+"px";trace("left: "+av+" top:"+aw);var ax=$E(ap.orignalPic);ax.style.top=(aw+10)+"px";ax.style.left=(av+10)+"px"};var b=function(){var o=$E(ap.orignalPic);o.style.visibility="inherit"};var E=function(){var o=$E(ap.orignalPic);o.style.visibility="hidden"};var p=function(av){var au="___$image"+new Date().getTime();var o=window[au]=new Image();blogId=$E(ap.multiPicLike).getAttribute("blog-id");o.src="http://control.blog.sina.com.cn/riaapi/article/filmslide.php?"+au+"&blogId="+blogId+"&img="+av;o.onload=o.onerror=function(){o=null;window[au]=null}};var aa=false;var ag=function(av,o,au){if(aa){return}aa=true;winDialog.alert(av,{icon:"01",textOk:"知道了",funcOk:function(){g=0;aa=false;a();o&&o()},funcClose:function(){g=0;aa=false;a();au&&au()}},"slide-box-tips")};var u=function(o){if(V){return}D=0;ag(o||"图片太小啦，无法展示！")};var U=function(av){var o=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/large/;var au=av.match(o);if(o.test(av)){av=av.replace(/\/large\//,"/orignal/")}$E(ap.orignalLink).href=av};var L="";var aj=function(aC,aA,aB,aw){if(V){return}var o=c(aC.url);if(!aw){var aw=new Image();aw.src=o}L=o;var ax="<em>"+(M+1)+"</em>/<span>"+aA+"</span>";$E(ap.multiPicIndex).innerHTML=ax;S();var ay=f();aw.style.top="-10000px";aw.style.position="absolute";O.appendChild(aw);var au=aw.width>200||aw.height>200;if((!$IE6&&au)||(aw.complete&&au)){n(aw,"opacity",0.5);N();setTimeout((function(aF){var aE=$E(ap.multiPicContent);return function(){if(aF.src!==L){O.removeChild(aF);return}p(aF.src);aF.setAttribute("action-type","show-large-layer");aF.setAttribute("action-data",encodeURIComponent(aF.src));aE.appendChild(aF);setTimeout(function(){at(f(),aF);s(aE,aF);var aG=new Ui.TweenStrategy(0.5,1,0.5);aG.onTween=function(aH){if(aw.src!==L){if(aF.parentNode){aF.parentNode.removeChild(aF)}aG.stop();aF=null;return}n(aF,"opacity",aH)};aG.start();U(aF.src)})}})(aw))}else{ad=arguments;t(ay);var az=0,av=15;var aD=setInterval((function(aF,aE){return function(){if(!y){clearInterval(aD);return}var aI=aF.offsetWidth>200||aF.offsetHeight>200;var aK=az*av/1000;az++;var aJ=aF.complete&&aF.width>0&&aF.height>0&&aF.width<200&&aF.height<200;if(aJ&&!y[aE].recordSmall){D++;y[aE].recordSmall=1}if(y&&y.length==(D+g)){clearInterval(aD);if(g==0){u()}return}if(aK>5||aJ){clearInterval(aD);g++;if(aE===M){S();a()}return}if(aF.complete&&aI){clearInterval(aD);var aL=[];for(var aH=0,aG=ad.length;aH<aG;aH++){aL.push(ad[aH])}aL.push(aF);ad.callee.apply(null,aL);return}}})(aw,aB),av);aw.onerror=(function(aE){return function(aF){if(!y[aE].recordError){g++;y[aE].recordError=1}if((g+D)>=aA){clearInterval(aD);ag("抱歉，图片读取失败。");return}aw.onerror=null;S();a()}})(aB)}};var a=function(){if("pre"===$E(ap.multiPicEntity).getAttribute("direction")){C()}else{P()}};var c=function(au){var o=/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/;var av=au.match(o);if(av){switch(av[1]){case"bmiddle":return au.replace(/\/bmiddle\//,"/large/");case"mw690":return au.replace(/\/mw690\//,"/large/");case"middle":return au.replace(/\/middle\//,"/large/");case"mw600":return au.replace(/\/mw600\//,"/large/");default:return au}}else{return au}};var ac=function(az,aw){var ay=null,ax=Math.abs(aw),o=az.length;for(var av=1;av<ax;av++){var au=(aw>0)?(M+av):(M-av);ay=az[au];if(ay&&ay.loaded===0){(function(aA,aB){setTimeout(function(){var aC=new Image();aC.onload=aC.onerror=function(){aC=null};aC.src=aA;y[aB].loaded=1},40)})(c(ay.url),au)}}};var q=function(o){if(-1!==o.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==o.indexOf("img.t.sinajs.cn")){return true}if(-1!==o.indexOf("simg.sinajs.cn")){return true}if(-1!==o.indexOf("sinaimg.cn/small")){return true}if(-1!==o.indexOf("sinaimg.cn/square")){return true}return false};var F=function(ax,au){var aw,o=ax.length,av=f();y=ax;if(0<o){t(av);an();var ay=false;for(aw=0;aw<o;aw++){if(y[aw].click){M=aw;aj(y[aw],o,aw);ay=true;break}}if(!ay){M=0;aj(y[0],o,0)}ac(y,3);ac(y,-3)}else{ab()}};var ab=function(o){if(o){var ax=Core.Events.getEventTarget(o);if("IMG"===ax.nodeName.toUpperCase()){return}}if(J){J.hide()}if(O){O.innerHTML="";document.body.removeChild(O);O=null}V=true;var au=f();aq();var av=ap.multiPicEntity;var aw=$E(av);aw.style.display="none";ak.hidden();y=[];M=0;g=0;D=0;A=null;af.data=null;if(am&&am.dialog){am.dialog.hidden()}};var ae=false;var ar=function(o){$E(o).style.visibility="hidden"};var Q=function(o){$E(o).style.visibility="inherit"};var ai=function(o){ar(ap.multiPicLike);ar(ap.multiPicTitle);ar(ap.multiPicIndex);if("next"===o){ar(ap.multiPicNext)}else{ar(ap.multiPicPre)}};var an=function(){Q(ap.multiPicLike);Q(ap.multiPicTitle);Q(ap.multiPicIndex);Q(ap.multiPicNext);Q(ap.multiPicPre)};var G=function(){if(J){J.hide()}};var Z=function(ax){ae=true;var o=T();if(o){o.style.visibility="hidden";o=null}ai(ax);E();if(!J){J=new Article.SlideTJCover({renderTo:$E(ap.multiPicContent),review:function(){an();M=-1;P();J.hide()}})}var au=$E(ap.multiPicEntity).getAttribute("blog-id");var aw=$E(ap.multiPicTitle);var av=decodeURIComponent(aw.getAttribute("publish-time")||"");af.getNextSlideData(au,av,function(ay){J.show(ay)},"")};var C=function(au){if(au){Core.Events.stopEvent(au)}Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(aw){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(aw){}});var o=y.length;if(M<=0){Z("pre");M=-1;return}else{M--}ae&&G();ae&&an();ae=false;var av=y[M];aj(av,o,M);$E(ap.multiPicEntity).setAttribute("direction","pre");ac(y,-3)};var P=function(au){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(aw){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(aw){}});if(au){Core.Events.stopEvent(au)}var o=y.length;if(M>=o-1){Z("next");M=o;return}else{M++}ae&&G();ae&&an();ae=false;var av=y[M];aj(av,o,M);$E(ap.multiPicEntity).setAttribute("direction","next");ac(y,3)};var r=function(av){Core.Events.stopEvent(av);var ax=$E(ap.multiPicLike),au=ax.getAttribute("blog-id"),aw="http://control.blog.sina.com.cn/admin/digg/post_digg.php";var o=ax.getAttribute("block");if(o==="1"){return}var ay=$E(ap.multiPicTitle);var az=ay.innerText||ay.textContent;ax.setAttribute("block","1");Utils.Io.JsLoad.request(aw,{onComplete:function(aG){ax.setAttribute("block","0");var aD=aG.code;if(aD==="A00006"||aD==="B00801"){ax.className="ico_unlike ico_liked";ax.innerHTML="已喜欢";if(scope.digger){scope.digger.setData(au,scope.$uid,1)}var aF=$E("dbox_"+au);aF.onmouseover=function(){};aF.onmouseout=function(){};aF.onclick=function(){};aF.className="upBox upBox_dis";var aJ=$E("dbox2_"+au);aF.style.cursor="default";var aH=aF.getElementsByTagName("p")[1];var aA=aH.innerHTML;var aB=SinaEx.createNode("<div>"+aA+"</div>");var aE=SinaEx.findNode(aB,"nextSibling","firstChild");if(aE){aB.removeChild(aE)}var aC=aB.innerHTML;if(aC==="顶"){aH.innerHTML='<img width="15" height="15" align="absmiddle" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶'}else{aH.innerHTML="已喜欢"}var aI=parseInt(aJ.getAttribute("mnum"))+1;aJ.innerHTML=aI}else{if("A00800"===aD){ag("对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",function(){},function(){})}else{ag(aG.message||"发生错误，请稍候再试",function(){},function(){})}}},GET:{res_id:au,res_uid:scope.$uid,action:"0",res_type:"1",ti_title:encodeURIComponent(az)},onException:function(){aObj.setAttribute("block","false");ag(result.message||"发生错误，请稍候再试",function(){},function(){})}})};var ao=function(){z($E(ap.multiPicEntity));setTimeout(function(){var o=f(),au=null;if(!ae){au=T();au&&at(o,au);au&&s($E(ap.multiPicContent),au)}else{if(J&&!J.isHidden){J.fixPos()}}},25)};var Y=function(au){if(V){return}var aw=f(),o=document.body,av=arguments,ax=this;setTimeout(function(){var ay=f();if(ay.height===aw.height&&ay.width===aw.width){ao()}},80)};var I=99999;var R=I+parseInt(Ui.LayerCount()||0,10);var d='<div id="#{multiPicEntity}" class="dialogMultiShow"                 style="display:none;z-index:'+(R+1)+';">              <a id="#{multiPicClose}" href="javascript:void(0);" title="关闭" class="close" style="z-index:'+(R+2)+'" hidefocus="true">关闭</a>              <a id="#{multiPicPre}" href="javascript:void(0);" class="btn_preview" style="z-index:'+(R+2)+'" hidefocus="true"></a>              <a id="#{multiPicNext}" href="javascript:void(0);" class="btn_next" style="z-index:'+(R+2)+'" hidefocus="true"></a>              <a id="#{multiPicLike}" href="javascript:void(0);" class="ico_unlike" style="z-index:'+(R+2)+'" hidefocus="true">喜欢</a>              <div class="bd">                <div id="#{multiPicIndex}" class="count"><em>5</em>/<span>20</span></div>                <div id="#{multiPicContent}" class="pic" style="position:relative;">                    <div class="con" id="#{orignalPic}" style="position:absolute;z-index:1025;">                        <a id="#{orignalLink}" target="_blank" href="#" class="opic" title="查看原图"  hidefocus="true">查看原图</a>                    </div>                    <div id="#{multiPicLoading}" class="loadding" style="top:-10000px;">图片加载中......</div>                </div>                <div class="title"><a id="#{multiPicTitle}" target="_blank" href="javascript:void(0);"  hidefocus="true">标题</a></div>              </div>            </div>';var j=document,ak=null,af=this,al=new Lib.HtmlTemplate(d),ap=al.getNodeIds(),X=al.getHtmlString(),g=0,D=0,y=[],v=Core.Events.addEvent,n=Core.Dom.setStyle,V=true,M=0,H="http://simg.sinajs.cn/blog7style/css/common/multishow.css",J=null,A=null;Utils.Io.loadExternalCSS(H,function(){});Core.Dom.addHTML(document.body,X);v($E(ap.multiPicClose),ab);v($E(ap.multiPicPre),C);v($E(ap.multiPicNext),P);v($E(ap.multiPicLike),r);v(document,function(o){if(V){return}var au=$E(ap.multiPicEntity).getAttribute("direction");if(37===o.keyCode&&!(ae&&au==="pre")){C()}else{if(39===o.keyCode&&!(ae&&au==="next")){P()}}},"keydown");v($E(ap.multiPicTitle),function(o){Core.Events.stopBubble(o)});v($E(ap.multiPicContent),function(au){var o=Lib.util.getActionData(au,"show-large-layer");if(!o){return}b()},"mouseover");v($E(ap.multiPicContent),function(av){var o=Lib.util.getActionData(av,"show-large-layer");if(!o){return}var au=av.toElement||av.relatedTarget;var aw=av.srcElement||av.target;if(au&&"A"===au.nodeName.toUpperCase()&&"IMG"===aw.nodeName.toUpperCase()){return}E()},"mouseout");v(window,Y,"resize");var O=null;var am=null;Lib.checkAuthor();if(!$isLogin){am=new Lib.Login.Ui()}var W={scrollTop:0,show:function(o,aA,aB,aC,ax,au){var aw=ap.multiPicEntity;var av=$E(aw);if(!av||!o.length){return}Lib.checkAuthor();ae=false;if(!O){O=document.createElement("DIV");O.id="_sile-img-box"+(new Date()).getTime();O.style.position="absolute";O.style.top="-10000px";this.imgContainer=O;document.body.appendChild(O)}E();g=0;D=0;aB=aB||"";V=false;var ay=f();K();ax=ax||scope.$articleid;$E(ap.multiPicEntity).setAttribute("blog-id",ax);setTimeout(function(){if(!ak){ak=new Lib.OnlyShadow(0.9,j.body,"mask_mutiplepic",{zIndex:R});ak.entity.style.zIndex=R;ak.entity.style.backgroundColor="black"}var aG=f();ak.entity.style.width=aG.width+"px";ak.show();av.style.display="";z(av);var aE=[];for(var aI=0,aD=o.length;aI<aD;aI++){ah=o[aI];if(!q(ah.url)){aE.push(ah)}}if(0<aE.length){F(aE,ax)}else{u()}if(aA){var aF=(typeof aA!=="string")?aA.href:aA;var aJ=$E(ap.multiPicTitle);aJ.href=aF;aJ.innerHTML="";aJ.setAttribute("publish-time",encodeURIComponent(au));var aK=document.createTextNode(Core.String.trim(aB)||"查看原文");aJ.appendChild(aK);var aH=$E(ap.multiPicLike);aH.setAttribute("blog-id",ax);if(aC){aH.className="ico_unlike ico_liked";aH.innerHTML="已喜欢"}else{aH.className="ico_unlike";aH.innerHTML="喜欢"}}},25);var az=this},getNextSlideData:function(aw,av,au,o){var ax=this;Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePrevNextPic.php?rnd="+Math.random(),{GET:{blog_id:aw,blog_pubdate:av,uid:$UID||"",action:o||""},onComplete:function(ay){if("A00006"===ay.code){ax.data=ay.data}else{ax.data={pre:{},next:{}}}au&&au(ax.data)},onException:function(){}})},setDirection:function(o){$E(ap.multiPicEntity).setAttribute("direction",o)},showNextSlide:function(ay){var aA=this.data;if(aA){this.recordPV(ay);var av;for(var aw in aA){av=aA[aw];if(av&&(ay===av.blogId)){break}}if(av){var aB="http://blog.sina.com.cn/s/blog_"+av.blogId+".html",au,ax=[],o=av.images;for(var az=o.length-1;az>=0;az--){au=av.images[az];ax.unshift({url:au,loaded:0,click:0})}this.show(ax,aB,av.title,av.isLiked,av.blogId,av.publishTime);if(J){J.hide()}}}},recordPV:function(o){if(o!==scope.$articleid){var av=new Image();var aw=parseInt(Math.random()*1000);var au="http://comet.blog.sina.com.cn/api?maintype=hits&act=4&aid="+o+"&ref="+encodeURIComponent(location.href)+"&rnd="+aw;av.src=au;window["log_pv"+aw]=av;av.onload=av.onerror=function(){window["log_pv"+aw]=null;av=null}}},hide:function(){ab()},destroy:function(){ab();aq();document.body.removeChild($E(ap.multiPicEntity));X=null;y=null;ap=null;if(J){J.destroy();J=null}}};Lib.apply(this,W)};$registJob("showSlideBox",function(j){var g=Lib.util.getActionData,f=Core.Events.addEvent,d=/([^\/]+)$/;var c=function(s,o,r,q,n,m){Lib.sendSuda(function(){try{SUDA.log("","blog_slide_page")}catch(t){}});Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(t){}});var p=new Article.MultipleImgLayer();p.show(s,o,r,q,n,m)};var b=function(m){if(-1!==m.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==m.indexOf("img.t.sinajs.cn")){return true}if(-1!==m.indexOf("simg.sinajs.cn")){return true}if(-1!==m.indexOf("sinaimg.cn/small")){return true}if(-1!==m.indexOf("sinaimg.cn/square")){return true}return false};var a=function(q,m,o){var n=q===m,p=null;var r=b(q);if(-1===q.indexOf("/blog7style")&&-1===q.indexOf("sg_trans.gif")&&!n&&!r){p={url:q,loaded:0,click:(o===q.match(d)[1].replace(/\&amp;690/,"&690"))}}return p};f(document.body,function(M){var O=g(M,"show-slide");if(!O){return}Core.Events.stopDefaultEvent(M);var G=scope.$articleid,r=location.protocol+"//"+location.host+location.pathname,J=[],n,s,P,A,Q,N,G,o,F,m=scope.$pageid;if(typeof SUDA!="undefined"){SUDA.uaTrack("blog_article","h_article19")}if("article"===m||"articleM"===m||"article_new"==m||"articleM_new"==m){var D=$E("dbox_"+G);var A=location.href;var z=$E("t_"+G),Q=z.innerText||z.textContent;var N=(/\bupBox_dis\b/.test(D.className));var y=$E("sina_keyword_ad_area2");var E=$T(y,"img");var p=decodeURIComponent(O.data);F=p.match(d)[1];for(L=0,l=E.length;L<l;L++){P=E[L];n=P.getAttribute("real_src");s=P.getAttribute("src");var v=n===s;if(v){var u=P.width>1&&P.width<200;var I=P.height>1&&P.height<200;if(u&&I){continue}}s=n||s;var B=a(s,r,F);if(B){J.push(B)}}var C=$T(document.body,"span"),q,o=scope.$publishTime;if(!o){for(var L=C.length-1;L>=0;L--){q=C[L];if("time SG_txtc"===q.className){o=q.innerText||q.textContent;break}}o=o.replace("(","").replace(")","")}c(J,A,Q,N,scope.$articleid,o)}else{var H=O.data.split("&");var s=decodeURIComponent(H[0]),K=decodeURIComponent(H[1]),t=decodeURIComponent(H[2]),Q=decodeURIComponent(H[3]),o=decodeURIComponent(H[4]);Utils.Io.JsLoad.request("http://control.blog.sina.com.cn/riaapi/article/getArticlePic.php?rnd="+Math.random(),{GET:{blog_id:K,blog_pubdate:o,uid:$UID||""},onComplete:function(S){if("A00006"===S.code){var R=S.data;var U=R.images;F=s.match(d)[1];for(L=0,l=U.length;L<l;L++){s=U[L];var T=a(s,r,F);if(T){J.push(T)}}c(J,t,Q,R.isLiked,K,R.publishTime)}},onException:function(){}})}})});$registJob("showSlideBtn",function(t){var B=Core.Array.foreach,c=scope.$pageid,f=c=="article"||c=="articleM"||c=="article_new"||c=="articleM_new",o=scope.$uid,C,r=$E("sina_keyword_ad_area2")||document.body,z,u,g=62,q=1,m=Core.Events.addEvent;var j=SinaEx.createNode('<div style="left: -1000px; top: -1000px;position:absolute;" class="picSlideBtn" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F697db644jw1dw1s1zljvaj.jpg"><a href="javascript:void(0);">幻灯播放</a></div>');document.body.appendChild(j);function s(){if(this.width<200&&this.height<200){return false}var E=this.getAttribute("real_src")||this.getAttribute("src");this.setAttribute("action-data",encodeURIComponent(E));this.setAttribute("action-type","show-slide");var D=Core.Dom.getXY(this)[0]+10;D=Math.min(D,z-134);j.style.left=D+"px";j.style.top=(Core.Dom.getXY(this)[1]+10)+"px";if(q){j.style.display="";j.setAttribute("action-data",encodeURIComponent(this.src))}}function a(){if(this.width<200&&this.height<200){return false}var E=Core.Events.getEvent(),D=E.relatedTarget||E.toElement;if(!D||!Core.Dom.contains(j,D)){j.style.display="none"}}function n(D){var E=D.getAttribute("real_src")||D.getAttribute("src")||"";if(-1!==E.indexOf("sinaimg.cn/uc/myshow")){return true}if(-1!==E.indexOf("img.t.sinajs.cn")){return true}if(-1!==E.indexOf("simg.sinajs.cn")){return true}if(-1!==E.indexOf("sinaimg.cn/small")){return true}if(-1!==E.indexOf("sinaimg.cn/square")){return true}return false}function d(D){while(D=D.parentNode){if("A"===D.nodeName.toUpperCase()){return D}}return null}function p(D){m(D,s.bind2(D),"mouseover");m(D,a.bind2(D),"mouseout")}function y(D){if(n(D)||!Core.Dom.contains(r,D)){return}b();var F=v(D);if(F&&(-1===F.href.indexOf("photo.blog.sina.com.cn"))){return}var E=D.getAttribute("src");var G=(-1!==E.indexOf("sg_trans.gif"));if(D.complete&&!G){p(D)}else{D.onload=(function(){p(this);var I=this.getAttribute("real_src");var H=this.getAttribute("src");if(!I&&(I===H)){D.onload=null}}).bind2(D)}}function b(){z=Core.Dom.getXY(r)[0]+r.clientWidth}Core.Events.addEvent(window,b,"resize");function v(E){if(!f){return null}var D;while(E=E.parentNode){if(E.nodeName.toUpperCase()=="A"){return E}}return null}function A(){q=1;B($T(r,"img"),function(D){y(D,"src")})}A();scope.showPicSlide=function(D,E){y(D)}});Core.Dom.byClass=function(b,d,m){m=m||document;if(m.getElementsByClassName){return m.getElementsByClassName(b)}var j=new RegExp("\\b"+b+"\\b"),c=[],g=m.getElementsByTagName(d),f,a=g.length;for(f=0;f<a;f++){m=g[f];if(m.nodeType===1&&m.className&&j.test(m.className)){c.push(m)}}return c};$registJob("xingqu",function(){var g={171:"娱乐博客",172:"财经博客",173:"股票博客",174:"体育博客",175:"IT博客",176:"博客首页",177:"文化博客",178:"教育博客",179:"军事博客",180:"女性博客",181:"育儿博客",182:"健康博客",183:"星座博客",184:"游戏博客",185:"美食博客",186:"旅游博客",187:"杂谈博客",191:"汽车博客",192:"房产博客",193:"佛学博客",194:"宠物博客"};var j=function(m){window._cateIdForThisPage_=m;Utils.Io.JsLoad.request("http://news.sina.com.cn/js/694/2013/0220/guess.boot.blog.js",{charset:"gb2312",isRemove:false,onComplete:function(){}})};var f;var c=window.location.href;if(c.indexOf("tj=")!==-1){var d=Core.Dom.byClass("SG_icon107","img",$E("articlebody")),a,b;if(d){a=d[0].title}if(a){for(b in g){if(a.indexOf(g[b])>-1){f=b;break}}}j(f)}else{if(f=scope.$cate_id){j(f)}}Utils.Io.JsLoad.request("http://ent.sina.com.cn/js/470/2013/0506/collect.js",{charset:"gb2312",isRemove:false,onComplete:function(){}})});Lib.countOSLink=function(m){var f=Core.Events.addEvent;var o=/^http:\/\/[\w\.]*?blog.sina.com.cn/i,d=m.length,b,g,n,c,a;while(d--){g=m[d].blogid;n=m[d].uid;c=m[d].container?$T(m[d].container,"a"):document.links;b=c.length;while(b--){a=c[b].href;if(!a||a.match(o)||a.indexOf("javascript:")>-1){continue}!function(q,j,p,r){if(q){f(j,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?blogid="+q+"&url="+encodeURIComponent(p))})}else{f(j,function(){commonLog("http://interface.blog.sina.com.cn/riaapi/article/click_url.php?uid="+r+"&url="+encodeURIComponent(p))})}j=null}(g,c[b],a,n)}}c=null;f=null};$registJob("osl_article",function(){Lib.countOSLink([{blogid:scope.$articleid||"",container:$E("sina_keyword_ad_area2")}])});slideBox=Core.Class.create();slideBox.prototype={assertNull:function(a,b){if(null==a){throw Error(b)}},initialize:function(j,m,c,a,b){this.assertNull(j,"boxBody不能为null");this.assertNull(m,"slideBody不能为null");this.assertNull(c,"previousBtn不能为null");this.assertNull(a,"nextBtn不能为null");this.boxBody=j;this.slideBody=m;this.previousBtn=c;this.nextBtn=a;this.isFirst=true;this.isLast=false;this.currentPage=1;this.cfg=b;var g=Core.Function.bind2,f={direction:"leftToRight",motion:Ui.Transition.simple,duration:0.5,slideChildCount:1,onTweenBegin:function(){},onTweenEnd:function(){}};Core.Events.addEvent(c,g(function(){this.cfg.onTweenBegin("",this.currentPage,"previous");this.previousPage()},this));Core.Events.addEvent(a,g(function(){this.cfg.onTweenBegin("",this.currentPage,"next");this.nextPage()},this));var d=function(q,n){var o;for(o in n){q[o]=n[o]}return q};this.cfg=d(f,b||{});this.startTweenStyle=parseInt(this._getSlideBeginValue()||0);m.style[this._getTweenStyle()]=this.startTweenStyle+"px"},getCurrentSlideLength:function(){var a=0,b=this.slideBody.style;switch(this.cfg.direction){case"leftToRight":a=b.left;break;case"bottomToTop":a=b.bottom;break;case"topToBottom":a=b.left;break}return parseInt(a||0)},hasNextPage:function(){return this.slideBody.children.length>this.currentPage*this.cfg.slideChildCount},hasPreviousePage:function(){return this.currentPage>1},getSlideLegnth:function(){var t=this.cfg.slideLength||0;if(t){return t}var q=this.slideBody,c=q.children,p=c.length;if(p<1){return 0}var d=c[0],a=a||(window.getComputedStyle?window.getComputedStyle(d,""):d.currentStyle);var s=0,m,g,o,j;switch(this.cfg.direction){case"leftToRight":var n=d.offsetWidth;m=this._getCurrentStyle(d,"margin-right",a)||0;g=this._getCurrentStyle(d,"margin-left",a)||0;s=n+parseInt(m)+parseInt(g);break;case"bottomToTop":case"topToBottom":var b=d.offsetHeight,f=0;o=parseInt(this._getCurrentStyle(d,"margin-top",a)||0,10);j=parseInt(this._getCurrentStyle(d,"margin-bottom",a)||0,10);f=Math.max(o,j);s=b+(p-1)*f+o+j;break}var r=s*this.cfg.slideChildCount;this.cfg.slideLength=r;return r},previousPage:function(){var d=!this.hasPreviousePage();if(d||this.onTweening){d&&this.cfg.onTweenEnd("begin",this.currentPage,"previous");return}var f=this.boxBody,c=this.slideBody,b=window.getComputedStyle?window.getComputedStyle(c,""):c.currentStyle,j=this.getCurrentSlideLength(b),a,g=this.getSlideLegnth();this.currentPage--;a=j+g;this._tween(j,a)},nextPage:function(){var d=!this.hasNextPage();if(d||this.onTweening){d&&this.cfg.onTweenEnd("end",this.currentPage,"next");return}var f=this.boxBody,c=this.slideBody,b=window.getComputedStyle?window.getComputedStyle(c,""):c.currentStyle,j=this.getCurrentSlideLength(b),a,g=this.getSlideLegnth();this.currentPage++;a=j-g;this._tween(j,a)},_getCurrentStyle:function(d,a,b){var c,b=b||(window.getComputedStyle?window.getComputedStyle(d,""):d.currentStyle);try{c=b.getPropertyValue(a)}catch(f){a=a.replace(/^(-)/,"").replace(/-(\S)/g,function(j,g){return g.toUpperCase()});c=b[a]}return c},_getSlideBeginValue:function(a){var b=this.slideBody,c=0;switch(this.cfg.direction){case"leftToRight":c=this._getCurrentStyle(b,"left",a)||0;break;case"bottomToTop":c=this._getCurrentStyle(b,"top",a)||0;break;case"topToBottom":c=this._getCurrentStyle(b,"bottom",a)||0;break}return parseInt(c)},_getTweenStyle:function(){switch(this.cfg.direction){case"leftToRight":return"left";case"bottomToTop":return"bottom";case"topToBottom":return"top"}return"left"},_tween:function(f,a){var b=this.slideBody.style,d=this._getTweenStyle();tween=new TweenStrategyEx([f],[a],this.cfg.duration,this.cfg.motion);this.onTweening=true;tween.onTween=function(g){b[d]=parseInt(g[0],10)+"px"};var c=this;tween.onEnd=function(){var m=!c.hasNextPage(),j=!c.hasPreviousePage(),g="";if(m){c.isLast=true;c.isFirst=false;g="end"}else{if(j){c.isFirst=true;c.isLast=false;g="begin"}else{c.isFirst=false;c.isLast=false}}c.onTweening=false;c.cfg.onTweenEnd(g,c.currentPage)};tween.start()}};$registJob("blog365Slide",function(){if(!$E("calendarCon")){return}$E("calendarCon").style.width=9999+"px";new slideBox($E("swrap"),$E("calendarCon"),$E("btn_preview"),$E("btn_next"),{slideChildCount:7,duration:1})});Lib.classUtils=function(){};Lib.classUtils.prototype.addClass=function(b,a){if(!b){return false}if(!this.hasClass(b,a)){b.className=Core.String.trim(b.className.concat(" "+a))}};Lib.classUtils.prototype.delClass=function(c,b){if(!c){return false}var a=new RegExp("( +|^)"+b+"(?=( |$))","ig");c.className=Core.String.trim(c.className.replace(a,""))};Lib.classUtils.prototype.hasClass=function(c,b){if(!c){return false}var a=new RegExp("( +|^)"+b+"(?=( |$))","ig");return a.test(c.className)};(function(){if(scope.tpl!=="8_52"){return}Lib.checkAuthor();var d='<ul id="blog365_calCon"><li class="d1"><div class="pic"></div></li><li class="d2"><div class="pic"></div></li><li class="d3"><div class="pic"></div></li><li class="d4"><div class="pic"></div></li><li class="d5"><div class="pic"></div></li><li class="d6"><div class="pic"></div></li><li class="d7"><div class="pic"></div></li><li class="d8"><div class="pic"></div></li><li class="d9"><div class="pic"></div></li><li class="d10"><div class="pic"></div></li><li class="d11"><div class="pic"></div></li><li class="d12"><div class="pic"></div></li><li class="d13"><div class="pic"></div></li><li class="d14"><div class="pic"></div></li><li class="d15"><div class="pic"></div></li><li class="d16"><div class="pic"></div></li><li class="d17"><div class="pic"></div></li><li class="d18"><div class="pic"></div></li><li class="d19"><div class="pic"></div></li><li class="d20"><div class="pic"></div></li><li class="d21"><div class="pic"></div></li><li class="d22"><div class="pic"></div></li><li class="d23"><div class="pic"></div></li><li class="d24"><div class="pic"></div></li><li class="d25"><div class="pic"></div></li><li class="d26"><div class="pic"></div></li><li class="d27"><div class="pic"></div></li><li class="d28"><div class="pic"></div></li><li class="d29"><div class="pic"></div></li><li class="d30"><div class="pic"></div></li><li class="d31"><div class="pic"></div></li><li class="actpage"><div class="pic"><a title="活动页" target="_blank" href="http://qing.blog.sina.com.cn/tag/365"></a></div></li></ul><div class="wdate" id="blog365_dateNum"></div>';var c="http://control.blog.sina.com.cn/riaapi/activity/get_blog365.php?data=1";b();Utils.Io.JsLoad.request(c,{GET:{uid:scope.$uid||""},onComplete:function(g){if(g.code&&g.code==="A00006"){a(g.data)}}});function b(){var g=$C("div");g.className="module365";g.style.position="absolute";g.style.top="0px";g.style.right="0px";g.style.zIndex="200";g.innerHTML=d;$E("headarea")&&$E("headarea").appendChild(g);var o=$E("blog365_calCon")&&$E("blog365_calCon").children;var m=new Date(),B=m.getDate(),A=m.getFullYear(),y=m.getMonth()+1;var v=m.getTime();var u=new Date(A,0,1).getTime();var q=v-u;if(q==0){q=1}else{q=Math.floor(q/(24*60*60*1000))+1}$E("blog365_dateNum").innerHTML=q;if($isAdmin){var z=o[B-1];todayDiv=z.getElementsByTagName("div")[0];z.className+=" today";var t='<a onclick="v7sendLog(\'48_01_22\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank"><span class="rectoday" title="记录今天"></span></a>';todayDiv.innerHTML=t;var C=f(A,y);for(var r=B;r<C;r++){var n=o[r],s=n.getElementsByTagName("div")[0];n.className+=" coming";var p=A+"-"+y+"-"+(r+1);var t='<a onclick="v7sendLog(\'48_01_23\')" href="http://control.blog.sina.com.cn/admin/article/article_add.php?tag365='+p+'" target="_blank"><span class="tq">提前<br>记录</span></a>';s.innerHTML=t}}}function a(q){var n=$E("blog365_calCon")&&$E("blog365_calCon").children;var j=new Date(),u=j.getDate(),t=j.getFullYear(),s=j.getMonth()+1;for(var v in q){var p=v.split("-")[2]-1;var m=n[p],o=m.getElementsByTagName("div")[0];if(q[v].pre&&q[v].href){m.className="d"+(p+1)+" writed";var r="";if($isAdmin){r='<a href="'+q[v].href+'" target="_blank" ><span class="date">'+(p+1)+"日</span></a>";o.innerHTML=r}o.innerHTML=r}else{if(p===(u-1)){m.className="d"+u}var g,r;g=(q[v].href)?q[v].href:"javascript:void(0);";target=(q[v].href)?"_blank":"";if(q[v].src&&q[v].src.indexOf("sinaimg.cn")>=0){r='<a href="'+g+'" target="'+target+'"><img src="'+q[v].src+'"/><span class="date">'+(p+1)+"日</span></a>"}else{r='<a href="'+g+'" target="'+target+'"><span class="date">'+(p+1)+"日</span></a>"}o.innerHTML=r}}}function f(o,g){var j=function(m){return m%400?(m%100?(m%4?0:1):0):1};if(!o*g){return 0}var n=31;switch(g){case 4:case 6:case 9:case 11:n=30;break;case 2:n=j(o)?29:28;break}return n}})();$registJob("loginStatus",function(){Lib.checkAuthor();var c=Utils.Cookie.getCookie;var a=Utils.Cookie.setCookie;var d=c("_s_loginStatus");var f=c("_s_loginuid");if($isLogin){if(f===$UID){return}}else{if(!d||(d===f)){return}}a("_s_loginuid",$UID||d,(24-new Date().getHours()),"","blog.sina.com.cn");var b="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(b,{onComplete:function(){},onException:function(){}})});$registJob("showTB680",function(){Lib.execZhitou(function(a){var b=document.getElementById("column_1");var f=Core.Dom.byClass("SG_conn","div",b);var d=f[2]||f[f.length-1];var c=blogAd.insertIns("PDPS000000033239",d,"beforebegin");(window.sinaads||[]).push({element:c,params:{sinaads_success_handler:function(){c.style.marginBottom="10px"}}})})});$registJob("padSwitch",function(){var c=navigator.userAgent,f=/(iPad).*OS\s([\d_]+)/.test(c);var b='<div class="webSelect"><a id="sw_web" class="current" href="javascript:void(0);">电脑版</a><a id="sw_pad" href="javascript:void(0)">PAD版</a></div>';var d=Core.Events.addEvent;var a=window.location.href;function g(j){var m=new Date();m.setTime(m.getTime()-1);document.cookie=j+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+m.toGMTString()}if(f){Core.Dom.insertHTML($E("sinablogfooter"),b,"AfterBegin");d($E("sw_pad"),function(j){j.target.className="current";Core.Dom.removeClass($E("sw_web"),"current");g("ipad4web");a=a.replace("blog","m.blog");window.location.href=a})}});$registJob("loginFollow",function(){Lib.checkAuthor();var b=$E("loginFollow");var m=unescape(Utils.Cookie.getCookie("onceloggedonblog"));var g=Lib.Login.info();var f=g.uid;var a=g.nick;if(!b||!m||$isLogin||!f||!a){return}if(f===scope.$uid){return}var d='<div class="loginFollow"><div class="con"><p id="#{loginFollowCon}"></p><div class="btm"><a id="#{loginBtn}" href="javascript:void(0);" class="btn" title="登录并关注"></a><span>还没有博客账号？点此<a href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&r=&srcuid=&src=blogicp" target="_blank" onclick="v7sendLog(\'44_01_03_'+f+"')\">注册</a>一个</span></div></div></div>";var c=Utils.insertTemplate(b,d,"BeforeEnd");c.loginFollowCon.innerHTML="Hi，"+a+"！我是"+(scope.owenerNickName||$E("ownernick").innerHTML.replace(/(\r|\n)/g,""))+"。  现在就登录关注我的博客，不要错过我的任何更新！";v7sendLog("44_01_01_"+f);var n=new Lib.Login.Ui();Core.Events.addEvent(c.loginBtn,function(){v7sendLog("44_01_02_"+f);n.login(function(){v7sendLog("44_01_04_"+f);Lib.Component.Attention($UID,scope.$uid,function(){location.reload()})})},"click");function j(){var o=new Ui.TweenStrategy();o.onTween=function(p){};o.onEnd=function(){};o.start()}});$registJob("blogTip",function(){var c=Lib.Listener;c.on({name:"article-msg-loaded",callBack:function(t){n(t)},scope:this});var r=null;var m="";var p="";var o="";var q="";var s=function(u){m=u;var t=t||50;var v=parseInt(u)%8+1;q="http://portrait"+v+".sinaimg.cn/"+u+"/blog/"+t};var n=function(t){if(t){if(t.cms_id==p){return}s(t.uid);p=t.cms_id+"";o=t.nick_name;a();d()}};var a=function(){if(!$E("blogTip")){var t='<div id="blogTip" class="mDynaState" style="position:fixed;z-index:300; left:580px; top:92px; opacity:0.0;"><div class="con"><a onclick="v7sendLog(\'40_01_47\')" href="###"><img id="UIMG" width="30" height="30" alt=""></a><a href="###" onclick="v7sendLog(\'40_01_47\')" id="NName" class="nickname"></a>刚刚对此博文进行了评论<span id="blogTipShowBtn">,<a href="###" onclick="v7sendLog(\'40_01_46\')">查看</a></span></div><a href="###" onclick="v7sendLog(\'40_01_48\');" class="close" title="关闭" id="blogTip_closeBtn">×</a></div>';Core.Dom.addHTML(document.body,t);var A=Core.Dom.getXY($E("sinabloga"));$E("blogTip").style.top=A[1]+"px";Core.Events.addEvent(blogTip,function(){f();if($E("article_comment_list").childNodes[0].childNodes.length<1){var B=new Comment.List();B.load(1);scope.$comment_is_load_page_1=1;setTimeout(b,1000)}else{b()}Core.Events.stopEvent()},"click");Core.Events.addEvent(blogTip_closeBtn,function(){f();Core.Events.stopEvent()},"click");Core.Events.addEvent(UIMG,function(){window.open("http://blog.sina.com.cn/u/"+m);f();Core.Events.stopEvent()},"click");Core.Events.addEvent(NName,function(){window.open("http://blog.sina.com.cn/u/"+m);f();Core.Events.stopEvent()},"click")}$E(UIMG).src=q;var y=0;var v=o.split("");var u=0;for(var z=0;z<v.length;z++){if(v[z].charCodeAt(0)<299){y+=0.75}else{y+=1}if(y>=8&&u==0){u=z}}if(u>0){$E(NName).innerHTML=o.substr(0,u)+"..."}else{$E(NName).innerHTML=o}if(p){$E("blogTipShowBtn").style.display=""}else{$E("blogTipShowBtn").style.display="none"}};var b=function(){if($E("cmt_"+p)){g()}else{var t="http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php?uid="+scope.$uid+"&cms_id="+p;Utils.Io.JsLoad.request(t,{onComplete:(function(u){if(u&&"A00006"===u.code){u.data.cid=p;j(u.data)}}),onException:(function(){location.hash="commonComment"}),timeout:3000})}};var j=function(u){var v=$E("article_comment_list");var z=new CommentV2.Add();var t=u;t.action_data=Utils.Json.flatten({articleid:scope.$articleid,commentid:t.id,fromProduct:t.fromProduct,comm_uid:t.uid,uname:t.nick_name,ulink:t.ulink,src_uid:t.src_uid,cms_reply_num:t.cms_reply_num});t.uname=t.nick_name;t.action_data=encodeURIComponent(t.action_data);var y=z.render(t);v.insertBefore(y,v.firstChild);g()};var g=function(){location.hash="cmt_"+p};var d=function(){v7sendLog("40_01_45");$E("blogTip").style.display="";var t=new Ui.TweenStrategy(0,1,0.5);t.onTween=function(u){Core.Dom.setStyle($E("blogTip"),"opacity",u)};t.onEnd=function(){t=null;setTimeout(f,5000)};t.start()};var f=function(){var t=new Ui.TweenStrategy(1,0,0.5);t.onTween=function(u){Core.Dom.setStyle($E("blogTip"),"opacity",u)};t.onEnd=function(){t=null;$E("blogTip").style.display="none"};t.start()}});CommentV2.CommentForCheck=Core.Class.create();CommentV2.CommentForCheck.prototype={initialize:function(a){this._opt=a;if(scope.$commentlistIsReady){this.load()}else{Lib.Listener.on({name:"commentlist-isready",callBack:this.load,scope:this})}},getParam:function(){return this._opt},load:function(){if($E("cmt_"+this._opt.cms_id)){this.setHashPos();return}var a=this.getParam();this.getInterface=new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload");this.getInterface.request({GET:a,onSuccess:function(b){this.rander(b)}.bind2(this),onError:function(b){},onFail:function(){}})},rander:function(a){var b=$E("article_comment_list");var d=new CommentV2.Add();a.action_data=Utils.Json.flatten({commentid:a.id,articleid:scope.$articleid,fromProduct:a.fromProduct,comm_uid:a.comm_uid,uname:a.nick_name,ulink:a.ulink});a.uname=a.nick_name;a.action_data=encodeURIComponent(a.action_data);if(a.fromProduct=="weibo"){a.from='<img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="http://simg.sinajs.cn/images/common/sg_trans.gif">'}var c=d.render(a);b.insertBefore(c,b.firstChild);this.setHashPos()},setHashPos:function(){var a=window.location.hash;window.location.hash="cmt_"+this._opt.cms_id;window.location.hash=a}};$registJob("commentForCheck",function(){if(/cmtforcheck_/.test(location.hash)){var b=location.hash.split("_");var a={cms_id:b[1],uid:b[2]};new CommentV2.CommentForCheck(a)}});$registJob("diYuanXin",function(){Lib.diYuanXinLog(function(){try{vjEventTrack("")}catch(a){}})});$registJob("uatrack",function(){Lib.sendSuda(function(){var j=scope.$pageid;var b=Core.Dom.byClass;switch(j){case"editor":var g=b("msnTips_lx","div");if(g){v7sendLog("41_01_05");SUDA.uaTrack("blog_post","v_post1")}break;case"article":case"articleM":var f=$E("module_910");var a=$E("module_911");var d=$E("module_909");var m=$E("module_903");var c=$E("module_904");if(f){SUDA.uaTrack("blog_wqing_g","v_wqing_g")}if(a){v7sendLog("41_01_03");SUDA.uaTrack("blog_bjqing_g","v_bjqing_g");SUDA.uaTrack("blog_qing_g","v_SLOT_49");SUDA.uaTrack("blog_qing_g","v_SLOT_50");SUDA.uaTrack("blog_qing_g","v_SLOT_51")}if(d){SUDA.uaTrack("blog_btjblog","v_btjblog")}if(m){SUDA.uaTrack("blog_xg","v_blogxg")}if(c){SUDA.uaTrack("blog_tjblog","v_tjblog")}break}})});$registJob("hotAdvertise",function(){var f=document.getElementById("column_1");var g=Core.Dom.byClass("SG_conn","div",f);var d=document.getElementById("module_911")||g[g.length-1];var c='<div class="SG_conn" suda-uatrack="key=blog_article&value=h_article53" id="hotShangPin"></div>';Utils.insertTemplate(d,c,"AfterEnd");Lib.execZhitou(function(j){blogAd.insertIns("PDPS000000052389",$E("hotShangPin"),"Afterbegin");(window.sinaads||[]).push({})});var a=document.getElementById("module_903")||g[g.length-1];var b='<div class="SG_conn" id="recommendShangXun"><div class="SG_connHead"><span class="title">推荐商讯</span></div><div class="SG_connBody"><div class="atcTitList relaList"><ul></ul></div></div></div>';Utils.insertTemplate(a,b,"AfterEnd");Lib.execZhitou(function(j){blogAd.insertIns("PDPS000000052390",$E("recommendShangXun").children[1].children[0].children[0],"Afterbegin");(window.sinaads||[]).push({params:{sinaads_ad_tpl:'<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a target="_blank" suda-uatrack="key=blog_article&value=h_article50" href="#{link}" onclick="try{#{monitor}}catch(e){}">#{src}</a></p><p class="atcTitCell_nm"><a target="_blank" suda-uatrack="key=blog_article&value=h_article50" href="#{link}" onclick="try{#{monitor}}catch(e){}" class="SG_linkb" style="display:inline-block;height:14px; line-height:14px; white-space:normal; overflow:hidden;">#{src1}</a></p></li>'}})})});$registJob("xgBlogAD",function(){var c=(scope.$pageid=="articleM_new"||scope.$pageid=="article_new");var n=Core.Dom.getElementsByClass;var o=Core.Dom.insertHTML;var g=$E("module_903");var d,q,j,t,r;var p="http://comet.blog.sina.com.cn/api?maintype=pagexg";var a="SLOT_89";var u='<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>';var v='<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="{{a_href}}" target="_blank">{{author}}</a></span></li>';var z='<li><p class=Ltit><a {{a_c_suda}} class="BNE_lkA" href="{{a_href}}" target="_blank" title="{{a_title}}"><i class="icon i7_dot"></i>{{words}}</a></p><p class="Lname"><a {{a_c_suda}} class="BNE_lkB" href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>';var b='<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="http://blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>';var A='<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="http://blog.sina.com.cn/u/{{uid}}" target="_blank">{{author}}</a></span></li>';var y='<li><p class=Ltit><a {{a_c_suda}} class="BNE_lkA" href="{{a_href}}" target="_blank" title="{{a_title}}"><i class="icon i7_dot"></i>{{a_title}}</a></p><p class="Lname"><a {{a_c_suda}} class="BNE_lkB" href="http://blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>';function s(B,F){var D,C,E;for(C in F){E=new RegExp("{{"+C+"}}","ig");D=(D||B).replace(E,F[C])}return D}function f(){Utils.Io.JsLoad.request(p,{GET:{id:a,uid:$UID||0,blogerid:scope.$uid||0},onComplete:function(B){var C=null;if(B[a]){C=B[a].res[0]}if(C){if(scope.$pageid=="articletj"){var E=s(v,C);o(q,E,"AfterEnd")}else{if(c){var D=s(z,C);o(q,D,"AfterEnd")}else{var F=s(u,C);o(q,F,"AfterEnd")}}if(SUDA){SUDA.uaTrack(C.a_v_suda_key,C.a_v_suda_value)}}m()},onException:function(B){}})}function m(){var C=scope.$articleid;var F=scope.$cate_id;var E=scope.$sort_id;if(C){var B="http://blog.sina.com.cn/s/related_"+C+".js";var D={cate_id:F,sort_id:E};d=c?n(g,"ul","crlaList"):n(g,"div","SG_connBody");r=c?n(g,"div","more"):n(g,"div","atcTit_more");if(scope.$pageid=="articletj"){t=n(d[0],"li","reco_bloglist_con").length}else{if(c){t=n(d[0],"li","").length}else{t=n(d[0],"li","SG_j_linedot1").length}}if(t>3){return}Utils.Io.Ajax.request(B,{returnType:"json",GET:D,onComplete:function(H){var I=H.slideReads;var H=H.relatedReads;if(scope.$pageid=="articletj"){var N=n(d[0],"ul","reco_bloglist have_user")[0];if(N){for(var G=0;G<H.length;G++){var L=s(A,H[G]);o(N,L,"BeforeEnd")}}}else{if(c){var N=d[0];if(N){for(var G=0;G<H.length;G++){var K=s(y,H[G]);o(N,K,"BeforeEnd")}}}else{var N=n(d[0],"ul","")[0];if(N){for(var G=0;G<H.length;G++){var M=s(b,H[G]);o(N,M,"BeforeEnd")}}}}var J=n(r[0],"a","")[0];if(J){if(E=="111"){J.setAttribute("href","http://finance.sina.com.cn/blog/8.html")}else{if(E=="153"){J.setAttribute("href","http://finance.sina.com.cn/blog/2.html")}}}if(typeof window.scope.___fnForListenerSlot==="function"){window.scope.___fnForListenerSlot(I)}else{window.scope.___fnForListenerSlot=I}},onException:function(G){}})}}if(scope.$pageid=="articletj"){d=n(g,"div","SG_connBody");q=n(d[0],"li","reco_bloglist_con")[1]}else{if(c){d=n(g,"ul","crlaList");q=n(d[0],"li","")[1]}else{d=n(g,"div","SG_connBody");q=n(d[0],"li","SG_j_linedot1")[1]}}if(q){f()}});Lib.register("blogAppAd",function(d){function c(){Core.Dom.insertHTML(document.body,'<div id="sinaads_pdps54771"></div>',"beforeend");var j="sinaads_blogAppAd_"+scope.$PRODUCT_NAME+scope.$pageid;if(document.cookie.indexOf(j)===-1){var f=document.getElementById("sinaads_pdps54771");f.innerHTML=' <ins class="sinaads" data-ad-pdps="PDPS000000054771"></ins>  ';(sinaads=window.sinaads||[]).push({params:{sinaads_ls_root:"sinablogbody",sinaads_ls_cookieKey:j}});var g=new Date();g.setTime(g.getTime()+24*60*60*1000);document.cookie="blogAppAd_"+scope.$PRODUCT_NAME+scope.$pageid+"=1; expires="+g.toGMTString()}}d.execZhitou(function(){c()});var b=d.Panel;var a=new b();a.init=function(v){var A="blogAppAd_"+scope.$PRODUCT_NAME+scope.$pageid;var p=Utils.Cookie.getCookie(A);if(p=="1"){return}var s=this;var o="http://comet.blog.sina.com.cn/qr?";var B={blog7indexM:"http://blog.sina.com.cn/main_v5/ria/app_515_7.html",blog7index:"http://blog.sina.com.cn/main_v5/ria/app_515_7.html",blog7articleM:"http://blog.sina.com.cn/main_v5/ria/app_515_8.html",blog7article:"http://blog.sina.com.cn/main_v5/ria/app_515_8.html",blog7articletj:"http://blog.sina.com.cn/main_v5/ria/app_515_8.html",blog7articletjTech:"http://blog.sina.com.cn/main_v5/ria/app_515_8.html",blog7icpprofile_index:"http://blog.sina.com.cn/main_v5/ria/app_515_9.html",blog7articlelistM:"http://blog.sina.com.cn/main_v5/ria/app_515_10.html",blog7articlelist:"http://blog.sina.com.cn/main_v5/ria/app_515_10.html",blog7photoindex:"http://blog.sina.com.cn/main_v5/ria/app_515_11.html",blog7photophoto:"http://blog.sina.com.cn/main_v5/ria/app_515_12.html"};v=Core.Dom.getElementsByClass(null,"div",v)[0];var u=B[scope.$PRODUCT_NAME+scope.$pageid];if(!v||!u){return}var m=o+u;var r='<div style="position:absolute;width:140px;height:330px; text-align:center;z-index:999;" id="#{panel}">                                <a href="http://blog.sina.com.cn/s/blog_86f95d450102uzt1.html" target="_blank" ><img src="http://simg.sinajs.cn/blog7style/images/activity/app_tuiguang/activity.png" style="display:block;border:0 none;"></a>                                <a href="http://blog.sina.com.cn/s/blog_86f95d450102uzt1.html" target="_blank" style="background:#fff;border:1px solid #dbdbdb; border-top:0 none; height:117px; padding-top:5px; display:block; text-decoration:none;">                                    <img src="http://comet.blog.sina.com.cn/qr?http://blog.sina.com.cn/lm/z/xytx22/index.html" width="70" height="70" style="display:block; border:0 none; margin:0 auto 3px;">                                    <span style=" display:block;line-height:1;font-size:12px;margin-bottom:5px;color:#6e6e6e;text-align:center; font-family:Helvetica,\'Microsoft YaHei\'">新阅天下客户端</span>                                    <span style=" display:block;line-height:1;font-size:18px;color:#5f5f5f;text-align:center;font-family:Helvetica,\'Microsoft YaHei\';"> 扫一扫下载</span>                                    <span node-action="close" style="position:absolute;z-index:99;right:0px;bottom:0px;width:15px;height:15px;text-align:center;line-height:17px; overflow:hidden;border:1px solid #cbcbcb;cursor:pointer;font-size:15px;color:#5f5f5f; font-family:SimSun;font-weight:700;" title="关闭">×</span>                                </a>                            </div>';s.setTemplate(r);var j=parseInt(Core.Dom.getStyle(s.entity,"width"),10);var C=parseInt(Core.Dom.getStyle(v,"paddingTop"),10);var f=parseInt(Core.Dom.getStyle(s.entity,"height"),10);var y=10;s.setFixed(true);t();var z=Core.Dom.getElementsByAttr(s.entity,"node-action","close")[0];function q(){Core.Events.stopDefaultEvent();a.close();Core.Events.removeEvent(z,q);Core.Events.removeEvent(window,t,"resize");Utils.Cookie.setCookie(A,"1",24)}function n(){var E=window,D="inner";if(!("innerWidth" in window)){D="client";E=document.documentElement||document.body}return{width:E[D+"Width"],height:E[D+"Height"]}}var g;function t(){if(g){clearTimeout(g)}g=setTimeout(function(){var D=n().height;var E=Core.Dom.getXY(v);var G=E[0]-j-y;var F=E[1]+C;G=G>0?G:0;F=F+f>D?D-f-20:F;s.setPosition(G,F)},300)}Core.Events.addEvent(z,q);Core.Events.addEvent(window,t,"resize");Core.Events.addEvent(window,t,"scroll");s.show()};return a});$registJob("blogAppAd",function(){Lib.blogAppAd.init("sinablogbody")});Utils.tpl=function(a,b){return a.replace(/{(\w+)}/g,function(d,c){return b[c]})};$registJob("goldPan",function(){var u=Core.Events.addEvent;var n=Core.Dom.getElementsByAttr;var y=Core.Events.stopDefaultEvent;var d=Core.Events.getEvent;var q=Core.Events.getEventTarget;var t=Core.String.trim;var r=Utils.Form.Radio;var c={articleid:scope.$articleid,uid:scope.$uid,_uid:(typeof $UID!=="undefined"?$UID:null),goldPanNum:0,_goldPanNum:0};var m={getGoldPanNum:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/goldpen/user_goldpen_num.php","ijax"),giveGoldpan:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/goldpen/donate.php","ijax"),redeem:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/points/points_redeem.php","ijax"),zindexGold:new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/goldpen/goldpen_rank.php","ijax")};var f={M00:"赠送成功~！",M10:"请输入1~100整数",M11:"请选择或者输入您要赠送的金笔数",M12:"请求失败",M13:"赠送失败",M14:"不能给自己的文章赠送金笔"};var v=0;var a={tpl:'<table class="CP_w" id="#{panel}" style="z-index: 5000"><thead><tr><th class="tLeft"><span></span></th><th class="tMid"><div class="bLyTop"><strong>赠金笔</strong><cite><a node-data="btn-close" href="#" class="CP_w_shut" title="关闭">关闭</a></cite></div></th><th class="tRight"><span></span></th></tr></thead><tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td><td class="tRight"><span></span></td></tr></tfoot><tbody><tr><td class="tLeft"><span></span></td><td class="tMid"><div class="CP_layercon3 jiben"><div class="SG_tag tag_h"><ul><li class="current"><span><strong><a node-data="gold-exchange" href="javascript:void(0)">金笔兑换</a></strong></span><span class="tagR"></span></li><li><span><strong><a node-data="tyrant-standings" href="javascript:void(0)">今日土豪榜</a></strong></span><span class="tagR"></span></li><li><span><strong><a node-data="nomination-list" href="javascript:void(0)">今日提名榜</a></strong></span><span class="tagR"></span></li></ul></div><div name="jiben_tab" class="jiben_tab"><ul class="denPicRow denPicRow01 clearfix" name="radioAll"><li><span class="a">兑换服务：</span><span class="b">金笔道具</span></li><li><span class="a"><span class="CP_w_star"></span>赠送数量：</span><span class="b rlist"><input name="num" value="1" type="radio" id="jb1"><label for="jb1">1支</label><input name="num" value="10" type="radio" id="jb2"><label for="jb2">10支</label><input name="num" value="20" type="radio" id="jb3"><label for="jb3">20支</label><input name="num" value="50" type="radio" id="jb4"><label for="jb4">50支</label><input name="num" value="100" type="radio" id="jb5"><label for="jb5">100支</label><br><input name="num" value="0" type="radio" id="jb5"><label for="jb6">其他</label><input type="text" maxLength="4" class="SG_input" id="jb6" node-data="other-num" value="请输入整数"></span></li><li><span class="a cold">现有金笔：</span><span class="b cold" node-data="own-num">12支</span></li><li><span class="a cold">还需兑换：</span><span class="b cold" node-data="need-num">2支 x 50=100(积分)</span></li></ul><div id="hidden"></div><div class="butt01" id="button01"><a node-data="btn-ok" href="#" class="SG_aBtn SG_aBtnB "><cite>确认</cite></a><a target="_blank" href="http://blog.sina.com.cn/s/blog_4b0f52990102v0dd.html" class="jf_rule">点击了解更多规则</a></div></div><div class="clearit"></div></div></td><td class="tRight"><span></span></td></tr></tbody></table>',thTpl:'<tr><th width="50px" align="center"><a href="{1}"><img src="{0}"></a></th><th width="240px" align="left"><a href="{1}">{2}</a></th><th width="105px" align="left">{3}<!--今日提名榜此处是“收到金笔”--></th><th width="110px" align="left"><strong><span>{4}</span>支</strong></th><th align="left"><img src="http://simg.sinajs.cn/blog7style/images/common/badge/badge14.png" class="badge" style="background-image:url(../../images/common/badge/badge14.png);_background-image: url(../../images/common/badge/badge14.gif);"></th></tr>',testTpl:'<tr><td align="center"><a href="{1}"><img src="{0}"></a></td><td><a href="{1}">{2}</a></td><td>{3}</td><td><strong><span>{4}</span>支</strong></td><td><img src="http://simg.sinajs.cn/blog7style/images/common/badge/badge14.png" class="badge" style="background-image:url(../../images/common/badge/badge14.png);_background-image: url(../../images/common/badge/badge14.gif);"></td></tr>',w:669,h:412,bs:null,panel:null,box:null,radios:null,input:null,ownNumEl:null,needNumEl:null,cNum:1,price:1,updateTag:null,goldExchange:null,tyrantStandings:null,nominationList:null,init:function(){var A=this;var B=a.bs=new BackShadow(0.4);var z=a.panel=new Lib.Panel();z.setTemplate(A.tpl);var C=A.box=z.getNode("panel");A.radios=n(C,"name","num");A.input=n(C,"node-data","other-num")[0];A.ownNumEl=n(A.box,"node-data","own-num")[0];A.needNumEl=n(A.box,"node-data","need-num")[0];A.goldExchange=n(A.box,"node-data","gold-exchange")[0];A.tyrantStandings=n(A.box,"node-data","tyrant-standings")[0];A.nominationList=n(A.box,"node-data","nomination-list")[0];A.initBox();A.initEvent();A.setPosition()},initBox:function(){var A=this;var C=A.radios;var z=C.length;var B=A.cNum;r.set(C,B);if(!parseInt(r.get(C))){C[z-1].checked=true;A.input.value=B}A.input.value=f.M10;A.ownNumEl.innerHTML=c._goldPanNum+"支";A.changeNeed(B)},initEvent:function(){var z=this;u(z.input,function(){var A=z.getNum(z.input);z.radios[z.radios.length-1].checked=true;z.input.value=A||""},"focus");u(z.input,function(){var A=z.getNum(z.input);z.input.value=A||f.M10;z.changeNeed(A)},"blur");u(z.box,function(){var C=d();var A=q(C);var B=A.getAttribute("node-data")||A.parentNode.getAttribute("node-data");if(B=="btn-close"){y();z.hide()}else{if(B=="btn-ok"){y();if(!v){v=1;z.submit()}}else{var D=z.getNum();D!=z.cNum?z.changeNeed(D):""}}});u(z.goldExchange,function(){var D=n(z.box,"name","jiben_tab")[0];var A=$E("hidden");var B=$E("button01");var C=n((document.getElementsByTagName("body"))[0],"name","radioAll")[0];C.style.display="block";A.style.display="none";B.style.display="block";z.goldExchange.parentNode.parentNode.parentNode.className="current";z.tyrantStandings.parentNode.parentNode.parentNode.className="";z.nominationList.parentNode.parentNode.parentNode.className=""});u(z.tyrantStandings,function(){var D=n(z.box,"name","jiben_tab")[0];var C=n((document.getElementsByTagName("body"))[0],"name","radioAll")[0];var A=$E("hidden");var B=$E("button01");B.style.display="none";C.style.display="none";A.style.display="block";z.goldExchange.parentNode.parentNode.parentNode.className="";z.tyrantStandings.parentNode.parentNode.parentNode.className="current";z.nominationList.parentNode.parentNode.parentNode.className="";m.zindexGold.request({GET:{type:"donate"},onSuccess:function(G){if(G.length){var F='<table width="100%" border="0" cellspacing="0" cellpadding="0" class="top_tab">';for(var E=0;E<G.length;E++){if(E==0){F=F+Utils.tpl(z.thTpl,[G[E]["photo"],"http://blog.sina.com.cn/u/"+G[E]["uid"],G[E]["nickname"],"送出金笔",G[E]["number"]])}else{F=F+Utils.tpl(z.testTpl,[G[E]["photo"],"http://blog.sina.com.cn/u/"+G[E]["uid"],G[E]["nickname"],"送出金笔",G[E]["number"]])}}F=F+'</table><div class="butt01"> <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/goldpen_rank.php?action=1" class="SG_aBtn SG_aBtnB "><cite>查看更多</cite></a></div>';A.innerHTML=F}else{A.innerHTML=""}},onError:function(E){if(E.code=="A00005"){alert("非法操作")}else{if(E.code=="A11007"){alert("非博客用户，只是新浪用户")}else{if(E.code=="00015"){alert("参数错误")}}}},onFail:function(){console.log(arguments[0])}})});u(z.nominationList,function(){var D=n(z.box,"name","jiben_tab")[0];var C=n((document.getElementsByTagName("body"))[0],"name","radioAll")[0];var A=$E("hidden");var B=$E("button01");B.style.display="none";C.style.display="none";A.style.display="block";z.goldExchange.parentNode.parentNode.parentNode.className="";z.tyrantStandings.parentNode.parentNode.parentNode.className="";z.nominationList.parentNode.parentNode.parentNode.className="current";m.zindexGold.request({GET:{type:"receive"},onSuccess:function(G){if(G.length){var F='<table width="100%" border="0" cellspacing="0" cellpadding="0" class="top_tab">';for(var E=0;E<G.length;E++){if(E==0){F=F+Utils.tpl(z.thTpl,[G[E]["photo"],"http://blog.sina.com.cn/u/"+G[E]["uid"],G[E]["nickname"],"收到金笔",G[E]["number"]])}else{F=F+Utils.tpl(z.testTpl,[G[E]["photo"],"http://blog.sina.com.cn/u/"+G[E]["uid"],G[E]["nickname"],"收到金笔",G[E]["number"]])}}F=F+'</table><div class="butt01"> <a href="http://control.blog.sina.com.cn/blog_rebuild/profile/controllers/goldpen_rank.php?action=2" class="SG_aBtn SG_aBtnB "><cite>查看更多</cite></a></div>';A.innerHTML=F}else{A.innerHTML=""}},onError:function(E){if(E.code=="A00005"){alert("非法操作")}else{if(E.code=="A11007"){alert("非博客用户，只是新浪用户")}else{if(E.code=="00015"){alert("参数错误")}}}},onFail:function(){}})})},changeNeed:function(B){var z=this;var A=0;if(B>c._goldPanNum){A=B-c._goldPanNum}z.cNum=B;z.needNumEl.innerHTML=A+"支 x "+z.price+"="+A*z.price+"(积分)"},updateOwnNum:function(A){var z=this;var B=new Date().valueOf();if(A!=1&&(!c._uid||(B-z.updateTag)<60*1000)){return}z.updateTag=B;m.getGoldPanNum.request({GET:{uid:c._uid},onSuccess:function(C){c._goldPanNum=parseInt(C&&C.total)||0;z.initBox();z.updateTag=new Date().valueOf()},onError:function(C){},onFail:function(){}})},getNum:function(z){var A=z?Math.abs(parseInt(t(z.value))||0):Math.abs(parseInt(r.get(this.radios)/1||this.input.value/1||0));return A>100?100:A},submit:function(){var z=this;var A=z.getNum();if(c.uid==c._uid){winDialog.alert(f.M14);v=0;return}if(!A){winDialog.alert(f.M11);v=0;return}else{if(A>c._goldPanNum){var B=A-c._goldPanNum;o(B,function(D,C){if(D){g({blogid:c.articleid,num:A,newnum:B},function(F,E){if(F){winDialog.alert(f.M00);b();z.updateOwnNum(1);z.hide();v=0}else{winDialog.alert(E);v=0}});c._goldPanNum=A;z.ownNumEl.innerHTML=A+"支";z.changeNeed(A)}else{winDialog.alert(C);v=0}})}else{g({blogid:c.articleid,num:A},function(D,C){if(D){winDialog.alert(f.M00);b();z.updateOwnNum(1);z.hide();v=0}else{winDialog.alert(C);v=0}})}}},show:function(){this.updateOwnNum();this.bs.show();this.panel.show()},hide:function(){this.panel.hide();this.bs.hidden()},setPosition:function(){var A=this;var B=Core.System.winSize();var z=B.width/2-A.w/2;var C=B.height/2-A.h/2-20;A.panel.setPosition(z,C);A.panel.setFixed(true)}};var s={tpl:['<table class="CP_w" id="#{panel}" style="z-index: 5000">',"<thead>","<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong>提示</strong><cite><a href="#" class="CP_w_shut" data-node="btn-close" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon9 jinbi_f">',"<p><strong>写的不错，送支金笔奖励一下吧！只需要1积分哦！！！！！</strong></p>",'<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" data-node="btn-ok"><cite>确认</cite></a></p>',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),w:396,h:198,bs:null,panel:null,box:null,init:function(){var A=this;var B=A.bs=new BackShadow(0.4);var z=A.panel=new Lib.Panel();z.setTemplate(A.tpl);var D=A.box=z.getNode("panel");var E=n(D,"data-node","btn-close")[0];var C=n(D,"data-node","btn-ok")[0];u(E,function(){y();A.hide()});u(C,function(){y();if(!v){v=1;A.submit()}});A.setPosition();A.isInit=1},submit:function(){var z=this;var A=1;if(c.uid==c._uid){winDialog.alert(f.M14);v=0;return}if(c._goldPanNum<A){var B=A-c._goldPanNum;o(B,function(D,C){if(D){g({blogid:c.articleid,num:A,newnum:B},function(F,E){if(F){winDialog.alert(f.M00);b();z.hide();v=0}else{winDialog.alert(E);v=0}})}else{winDialog.alert(C);v=0}})}else{g({blogid:c.articleid,num:A},function(D,C){if(D){winDialog.alert(f.M00);b();z.hide();v=0}else{winDialog.alert(C);v=0}})}},show:function(){!this.isInit?this.init():"";this.bs.show();this.panel.show()},hide:function(){this.panel.hide();this.bs.hidden()},setPosition:function(){var A=this;var B=Core.System.winSize();var z=B.width/2-A.w/2;var C=B.height/2-A.h/2-20;A.panel.setPosition(z,C);A.panel.setFixed(true)}};function j(z){var A=new Interface("http://blogtj.sinajs.cn/api/get_attention_num.php","jsload");var B={uid:$UID,suid:$UID,attention:"suid",userpointuid:$UID,s:"1"};A.request({GET:B,onSuccess:function(C){z(C)},onError:function(){z({})},onFail:function(){z({})}})}function o(A,z){m.redeem.request({POST:{type:10,num:A,user:"",auto:0},onSuccess:function(B){z(true)},onError:function(B){z(false,B&&B.data)},onFail:function(){z(false,f.M12)}})}function g(A,z){m.giveGoldpan.request({POST:A,onSuccess:function(B){z(1)},onError:function(B){z(0,B&&B.data)},onFail:function(){z(0,f.M13)}})}function b(){Utils.Io.JsLoad.request("http://comet.blog.sina.com.cn/api?maintype=goldpen&blogid="+c.articleid,{onComplete:function(A){var z=$E("goldPan-num");if(A&&z){z.innerHTML=c.goldPanNum=parseInt(A.blog_receive)||0}},onException:function(){}})}function p(){Lib.checkAuthor();b();a.init();$isLogin?j(function(z){c._userpoint=z.userpoint;c._goldPanNum=z.goldpen;if(z.userpoint>0||z.goldpen>0){Lib.Listener.on({name:"article_like_success",callBack:function(){s.show()}})}}):"";u($E("goldPan-give"),function(){if(!$isLogin){var E=new Lib.Login.Ui();E.login(function(){scope.blogOpener.showDialog(function(){c._uid=$UID;a.show()})},false,"referer:"+location.hostname+location.pathname+",func:giveGoldpan")}else{a.show();var D=n((document.getElementsByTagName("body"))[0],"name","jiben_tab")[0];var A=n((document.getElementsByTagName("body"))[0],"node-data","other-num")[0];n((document.getElementsByTagName("body"))[0],"node-data","gold-exchange")[0].parentNode.parentNode.parentNode.className="current";n((document.getElementsByTagName("body"))[0],"node-data","tyrant-standings")[0].parentNode.parentNode.parentNode.className="";n((document.getElementsByTagName("body"))[0],"node-data","nomination-list")[0].parentNode.parentNode.parentNode.className="";var C=n((document.getElementsByTagName("body"))[0],"name","radioAll")[0];var z=$E("hidden");var B=$E("button01");B.style.display="block";C.style.display="block";z.style.display="none"}})}p()});$registJob("godReply",function(){var f=Core.Dom.getElementsByAttr;var c=Core.Events.addEvent;var a=Core.Events.getEventTarget;var m=Core.Events.stopDefaultEvent;var g=Core.System.winSize;var j=Core.Dom.setStyle;var o=Lib.Panel;var n=$E("sinablogbody");var d="http://simg.sinajs.cn/blog7style/images/common/godreply/";var b={oPanel:new o(),fPanel:new o(),commentPost:new CommentV2.Post(),faceImgs:[{code:"0101",img:d+"E___0101GD00SIGT.gif",title:"贱人就是矫情"},{code:"0102",img:d+"E___0102GD00SIGT.gif",title:"人艰不拆"},{code:"0103",img:d+"E___0103GD00SIGT.gif",title:"朕知道了"},{code:"0104",img:d+"E___0104GD00SIGT.gif",title:"不明觉厉"},{code:"0105",img:d+"E___0105GD00SIGT.gif",title:"这真是极好的"},{code:"0106",img:d+"E___0106GD00SIGT.gif",title:"也真是醉了"},{code:"0107",img:d+"E___0107GD00SIGT.gif",title:"点个赞"},{code:"0108",img:d+"E___0108GD00SIGT.gif",title:"你那么萌你家人造吗"},{code:"0109",img:d+"E___0109GD00SIGT.gif",title:"涨姿势"}],init:function(){var p=this;p.commentPost.articleid=scope.$articleid;p.initOpanel();p.initFopanel()},initOpanel:function(){var B=this;var p=B.oPanel;var y=B.getOpanelTpl();p.setTemplate(y);var z=58;var t=58;var u=parseInt(Core.Dom.getStyle(p.entity,"width"),10)||308;var s=5;var r;var q=f(p.entity,"node-data","btn-golgreply")[0];var A=f(p.entity,"node-data","reply-conlist")[0];p.setFixed(true);v();p.showList=function(){A.style.display=""};p.hideList=function(){A.style.display="none"};function v(){if(r){clearTimeout(r)}r=setTimeout(function(){var C=g();var E=Core.Dom.getXY(n);var D=parseInt(Core.Dom.getStyle(n,"width"));var G=Math.min(C.width-u-z-20,E[0]+D+s-u);var F=Math.max(C.height-260-t,80);p.setPosition(G,F)},300)}c(q.parentNode,function(){q.style.display=""},"mouseover");c(q.parentNode,function(){q.style.display="none"},"mouseout");c(q.parentNode,function(){A.style.display=A.style.display!="none"?"none":""});c(A,function(){var E=a();var D=E.tagName.toLocaleLowerCase();if(D=="img"){E=E.parentNode}var C=parseInt(E.getAttribute("data-num"));if(C>=0){m();p.currTar?Core.Dom.removeClass(p.currTar,"click"):"";Core.Dom.addClass(E,"click");p.currTar=E;B.cfaceData=B.faceImgs[C];B.fPanel.show()}});c(window,v,"resize");c(window,v,"scroll");p.show()},initFopanel:function(){var A=this;var p=A.fPanel;var z='<div class="godreply_show" id="#{panel}" style="z-index:1001">                               <div class="reply_pic_l" node-data="facebox">                                 <img node-data="faceimg" title="" alt="" src="">                               </div>                               <div class="btn_group" node-data="action" style="display:none;"><a href="#" class="a1" action-type="ok">发表</a><a href="#" class="a2" action-type="cancel">取消</a></div>                               <div class="jgimg" node-data="success" style="display:none;"><img src="http://simg.sinajs.cn/blog7style/images/common/godreply/jf.gif"><div class="txt">发表成功</div></div>                           </div>';p.noIframe=true;p.setTemplate(z);p.setFixed(true);var u=p.entity;var q=Core.Dom.getElementsByAttr(u,"node-data","facebox")[0];var r=Core.Dom.getElementsByAttr(u,"node-data","faceimg")[0];var v=Core.Dom.getElementsByAttr(u,"node-data","action")[0];var t=Core.Dom.getElementsByAttr(u,"node-data","success")[0];var C=460;var B=230;var s;y();function y(){if(s){clearTimeout(s)}s=setTimeout(function(){var D=g();var F=parseInt((D.width-C)/2-85,10);var E=parseInt(D.height/2-B,10);p.setPosition(F,E)},300)}p._show=p.show;p.show=function(){var D=A.cfaceData;r.title=D.title;r.alt=D.title;r.src=D.img;t.style.visibility="hidden";v.style.display="none";q.style.display="";j(u,"background","none");var F=0;var E=2;(function(){var H=g();var G=C*E;var I=B*E;var K=parseInt((H.width-G)/2-85,10);var J=parseInt(H.height/2-I,10);r.width=G;r.height=I;p.setPosition(K,J);j(u,"width",G);j(u,"opacity",F);F+=0.1;E-=0.1;if(F<1){setTimeout(arguments.callee,20)}else{y();j(u,"opacity",1);j(u,"background","");v.style.display="";A.domShake($E("sinabloga"))}})();p._show()};c(v,function(){var F=a();var D=F.getAttribute("action-type");m();if(D=="ok"){Lib.checkAuthor();if($isLogin){A.submit()}else{var E=new Lib.Login.Ui();E.login(function(){scope.blogOpener.showDialog(function(){A.submit()})},false,"referer:"+location.hostname+location.pathname+",func:godFace")}p.hide()}else{if(D=="cancel"){p.hide()}}});c(window,y,"resize");c(window,y,"scroll");A.commentPost.onSuccess=function(){A.oPanel.hideList();v.style.display="none";q.style.display="none";t.style.display="";t.style.visibility="";p._show();var D=1;(function(){j(u,"opacity",D);D-=0.1;if(D>0){setTimeout(arguments.callee,100)}else{p.hide();j(u,"opacity","")}})()};A.commentPost.onError=function(){}},getOpanelTpl:function(){var t=this.faceImgs;var q='<li title="{title}" data-num="{i}"><img src="{img}" title="{title}" alt="{title}"/></li>';var s="";for(var r=0;r<9;r++){var u=t[r];if(u){u.i=r;s+=Utils.tpl(q,u)}}var p='<div class="godreply" id="#{panel}" style="z-index:999;">                              <div class="btn"><span node-data="btn-golgreply" style="display:none;">神回复</span></div>                              <div class="reply_con" node-data="reply-conlist" style="display:none;">                                <div class="txt">神回复，只要<span>1积分</span>就可以了哦</div>                                <ul class="reply_pic_s">'+s+"</ul>                              </div>                            </div>";return p},domShake:function(r){var u=20;var p=1;var q=0.5;var v=0;(function(){var s=0;var t=0;switch(p){case 1:v+=q;v>1?v=1:"";s=u*v;if(v==1){p=2}break;case 2:v-=q;v<0?v=0:"";s=v;if(v==0){p=3;u-=2}break;case 3:v+=q;v>1?v=1:"";t=v;if(v==1){p=4}break;case 4:t=--v;v<0?v=0:"";if(v==0){p=1;u-=2}break;default:break}if(u>0){j(r,"padding","0 "+t+"px 0 "+s+"px");setTimeout(arguments.callee,1)}else{j(r,"padding","0")}})()},submit:function(){var p=this;var q=p.cfaceData;var r={god:1,comment:"[emoticons=E___"+q.code+"GD00SIG]"+q.title+"[/emoticons]",login_name:"",login_pass:"",check:"",comment_anonyous:"新浪网友",anonymity:false,is_t:0};p.commentPost.post(r)}};b.init()});$registJob("articleMaxImg",function(){var f=scope.$pageid,m=Core.Dom.getElementsByClass,a=Core.Dom.getStyle,d="100%",c;function j(o,n,p){setTimeout(function(){if(o.width>p){if("max-width" in o.style){o.style["max-width"]=n}else{o.style.width=n}}if(o.width==1){j(o,n,p)}},100)}function g(o,n){var s=parseInt(a(o[0],"width"),10);for(var r=0;r<o.length;r++){var t=o[r];var u=t.getElementsByTagName("img");for(var q=0;q<u.length;q++){var p=u[q];j(p,n,s)}}}if(f=="indexM"||f=="index"){c=$E("module_10001_SG_connBody");var b=m(c,"div","content");g(b,d)}else{if(f=="articleM"||f=="article"){c=$E("sina_keyword_ad_area2");g([c],d)}}});function main(){var a=window.location.href.indexOf("tj=1")>-1;if(a){v7sendLog("42_01_07")}var c=Lib.Listener;c.add("tray-ad-tips");var b=new Jobs();b.add("suda");b.add("tray");b.add("trayTipsAd");b.add("renderAd");b.add("showTB680");b.add("digger");b.add("articleDigger");b.add("recordVisitor");b.add("renderReblogDiv");b.add("godReply");b.add("articleCommentV2");b.add("goldPan");b.add("blogNotice");b.add("trashPv");b.add("adNoticeChannel");b.add("articleMaxImg");b.add("imageLazyLoad");b.add("articleComp1");b.add("articleNumberV2");b.add("articleCommentPostV2");b.add("quote");b.add("quote_list");b.add("dynamicVoteView");b.add("updownurl");b.add("articleComp2");b.add("sharePhoto");b.add("templateClone",3);b.add("favGames");b.add("teams_wc");b.add("calendar_wc");b.add("phone_attention_add",3);b.add("randomScroll",3);b.add("audioCheck",3);b.add("subscribe",3);b.add("articleShare",3);b.add("report_bodyArticle");b.add("flashtemplate",3);b.add("stylefix",3);b.add("miniBlogAttention");b.add("baby_headPhoto");b.add("baby_babyBarFlashDetect");b.add("scrollAd");b.add("static");b.add("userResidenceTime");b.add("blog365Slide");b.add("SinglesDay");b.add("selectionShare");b.add("qingRecommend",3);b.add("qingRecomNew",3);b.add("tranVideo");b.add("errorTips");b.add("toZoneStatic",3);b.add("tjAd",3);b.add("showSlideBox",3);b.add("showSlideBtn",3);b.add("xingqu",3);b.add("osl_article",3);b.add("padSwitch");b.add("loginFollow");b.add("uatrack");b.add("blogTip");b.add("commentForCheck");b.add("diYuanXin");b.add("xgBlogAD");b.add("blogAppAd");b.add("hotAdvertise");b.start()};